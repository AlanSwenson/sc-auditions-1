(function(e,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)})(typeof window!="undefined"?window:this,function(e,t){function y(e){var t=e.length,n=p.type(e);return n==="function"||p.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||t===0||typeof t=="number"&&t>0&&t-1 in e}function x(e,t,n){if(p.isFunction(t))return p.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return p.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(S.test(t))return p.filter(t,e,n);t=p.filter(t,e)}return p.grep(e,function(e){return p.inArray(e,t)>=0!==n})}function O(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function D(e){var t=_[e]={};return p.each(e.match(M)||[],function(e,n){t[n]=!0}),t}function H(){N.addEventListener?(N.removeEventListener("DOMContentLoaded",B,!1),e.removeEventListener("load",B,!1)):(N.detachEvent("onreadystatechange",B),e.detachEvent("onload",B))}function B(){if(N.addEventListener||event.type==="load"||N.readyState==="complete")H(),p.ready()}function R(e,t,n){if(n===undefined&&e.nodeType===1){var r="data-"+t.replace(q,"-$1").toLowerCase();n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:I.test(n)?p.parseJSON(n):n}catch(i){}p.data(e,t,n)}else n=undefined}return n}function U(e){var t;for(t in e){if(t==="data"&&p.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function z(e,t,r,i){if(!p.acceptData(e))return;var s,o,u=p.expando,a=e.nodeType,f=a?p.cache:e,l=a?e[u]:e[u]&&u;if((!l||!f[l]||!i&&!f[l].data)&&r===undefined&&typeof t=="string")return;l||(a?l=e[u]=n.pop()||p.guid++:l=u),f[l]||(f[l]=a?{}:{toJSON:p.noop});if(typeof t=="object"||typeof t=="function")i?f[l]=p.extend(f[l],t):f[l].data=p.extend(f[l].data,t);return o=f[l],i||(o.data||(o.data={}),o=o.data),r!==undefined&&(o[p.camelCase(t)]=r),typeof t=="string"?(s=o[t],s==null&&(s=o[p.camelCase(t)])):s=o,s}function W(e,t,n){if(!p.acceptData(e))return;var r,i,s=e.nodeType,o=s?p.cache:e,u=s?e[p.expando]:p.expando;if(!o[u])return;if(t){r=n?o[u]:o[u].data;if(r){p.isArray(t)?t=t.concat(p.map(t,p.camelCase)):t in r?t=[t]:(t=p.camelCase(t),t in r?t=[t]:t=t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!U(r):!p.isEmptyObject(r))return}}if(!n){delete o[u].data;if(!U(o[u]))return}s?p.cleanData([e],!0):c.deleteExpando||o!=o.window?delete o[u]:o[u]=null}function tt(){return!0}function nt(){return!1}function rt(){try{return N.activeElement}catch(e){}}function it(e){var t=st.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Et(e,t){var n,r,i=0,s=typeof e.getElementsByTagName!==j?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==j?e.querySelectorAll(t||"*"):undefined;if(!s)for(s=[],n=e.childNodes||e;(r=n[i])!=null;i++)!t||p.nodeName(r,t)?s.push(r):p.merge(s,Et(r,t));return t===undefined||t&&p.nodeName(e,t)?p.merge([e],s):s}function St(e){K.test(e.type)&&(e.defaultChecked=e.checked)}function xt(e,t){return p.nodeName(e,"table")&&p.nodeName(t.nodeType!==11?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function Tt(e){return e.type=(p.find.attr(e,"type")!==null)+"/"+e.type,e}function Nt(e){var t=mt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Ct(e,t){var n,r=0;for(;(n=e[r])!=null;r++)p._data(n,"globalEval",!t||p._data(t[r],"globalEval"))}function kt(e,t){if(t.nodeType!==1||!p.hasData(e))return;var n,r,i,s=p._data(e),o=p._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)p.event.add(t,n,u[n][r])}o.data&&(o.data=p.extend({},o.data))}function Lt(e,t){var n,r,i;if(t.nodeType!==1)return;n=t.nodeName.toLowerCase();if(!c.noCloneEvent&&t[p.expando]){i=p._data(t);for(r in i.events)p.removeEvent(t,r,i.handle);t.removeAttribute(p.expando)}if(n==="script"&&t.text!==e.text)Tt(t).text=e.text,Nt(t);else if(n==="object")t.parentNode&&(t.outerHTML=e.outerHTML),c.html5Clone&&e.innerHTML&&!p.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML);else if(n==="input"&&K.test(e.type))t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value);else if(n==="option")t.defaultSelected=t.selected=e.defaultSelected;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function Mt(t,n){var r=p(n.createElement(t)).appendTo(n.body),i=e.getDefaultComputedStyle?e.getDefaultComputedStyle(r[0]).display:p.css(r[0],"display");return r.detach(),i}function _t(e){var t=N,n=Ot[e];if(!n){n=Mt(e,t);if(n==="none"||!n)At=(At||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=(At[0].contentWindow||At[0].contentDocument).document,t.write(),t.close(),n=Mt(e,t),At.detach();Ot[e]=n}return n}function Ft(e,t){return{get:function(){var n=e();if(n==null)return;if(n){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function $t(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Vt.length;while(i--){t=Vt[i]+n;if(t in e)return t}return r}function Jt(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=p._data(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&$(r)&&(s[o]=p._data(r,"olddisplay",_t(r.nodeName)))):s[o]||(i=$(r),(n&&n!=="none"||!i)&&p._data(r,"olddisplay",i?n:p.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function Kt(e,t,n){var r=Ut.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Qt(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=p.css(e,n+V[s],!0,i)),r?(n==="content"&&(o-=p.css(e,"padding"+V[s],!0,i)),n!=="margin"&&(o-=p.css(e,"border"+V[s]+"Width",!0,i))):(o+=p.css(e,"padding"+V[s],!0,i),n!=="padding"&&(o+=p.css(e,"border"+V[s]+"Width",!0,i)));return o}function Gt(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=Ht(e),o=c.boxSizing()&&p.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=Bt(e,t,s);if(i<0||i==null)i=e.style[t];if(Pt.test(i))return i;r=o&&(c.boxSizingReliable()||i===e.style[t]),i=parseFloat(i)||0}return i+Qt(e,t,n||(o?"border":"content"),r,s)+"px"}function Yt(e,t,n,r,i){return new Yt.prototype.init(e,t,n,r,i)}function un(){return setTimeout(function(){Zt=undefined}),Zt=p.now()}function an(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=V[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function fn(e,t,n){var r,i=(on[t]||[]).concat(on["*"]),s=0,o=i.length;for(;s<o;s++)if(r=i[s].call(n,t,e))return r}function ln(e,t,n){var r,i,s,o,u,a,f,l,h=this,d={},v=e.style,m=e.nodeType&&$(e),g=p._data(e,"fxshow");n.queue||(u=p._queueHooks(e,"fx"),u.unqueued==null&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,h.always(function(){h.always(function(){u.unqueued--,p.queue(e,"fx").length||u.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[v.overflow,v.overflowX,v.overflowY],f=p.css(e,"display"),l=_t(e.nodeName),f==="none"&&(f=l),f==="inline"&&p.css(e,"float")==="none"&&(!c.inlineBlockNeedsLayout||l==="inline"?v.display="inline-block":v.zoom=1)),n.overflow&&(v.overflow="hidden",c.shrinkWrapBlocks()||h.always(function(){v.overflow=n.overflow[0],v.overflowX=n.overflow[1],v.overflowY=n.overflow[2]}));for(r in t){i=t[r];if(tn.exec(i)){delete t[r],s=s||i==="toggle";if(i===(m?"hide":"show")){if(i!=="show"||!g||g[r]===undefined)continue;m=!0}d[r]=g&&g[r]||p.style(e,r)}}if(!p.isEmptyObject(d)){g?"hidden"in g&&(m=g.hidden):g=p._data(e,"fxshow",{}),s&&(g.hidden=!m),m?p(e).show():h.done(function(){p(e).hide()}),h.done(function(){var t;p._removeData(e,"fxshow");for(t in d)p.style(e,t,d[t])});for(r in d)o=fn(m?g[r]:0,r,h),r in g||(g[r]=o.start,m&&(o.end=o.start,o.start=r==="width"||r==="height"?1:0))}}function cn(e,t){var n,r,i,s,o;for(n in e){r=p.camelCase(n),i=t[r],s=e[n],p.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=p.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function hn(e,t,n){var r,i,s=0,o=sn.length,u=p.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Zt||un(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:p.extend({},t),opts:p.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Zt||un(),duration:n.duration,tweens:[],createTween:function(t,n){var r=p.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;cn(l,f.opts.specialEasing);for(;s<o;s++){r=sn[s].call(f,e,l,f.opts);if(r)return r}return p.map(l,fn,f),p.isFunction(f.opts.start)&&f.opts.start.call(e,f),p.fx.timer(p.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function In(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(M)||[];if(p.isFunction(n))while(r=s[i++])r.charAt(0)==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function qn(e,t,n,r){function o(u){var a;return i[u]=!0,p.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===Bn;return o(t.dataTypes[0])||!i["*"]&&o("*")}function Rn(e,t){var n,r,i=p.ajaxSettings.flatOptions||{};for(r in t)t[r]!==undefined&&((i[r]?e:n||(n={}))[r]=t[r]);return n&&p.extend(!0,e,n),e}function Un(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),i===undefined&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in u)if(u[o]&&u[o].test(i)){a.unshift(o);break}if(a[0]in n)s=a[0];else{for(o in n){if(!a[0]||e.converters[o+" "+a[0]]){s=o;break}r||(r=o)}s=s||r}if(s)return s!==a[0]&&a.unshift(s),n[s]}function zn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function Kn(e,t,n,r){var i;if(p.isArray(t))p.each(t,function(t,i){n||Xn.test(e)?r(e,i):Kn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&p.type(t)==="object")for(i in t)Kn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Zn(){try{return new e.XMLHttpRequest}catch(t){}}function er(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function sr(e){return p.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n=[],r=n.slice,i=n.concat,s=n.push,o=n.indexOf,u={},a=u.toString,f=u.hasOwnProperty,l="".trim,c={},h="1.11.0",p=function(e,t){return new p.fn.init(e,t)},d=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,v=/^-ms-/,m=/-([\da-z])/gi,g=function(e,t){return t.toUpperCase()};p.fn=p.prototype={jquery:h,constructor:p,selector:"",length:0,toArray:function(){return r.call(this)},get:function(e){return e!=null?e<0?this[e+this.length]:this[e]:r.call(this)},pushStack:function(e){var t=p.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return p.each(this,e,t)},map:function(e){return this.pushStack(p.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:s,sort:n.sort,splice:n.splice},p.extend=p.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[u]||{},u++),typeof o!="object"&&!p.isFunction(o)&&(o={}),u===a&&(o=this,u--);for(;u<a;u++)if((i=arguments[u])!=null)for(r in i){e=o[r],n=i[r];if(o===n)continue;f&&n&&(p.isPlainObject(n)||(t=p.isArray(n)))?(t?(t=!1,s=e&&p.isArray(e)?e:[]):s=e&&p.isPlainObject(e)?e:{},o[r]=p.extend(f,s,n)):n!==undefined&&(o[r]=n)}return o},p.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return p.type(e)==="function"},isArray:Array.isArray||function(e){return p.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||p.type(e)!=="object"||e.nodeType||p.isWindow(e))return!1;try{if(e.constructor&&!f.call(e,"constructor")&&!f.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(c.ownLast)for(t in e)return f.call(e,t);for(t in e);return t===undefined||f.call(e,t)},type:function(e){return e==null?e+"":typeof e=="object"||typeof e=="function"?u[a.call(e)]||"object":typeof e},globalEval:function(t){t&&p.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(v,"ms-").replace(m,g)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=y(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:l&&!l.call("﻿ ")?function(e){return e==null?"":l.call(e)}:function(e){return e==null?"":(e+"").replace(d,"")},makeArray:function(e,t){var n=t||[];return e!=null&&(y(Object(e))?p.merge(n,typeof e=="string"?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(o)return o.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var n=+t.length,r=0,i=e.length;while(r<n)e[i++]=t[r++];if(n!==n)while(t[r]!==undefined)e[i++]=t[r++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length,u=!n;for(;s<o;s++)r=!t(e[s],s),r!==u&&i.push(e[s]);return i},map:function(e,t,n){var r,s=0,o=e.length,u=y(e),a=[];if(u)for(;s<o;s++)r=t(e[s],s,n),r!=null&&a.push(r);else for(s in e)r=t(e[s],s,n),r!=null&&a.push(r);return i.apply([],a)},guid:1,proxy:function(e,t){var n,i,s;return typeof t=="string"&&(s=e[t],t=e,e=s),p.isFunction(e)?(n=r.call(arguments,2),i=function(){return e.apply(t||this,n.concat(r.call(arguments)))},i.guid=e.guid=e.guid||p.guid++,i):undefined},now:function(){return+(new Date)},support:c}),p.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()});var b=function(e){function rt(e,t,r,i){var s,o,u,a,f,h,v,m,w,E;(t?t.ownerDocument||t:b)!==c&&l(t),t=t||c,r=r||[];if(!e||typeof e!="string")return r;if((a=t.nodeType)!==1&&a!==9)return[];if(p&&!i){if(s=G.exec(e))if(u=s[1]){if(a===9){o=t.getElementById(u);if(!o||!o.parentNode)return r;if(o.id===u)return r.push(o),r}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&g(t,o)&&o.id===u)return r.push(o),r}else{if(s[2])return _.apply(r,t.getElementsByTagName(e)),r;if((u=s[3])&&n.getElementsByClassName&&t.getElementsByClassName)return _.apply(r,t.getElementsByClassName(u)),r}if(n.qsa&&(!d||!d.test(e))){m=v=y,w=t,E=a===9&&e;if(a===1&&t.nodeName.toLowerCase()!=="object"){h=dt(e),(v=t.getAttribute("id"))?m=v.replace(Z,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=h.length;while(f--)h[f]=m+vt(h[f]);w=Y.test(e)&&ht(t.parentNode)||t,E=h.join(",")}if(E)try{return _.apply(r,w.querySelectorAll(E)),r}catch(S){}finally{v||t.removeAttribute("id")}}}return xt(e.replace(R,"$1"),t,r,i)}function it(){function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function st(e){return e[y]=!0,e}function ot(e){var t=c.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ut(e,t){var n=e.split("|"),i=e.length;while(i--)r.attrHandle[n[i]]=t}function at(e,t){var n=t&&e,r=n&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||k)-(~e.sourceIndex||k);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ft(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function lt(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function ct(e){return st(function(t){return t=+t,st(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ht(e){return e&&typeof e.getElementsByTagName!==C&&e}function pt(){}function dt(e,t){var n,i,s,o,u,a,f,l=x[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=r.preFilter;while(u){if(!n||(i=U.exec(u)))i&&(u=u.slice(i[0].length)||u),a.push(s=[]);n=!1;if(i=z.exec(u))n=i.shift(),s.push({value:n,type:i[0].replace(R," ")}),u=u.slice(n.length);for(o in r.filter)(i=$[o].exec(u))&&(!f[o]||(i=f[o](i)))&&(n=i.shift(),s.push({value:n,type:o,matches:i}),u=u.slice(n.length));if(!n)break}return t?u.length:u?rt.error(e):x(e,a).slice(0)}function vt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function mt(e,t,n){var r=t.dir,i=n&&r==="parentNode",s=E++;return t.first?function(t,n,s){while(t=t[r])if(t.nodeType===1||i)return e(t,n,s)}:function(t,n,o){var u,a,f=[w,s];if(o){while(t=t[r])if(t.nodeType===1||i)if(e(t,n,o))return!0}else while(t=t[r])if(t.nodeType===1||i){a=t[y]||(t[y]={});if((u=a[r])&&u[0]===w&&u[1]===s)return f[2]=u[2];a[r]=f;if(f[2]=e(t,n,o))return!0}}}function gt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function yt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function bt(e,t,n,r,i,s){return r&&!r[y]&&(r=bt(r)),i&&!i[y]&&(i=bt(i,s)),st(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||St(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?yt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=yt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?P.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=yt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):_.apply(o,g)})}function wt(e){var t,n,i,s=e.length,o=r.relative[e[0].type],a=o||r.relative[" "],f=o?1:0,l=mt(function(e){return e===t},a,!0),c=mt(function(e){return P.call(t,e)>-1},a,!0),h=[function(e,n,r){return!o&&(r||n!==u)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;f<s;f++)if(n=r.relative[e[f].type])h=[mt(gt(h),n)];else{n=r.filter[e[f].type].apply(null,e[f].matches);if(n[y]){i=++f;for(;i<s;i++)if(r.relative[e[i].type])break;return bt(f>1&&gt(h),f>1&&vt(e.slice(0,f-1).concat({value:e[f-2].type===" "?"*":""})).replace(R,"$1"),n,f<i&&wt(e.slice(f,i)),i<s&&wt(e=e.slice(i)),i<s&&vt(e))}h.push(n)}return gt(h)}function Et(e,t){var n=t.length>0,i=e.length>0,s=function(s,o,a,f,l){var h,p,d,v=0,m="0",g=s&&[],y=[],b=u,E=s||i&&r.find.TAG("*",l),S=w+=b==null?1:Math.random()||.1,x=E.length;l&&(u=o!==c&&o);for(;m!==x&&(h=E[m])!=null;m++){if(i&&h){p=0;while(d=e[p++])if(d(h,o,a)){f.push(h);break}l&&(w=S)}n&&((h=!d&&h)&&v--,s&&g.push(h))}v+=m;if(n&&m!==v){p=0;while(d=t[p++])d(g,y,o,a);if(s){if(v>0)while(m--)!g[m]&&!y[m]&&(y[m]=O.call(f));y=yt(y)}_.apply(f,y),l&&!s&&y.length>0&&v+t.length>1&&rt.uniqueSort(f)}return l&&(w=S,u=b),g};return n?st(s):s}function St(e,t,n){var r=0,i=t.length;for(;r<i;r++)rt(e,t[r],n);return n}function xt(e,t,i,s){var u,a,f,l,c,h=dt(e);if(!s&&h.length===1){a=h[0]=h[0].slice(0);if(a.length>2&&(f=a[0]).type==="ID"&&n.getById&&t.nodeType===9&&p&&r.relative[a[1].type]){t=(r.find.ID(f.matches[0].replace(et,tt),t)||[])[0];if(!t)return i;e=e.slice(a.shift().value.length)}u=$.needsContext.test(e)?0:a.length;while(u--){f=a[u];if(r.relative[l=f.type])break;if(c=r.find[l])if(s=c(f.matches[0].replace(et,tt),Y.test(a[0].type)&&ht(t.parentNode)||t)){a.splice(u,1),e=s.length&&vt(a);if(!e)return _.apply(i,s),i;break}}}return o(e,h)(s,t,!p,i,Y.test(e)&&ht(t.parentNode)||t),i}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y="sizzle"+ -(new Date),b=e.document,w=0,E=0,S=it(),x=it(),T=it(),N=function(e,t){return e===t&&(f=!0),0},C=typeof undefined,k=1<<31,L={}.hasOwnProperty,A=[],O=A.pop,M=A.push,_=A.push,D=A.slice,P=A.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},H="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",B="[\\x20\\t\\r\\n\\f]",j="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",F=j.replace("w","w#"),I="\\["+B+"*("+j+")"+B+"*(?:([*^$|!~]?=)"+B+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+F+")|)|)"+B+"*\\]",q=":("+j+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+I.replace(3,8)+")*)|.*)\\)|)",R=new RegExp("^"+B+"+|((?:^|[^\\\\])(?:\\\\.)*)"+B+"+$","g"),U=new RegExp("^"+B+"*,"+B+"*"),z=new RegExp("^"+B+"*([>+~]|"+B+")"+B+"*"),W=new RegExp("="+B+"*([^\\]'\"]*?)"+B+"*\\]","g"),X=new RegExp(q),V=new RegExp("^"+F+"$"),$={ID:new RegExp("^#("+j+")"),CLASS:new RegExp("^\\.("+j+")"),TAG:new RegExp("^("+j.replace("w","w*")+")"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+q),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+B+"*(even|odd|(([+-]|)(\\d*)n|)"+B+"*(?:([+-]|)"+B+"*(\\d+)|))"+B+"*\\)|)","i"),bool:new RegExp("^(?:"+H+")$","i"),needsContext:new RegExp("^"+B+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+B+"*((?:-\\d)?\\d*)"+B+"*\\)|)(?=[^-]|$)","i")},J=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Y=/[+~]/,Z=/'|\\/g,et=new RegExp("\\\\([\\da-f]{1,6}"+B+"?|("+B+")|.)","ig"),tt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{_.apply(A=D.call(b.childNodes),b.childNodes),A[b.childNodes.length].nodeType}catch(nt){_={apply:A.length?function(e,t){M.apply(e,D.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}n=rt.support={},s=rt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},l=rt.setDocument=function(e){var t,i=e?e.ownerDocument||e:b,o=i.defaultView;if(i===c||i.nodeType!==9||!i.documentElement)return c;c=i,h=i.documentElement,p=!s(i),o&&o!==o.top&&(o.addEventListener?o.addEventListener("unload",function(){l()},!1):o.attachEvent&&o.attachEvent("onunload",function(){l()})),n.attributes=ot(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ot(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(i.getElementsByClassName)&&ot(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),n.getById=ot(function(e){return h.appendChild(e).id=y,!i.getElementsByName||!i.getElementsByName(y).length}),n.getById?(r.find.ID=function(e,t){if(typeof t.getElementById!==C&&p){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(et,tt);return function(e){return e.getAttribute("id")===t}}):(delete r.find.ID,r.filter.ID=function(e){var t=e.replace(et,tt);return function(e){var n=typeof e.getAttributeNode!==C&&e.getAttributeNode("id");return n&&n.value===t}}),r.find.TAG=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==C)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==C&&p)return t.getElementsByClassName(e)},v=[],d=[];if(n.qsa=Q.test(i.querySelectorAll))ot(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+B+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||d.push("\\["+B+"*(?:value|"+H+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ot(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&d.push("name"+B+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")});return(n.matchesSelector=Q.test(m=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ot(function(e){n.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),v.push("!=",q)}),d=d.length&&new RegExp(d.join("|")),v=v.length&&new RegExp(v.join("|")),t=Q.test(h.compareDocumentPosition),g=t||Q.test(h.contains)?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},N=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r?r:(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,r&1||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===i||e.ownerDocument===b&&g(b,e)?-1:t===i||t.ownerDocument===b&&g(b,t)?1:a?P.call(a,e)-P.call(a,t):0:r&4?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,s=e.parentNode,o=t.parentNode,u=[e],l=[t];if(!s||!o)return e===i?-1:t===i?1:s?-1:o?1:a?P.call(a,e)-P.call(a,t):0;if(s===o)return at(e,t);n=e;while(n=n.parentNode)u.unshift(n);n=t;while(n=n.parentNode)l.unshift(n);while(u[r]===l[r])r++;return r?at(u[r],l[r]):u[r]===b?-1:l[r]===b?1:0},i},rt.matches=function(e,t){return rt(e,null,null,t)},rt.matchesSelector=function(e,t){(e.ownerDocument||e)!==c&&l(e),t=t.replace(W,"='$1']");if(n.matchesSelector&&p&&(!v||!v.test(t))&&(!d||!d.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&e.document.nodeType!==11)return r}catch(i){}return rt(t,c,null,[e]).length>0},rt.contains=function(e,t){return(e.ownerDocument||e)!==c&&l(e),g(e,t)},rt.attr=function(e,t){(e.ownerDocument||e)!==c&&l(e);var i=r.attrHandle[t.toLowerCase()],s=i&&L.call(r.attrHandle,t.toLowerCase())?i(e,t,!p):undefined;return s!==undefined?s:n.attributes||!p?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},rt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},rt.uniqueSort=function(e){var t,r=[],i=0,s=0;f=!n.detectDuplicates,a=!n.sortStable&&e.slice(0),e.sort(N);if(f){while(t=e[s++])t===e[s]&&(i=r.push(s));while(i--)e.splice(r[i],1)}return a=null,e},i=rt.getText=function(e){var t,n="",r=0,s=e.nodeType;if(!s)while(t=e[r++])n+=i(t);else if(s===1||s===9||s===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(s===3||s===4)return e.nodeValue;return n},r=rt.selectors={cacheLength:50,createPseudo:st,match:$,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(et,tt),e[3]=(e[4]||e[5]||"").replace(et,tt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||rt.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&rt.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return $.CHILD.test(e[0])?null:(e[3]&&e[4]!==undefined?e[2]=e[4]:n&&X.test(n)&&(t=dt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(et,tt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=S[e+" "];return t||(t=new RegExp("(^|"+B+")"+e+"("+B+"|$)"))&&S(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==C&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=rt.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),b=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&b){l=m[y]||(m[y]={}),f=l[e]||[],p=f[0]===w&&f[1],h=f[0]===w&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[w,p,h];break}}else if(b&&(f=(t[y]||(t[y]={}))[e])&&f[0]===w)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){b&&((c[y]||(c[y]={}))[e]=[w,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||rt.error("unsupported pseudo: "+e);return i[y]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?st(function(e,n){var r,s=i(e,t),o=s.length;while(o--)r=P.call(e,s[o]),e[r]=!(n[r]=s[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:st(function(e){var t=[],n=[],r=o(e.replace(R,"$1"));return r[y]?st(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:st(function(e){return function(t){return rt(e,t).length>0}}),contains:st(function(e){return function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:st(function(e){return V.test(e||"")||rt.error("unsupported lang: "+e),e=e.replace(et,tt).toLowerCase(),function(t){var n;do if(n=p?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return J.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()==="text")},first:ct(function(){return[0]}),last:ct(function(e,t){return[t-1]}),eq:ct(function(e,t,n){return[n<0?n+t:n]}),even:ct(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:ct(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:ct(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:ct(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}},r.pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=ft(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=lt(t);return pt.prototype=r.filters=r.pseudos,r.setFilters=new pt,o=rt.compile=function(e,t){var n,r=[],i=[],s=T[e+" "];if(!s){t||(t=dt(
e)),n=t.length;while(n--)s=wt(t[n]),s[y]?r.push(s):i.push(s);s=T(e,Et(i,r))}return s},n.sortStable=y.split("").sort(N).join("")===y,n.detectDuplicates=!!f,l(),n.sortDetached=ot(function(e){return e.compareDocumentPosition(c.createElement("div"))&1}),ot(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild.getAttribute("href")==="#"})||ut("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}),(!n.attributes||!ot(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),e.firstChild.getAttribute("value")===""}))&&ut("value",function(e,t,n){if(!n&&e.nodeName.toLowerCase()==="input")return e.defaultValue}),ot(function(e){return e.getAttribute("disabled")==null})||ut(H,function(e,t,n){var r;if(!n)return e[t]===!0?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),rt}(e);p.find=b,p.expr=b.selectors,p.expr[":"]=p.expr.pseudos,p.unique=b.uniqueSort,p.text=b.getText,p.isXMLDoc=b.isXML,p.contains=b.contains;var w=p.expr.match.needsContext,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^.[^:#\[\.,]*$/;p.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?p.find.matchesSelector(r,e)?[r]:[]:p.find.matches(e,p.grep(t,function(e){return e.nodeType===1}))},p.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if(typeof e!="string")return this.pushStack(p(e).filter(function(){for(t=0;t<i;t++)if(p.contains(r[t],this))return!0}));for(t=0;t<i;t++)p.find(e,r[t],n);return n=this.pushStack(i>1?p.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(x(this,e||[],!1))},not:function(e){return this.pushStack(x(this,e||[],!0))},is:function(e){return!!x(this,typeof e=="string"&&w.test(e)?p(e):e||[],!1).length}});var T,N=e.document,C=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,k=p.fn.init=function(e,t){var n,r;if(!e)return this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?n=[null,e,null]:n=C.exec(e);if(n&&(n[1]||!t)){if(n[1]){t=t instanceof p?t[0]:t,p.merge(this,p.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:N,!0));if(E.test(n[1])&&p.isPlainObject(t))for(n in t)p.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}r=N.getElementById(n[2]);if(r&&r.parentNode){if(r.id!==n[2])return T.find(e);this.length=1,this[0]=r}return this.context=N,this.selector=e,this}return!t||t.jquery?(t||T).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):p.isFunction(e)?typeof T.ready!="undefined"?T.ready(e):e(p):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),p.makeArray(e,this))};k.prototype=p.fn,T=p(N);var L=/^(?:parents|prev(?:Until|All))/,A={children:!0,contents:!0,next:!0,prev:!0};p.extend({dir:function(e,t,n){var r=[],i=e[t];while(i&&i.nodeType!==9&&(n===undefined||i.nodeType!==1||!p(i).is(n)))i.nodeType===1&&r.push(i),i=i[t];return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}}),p.fn.extend({has:function(e){var t,n=p(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(p.contains(this,n[t]))return!0})},closest:function(e,t){var n,r=0,i=this.length,s=[],o=w.test(e)||typeof e!="string"?p(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&p.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(s.length>1?p.unique(s):s)},index:function(e){return e?typeof e=="string"?p.inArray(this[0],p(e)):p.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(p.unique(p.merge(this.get(),p(e,t))))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),p.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return p.dir(e,"parentNode")},parentsUntil:function(e,t,n){return p.dir(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return p.dir(e,"nextSibling")},prevAll:function(e){return p.dir(e,"previousSibling")},nextUntil:function(e,t,n){return p.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return p.dir(e,"previousSibling",n)},siblings:function(e){return p.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return p.sibling(e.firstChild)},contents:function(e){return p.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:p.merge([],e.childNodes)}},function(e,t){p.fn[e]=function(n,r){var i=p.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=p.filter(r,i)),this.length>1&&(A[e]||(i=p.unique(i)),L.test(e)&&(i=i.reverse())),this.pushStack(i)}});var M=/\S+/g,_={};p.Callbacks=function(e){e=typeof e=="string"?_[e]||D(e):p.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){n=e.memory&&c,r=!0,s=o||0,o=0,i=u.length,t=!0;for(;u&&s<i;s++)if(u[s].apply(c[0],c[1])===!1&&e.stopOnFalse){n=!1;break}t=!1,u&&(a?a.length&&f(a.shift()):n?u=[]:l.disable())},l={add:function(){if(u){var r=u.length;(function s(t){p.each(t,function(t,n){var r=p.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&s(n)})})(arguments),t?i=u.length:n&&(o=r,f(n))}return this},remove:function(){return u&&p.each(arguments,function(e,n){var r;while((r=p.inArray(n,u,r))>-1)u.splice(r,1),t&&(r<=i&&i--,r<=s&&s--)}),this},has:function(e){return e?p.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],i=0,this},disable:function(){return u=a=n=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,n||l.disable(),this},locked:function(){return!a},fireWith:function(e,n){return u&&(!r||a)&&(n=n||[],n=[e,n.slice?n.slice():n],t?a.push(n):f(n)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l},p.extend({Deferred:function(e){var t=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return p.Deferred(function(n){p.each(t,function(t,s){var o=p.isFunction(e[t])&&e[t];i[s[1]](function(){var e=o&&o.apply(this,arguments);e&&p.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?p.extend(e,r):r}},i={};return r.pipe=r.then,p.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=r.call(arguments),i=n.length,s=i!==1||e&&p.isFunction(e.promise)?i:0,o=s===1?e:p.Deferred(),u=function(e,t,n){return function(i){t[e]=this,n[e]=arguments.length>1?r.call(arguments):i,n===a?o.notifyWith(t,n):--s||o.resolveWith(t,n)}},a,f,l;if(i>1){a=new Array(i),f=new Array(i),l=new Array(i);for(;t<i;t++)n[t]&&p.isFunction(n[t].promise)?n[t].promise().done(u(t,l,n)).fail(o.reject).progress(u(t,f,a)):--s}return s||o.resolveWith(l,n),o.promise()}});var P;p.fn.ready=function(e){return p.ready.promise().done(e),this},p.extend({isReady:!1,readyWait:1,holdReady:function(e){e?p.readyWait++:p.ready(!0)},ready:function(e){if(e===!0?--p.readyWait:p.isReady)return;if(!N.body)return setTimeout(p.ready);p.isReady=!0;if(e!==!0&&--p.readyWait>0)return;P.resolveWith(N,[p]),p.fn.trigger&&p(N).trigger("ready").off("ready")}}),p.ready.promise=function(t){if(!P){P=p.Deferred();if(N.readyState==="complete")setTimeout(p.ready);else if(N.addEventListener)N.addEventListener("DOMContentLoaded",B,!1),e.addEventListener("load",B,!1);else{N.attachEvent("onreadystatechange",B),e.attachEvent("onload",B);var n=!1;try{n=e.frameElement==null&&N.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!p.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}H(),p.ready()}}()}}return P.promise(t)};var j=typeof undefined,F;for(F in p(c))break;c.ownLast=F!=="0",c.inlineBlockNeedsLayout=!1,p(function(){var e,t,n=N.getElementsByTagName("body")[0];if(!n)return;e=N.createElement("div"),e.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=N.createElement("div"),n.appendChild(e).appendChild(t);if(typeof t.style.zoom!==j){t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1";if(c.inlineBlockNeedsLayout=t.offsetWidth===3)n.style.zoom=1}n.removeChild(e),e=t=null}),function(){var e=N.createElement("div");if(c.deleteExpando==null){c.deleteExpando=!0;try{delete e.test}catch(t){c.deleteExpando=!1}}e=null}(),p.acceptData=function(e){var t=p.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return n!==1&&n!==9?!1:!t||t!==!0&&e.getAttribute("classid")===t};var I=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,q=/([A-Z])/g;p.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?p.cache[e[p.expando]]:e[p.expando],!!e&&!U(e)},data:function(e,t,n){return z(e,t,n)},removeData:function(e,t){return W(e,t)},_data:function(e,t,n){return z(e,t,n,!0)},_removeData:function(e,t){return W(e,t,!0)}}),p.fn.extend({data:function(e,t){var n,r,i,s=this[0],o=s&&s.attributes;if(e===undefined){if(this.length){i=p.data(s);if(s.nodeType===1&&!p._data(s,"parsedAttrs")){n=o.length;while(n--)r=o[n].name,r.indexOf("data-")===0&&(r=p.camelCase(r.slice(5)),R(s,r,i[r]));p._data(s,"parsedAttrs",!0)}}return i}return typeof e=="object"?this.each(function(){p.data(this,e)}):arguments.length>1?this.each(function(){p.data(this,e,t)}):s?R(s,e,p.data(s,e)):undefined},removeData:function(e){return this.each(function(){p.removeData(this,e)})}}),p.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=p._data(e,t),n&&(!r||p.isArray(n)?r=p._data(e,t,p.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=p.queue(e,t),r=n.length,i=n.shift(),s=p._queueHooks(e,t),o=function(){p.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return p._data(e,n)||p._data(e,n,{empty:p.Callbacks("once memory").add(function(){p._removeData(e,t+"queue"),p._removeData(e,n)})})}}),p.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?p.queue(this[0],e):t===undefined?this:this.each(function(){var n=p.queue(this,e,t);p._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&p.dequeue(this,e)})},dequeue:function(e){return this.each(function(){p.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=p.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=p._data(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var X=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,V=["Top","Right","Bottom","Left"],$=function(e,t){return e=t||e,p.css(e,"display")==="none"||!p.contains(e.ownerDocument,e)},J=p.access=function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(p.type(n)==="object"){i=!0;for(u in n)p.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,p.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(p(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s},K=/^(?:checkbox|radio)$/i;(function(){var e=N.createDocumentFragment(),t=N.createElement("div"),n=N.createElement("input");t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a>",c.leadingWhitespace=t.firstChild.nodeType===3,c.tbody=!t.getElementsByTagName("tbody").length,c.htmlSerialize=!!t.getElementsByTagName("link").length,c.html5Clone=N.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",n.type="checkbox",n.checked=!0,e.appendChild(n),c.appendChecked=n.checked,t.innerHTML="<textarea>x</textarea>",c.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",c.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,c.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){c.noCloneEvent=!1}),t.cloneNode(!0).click());if(c.deleteExpando==null){c.deleteExpando=!0;try{delete t.test}catch(r){c.deleteExpando=!1}}e=t=n=null})(),function(){var t,n,r=N.createElement("div");for(t in{submit:!0,change:!0,focusin:!0})n="on"+t,(c[t+"Bubbles"]=n in e)||(r.setAttribute(n,"t"),c[t+"Bubbles"]=r.attributes[n].expando===!1);r=null}();var Q=/^(?:input|select|textarea)$/i,G=/^key/,Y=/^(?:mouse|contextmenu)|click/,Z=/^(?:focusinfocus|focusoutblur)$/,et=/^([^.]*)(?:\.(.+)|)$/;p.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,d,v,m,g=p._data(e);if(!g)return;n.handler&&(a=n,n=a.handler,i=a.selector),n.guid||(n.guid=p.guid++),(o=g.events)||(o=g.events={}),(l=g.handle)||(l=g.handle=function(e){return typeof p===j||!!e&&p.event.triggered===e.type?undefined:p.event.dispatch.apply(l.elem,arguments)},l.elem=e),t=(t||"").match(M)||[""],u=t.length;while(u--){s=et.exec(t[u])||[],d=m=s[1],v=(s[2]||"").split(".").sort();if(!d)continue;f=p.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=p.event.special[d]||{},c=p.extend({type:d,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&p.expr.match.needsContext.test(i),namespace:v.join(".")},a);if(!(h=o[d])){h=o[d]=[],h.delegateCount=0;if(!f.setup||f.setup.call(e,r,v,l)===!1)e.addEventListener?e.addEventListener(d,l,!1):e.attachEvent&&e.attachEvent("on"+d,l)}f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,c):h.push(c),p.event.global[d]=!0}e=null},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,d,v,m,g=p.hasData(e)&&p._data(e);if(!g||!(l=g.events))return;t=(t||"").match(M)||[""],f=t.length;while(f--){u=et.exec(t[f])||[],d=m=u[1],v=(u[2]||"").split(".").sort();if(!d){for(d in l)p.event.remove(e,d+t[f],n,r,!0);continue}c=p.event.special[d]||{},d=(r?c.delegateType:c.bindType)||d,h=l[d]||[],u=u[2]&&new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;while(s--)o=h[s],(i||m===o.origType)&&(!n||n.guid===o.guid)&&(!u||u.test(o.namespace))&&(!r||r===o.selector||r==="**"&&o.selector)&&(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&((!c.teardown||c.teardown.call(e,v,g.handle)===!1)&&p.removeEvent(e,d,g.handle),delete l[d])}p.isEmptyObject(l)&&(delete g.handle,p._removeData(e,"events"))},trigger:function(t,n,r,i){var s,o,u,a,l,c,h,d=[r||N],v=f.call(t,"type")?t.type:t,m=f.call(t,"namespace")?t.namespace.split("."):[];u=c=r=r||N;if(r.nodeType===3||r.nodeType===8)return;if(Z.test(v+p.event.triggered))return;v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),o=v.indexOf(":")<0&&"on"+v,t=t[p.expando]?t:new p.Event(v,typeof t=="object"&&t),t.isTrigger=i?2:3,t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=n==null?[t]:p.makeArray(n,[t]),l=p.event.special[v]||{};if(!i&&l.trigger&&l.trigger.apply(r,n)===!1)return;if(!i&&!l.noBubble&&!p.isWindow(r)){a=l.delegateType||v,Z.test(a+v)||(u=u.parentNode);for(;u;u=u.parentNode)d.push(u),c=u;c===(r.ownerDocument||N)&&d.push(c.defaultView||c.parentWindow||e)}h=0;while((u=d[h++])&&!t.isPropagationStopped())t.type=h>1?a:l.bindType||v,s=(p._data(u,"events")||{})[t.type]&&p._data(u,"handle"),s&&s.apply(u,n),s=o&&u[o],s&&s.apply&&p.acceptData(u)&&(t.result=s.apply(u,n),t.result===!1&&t.preventDefault());t.type=v;if(!i&&!t.isDefaultPrevented()&&(!l._default||l._default.apply(d.pop(),n)===!1)&&p.acceptData(r)&&o&&r[v]&&!p.isWindow(r)){c=r[o],c&&(r[o]=null),p.event.triggered=v;try{r[v]()}catch(g){}p.event.triggered=undefined,c&&(r[o]=c)}return t.result},dispatch:function(e){e=p.event.fix(e);var t,n,i,s,o,u=[],a=r.call(arguments),f=(p._data(this,"events")||{})[e.type]||[],l=p.event.special[e.type]||{};a[0]=e,e.delegateTarget=this;if(l.preDispatch&&l.preDispatch.call(this,e)===!1)return;u=p.event.handlers.call(this,e,f),t=0;while((s=u[t++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(i.namespace))e.handleObj=i,e.data=i.data,n=((p.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),n!==undefined&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation())}return l.postDispatch&&l.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!=this;a=a.parentNode||this)if(a.nodeType===1&&(a.disabled!==!0||e.type!=="click")){i=[];for(s=0;s<u;s++)r=t[s],n=r.selector+" ",i[n]===undefined&&(i[n]=r.needsContext?p(n,this).index(a)>=0:p.find(n,this,null,[a]).length),i[n]&&i.push(r);i.length&&o.push({elem:a,handlers:i})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},fix:function(e){if(e[p.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=Y.test(i)?this.mouseHooks:G.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new p.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||N),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button,o=t.fromElement;return e.pageX==null&&t.clientX!=null&&(r=e.target.ownerDocument||N,i=r.documentElement,n=r.body,e.pageX=t.clientX+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==rt()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===rt()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(p.nodeName(this,"input")&&this.type==="checkbox"&&this.click)return this.click(),!1},_default:function(e){return p.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=p.extend(new p.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?p.event.trigger(i,null,t):p.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},p.removeEvent=N.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===j&&(e[r]=null),e.detachEvent(r,n))},p.Event=function(e,t){if(!(this instanceof p.Event))return new p.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.defaultPrevented===undefined&&(e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault())?tt:nt):this.type=e,t&&p.extend(this,t),this.timeStamp=e&&e.timeStamp||p.now(),this[p.expando]=!0},p.Event.prototype={isDefaultPrevented:nt,isPropagationStopped:nt,isImmediatePropagationStopped:nt,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=tt;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=tt;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){p.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!p.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),c.submitBubbles||(p.event.special.submit={setup:function(){if(p.nodeName(this,"form"))return!1;p.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,n=p.nodeName(t,"input")||p.nodeName(t,"button")?t.form:undefined;n&&!p._data(n,"submitBubbles")&&(p.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),p._data(n,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&p.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(p.nodeName(this,"form"))return!1;p.event.remove(this,"._submit")}}),c.changeBubbles||(p.event.special.change={setup:function(){if(Q.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")p.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),p.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),p.event.simulate("change",this,e,!0)});return!1}p.event.add(this,"beforeactivate._change",function(e){var t=e.target;Q.test(t.nodeName)&&!p._data(t,"changeBubbles")&&(p.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&p.event.simulate("change",this.parentNode,e,!0)}),p._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return p.event.remove(this,"._change"),!Q.test(this.nodeName)}}),c.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){p.event.simulate(t,e.target,p.event.fix(e),!0)};p.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=p._data(r,t);i||r.addEventListener(e,n,!0),p._data(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=p._data(r,t)-1;i?p._data(r,t,i):(r.removeEventListener(e,n,!0),p._removeData(r,t))}}}),p.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(s in e)this.on(s,t,n,e[s],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=nt;else if(!r)return this;return i===1&&(o=r,r=function(e){return p().off(e),o.apply(this,arguments)},r.guid=o.guid||(o.guid=p.guid++)),this.each(function(){p.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,p(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=nt),this.each(function(){p.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){p.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return p.event.trigger(e,t,n,!0)}});var st="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ot=/ jQuery\d+="(?:null|\d+)"/g,ut=new RegExp("<(?:"+st+")[\\s/>]","i"),at=/^\s+/,ft=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,lt=/<([\w:]+)/,ct=/<tbody/i,ht=/<|&#?\w+;/,pt=/<(?:script|style|link)/i,dt=/checked\s*(?:[^=]|=\s*.checked.)/i,vt=/^$|\/(?:java|ecma)script/i,mt=/^true\/(.*)/,gt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,yt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:c.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},bt=it(N),wt=bt.appendChild(N.createElement("div"));yt.optgroup=yt.option,yt.tbody=yt.tfoot=yt.colgroup=yt.caption=yt.thead,yt.th=yt.td,p.extend({clone:function(e,t,n){var r,i,s,o,u,a=p.contains(e.ownerDocument,e);c.html5Clone||p.isXMLDoc(e)||!ut.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(wt.innerHTML=e.outerHTML,wt.removeChild(s=wt.firstChild));if((!c.noCloneEvent||!c.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!p.isXMLDoc(e)){r=Et(s),u=Et(e);for(o=0;(i=u[o])!=null;++o)r[o]&&Lt(i,r[o])}if(t)if(n){u=u||Et(e),r=r||Et(s);for(o=0;(i=u[o])!=null;o++)kt(i,r[o])}else kt(e,s);return r=Et(s,"script"),r.length>0&&Ct(r,!a&&Et(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l,h=e.length,d=it(t),v=[],m=0;for(;m<h;m++){s=e[m];if(s||s===0)if(p.type(s)==="object")p.merge(v,s.nodeType?[s]:s);else if(!ht.test(s))v.push(t.createTextNode(s));else{u=u||d.appendChild(t.createElement("div")),a=(lt.exec(s)||["",""])[1].toLowerCase(),l=yt[a]||yt._default,u.innerHTML=l[1]+s.replace(ft,"<$1></$2>")+l[2],i=l[0];while(i--)u=u.lastChild;!c.leadingWhitespace&&at.test(s)&&v.push(t.createTextNode(at.exec(s)[0]));if(!c.tbody){s=a==="table"&&!ct.test(s)?u.firstChild:l[1]==="<table>"&&!ct.test(s)?u:0,i=s&&s.childNodes.length;while(i--)p.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}p.merge(v,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=d.lastChild}}u&&d.removeChild(u),c.appendChecked||p.grep(Et(v,"input"),St),m=0;while(s=v[m++]){if(r&&p.inArray(s,r)!==-1)continue;o=p.contains(s.ownerDocument,s),u=Et(d.appendChild(s),"script"),o&&Ct(u);if(n){i=0;while(s=u[i++])vt.test(s.type||"")&&n.push(s)}}return u=null,d},cleanData:function(e,t){var r,i,s,o,u=0,a=p.expando,f=p.cache,l=c.deleteExpando,h=p.event.special;for(;(r=e[u])!=null;u++)if(t||p.acceptData(r)){s=r[a],o=s&&f[s];if(o){if(o.events)for(i in o.events)h[i]?p.event.remove(r,i):p.removeEvent(r,i,o.handle);f[s]&&(delete f[s],l?delete r[a]:typeof r.removeAttribute!==j?r.removeAttribute(a):r[a]=null,n.push(s))}}}}),p.fn.extend({text:function(e){return J(this,function(e){return e===undefined?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||N).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=xt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=xt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?p.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&p.cleanData(Et(n)),n.parentNode&&(t&&p.contains(n.ownerDocument,n)&&Ct(Et(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&p.cleanData(Et(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&p.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return p.clone(this,e,t)})},html:function(e){return J(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined)return t.nodeType===1?t.innerHTML.replace(ot,""):undefined;if(typeof e=="string"&&!pt.test(e)&&(c.htmlSerialize||!ut.test(e))&&(c.leadingWhitespace||!at.test(e))&&!yt[(lt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(ft,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(p.cleanData(Et(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,p.cleanData(Et(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=i.apply([],e);var n,r,s,o,u,a,f=0,l=this.length,h=this,d=l-1,v=e[0],m=p.isFunction(v);if(m||l>1&&typeof v=="string"&&!c.checkClone&&dt.test(v))return this.each(function(n){var r=h.eq(n);m&&(e[0]=v.call(this,n,r.html())),r.domManip(e,t)});if(l){a=p.buildFragment(e,this[0].ownerDocument,!1,this),n=a.firstChild,a.childNodes.length===1&&(a=n);if(n){o=p.map(Et(a,"script"),Tt),s=o.length;for(;f<l;f++)r=a,f!==d&&(r=p.clone(r,!0,!0),s&&p.merge(o,Et(r,"script"))),t.call(this[f],r,f);if(s){u=o[o.length-1].ownerDocument,p.map(o,Nt);for(f=0;f<s;f++)r=o[f],vt.test(r.type||"")&&!p._data(r,"globalEval")&&p.contains(u,r)&&(r.src?p._evalUrl&&p._evalUrl(r.src):p.globalEval((r.text||r.textContent||r.innerHTML||"").replace(gt,"")))}a=n=null}}return this}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){p.fn[e]=function(e){var n,r=0,i=[],o=p(e),u=o.length-1;for(;r<=u;r++)n=r===u?this:this.clone(!0),p(o[r])[t](n),s.apply(i,n.get());return this.pushStack(i)}});var At,Ot={};(function(){var e,t,n=N.createElement("div"),r="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=n.getElementsByTagName("a")[0],e.style.cssText="float:left;opacity:.5",c.opacity=/^0.5/.test(e.style.opacity),c.cssFloat=!!e.style.cssFloat,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",c.clearCloneStyle=n.style.backgroundClip==="content-box",e=n=null,c.shrinkWrapBlocks=function(){var e,n,i,s;if(t==null){e=N.getElementsByTagName("body")[0];if(!e)return;s="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",n=N.createElement("div"),i=N.createElement("div"),e.appendChild(n).appendChild(i),t=!1,typeof i.style.zoom!==j&&(i.style.cssText=r+";width:1px;padding:1px;zoom:1",i.innerHTML="<div></div>",i.firstChild.style.width="5px",t=i.offsetWidth!==3),e.removeChild(n),e=n=i=null}return t}})();var Dt=/^margin/,Pt=new RegExp("^("+X+")(?!px)[a-z%]+$","i"),Ht,Bt,jt=/^(top|right|bottom|left)$/;e.getComputedStyle?(Ht=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},Bt=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Ht(e),o=n?n.getPropertyValue(t)||n[t]:undefined,n&&(o===""&&!p.contains(e.ownerDocument,e)&&(o=p.style(e,t)),Pt.test(o)&&Dt.test(t)&&(r=u.width,i=u.minWidth,s=u.maxWidth,u.minWidth=u.maxWidth=u.width=o,o=n.width,u.width=r,u.minWidth=i,u.maxWidth=s)),o===undefined?o:o+""}):N.documentElement.currentStyle&&(Ht=function(e){return e.currentStyle},Bt=function(e,t,n){var r,i,s,o,u=e.style;return n=n||Ht(e),o=n?n[t]:undefined,o==null&&u&&u[t]&&(o=u[t]),Pt.test(o)&&!jt.test(t)&&(r=u.left,i=e.runtimeStyle,s=i&&i.left,s&&(i.left=e.currentStyle.left),u.left=t==="fontSize"?"1em":o,o=u.pixelLeft+"px",u.left=r,s&&(i.left=s)),o===undefined?o:o+""||"auto"}),function(){function l(){var t,n,u=N.getElementsByTagName("body")[0];if(!u)return;t=N.createElement("div"),n=N.createElement("div"),t.style.cssText=a,u.appendChild(t).appendChild(n),n.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",p.swap(u,u.style.zoom!=null?{zoom:1}:{},function(){r=n.offsetWidth===4}),i=!0,s=!1,o=!0,e.getComputedStyle&&(s=(e.getComputedStyle(n,null)||{}).top!=="1%",i=(e.getComputedStyle(n,null)||{width:"4px"}).width==="4px"),u.removeChild(t),n=u=null}var t,n,r,i,s,o,u=N.createElement("div"),a="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",f="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=u.getElementsByTagName("a")[0],t.style.cssText="float:left;opacity:.5",c.opacity=/^0.5/.test(t.style.opacity),c.cssFloat=!!t.style
.cssFloat,u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",c.clearCloneStyle=u.style.backgroundClip==="content-box",t=u=null,p.extend(c,{reliableHiddenOffsets:function(){if(n!=null)return n;var e,t,r,i=N.createElement("div"),s=N.getElementsByTagName("body")[0];if(!s)return;return i.setAttribute("className","t"),i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=N.createElement("div"),e.style.cssText=a,s.appendChild(e).appendChild(i),i.innerHTML="<table><tr><td></td><td>t</td></tr></table>",t=i.getElementsByTagName("td"),t[0].style.cssText="padding:0;margin:0;border:0;display:none",r=t[0].offsetHeight===0,t[0].style.display="",t[1].style.display="none",n=r&&t[0].offsetHeight===0,s.removeChild(e),i=s=null,n},boxSizing:function(){return r==null&&l(),r},boxSizingReliable:function(){return i==null&&l(),i},pixelPosition:function(){return s==null&&l(),s},reliableMarginRight:function(){var t,n,r,i;if(o==null&&e.getComputedStyle){t=N.getElementsByTagName("body")[0];if(!t)return;n=N.createElement("div"),r=N.createElement("div"),n.style.cssText=a,t.appendChild(n).appendChild(r),i=r.appendChild(N.createElement("div")),i.style.cssText=r.style.cssText=f,i.style.marginRight=i.style.width="0",r.style.width="1px",o=!parseFloat((e.getComputedStyle(i,null)||{}).marginRight),t.removeChild(n)}return o}})}(),p.swap=function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i};var It=/alpha\([^)]*\)/i,qt=/opacity\s*=\s*([^)]*)/,Rt=/^(none|table(?!-c[ea]).+)/,Ut=new RegExp("^("+X+")(.*)$","i"),zt=new RegExp("^([+-])=("+X+")","i"),Wt={position:"absolute",visibility:"hidden",display:"block"},Xt={letterSpacing:0,fontWeight:400},Vt=["Webkit","O","Moz","ms"];p.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Bt(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":c.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=p.camelCase(t),a=e.style;t=p.cssProps[u]||(p.cssProps[u]=$t(a,u)),o=p.cssHooks[t]||p.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=zt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(p.css(e,t)),s="number");if(n==null||n!==n)return;s==="number"&&!p.cssNumber[u]&&(n+="px"),!c.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)try{a[t]="",a[t]=n}catch(f){}},css:function(e,t,n,r){var i,s,o,u=p.camelCase(t);return t=p.cssProps[u]||(p.cssProps[u]=$t(e.style,u)),o=p.cssHooks[t]||p.cssHooks[u],o&&"get"in o&&(s=o.get(e,!0,n)),s===undefined&&(s=Bt(e,t,r)),s==="normal"&&t in Xt&&(s=Xt[t]),n===""||n?(i=parseFloat(s),n===!0||p.isNumeric(i)?i||0:s):s}}),p.each(["height","width"],function(e,t){p.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&Rt.test(p.css(e,"display"))?p.swap(e,Wt,function(){return Gt(e,t,r)}):Gt(e,t,r)},set:function(e,n,r){var i=r&&Ht(e);return Kt(e,n,r?Qt(e,t,r,c.boxSizing()&&p.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),c.opacity||(p.cssHooks.opacity={get:function(e,t){return qt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=p.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if((t>=1||t==="")&&p.trim(s.replace(It,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(t===""||r&&!r.filter)return}n.filter=It.test(s)?s.replace(It,i):s+" "+i}}),p.cssHooks.marginRight=Ft(c.reliableMarginRight,function(e,t){if(t)return p.swap(e,{display:"inline-block"},Bt,[e,"marginRight"])}),p.each({margin:"",padding:"",border:"Width"},function(e,t){p.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+V[r]+t]=s[r]||s[r-2]||s[0];return i}},Dt.test(e)||(p.cssHooks[e+t].set=Kt)}),p.fn.extend({css:function(e,t){return J(this,function(e,t,n){var r,i,s={},o=0;if(p.isArray(t)){r=Ht(e),i=t.length;for(;o<i;o++)s[t[o]]=p.css(e,t[o],!1,r);return s}return n!==undefined?p.style(e,t,n):p.css(e,t)},e,t,arguments.length>1)},show:function(){return Jt(this,!0)},hide:function(){return Jt(this)},toggle:function(e){return typeof e=="boolean"?e?this.show():this.hide():this.each(function(){$(this)?p(this).show():p(this).hide()})}}),p.Tween=Yt,Yt.prototype={constructor:Yt,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(p.cssNumber[n]?"":"px")},cur:function(){var e=Yt.propHooks[this.prop];return e&&e.get?e.get(this):Yt.propHooks._default.get(this)},run:function(e){var t,n=Yt.propHooks[this.prop];return this.options.duration?this.pos=t=p.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yt.propHooks._default.set(this),this}},Yt.prototype.init.prototype=Yt.prototype,Yt.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=p.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){p.fx.step[e.prop]?p.fx.step[e.prop](e):e.elem.style&&(e.elem.style[p.cssProps[e.prop]]!=null||p.cssHooks[e.prop])?p.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yt.propHooks.scrollTop=Yt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},p.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},p.fx=Yt.prototype.init,p.fx.step={};var Zt,en,tn=/^(?:toggle|show|hide)$/,nn=new RegExp("^(?:([+-])=|)("+X+")([a-z%]*)$","i"),rn=/queueHooks$/,sn=[ln],on={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=nn.exec(t),s=i&&i[3]||(p.cssNumber[e]?"":"px"),o=(p.cssNumber[e]||s!=="px"&&+r)&&nn.exec(p.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,p.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&u!==1&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};p.Animation=p.extend(hn,{tweener:function(e,t){p.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],on[n]=on[n]||[],on[n].unshift(t)},prefilter:function(e,t){t?sn.unshift(e):sn.push(e)}}),p.speed=function(e,t,n){var r=e&&typeof e=="object"?p.extend({},e):{complete:n||!n&&t||p.isFunction(e)&&e,duration:e,easing:n&&t||t&&!p.isFunction(t)&&t};r.duration=p.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in p.fx.speeds?p.fx.speeds[r.duration]:p.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){p.isFunction(r.old)&&r.old.call(this),r.queue&&p.dequeue(this,r.queue)},r},p.fn.extend({fadeTo:function(e,t,n,r){return this.filter($).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=p.isEmptyObject(e),s=p.speed(t,n,r),o=function(){var t=hn(this,p.extend({},e),s);(i||p._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=p.timers,o=p._data(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&rn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&p.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=p._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=p.timers,o=r?r.length:0;n.finish=!0,p.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),p.each(["toggle","show","hide"],function(e,t){var n=p.fn[t];p.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(an(t,!0),e,r,i)}}),p.each({slideDown:an("show"),slideUp:an("hide"),slideToggle:an("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){p.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),p.timers=[],p.fx.tick=function(){var e,t=p.timers,n=0;Zt=p.now();for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||p.fx.stop(),Zt=undefined},p.fx.timer=function(e){p.timers.push(e),e()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){en||(en=setInterval(p.fx.tick,p.fx.interval))},p.fx.stop=function(){clearInterval(en),en=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(e,t){return e=p.fx?p.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e,t,n,r,i=N.createElement("div");i.setAttribute("className","t"),i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=i.getElementsByTagName("a")[0],n=N.createElement("select"),r=n.appendChild(N.createElement("option")),t=i.getElementsByTagName("input")[0],e.style.cssText="top:1px",c.getSetAttribute=i.className!=="t",c.style=/top/.test(e.getAttribute("style")),c.hrefNormalized=e.getAttribute("href")==="/a",c.checkOn=!!t.value,c.optSelected=r.selected,c.enctype=!!N.createElement("form").enctype,n.disabled=!0,c.optDisabled=!r.disabled,t=N.createElement("input"),t.setAttribute("value",""),c.input=t.getAttribute("value")==="",t.value="t",t.setAttribute("type","radio"),c.radioValue=t.value==="t",e=t=n=r=i=null}();var pn=/\r/g;p.fn.extend({val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=p.valHooks[i.type]||p.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(pn,""):n==null?"":n);return}return r=p.isFunction(e),this.each(function(n){var i;if(this.nodeType!==1)return;r?i=e.call(this,n,p(this).val()):i=e,i==null?i="":typeof i=="number"?i+="":p.isArray(i)&&(i=p.map(i,function(e){return e==null?"":e+""})),t=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),p.extend({valHooks:{option:{get:function(e){var t=p.find.attr(e,"value");return t!=null?t:p.text(e)}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(c.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!p.nodeName(n.parentNode,"optgroup"))){t=p(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=p.makeArray(t),o=i.length;while(o--){r=i[o];if(p.inArray(p.valHooks.option.get(r),s)>=0)try{r.selected=n=!0}catch(u){r.scrollHeight}else r.selected=!1}return n||(e.selectedIndex=-1),i}}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(e,t){if(p.isArray(t))return e.checked=p.inArray(p(e).val(),t)>=0}},c.checkOn||(p.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})});var dn,vn,mn=p.expr.attrHandle,gn=/^(?:checked|selected)$/i,yn=c.getSetAttribute,bn=c.input;p.fn.extend({attr:function(e,t){return J(this,p.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){p.removeAttr(this,e)})}}),p.extend({attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===j)return p.prop(e,t,n);if(s!==1||!p.isXMLDoc(e))t=t.toLowerCase(),r=p.attrHooks[t]||(p.expr.match.bool.test(t)?vn:dn);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=p.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);p.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(M);if(s&&e.nodeType===1)while(n=s[i++])r=p.propFix[n]||n,p.expr.match.bool.test(n)?bn&&yn||!gn.test(n)?e[r]=!1:e[p.camelCase("default-"+n)]=e[r]=!1:p.attr(e,n,""),e.removeAttribute(yn?n:r)},attrHooks:{type:{set:function(e,t){if(!c.radioValue&&t==="radio"&&p.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),vn={set:function(e,t,n){return t===!1?p.removeAttr(e,n):bn&&yn||!gn.test(n)?e.setAttribute(!yn&&p.propFix[n]||n,n):e[p.camelCase("default-"+n)]=e[n]=!0,n}},p.each(p.expr.match.bool.source.match(/\w+/g),function(e,t){var n=mn[t]||p.find.attr;mn[t]=bn&&yn||!gn.test(t)?function(e,t,r){var i,s;return r||(s=mn[t],mn[t]=i,i=n(e,t,r)!=null?t.toLowerCase():null,mn[t]=s),i}:function(e,t,n){if(!n)return e[p.camelCase("default-"+t)]?t.toLowerCase():null}});if(!bn||!yn)p.attrHooks.value={set:function(e,t,n){if(!p.nodeName(e,"input"))return dn&&dn.set(e,t,n);e.defaultValue=t}};yn||(dn={set:function(e,t,n){var r=e.getAttributeNode(n);r||e.setAttributeNode(r=e.ownerDocument.createAttribute(n)),r.value=t+="";if(n==="value"||t===e.getAttribute(n))return t}},mn.id=mn.name=mn.coords=function(e,t,n){var r;if(!n)return(r=e.getAttributeNode(t))&&r.value!==""?r.value:null},p.valHooks.button={get:function(e,t){var n=e.getAttributeNode(t);if(n&&n.specified)return n.value},set:dn.set},p.attrHooks.contenteditable={set:function(e,t,n){dn.set(e,t===""?!1:t,n)}},p.each(["width","height"],function(e,t){p.attrHooks[t]={set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}}})),c.style||(p.attrHooks.style={get:function(e){return e.style.cssText||undefined},set:function(e,t){return e.style.cssText=t+""}});var wn=/^(?:input|select|textarea|button|object)$/i,En=/^(?:a|area)$/i;p.fn.extend({prop:function(e,t){return J(this,p.prop,e,t,arguments.length>1)},removeProp:function(e){return e=p.propFix[e]||e,this.each(function(){try{this[e]=undefined,delete this[e]}catch(t){}})}}),p.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!p.isXMLDoc(e),s&&(t=p.propFix[t]||t,i=p.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=p.find.attr(e,"tabindex");return t?parseInt(t,10):wn.test(e.nodeName)||En.test(e.nodeName)&&e.href?0:-1}}}}),c.hrefNormalized||p.each(["href","src"],function(e,t){p.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),c.optSelected||(p.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){p.propFix[this.toLowerCase()]=this}),c.enctype||(p.propFix.enctype="encoding");var Sn=/[\t\r\n\f]/g;p.fn.extend({addClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f=typeof e=="string"&&e;if(p.isFunction(e))return this.each(function(t){p(this).addClass(e.call(this,t,this.className))});if(f){t=(e||"").match(M)||[];for(;u<a;u++){n=this[u],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(Sn," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");o=p.trim(r),n.className!==o&&(n.className=o)}}}return this},removeClass:function(e){var t,n,r,i,s,o,u=0,a=this.length,f=arguments.length===0||typeof e=="string"&&e;if(p.isFunction(e))return this.each(function(t){p(this).removeClass(e.call(this,t,this.className))});if(f){t=(e||"").match(M)||[];for(;u<a;u++){n=this[u],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(Sn," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");o=e?p.trim(r):"",n.className!==o&&(n.className=o)}}}return this},toggleClass:function(e,t){var n=typeof e;return typeof t=="boolean"&&n==="string"?t?this.addClass(e):this.removeClass(e):p.isFunction(e)?this.each(function(n){p(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var t,r=0,i=p(this),s=e.match(M)||[];while(t=s[r++])i.hasClass(t)?i.removeClass(t):i.addClass(t)}else if(n===j||n==="boolean")this.className&&p._data(this,"__className__",this.className),this.className=this.className||e===!1?"":p._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(Sn," ").indexOf(t)>=0)return!0;return!1}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){p.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),p.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var xn=p.now(),Tn=/\?/,Nn=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;p.parseJSON=function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t+"");var n,r=null,i=p.trim(t+"");return i&&!p.trim(i.replace(Nn,function(e,t,i,s){return n&&t&&(r=0),r===0?e:(n=i||t,r+=!s-!i,"")}))?Function("return "+i)():p.error("Invalid JSON: "+t)},p.parseXML=function(t){var n,r;if(!t||typeof t!="string")return null;try{e.DOMParser?(r=new DOMParser,n=r.parseFromString(t,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t))}catch(i){n=undefined}return(!n||!n.documentElement||n.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+t),n};var Cn,kn,Ln=/#.*$/,An=/([?&])_=[^&]*/,On=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Mn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,_n=/^(?:GET|HEAD)$/,Dn=/^\/\//,Pn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hn={},Bn={},jn="*/".concat("*");try{kn=location.href}catch(Fn){kn=N.createElement("a"),kn.href="",kn=kn.href}Cn=Pn.exec(kn.toLowerCase())||[],p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:kn,type:"GET",isLocal:Mn.test(Cn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":jn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Rn(Rn(e,p.ajaxSettings),t):Rn(p.ajaxSettings,e)},ajaxPrefilter:In(Hn),ajaxTransport:In(Bn),ajax:function(e,t){function x(e,t,n,r){var f,g,y,w,S,x=t;if(b===2)return;b=2,o&&clearTimeout(o),a=undefined,s=r||"",E.readyState=e>0?4:0,f=e>=200&&e<300||e===304,n&&(w=Un(l,E,n)),w=zn(l,w,E,f);if(f)l.ifModified&&(S=E.getResponseHeader("Last-Modified"),S&&(p.lastModified[i]=S),S=E.getResponseHeader("etag"),S&&(p.etag[i]=S)),e===204||l.type==="HEAD"?x="nocontent":e===304?x="notmodified":(x=w.state,g=w.data,y=w.error,f=!y);else{y=x;if(e||!x)x="error",e<0&&(e=0)}E.status=e,E.statusText=(t||x)+"",f?d.resolveWith(c,[g,x,E]):d.rejectWith(c,[E,x,y]),E.statusCode(m),m=undefined,u&&h.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?g:y]),v.fireWith(c,[E,x]),u&&(h.trigger("ajaxComplete",[E,l]),--p.active||p.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=p.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?p(c):p.event,d=p.Deferred(),v=p.Callbacks("once memory"),m=l.statusCode||{},g={},y={},b=0,w="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(b===2){if(!f){f={};while(t=On.exec(s))f[t[1].toLowerCase()]=t[2]}t=f[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return b===2?s:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)m[t]=[m[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||w;return a&&a.abort(t),x(0,t),this}};d.promise(E).complete=v.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||kn)+"").replace(Ln,"").replace(Dn,Cn[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=p.trim(l.dataType||"*").toLowerCase().match(M)||[""],l.crossDomain==null&&(n=Pn.exec(l.url.toLowerCase()),l.crossDomain=!(!n||n[1]===Cn[1]&&n[2]===Cn[2]&&(n[3]||(n[1]==="http:"?"80":"443"))===(Cn[3]||(Cn[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=p.param(l.data,l.traditional)),qn(Hn,l,t,E);if(b===2)return E;u=l.global,u&&p.active++===0&&p.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!_n.test(l.type),i=l.url,l.hasContent||(l.data&&(i=l.url+=(Tn.test(i)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=An.test(i)?i.replace(An,"$1_="+xn++):i+(Tn.test(i)?"&":"?")+"_="+xn++)),l.ifModified&&(p.lastModified[i]&&E.setRequestHeader("If-Modified-Since",p.lastModified[i]),p.etag[i]&&E.setRequestHeader("If-None-Match",p.etag[i])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+jn+"; q=0.01":""):l.accepts["*"]);for(r in l.headers)E.setRequestHeader(r,l.headers[r]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&b!==2){w="abort";for(r in{success:1,error:1,complete:1})E[r](l[r]);a=qn(Bn,l,t,E);if(!a)x(-1,"No Transport");else{E.readyState=1,u&&h.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{b=1,a.send(g,x)}catch(S){if(!(b<2))throw S;x(-1,S)}}return E}return E.abort()},getJSON:function(e,t,n){return p.get(e,t,n,"json")},getScript:function(e,t){return p.get(e,undefined,t,"script")}}),p.each(["get","post"],function(e,t){p[t]=function(e,n,r,i){return p.isFunction(n)&&(i=i||r,r=n,n=undefined),p.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){p.fn[t]=function(e){return this.on(t,e)}}),p._evalUrl=function(e){return p.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},p.fn.extend({wrapAll:function(e){if(p.isFunction(e))return this.each(function(t){p(this).wrapAll(e.call(this,t))});if(this[0]){var t=p(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return p.isFunction(e)?this.each(function(t){p(this).wrapInner(e.call(this,t))}):this.each(function(){var t=p(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=p.isFunction(e);return this.each(function(n){p(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()}}),p.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!c.reliableHiddenOffsets()&&(e.style&&e.style.display||p.css(e,"display"))==="none"},p.expr.filters.visible=function(e){return!p.expr.filters.hidden(e)};var Wn=/%20/g,Xn=/\[\]$/,Vn=/\r?\n/g,$n=/^(?:submit|button|image|reset|file)$/i,Jn=/^(?:input|select|textarea|keygen)/i;p.param=function(e,t){var n,r=[],i=function(e,t){t=p.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(e)||e.jquery&&!p.isPlainObject(e))p.each(e,function(){i(this.name,this.value)});else for(n in e)Kn(n,e[n],t,i);return r.join("&").replace(Wn,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=p.prop(this,"elements");return e?p.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!p(this).is(":disabled")&&Jn.test(this.nodeName)&&!$n.test(e)&&(this.checked||!K.test(e))}).map(function(e,t){var n=p(this).val();return n==null?null:p.isArray(n)?p.map(n,function(e){return{name:t.name,value:e.replace(Vn,"\r\n")}}):{name:t.name,value:n.replace(Vn,"\r\n")}}).get()}}),p.ajaxSettings.xhr=e.ActiveXObject!==undefined?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zn()||er()}:Zn;var Qn=0,Gn={},Yn=p.ajaxSettings.xhr();e.ActiveXObject&&p(e).on("unload",function(){for(var e in Gn)Gn[e](undefined,!0)}),c.cors=!!Yn&&"withCredentials"in Yn,Yn=c.ajax=!!Yn,Yn&&p.ajaxTransport(function(e){if(!e.crossDomain||c.cors){var t;return{send:function(n,r){var i,s=e.xhr(),o=++Qn;s.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)s[i]=e.xhrFields[i];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)n[i]!==undefined&&s.setRequestHeader(i,n[i]+"");s.send(e.hasContent&&e.data||null),t=function(n,i){var u,a,f;if(t&&(i||s.readyState===4)){delete Gn[o],t=undefined,s.onreadystatechange=p.noop;if(i)s.readyState!==4&&s.abort();else{f={},u=s.status,typeof s.responseText=="string"&&(f.text=s.responseText);try{a=s.statusText}catch(l){a=""}!u&&e.isLocal&&!e.crossDomain?u=f.text?200:404:u===1223&&(u=204)}}f&&r(u,a,f,s.getAllResponseHeaders())},e.async?s.readyState===4?setTimeout(t):s.onreadystatechange=Gn[o]=t:t()},abort:function(){t&&t(undefined,!0)}}}}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return p.globalEval(e),e}}}),p.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),p.ajaxTransport("script",function(e){if(e.crossDomain){var t,n=N.head||p("head")[0]||N.documentElement;return{send:function(r,i){t=N.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){if(n||!t.readyState||/loaded|complete/.test(t.readyState))t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||i(200,"success")},n.insertBefore(t,n.firstChild)},abort:function(){t&&t.onload(undefined,!0)}}}});var tr=[],nr=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tr.pop()||p.expando+"_"+xn++;return this[e]=!0,e}}),p.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(nr.test(t.url)?"url":typeof t.data=="string"&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&nr.test(t.data)&&"data");if(u||t.dataTypes[0]==="jsonp")return i=t.jsonpCallback=p.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(nr,"$1"+i):t.jsonp!==!1&&(t.url+=(Tn.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||p.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,tr.push(i)),o&&p.isFunction(s)&&s(o[0]),o=s=undefined}),"script"}),p.parseHTML=function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||N;var r=E.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=p.buildFragment([e],t,i),i&&i.length&&p(i).remove(),p.merge([],r.childNodes))};var rr=p.fn.load;p.fn.load=function(e,t,n){if(typeof e!="string"&&rr)return rr.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u,e.length),e=e.slice(0,u)),p.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(s="POST"),o.length>0&&p.ajax({url:e,type:s,dataType:"html",data:t}).done(function(e){i=arguments,o.html(r?p("<div>").append(p.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,i||[e.responseText,t,e])}),this},p.expr.filters.animated=function(e){return p.grep(p.timers,function(t){return e===t.elem}).length};var ir=e.document.documentElement;p.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=p.css(e,"position"),c=p(e),h={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=p.css(e,"top"),a=p.css(e,"left"),f=(l==="absolute"||l==="fixed")&&p.inArray("auto",[s,a])>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),p.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(h.top=t.top-u.top+o),t.left!=null&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},p.fn.extend({offset:function(e){if(arguments.length)return e===undefined?this:this.each(function(t){p.offset.setOffset(this,e,t)});var t,n,r={top:0,left:0},i=this[0],s=i&&i.ownerDocument;if(!s)return;return t=s.documentElement,p.contains(t,i)?(typeof i.getBoundingClientRect!==j&&(r=i.getBoundingClientRect()),n=sr(s),{top:r.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0),left:r.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):r},position:function(){if(!this[0])return;var e,t,n={top:0,left:0},r=this[0];return p.css(r,"position")==="fixed"?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),p.nodeName(e[0],"html")||(n=e.offset()),n.top+=p.css(e[0],"borderTopWidth",!0),n.left+=p.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-p.css(r,"marginTop",!0),left:t.left-n.left-p.css(r,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||ir;while(e&&!p.nodeName(e,"html")&&p.css(e,"position")==="static")e=e.offsetParent;return e||ir})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n=/Y/.test(t);p.fn[e]=function(r){return J(this,function(e,r,i){var s=sr(e);if(i===undefined)return s?t in s?s[t]:s.document.documentElement[r]:e[r];s?s.scrollTo(n?p(s).scrollLeft():i,n?i:p(s).scrollTop()):e[r]=i},e,r,arguments.length,null)}}),p.each(["top","left"],function(e,t){p.cssHooks[t]=Ft(c.pixelPosition,function(e,n){if(n)return n=Bt(e,t),Pt.test(n)?p(e).position()[t]+"px":n})}),p.each({Height:"height",Width:"width"},function(e,t){p.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){p.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return J(this,function(t,n,r){var i;return p.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?p.css(t,n,o):p.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),p.fn.size=function(){return this.length},p.fn.andSelf=p.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return p});var or=e.jQuery,ur=e.$;return p.noConflict=function(t){return e.$===p&&(e.$=ur),t&&e.jQuery===p&&(e.jQuery=or),p},typeof t===j&&(e.jQuery=e.$=p),p}),function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n,r=e(document);e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},refreshCSRFTokens:function(){var t=e("meta[name=csrf-token]").attr("content"),n=e("meta[name=csrf-param]").attr("content");e('form input[name="'+n+'"]').val(t)},fire:function(t,n,r){var i=e.Event(n);return t.trigger(i,r),i.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e
){return e.attr("href")},handleRemote:function(r){var i,s,o,u,a,f,l,c;if(n.fire(r,"ajax:before")){u=r.data("cross-domain"),a=u===t?null:u,f=r.data("with-credentials")||null,l=r.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType;if(r.is("form")){i=r.attr("method"),s=r.attr("action"),o=r.serializeArray();var h=r.data("ujs:submit-button");h&&(o.push(h),r.data("ujs:submit-button",null))}else r.is(n.inputChangeSelector)?(i=r.data("method"),s=r.data("url"),o=r.serialize(),r.data("params")&&(o=o+"&"+r.data("params"))):r.is(n.buttonClickSelector)?(i=r.data("method")||"get",s=r.data("url"),o=r.serialize(),r.data("params")&&(o=o+"&"+r.data("params"))):(i=r.data("method"),s=n.href(r),o=r.data("params")||null);c={type:i||"GET",data:o,dataType:l,beforeSend:function(e,i){return i.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script),n.fire(r,"ajax:beforeSend",[e,i])},success:function(e,t,n){r.trigger("ajax:success",[e,t,n])},complete:function(e,t){r.trigger("ajax:complete",[e,t])},error:function(e,t,n){r.trigger("ajax:error",[e,t,n])},crossDomain:a},f&&(c.xhrFields={withCredentials:f}),s&&(c.url=s);var p=n.ajax(c);return r.trigger("ajax:send",p),p}return!1},handleMethod:function(r){var i=n.href(r),s=r.data("method"),o=r.attr("target"),u=e("meta[name=csrf-token]").attr("content"),a=e("meta[name=csrf-param]").attr("content"),f=e('<form method="post" action="'+i+'"></form>'),l='<input name="_method" value="'+s+'" type="hidden" />';a!==t&&u!==t&&(l+='<input name="'+a+'" value="'+u+'" type="hidden" />'),o&&f.attr("target",o),f.hide().append(l).appendTo("body"),f.submit()},disableFormElements:function(t){t.find(n.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(n.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t=e.data("confirm"),r=!1,i;return t?(n.fire(e,"confirm")&&(r=n.confirm(t),i=n.fire(e,"confirm:complete",[r])),r&&i):!0},blankInputs:function(t,n,r){var i=e(),s,o,u=n||"input,textarea",a=t.find(u);return a.each(function(){s=e(this),o=s.is("input[type=checkbox],input[type=radio]")?s.is(":checked"):s.val();if(!o==!r){if(s.is("input[type=radio]")&&a.filter('input[type=radio]:checked[name="'+s.attr("name")+'"]').length)return!0;i=i.add(s)}}),i.length?i:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},n.fire(r,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,r){e.crossDomain||n.CSRFProtection(r)}),r.delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),r.delegate(n.linkClickSelector,"click.rails",function(r){var i=e(this),s=i.data("method"),o=i.data("params"),u=r.metaKey||r.ctrlKey;if(!n.allowAction(i))return n.stopEverything(r);!u&&i.is(n.linkDisableSelector)&&n.disableElement(i);if(i.data("remote")!==t){if(u&&(!s||s==="GET")&&!o)return!0;var a=n.handleRemote(i);return a===!1?n.enableElement(i):a.error(function(){n.enableElement(i)}),!1}if(i.data("method"))return n.handleMethod(i),!1}),r.delegate(n.buttonClickSelector,"click.rails",function(t){var r=e(this);return n.allowAction(r)?(n.handleRemote(r),!1):n.stopEverything(t)}),r.delegate(n.inputChangeSelector,"change.rails",function(t){var r=e(this);return n.allowAction(r)?(n.handleRemote(r),!1):n.stopEverything(t)}),r.delegate(n.formSubmitSelector,"submit.rails",function(r){var i=e(this),s=i.data("remote")!==t,o=n.blankInputs(i,n.requiredInputSelector),u=n.nonBlankInputs(i,n.fileInputSelector);if(!n.allowAction(i))return n.stopEverything(r);if(o&&i.attr("novalidate")==t&&n.fire(i,"ajax:aborted:required",[o]))return n.stopEverything(r);if(s){if(u){setTimeout(function(){n.disableFormElements(i)},13);var a=n.fire(i,"ajax:aborted:file",[u]);return a||setTimeout(function(){n.enableFormElements(i)},13),a}return n.handleRemote(i),!1}setTimeout(function(){n.disableFormElements(i)},13)}),r.delegate(n.formInputClickSelector,"click.rails",function(t){var r=e(this);if(!n.allowAction(r))return n.stopEverything(t);var i=r.attr("name"),s=i?{name:i,value:r.val()}:null;r.closest("form").data("ujs:submit-button",s)}),r.delegate(n.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),r.delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))}),e(function(){n.refreshCSRFTokens()}))}(jQuery),function(e,t,n){"use strict";var r,i;e.uaMatch=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:n[0]||""}},r=e.uaMatch(t.navigator.userAgent),i={},r.browser&&(i[r.browser]=!0,i.version=r.version,i.versionNumber=parseInt(r.version)),r.platform&&(i[r.platform]=!0);if(i.chrome||i.opr||i.safari)i.webkit=!0;if(i.rv){var s="msie";r.browser=s,i[s]=!0}if(i.opr){var o="opera";r.browser=o,i[o]=!0}if(i.safari&&i.android){var u="android";r.browser=u,i[u]=!0}i.name=r.browser,i.platform=r.platform,e.browser=i}(jQuery,window),function(){try{document.cookie,jQuery.cookie=function(e,t,n){if(arguments.length>1&&String(t)!=="[object Object]"){n=jQuery.extend({},n);if(t===null||t===undefined)n.expires=-1;if(typeof n.expires=="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s,o=n.raw?function(e){return e}:decodeURIComponent;return(s=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?o(s[1]):null}}catch(e){jQuery.cookie=jQuery.noop}}.call(this),function(){$.fn.live=function(e,t,n){return $(this.context).on(e,this.selector,t,n),this}}.call(this),function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,t.href&&s&&"map"===i.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o)):!1):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var i=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var r,i,s=e(this[0]);s.length&&s[0]!==document;){if(r=s.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(i=parseInt(s.css("zIndex"),10),!isNaN(i)&&0!==i))return i;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){return e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),i&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var s="Width"===r?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return"number"!=typeof t?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(i&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(r=0;i.length>r;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})}(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n,r=0;null!=(n=t[r]);r++)try{e(n).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(n,r,i){var s,o,u,a,f={},l=n.split(".")[0];n=n.split(".")[1],s=l+"-"+n,i||(i=r,r=e.Widget),e.expr[":"][s.toLowerCase()]=function(t){return!!e.data(t,s)},e[l]=e[l]||{},o=e[l][n],u=e[l][n]=function(e,n){return this._createWidget?(arguments.length&&this._createWidget(e,n),t):new u(e,n)},e.extend(u,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new r,a.options=e.widget.extend({},a.options),e.each(i,function(n,i){return e.isFunction(i)?(f[n]=function(){var e=function(){return r.prototype[n].apply(this,arguments)},t=function(e){return r.prototype[n].apply(this,e)};return function(){var n,r=this._super,s=this._superApply;return this._super=e,this._superApply=t,n=i.apply(this,arguments),this._super=r,this._superApply=s,n}}(),t):(f[n]=i,t)}),u.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix:n},f,{constructor:u,namespace:l,widgetName:n,widgetFullName:s}),o?(e.each(o._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,u,n._proto)}),delete o._childConstructors):r._childConstructors.push(u),e.widget.bridge(n,u)},e.widget.extend=function(n){for(var i,o,u=r.call(arguments,1),a=0,f=u.length;f>a;a++)for(i in u[a])o=u[a][i],u[a].hasOwnProperty(i)&&o!==t&&(n[i]=e.isPlainObject(o)?e.isPlainObject(n[i])?e.widget.extend({},n[i],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,i){var o=i.prototype.widgetFullName||n;e.fn[n]=function(u){var f="string"==typeof u,l=r.call(arguments,1),c=this;return u=!f&&l.length?e.widget.extend.apply(null,[u].concat(l)):u,f?this.each(function(){var r,i=e.data(this,o);return i?e.isFunction(i[u])&&"_"!==u.charAt(0)?(r=i[u].apply(i,l),r!==i&&r!==t?(c=r&&r.jquery?c.pushStack(r.get()):r,!1):t):e.error("no such method '"+u+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+u+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(u||{})._init():e.data(this,o,new i(u,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i,s,o,u=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(u={},i=n.split("."),n=i.shift(),i.length){for(s=u[n]=e.widget.extend({},this.options[n]),o=0;i.length-1>o;o++)s[i[o]]=s[i[o]]||{},s=s[i[o]];if(n=i.pop(),r===t)return s[n]===t?null:s[n];s[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];u[n]=r}return this._setOptions(u),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(n,r,i){var s,o=this;"boolean"!=typeof n&&(i=r,r=n,n=!1),i?(r=s=e(r),this.bindings=this.bindings.add(r)):(i=r,r=this.element,s=this.widget()),e.each(i,function(i,u){function a(){return n||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof u?o[u]:u).apply(o,arguments):t}"string"!=typeof u&&(a.guid=u.guid=u.guid||a.guid||e.guid++);var f=i.match(/^(\w+)\s*(.*)$/),l=f[1]+o.eventNamespace,c=f[2];c?s.delegate(c,l,a):r.bind(l,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var r=this,i=1===n.which,s="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return i&&!s&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e,t){function n(e,t,n){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?n/100:1)]}function r(t,n){return parseInt(e.css(t,n),10)||0}function i(t){var n=t[0];return 9===n.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(n)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:n.preventDefault?{width:0,height:0,offset:{top:n.pageY,left:n.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var s,o=Math.max,u=Math.abs,a=Math.round,f=/left|center|right/,l=/top|center|bottom/,c=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,p=/%$/,d=e.fn.position;e.position={scrollbarWidth:function(){if(s!==t)return s;var n,r,i=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=i.children()[0];return e("body").append(i),n=o.offsetWidth,i.css("overflow","scroll"),r=o.offsetWidth,n===r&&(r=i[0].clientWidth),i.remove(),s=n-r},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i="scroll"===n||"auto"===n&&t.width<t.element[0].scrollWidth,s="scroll"===r||"auto"===r&&t.height<t.element[0].scrollHeight;return{width:s?e.position.scrollbarWidth():0,height:i?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return d.apply(this,arguments);t=e.extend({},t);var s,p,v,m,g,y,b=e(t.of),w=e.position.getWithinInfo(t.within),E=e.position.getScrollInfo(w),S=(t.collision||"flip").split(" "),x={};return y=i(b),b[0].preventDefault&&(t.at="left top"),p=y.width,v=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],function(){var e,n,r=(t[this]||"").split(" ");1===r.length&&(r=f.test(r[0])?r.concat(["center"]):l.test(r[0])?["center"].concat(r):["center","center"]),r[0]=f.test(r[0])?r[0]:"center",r[1]=l.test(r[1])?r[1]:"center",e=c.exec(r[0]),n=c.exec(r[1]),x[this]=[e?e[0]:0,n?n[0]:0],t[this]=[h.exec(r[0])[0],h.exec(r[1])[0]]}),1===S.length&&(S[1]=S[0]),"right"===t.at[0]?g.left+=p:"center"===t.at[0]&&(g.left+=p/2),"bottom"===t.at[1]?g.top+=v:"center"===t.at[1]&&(g.top+=v/2),s=n(x.at,p,v),g.left+=s[0],g.top+=s[1],this.each(function(){var i,f,l=e(this),c=l.outerWidth(),h=l.outerHeight(),d=r(this,"marginLeft"),y=r(this,"marginTop"),T=c+d+r(this,"marginRight")+E.width,N=h+y+r(this,"marginBottom")+E.height,C=e.extend({},g),L=n(x.my,l.outerWidth(),l.outerHeight());"right"===t.my[0]?C.left-=c:"center"===t.my[0]&&(C.left-=c/2),"bottom"===t.my[1]?C.top-=h:"center"===t.my[1]&&(C.top-=h/2),C.left+=L[0],C.top+=L[1],e.support.offsetFractions||(C.left=a(C.left),C.top=a(C.top)),i={marginLeft:d,marginTop:y},e.each(["left","top"],function(n,r){e.ui.position[S[n]]&&e.ui.position[S[n]][r](C,{targetWidth:p,targetHeight:v,elemWidth:c,elemHeight:h,collisionPosition:i,collisionWidth:T,collisionHeight:N,offset:[s[0]+L[0],s[1]+L[1]],my:t.my,at:t.at,within:w,elem:l})}),t.using&&(f=function(e){var n=m.left-C.left,r=n+p-c,i=m.top-C.top,s=i+v-h,a={target:{element:b,left:m.left,top:m.top,width:p,height:v},element:{element:l,left:C.left,top:C.top,width:c,height:h},horizontal:0>r?"left":n>0?"right":"center",vertical:0>s?"top":i>0?"bottom":"middle"};c>p&&p>u(n+r)&&(a.horizontal="center"),h>v&&v>u(i+s)&&(a.vertical="middle"),a.important=o(u(n),u(r))>o(u(i),u(s))?"horizontal":"vertical",t.using.call(this,e,a)}),l.offset(e.extend(C,{using:f}))})},e.ui.position={fit:{left:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollLeft:r.offset.left,s=r.width,u=e.left-t.collisionPosition.marginLeft,a=i-u,f=u+t.collisionWidth-s-i;t.collisionWidth>s?a>0&&0>=f?(n=e.left+a+t.collisionWidth-s-i,e.left+=a-n):e.left=f>0&&0>=a?i:a>f?i+s-t.collisionWidth:i:a>0?e.left+=a:f>0?e.left-=f:e.left=o(e.left-u,e.left)},top:function(e,t){var n,r=t.within,i=r.isWindow?r.scrollTop:r.offset.top,s=t.within.height,u=e.top-t.collisionPosition.marginTop,a=i-u,f=u+t.collisionHeight-s-i;t.collisionHeight>s?a>0&&0>=f?(n=e.top+a+t.collisionHeight-s-i,e.top+=a-n):e.top=f>0&&0>=a?i:a>f?i+s-t.collisionHeight:i:a>0?e.top+=a:f>0?e.top-=f:e.top=o(e.top-u,e.top)}},flip:{left:function(e,t){var n,r,i=t.within,s=i.offset.left+i.scrollLeft,o=i.width,a=i.isWindow?i.scrollLeft:i.offset.left,f=e.left-t.collisionPosition.marginLeft,l=f-a,c=f+t.collisionWidth-o-a,h="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,d=-2*t.offset[0];0>l?(n=e.left+h+p+d+t.collisionWidth-o-s,(0>n||u(l)>n)&&(e.left+=h+p+d)):c>0&&(r=e.left-t.collisionPosition.marginLeft+h+p+d-a,(r>0||c>u(r))&&(e.left+=h+p+d))},top:function(e,t){var n,r,i=t.within,s=i.offset.top+i.scrollTop,o=i.height,a=i.isWindow?i.scrollTop:i.offset.top,f=e.top-t.collisionPosition.marginTop,l=f-a,c=f+t.collisionHeight-o-a,h="top"===t.my[1],p=h?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,d="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,v=-2*t.offset[1];0>l?(r=e.top+p+d+v+t.collisionHeight-o-s,e.top+p+d+v>l&&(0>r||u(l)>r)&&(e.top+=p+d+v)):c>0&&(n=e.top-t.collisionPosition.marginTop+p+d+v-a,e.top+p+d+v>c&&(n>0||c>u(n))&&(e.top+=p+d+v))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&11>i,t.innerHTML="",n.removeChild(t)}()}(jQuery),function(e){function t(e,t,n){return e>t&&t+n>e}function n(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||n(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=null,i=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,s.widgetName+"-item")===s?(r=e(this),!1):undefined}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target)),r?!this.options.handle||n||(e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)}),i)?(this.currentItem=r,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,n,r){var i,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r),s&&r.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],i):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var r=this,i=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=i.top-
this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c="x"===this.options.axis||r+f>u&&a>r+f,h="y"===this.options.axis||t+l>s&&o>t+l,p=c&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>s&&o>n-this.helperProportions.width/2&&r+this.helperProportions.height/2>u&&a>i-this.helperProportions.height/2},_intersectsWithPointer:function(e){var n="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),r="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),i=n&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&"right"===o||"down"===s?2:1:s&&("down"===s?2:1):!1},_intersectsWithSides:function(e){var n=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),r=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&r||"left"===s&&!r:i&&("down"===i&&n||"up"===i&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,r,i,s,o=[],u=[],a=this._connectWith();if(a&&t)for(n=a.length-1;n>=0;n--)for(i=e(a[n]),r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&u.push([e.isFunction(s.options.items)?s.options.items.call(s.element):e(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(u.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=u.length-1;n>=0;n--)u[n][0].each(function(){o.push(this)});return e(o)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;t.length>n;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,a,f,l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--)for(i=e(h[n]),r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(c.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s));for(n=c.length-1;n>=0;n--)for(o=c[n][1],u=c[n][0],r=0,f=u.length;f>r;r++)a=e(u[r]),a.data(this.widgetName+"-item",o),l.push({item:a,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--)r=this.items[n],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),s=e("<"+r+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===r?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(s)}):"img"===r&&s.attr("src",t.currentItem.attr("src")),n||s.css("visibility","hidden"),s},update:function(e,o){(!n||r.forcePlaceholderSize)&&(o.height()||o.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(r){var s,o,u,a,f,l,c,h,p,d,v=null,m=null;for(s=this.containers.length-1;s>=0;s--)if(!e.contains(this.currentItem[0],this.containers[s].element[0]))if(this._intersectsWith(this.containers[s].containerCache)){if(v&&e.contains(this.containers[s].element[0],v.element[0]))continue;v=this.containers[s],m=s}else this.containers[s].containerCache.over&&(this.containers[s]._trigger("out",r,this._uiHash(this)),this.containers[s].containerCache.over=0);if(v)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",r,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(u=1e4,a=null,d=v.floating||n(this.currentItem),f=d?"left":"top",l=d?"width":"height",c=this.positionAbs[f]+this.offset.click[f],o=this.items.length-1;o>=0;o--)e.contains(this.containers[m].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(!d||t(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height))&&(h=this.items[o].item.offset()[f],p=!1,Math.abs(h-c)>Math.abs(h+this.items[o][l]-c)&&(p=!0,h+=this.items[o][l]),u>Math.abs(h-c)&&(u=Math.abs(h-c),a=this.items[o],this.direction=p?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;a?this._rearrange(r,a,null,!0):this._rearrange(r,null,this.containers[m].element,!0),this._trigger("change",r,this._uiHash()),this.containers[m]._trigger("change",r,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",r,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return r.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(u[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(e,t){this.reverting=!1;var n,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),n=0;r.length>n;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(n=0;r.length>n;n++)r[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e){var t=0;e.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,r,i=this.element[0].nodeName.toLowerCase(),s="textarea"===i,o="input"===i;this.isMultiLine=s?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(i){if(this.element.prop("readOnly"))return t=!0,r=!0,n=!0,undefined;t=!1,r=!1,n=!1;var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",i);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",i);break;case s.UP:t=!0,this._keyEvent("previous",i);break;case s.DOWN:t=!0,this._keyEvent("next",i);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,i.preventDefault(),this.menu.select(i));break;case s.TAB:this.menu.active&&this.menu.select(i);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(i),i.preventDefault());break;default:n=!0,this._searchTimeout(i)}},keypress:function(r){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&r.preventDefault(),undefined;if(!n){var i=e.ui.keyCode;switch(r.keyCode){case i.PAGE_UP:this._move("previousPage",r);break;case i.PAGE_DOWN:this._move("nextPage",r);break;case i.UP:this._keyEvent("previous",r);break;case i.DOWN:this._keyEvent("next",r)}}},input:function(e){return r?(r=!1,e.preventDefault(),undefined):(this._searchTimeout(e),undefined)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,undefined):(clearTimeout(this.searching),this.close(e),this._change(e),undefined)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target===t.element[0]||r.target===n||e.contains(n,r.target)||t.close()})})},menufocus:function(t,n){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),undefined;var r=n.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,n,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,r){r(e.ui.autocomplete.filter(t,n.term))}):"string"==typeof this.options.source?(n=this.options.source,this.source=function(t,s){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){s(e)},error:function(){s([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):undefined},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,n=++t;return function(r){n===t&&e.__response(r),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty();this._renderMenu(n,t),this.isNewMenu=!0,this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this._value(this.term),this.menu.blur(),undefined):(this.menu[e](t),undefined):(this.search(null,t),undefined)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments),this.options.disabled||this.cancelSearch||(t=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(e,t){function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=r(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(s.inline?t.parent()[0]:s.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function i(t,n){e.extend(t,n);for(var r in n)null==n[r]&&(t[r]=n[r]);return t}e.extend(e.ui,{datepicker:{version:"1.10.3"}});var s,o="datepicker";e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return i(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i="div"===r||"span"===r,t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),"input"===r?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var i=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:i,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?r(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var r=e(t);n.append=e([]),n.trigger=e([]),r.hasClass(this.markerClassName)||(this._attachments(r,n),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(n),e.data(t,o,n),n.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),("focus"===r||"both"===r)&&t.focus(this._showDatepicker),("button"===r||"both"===r)&&(i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(n=0,r=0,i=0;e.length>i;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,n){var r=e(t);r.hasClass(this.markerClassName)||(r.addClass(this.markerClassName).append(n.dpDiv),e.data(t,o,n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block"))},_dialogDatepicker:function(t,n,r,s,u){var a,f,l,c,h,p=this._dialogInst;return p||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],o,p)),i(p.settings,s||{}),n=n&&n.constructor===Date?this._formatDate(p,n):n,this._dialogInput.val(n),this._pos=u?u.length?u:[u.pageX,u.pageY]:null,this._pos||(f=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+c,l/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],o,p),this},_destroyDatepicker:function(t){var n,r=e(t),i=e.data(t,o);r.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),e.removeData(t,o),"input"===n?(i.append.remove(),i.trigger.remove(),r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===n||"span"===n)&&r.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,o);i.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===n||"span"===n)&&(r=i.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled"
,!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,o);i.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===n||"span"===n)&&(r=i.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,o)}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,r,s){var o,u,a,f,l=this._getInst(n);return 2===arguments.length&&"string"==typeof r?"defaults"===r?e.extend({},e.datepicker._defaults):l?"all"===r?e.extend({},l.settings):this._get(l,r):null:(o=r||{},"string"==typeof r&&(o={},o[r]=s),l&&(this._curInst===l&&this._hideDatepicker(),u=this._getDateDatepicker(n,!0),a=this._getMinMaxDate(l,"min"),f=this._getMinMaxDate(l,"max"),i(l.settings,o),null!==a&&o.dateFormat!==t&&o.minDate===t&&(l.settings.minDate=this._formatDate(l,a)),null!==f&&o.dateFormat!==t&&o.maxDate===t&&(l.settings.maxDate=this._formatDate(l,f)),"disabled"in o&&(o.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),l),this._autoSize(l),this._setDate(l,u),this._updateAlternate(l),this._updateDatepicker(l)),t)},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(n){var r,i,s=e.datepicker._getInst(n.target);return e.datepicker._get(s,"constrainInput")?(r=e.datepicker._possibleChars(e.datepicker._get(s,"dateFormat")),i=String.fromCharCode(null==n.charCode?n.keyCode:n.charCode),n.ctrlKey||n.metaKey||" ">i||!r||r.indexOf(i)>-1):t},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var n,r,s,o,u,a,f;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),s=r?r.apply(t,[t,n]):{},s!==!1&&(i(n.settings,s),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),u={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),u=e.datepicker._checkOffset(n,u,o),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:u.left+"px",top:u.top+"px"}),n.inline||(a=e.datepicker._get(n,"showAnim"),f=e.datepicker._get(n,"duration"),n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[a]?n.dpDiv.show(a,e.datepicker._get(n,"showOptions"),f):n.dpDiv[a||"show"](a?f:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n))}},_updateDatepicker:function(t){this.maxRows=4,s=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,r=this._getNumberOfMonths(t),i=r[1],o=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&t.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",o*i+"em"),t.dpDiv[(1!==r[0]||1!==r[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){for(var n,r=this._getInst(t),i=this._get(r,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,r,i,s,u=this._curInst;!u||t&&u!==e.data(t,o)||this._datepickerShowing&&(n=this._get(u,"showAnim"),r=this._get(u,"duration"),i=function(){e.datepicker._tidyDialog(u)},e.effects&&(e.effects.effect[n]||e.effects[n])?u.dpDiv.hide(n,e.datepicker._get(u,"showOptions"),r,i):u.dpDiv["slideDown"===n?"slideUp":"fadeIn"===n?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1,s=this._get(u,"onClose"),s&&s.apply(u.input?u.input[0]:null,[u.input?u.input.val():"",u]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&0===n.parents("#"+e.datepicker._mainDivId).length&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);this._isDisabledDatepicker(i[0])||(this._adjustInstDate(s,n+("M"===r?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s))},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+("M"===r?"Month":"Year")]=s["draw"+("M"===r?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=null!=n?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(n,r,i){if(null==n||null==r)throw"Invalid arguments";if(r="object"==typeof r?""+r:r+"",""===r)return null;var s,o,u,a,f=0,l=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),h=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,p=(i?i.dayNames:null)||this._defaults.dayNames,d=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,v=(i?i.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,y=-1,b=-1,w=!1,E=function(e){var t=n.length>s+1&&n.charAt(s+1)===e;return t&&s++,t},S=function(e){var t=E(e),n="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,i=RegExp("^\\d{1,"+n+"}"),s=r.substring(f).match(i);if(!s)throw"Missing number at position "+f;return f+=s[0].length,parseInt(s[0],10)},x=function(n,i,s){var o=-1,u=e.map(E(n)?s:i,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(u,function(e,n){var i=n[1];return r.substr(f,i.length).toLowerCase()===i.toLowerCase()?(o=n[0],f+=i.length,!1):t}),-1!==o)return o+1;throw"Unknown name at position "+f},T=function(){if(r.charAt(f)!==n.charAt(s))throw"Unexpected literal at position "+f;f++};for(s=0;n.length>s;s++)if(w)"'"!==n.charAt(s)||E("'")?T():w=!1;else switch(n.charAt(s)){case"d":y=S("d");break;case"D":x("D",h,p);break;case"o":b=S("o");break;case"m":g=S("m");break;case"M":g=x("M",d,v);break;case"y":m=S("y");break;case"@":a=new Date(S("@")),m=a.getFullYear(),g=a.getMonth()+1,y=a.getDate();break;case"!":a=new Date((S("!")-this._ticksTo1970)/1e4),m=a.getFullYear(),g=a.getMonth()+1,y=a.getDate();break;case"'":E("'")?T():w=!0;break;default:T()}if(r.length>f&&(u=r.substr(f),!/^\s+/.test(u)))throw"Extra/unparsed characters found in date: "+u;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=m?0:-100)),b>-1)for(g=1,y=b;;){if(o=this._getDaysInMonth(m,g-1),o>=y)break;g++,y-=o}if(a=this._daylightSavingAdjust(new Date(m,g-1,y)),a.getFullYear()!==m||a.getMonth()+1!==g||a.getDate()!==y)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=e.length>r+1&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))for(;n>r.length;)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;e.length>r;r++)if(h)"'"!==e.charAt(r)||a("'")?c+=e.charAt(r):h=!1;else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=e.length>t+1&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;e.length>t;t++)if(r)"'"!==e.charAt(t)||i("'")?n+=e.charAt(t):r=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}for(var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);f;){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=7*parseInt(f[1],10);break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=null==n||""===n?r:"string"==typeof n?s(n):"number"==typeof n?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&"Invalid Date"==""+o?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),i===e.selectedMonth&&s===e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=1!==V[0]||1!==V[1],Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;if(0>Z&&(Z+=12,et--),Y)for(t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&G>t?G:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",S=0;V[0]>S;S++){for(x="",this.maxRows=4,T=0;V[1]>T;T++){if(N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="",K){if(k+="<div class='ui-datepicker-group",V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}for(k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&0===S?U?s:r:"")+(/all|right/.test(C)&&0===S?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",E=0;7>E;E++)A=(E+l)%7,L+="<th"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";for(k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M)),H=0;D>H;H++){for(k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"",E=0;7>E;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&G>P||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(F&&!g||!j[2]?"":" title='"+j[2].replace(/'/g,"&#39;")+"'")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",l=0;12>l;l++)(!a||l>=r.getMonth())&&(!f||i.getMonth()>=l)&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}if(y||(b+=w+(!s&&m&&g?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";v>=d;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!s&&m&&g?"":"&#xa0;")+w),b+="</div>"},_adjustInstDate:function(e,t,n){var r=e.drawYear+("Y"===n?t:0),i=e.drawMonth+("M"===n?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+("D"===n?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===n||"Y"===n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&n>t?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(0>t?t:i[0]*i[1]),1));return 0>t&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||u>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.3"}(jQuery),function(e){e.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var n=e(t.target).closest(".ui-menu-item");!this.mouseHandled&&n.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),n.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var r,i,s,o,u,a=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:a=!1,i=this.previousFilter||"",s=String.fromCharCode(t.keyCode),o=!1,clearTimeout(this.filterTimer),s===i?o=!0:s=i+s,u=RegExp("^"+n(s),"i"),r=this.activeMenu.children(".ui-menu-item").filter(function(){return u.test(e(this).children("a").text())}),r=o&&-1!==r.index(this.active.next())?this.active.nextAll(".ui-menu-item"):r,r.length||(s=String.fromCharCode(t.keyCode),u=RegExp("^"+n(s),"i"),r=this.activeMenu.children(".ui-menu-item").filter(function(){return u.test(e(this).children("a").text())})),r.length?(this.focus(t,r),r.length>1?(this.previousFilter=s,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}a&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,r=this.element.find(this.options.menus);r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),r=t.prev("a"),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);r.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",r.attr("id"))}),t=r.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role
:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),this._super(e,t)},focus:function(e,t){var n,r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),r=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,r,i,s,o,u;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-n-r,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),u=t.height(),0>i?this.activeMenu.scrollTop(s+i):i+u>o&&this.activeMenu.scrollTop(s+i-o+u))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var r=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var r;this.active&&(r="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),r&&r.length&&this.active||(r=this.activeMenu.children(".ui-menu-item")[t]()),this.focus(n,r)},nextPage:function(t){var n,r,i;return this.active?(this.isLastItem()||(this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),0>n.offset().top-r-i}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),undefined):(this.next(t),undefined)},previousPage:function(t){var n,r,i;return this.active?(this.isFirstItem()||(this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r+i>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())),undefined):(this.next(t),undefined)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){var n="ui-effects-";e.effects={effect:{}},function(e,t){function n(e,t,n){var r=c[t.type]||{};return null==e?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:e>r.max?r.max:e)}function r(n){var r=f(),i=r._rgba=[];return n=n.toLowerCase(),d(a,function(e,s){var o,u=s.re.exec(n),a=u&&s.parse(u),f=s.space||"rgba";return a?(o=r[f](a),r[l[f].cache]=o[l[f].cache],i=r._rgba=o._rgba,!1):t}),i.length?("0,0,0,0"===i.join()&&e.extend(i,s.transparent),r):s[n]}function i(e,t,n){return n=(n+1)%1,1>6*n?e+6*(t-e)*n:1>2*n?t:2>3*n?e+6*(t-e)*(2/3-n):e}var s,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",u=/^([\-+])=\s*(\d+\.?\d*)/,a=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],f=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},l={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},h=f.support={},p=e("<p>")[0],d=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",h.rgba=p.style.backgroundColor.indexOf("rgba")>-1,d(l,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),f.fn=e.extend(f.prototype,{parse:function(i,o,u,a){if(i===t)return this._rgba=[null,null,null,null],this;(i.jquery||i.nodeType)&&(i=e(i).css(o),o=t);var c=this,h=e.type(i),p=this._rgba=[];return o!==t&&(i=[i,o,u,a],h="array"),"string"===h?this.parse(r(i)||s._default):"array"===h?(d(l.rgba.props,function(e,t){p[t.idx]=n(i[t.idx],t)}),this):"object"===h?(i instanceof f?d(l,function(e,t){i[t.cache]&&(c[t.cache]=i[t.cache].slice())}):d(l,function(t,r){var s=r.cache;d(r.props,function(e,t){if(!c[s]&&r.to){if("alpha"===e||null==i[e])return;c[s]=r.to(c._rgba)}c[s][t.idx]=n(i[e],t,!0)}),c[s]&&0>e.inArray(null,c[s].slice(0,3))&&(c[s][3]=1,r.from&&(c._rgba=r.from(c[s])))}),this):t},is:function(e){var n=f(e),r=!0,i=this;return d(l,function(e,s){var o,u=n[s.cache];return u&&(o=i[s.cache]||s.to&&s.to(i._rgba)||[],d(s.props,function(e,n){return null!=u[n.idx]?r=u[n.idx]===o[n.idx]:t})),r}),r},_space:function(){var e=[],t=this;return d(l,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var r=f(e),i=r._space(),s=l[i],o=0===this.alpha()?f("transparent"):this,u=o[s.cache]||s.to(o._rgba),a=u.slice();return r=r[s.cache],d(s.props,function(e,i){var s=i.idx,o=u[s],f=r[s],l=c[i.type]||{};null!==f&&(null===o?a[s]=f:(l.mod&&(f-o>l.mod/2?o+=l.mod:o-f>l.mod/2&&(o-=l.mod)),a[s]=n((f-o)*t+o,i)))}),this[i](a)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),r=n.pop(),i=f(t)._rgba;return f(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(255*r)),"#"+e.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),f.fn.parse.prototype=f.fn,l.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,r=e[0]/255,i=e[1]/255,s=e[2]/255,o=e[3],u=Math.max(r,i,s),a=Math.min(r,i,s),f=u-a,l=u+a,c=.5*l;return t=a===u?0:r===u?60*(i-s)/f+360:i===u?60*(s-r)/f+120:60*(r-i)/f+240,n=0===f?0:.5>=c?f/l:f/(2-l),[Math.round(t)%360,n,c,null==o?1:o]},l.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],s=e[3],o=.5>=r?r*(1+n):r+n-r*n,u=2*r-o;return[Math.round(255*i(u,o,t+1/3)),Math.round(255*i(u,o,t)),Math.round(255*i(u,o,t-1/3)),s]},d(l,function(r,i){var s=i.props,o=i.cache,a=i.to,l=i.from;f.fn[r]=function(r){if(a&&!this[o]&&(this[o]=a(this._rgba)),r===t)return this[o].slice();var i,u=e.type(r),c="array"===u||"object"===u?r:arguments,h=this[o].slice();return d(s,function(e,t){var r=c["object"===u?e:t.idx];null==r&&(r=h[t.idx]),h[t.idx]=n(r,t)}),l?(i=f(l(h)),i[o]=h,i):f(h)},d(s,function(t,n){f.fn[t]||(f.fn[t]=function(i){var s,o=e.type(i),a="alpha"===t?this._hsla?"hsla":"rgba":r,f=this[a](),l=f[n.idx];return"undefined"===o?l:("function"===o&&(i=i.call(this,l),o=e.type(i)),null==i&&n.empty?this:("string"===o&&(s=u.exec(i),s&&(i=l+parseFloat(s[2])*("+"===s[1]?1:-1))),f[n.idx]=i,this[a](f)))})})}),f.hook=function(t){var n=t.split(" ");d(n,function(t,n){e.cssHooks[n]={set:function(t,i){var s,o,u="";if("transparent"!==i&&("string"!==e.type(i)||(s=r(i)))){if(i=f(s||i),!h.rgba&&1!==i._rgba[3]){for(o="backgroundColor"===n?t.parentNode:t;(""===u||"transparent"===u)&&o&&o.style;)try{u=e.css(o,"backgroundColor"),o=o.parentNode}catch(a){}i=i.blend(u&&"transparent"!==u?u:"_default")}i=i.toRgbaString()}try{t.style[n]=i}catch(a){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=f(t.elem,n),t.end=f(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},f.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return d(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},s=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(t){var n,r,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,s={};if(i&&i.length&&i[0]&&i[i[0]])for(r=i.length;r--;)n=i[r],"string"==typeof i[n]&&(s[e.camelCase(n)]=i[n]);else for(n in i)"string"==typeof i[n]&&(s[n]=i[n]);return s}function r(t,n){var r,i,o={};for(r in n)i=n[r],t[r]!==i&&(s[r]||(e.fx.step[r]||!isNaN(parseFloat(i)))&&(o[r]=i));return o}var i=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(jQuery.style(e.elem,n,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(t,s,o,u){var f=e.speed(s,o,u);return this.queue(function(){var s,o=e(this),u=o.attr("class")||"",l=f.children?o.find("*").addBack():o;l=l.map(function(){var t=e(this);return{el:t,start:n(this)}}),s=function(){e.each(i,function(e,n){t[n]&&o[n+"Class"](t[n])})},s(),l=l.map(function(){return this.end=n(this.el[0]),this.diff=r(this.start,this.end),this}),o.attr("class",u),l=l.map(function(){var t=this,n=e.Deferred(),r=e.extend({},f,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,l.get()).done(function(){s(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),f.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(n,r,i,s){return r?e.effects.animateClass.call(this,{add:n},r,i,s):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(n,r,i,s){return arguments.length>1?e.effects.animateClass.call(this,{remove:n},r,i,s):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(n){return function(r,i,s,o,u){return"boolean"==typeof i||i===t?s?e.effects.animateClass.call(this,i?{add:r}:{remove:r},s,o,u):n.apply(this,arguments):e.effects.animateClass.call(this,{toggle:r},i,s,o)}}(e.fn.toggleClass),switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function r(t,n,r,i){return e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},null==n&&(n={}),e.isFunction(n)&&(i=n,r=null,n={}),("number"==typeof n||e.fx.speeds[n])&&(i=r,r=n,n={}),e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:"number"==typeof r?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function s(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.10.3",save:function(e,t){for(var r=0;t.length>r;r++)null!==t[r]&&e.data(n+t[r],e[0].style[t[r]])},restore:function(e,r){var s,o;for(o=0;r.length>o;o++)null!==r[o]&&(s=e.data(n+r[o]),s===t&&(s=""),e.css(r[o],s))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),"static"===t.css("position")?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function t(t){function r(){e.isFunction(s)&&s.call(i[0]),e.isFunction(t)&&t()}var i=e(this),s=n.complete,u=n.mode;(i.is(":hidden")?"hide"===u:"show"===u)?(i[u](),r()):o.call(i[0],n,r)}var n=r.apply(this,arguments),i=n.mode,s=n.queue,o=e.effects.effect[n.effect];return e.fx.off||!o?i?this[i](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):s===!1?this.each(t):this.queue(s||"fx",t)},show:function(e){return function(t){if(s(t))return e.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(t){if(s(t))return e.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(t){if(s(t)||"boolean"==typeof t)return e.apply(this,arguments);var n=r.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,n=4;((t=Math.pow(2,--n))-1)/11>e;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?n(2*e)/2:1-n(-2*e+2)/2}})}()}(jQuery),function(e){e.effects.effect.drop=function(t,n){var r,i=e(this),s=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(i,t.mode||"hide"),u="show"===o,a=t.direction||"left",f="up"===a||"down"===a?"top":"left",l="up"===a||"left"===a?"pos":"neg",c={opacity:u?1:0};e.effects.save(i,s),i.show(),e.effects.createWrapper(i),r=t.distance||i["top"===f?"outerHeight":"outerWidth"](!0)/2,u&&i.css("opacity",0).css(f,"pos"===l?-r:r),c[f]=(u?"pos"===l?"+=":"-=":"pos"===l?"-=":"+=")+r,i.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&i.hide(),e.effects.restore(i,s),e.effects.removeWrapper(i),n()}})}}(jQuery),function(e){e.effects.effect.explode=function(t,n){function r(){b.push(this),b.length===c*h&&i()}function i(){p.css({visibility:"visible"}),e(b).remove(),v||p.hide(),n()}var s,o,u,a,f,l,c=t.pieces?Math.round(Math.sqrt(t.pieces)):3,h=c,p=e(this),d=e.effects.setMode(p,t.mode||"hide"),v="show"===d,m=p.show().css("visibility","hidden").offset(),g=Math.ceil(p.outerWidth()/h),y=Math.ceil(p.outerHeight()/c),b=[];for(s=0;c>s;s++)for(a=m.top+s*y,l=s-(c-1)/2,o=0;h>o;o++)u=m.left+o*g,f=o-(h-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*g,top:-s*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:g,height:y,left:u+(v?f*g:0),top:a+(v?l*y:0),opacity:v?0:1}).animate({left:u+(v?0:f*g),top:a+(v?0:l*y),opacity:v?1:0},t.duration||500,t.easing,r)}}(jQuery),function(e){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};"hide"===s&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===s&&r.hide(),e.effects.restore(r,i),n()}})}}(jQuery),function(e){e.effects.effect.pulsate=function(t,n){var r,i=e(this),s=e.effects.setMode(i,t.mode||"show"),o="show"===s,u="hide"===s,a=o||"hide"===s,f=2*(t.times||5)+(a?1:0),l=t.duration/f,c=0,h=i.queue(),p=h.length;for((o||!i.is(":visible"))&&(i.css("opacity",0).show(),c=1),r=1;f>r;r++)i.animate({opacity:c},l,t.easing),c=1-c;i.animate({opacity:c},l,t.easing),i.queue(function(){u&&i.hide(),n()}),p>1&&h.splice.apply(h,[1,0].concat(h.splice(p,f+1))),i.dequeue()}}(jQuery),function(e){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s="fixed"===i.css("position"),o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery);var Plugins;(function(e){var t=function(){function e(e){typeof e=="undefined"&&(e=30),this.space=e}return e}();e.AutosizeInputOptions=t;var n=function(){function e(t,n){var r=this;this._input=$(t),this._options=$.extend({},e.getDefaultOptions(),n),this._mirror=$('<span style="position:absolute; top:-9999px; left:-9999px; white-space:pre;"/>'),$.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(e,t){r._mirror[0].style[t]=r._input.css(t)}),$("body").append(this._mirror),this._input.on("keydown keyup input propertychange change",function(e){r.update()}),function(){r.update()}()}return e.prototype.getOptions=function(){return this._options},e.prototype.update=function(){var e=this._input.val()||"";if(e===this._mirror.text())return;this._mirror.text(e);var t=this._mirror.width()+this._options.space;this._input.width(t)},e.getDefaultOptions=function(){return this._defaultOptions},e.getInstanceKey=function(){return"autosizeInputInstance"},e._defaultOptions=new t,e}();e.AutosizeInput=n,function(t){var n="autosize-input",r=["text","password","search","url","tel","email","number"];t.fn.autosizeInput=function(i){return this.each(function(){if(!(this.tagName=="INPUT"&&t.inArray(this.type,r)>-1))return;var s=t(this);s.data(e.AutosizeInput.getInstanceKey())||(i==undefined&&(i=s.data(n)),s.data(e.AutosizeInput.getInstanceKey(),new e.AutosizeInput(this,i)))})},t(function(){t("input[data-"+n+"]").autosizeInput()})}(jQuery)})(Plugins||(Plugins={})),function(e,t,n){"$:nomunge";function r(r,i){function u(t){e(s).each(function(){var n=e(this);this!==t.target&&!n.has(t.target).length&&n.triggerHandler(i,[t.target])})}i=i||r+n;var s=e(),o=r+"."+i+"-special-event";e.event.special[i]={setup:function(){s=s.add(this),s.length===1&&e(t).bind(o,u)},teardown:function(){s=s.not(this),s.length===0&&e(t).unbind(o)},add:function(e){var t=e.handler;e.handler=function(e,n){e.target=n,t.apply(this,arguments)}}}}e.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(e){r(e)}),r("focusin","focus"+n),r("focusout","blur"+n),e.addOutsideEvent=r}(jQuery,document,"outside"),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,n,r,i){return jQuery.easing[jQuery.easing.def](e,t,n,r,i)},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){return t==0?n:t==i?n+r:(t/=i/2)<1?r/2*Math.pow(2,10*(t-1))+n:r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){return(t/=i/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return-(u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o))+n},easeOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i)==1)return n+r;o||(o=i*.3);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return u*Math.pow(2,-10*t)*Math.sin((t*i-s)*2*Math.PI/o)+r+n},easeInOutElastic:function(e,t,n,r,i){var s=1.70158,o=0,u=r;if(t==0)return n;if((t/=i/2)==2)return n+r;o||(o=i*.3*1.5);if(u<Math.abs(r)){u=r;var s=o/4}else var s=o/(2*Math.PI)*Math.asin(r/u);return t<1?-0.5*u*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)+n:u*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*2*Math.PI/o)*.5+r+n},easeInBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*(t/=i)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*((t=t/i-1)*t*((s+1)*t+s)+1)+n},easeInOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),(t/=i/2)<1?r/2*t*t*(((s*=1.525)+1)*t-s)+n:r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n},easeInBounce:function(e,t,n,r,i){return r-jQuery.easing.easeOutBounce(e,i-t,0,r,i)+n},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(e,t,n,r,i){return t<i/2?jQuery.easing.easeInBounce(e,t*2,0,r,i)*.5+n:jQuery.easing.easeOutBounce(e,t*2-i,0,r,i)*.5+r*.5+n}}),function(e){window.embedlyURLre=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,e.embedly=e.embedly||{};if(e.embedly.version)return;e.extend({embedly:function(t,n,r){var i=[],s="http://api.embed.ly/",o;typeof n!="undefined"?o=e.extend(e.embedly.defaults,n):o=e.embedly.defaults,o.urlRe||(o.urlRe=window.embedlyURLre),typeof t=="string"&&(t=new Array(t)),typeof r!="undefined"&&(o.success=r),o.secure&&(s="https://api.embed.ly/"),o.success===null&&(o.success=function(t,n){var r,i=e(n.node);if(!t)return null;if((r=o.method)==="replace")return i.replaceWith(t.code);if(r==="after")return i.after(t.code);if(r==="afterParent")return i.parent().after(t.code);if(r==="replaceParent")return i.parent().replaceWith(t.code)}),o.error===null&&(o.error=function(e,t){});var u=function(e){return o.urlRe.test(e)},a=function(e){var t="urls="+e;o.maxWidth!==null?t+="&maxwidth="+o.maxWidth:typeof dimensions!="undefined"&&(t+="&maxwidth="+dimensions.width),o.maxHeight!==null&&(t+="&maxheight="+o.maxHeight),o.chars!==null&&(t+="&chars="+o.chars),o.words!==null&&(t+="&words="+o.words),t+="&wmode="+o.wmode,typeof o.key=="string"&&(t+="&key="+o.key);if(typeof o.autoplay=="string"||typeof o.autoplay=="boolean")t+="&autoplay="+o.autoplay;return o.width&&(t+="&width="+o.width),t},f=function(){if(typeof o.key=="string"){if(o.endpoint.search(/objectify/i)>=0)return s+"2/objectify";if(o.endpoint.search(/preview/i)>=0)return s+"1/preview"}return s+"1/oembed"},l=function(t,n){if(o.endpoint!=="oembed")return o.success(t,n);var r,i,s,u,a,f,l,c;return(r=t.type)==="photo"?(u=t.title||"",s=[],o.addImageStyles&&(o.maxWidth&&(a=isNaN(parseInt(o.maxWidth,10))?"":"px",s.push("max-width: "+o.maxWidth+a)),o.maxHeight&&(a=isNaN(parseInt(o.maxHeight,10))?"":"px",s.push("max-height: "+o.maxHeight+a))),s=s.join(";"),i="<a href='"+n.url+"' target='_blank'><img style='"+s+"' src='"+t.url+"' alt='"+u+"' /></a>"):r==="video"?i=t.html:r==="rich"?i=t.html:(u=t.title||n.url,f=t.thumbnail_url?'<img src="'+t.thumbnail_url+'" class="thumb" />':"",c=t.description?'<div class="description">'+t.description+"</div>":"",l=t.provider_name?'<a href="'+t.provider_url+'" class="provider">'+t.provider_name+"</a>":"",i=f+"<a href='"+n.url+"'>"+u+"</a>",i+=l,i+=c),o.wrapElement&&o.wrapElement==="div"&&e.browser.msie&&e.browser.version<9&&(o.wrapElement="span"),o.wrapElement&&(i="<"+o.wrapElement+' class="'+o.className+'">'+i+"</"+o.wrapElement+">"),t.code=i,typeof n.node!="undefined"&&e(n.node).data("oembed",t).trigger("embedly-oembed",[t]),o.success(t,n)},c=function(t){var n,r,i,s,u;i=e.map(t,function(t,n){return n===0&&t.node!==null&&(u=e(t.node),s={width:u.parent().width(),height:u.parent().height()}),encodeURIComponent(t.url)}).join(","),e.ajax({url:f(),dataType:"jsonp",data:a(i),success:function(n){return e.each(n,function(e,n){return n.type!=="error"?l(n,t[e]):o.error(t[e].node,n)})}})};e.each(t,function(t,n){var r=typeof o.elems!="undefined"?o.elems[t]:null;typeof r!="undefined"&&!u(n)&&e(r).data("oembed",!1);var s={url:n,error_code:400,error_message:"HTTP 400: Bad Request",type:"error"};return n&&u(n)?i.push({url:n,node:r}):o.error(r,s)});var h=[],p=i.length;for(var d=0;0<=p?d<p:d>p;d+=20)h=h.concat(c(i.slice(d,d+20)));return o.elems?o.elems:this}}),e.embedly.version="2.1.6",e.embedly.defaults={endpoint:"oembed",chars:null,words:null,maxWidth:null,maxHeight:null,secure:!1,frame:!1,wmode:"opaque",autoplay:null,width:null,method:"replace",addImageStyles:!0,wrapElement:"div",className:"embed",urlRe:null,key:null,elems:[],success:null,error:null},e.fn.embedly=function(t,n){var r=typeof t!="undefined"?t:{};typeof n!="undefined"&&(t.success=n);var i=new Array,s=new Array;this.each(function(){typeof e(this).attr("href")!="undefined"?(i.push(e(this).attr("href")),s.push(e(this))):e(this).find("a").each(function(){i.push(e(this).attr("href")),s.push(e(this))}),r.elems=s});var o=e.embedly(i,r);return this}}(jQuery),jQuery.extend({highlightQuery:function(e,t,n,r){if(e.nodeType===3){var i=e.data.match(t);if(i){var s=document.createElement(n||"span");s.className=r||"highlightQuery";var o=e.splitText(i.index);o.splitText(i[0].length);var u=o.cloneNode(!0);return s.appendChild(u),o.parentNode.replaceChild(s,o),1}}else if(e.nodeType===1&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&(e.tagName!==n.toUpperCase()||e.className!==r))for(var a=0;a<e.childNodes.length;a++)a+=jQuery.highlightQuery(e.childNodes[a],t,n,r);return 0}}),jQuery.fn.unhighlightQuery=function(e){var t={className:"highlightQuery",element:"span"};return jQuery.extend(t,e),this.find(t.element+"."+t.className).each(function(){var e=this.parentNode;e.replaceChild(this.firstChild,this),e.normalize()}).end()},jQuery.fn.highlightQuery=function(e,t){var n={className:"highlightQuery",element:"span",caseSensitive:!1,wordsOnly:!1};jQuery.extend(n,t),e.constructor===String&&(e=[e]),e=jQuery.grep(e,function(e,t){return e!=""}),e=jQuery.map(e,function(e,t){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")});if(e.length==0)return this;var r=n.caseSensitive?"":"i",i="("+e.join("|")+")";n.wordsOnly&&(i="\\b"+i+"\\b");var s=new RegExp(i,r);return this.each(function(){jQuery.highlightQuery(this,s,n.element,n.className)})},function(e){e.fn.iframeAutoHeight=function(t){function n(e){i.debug&&i.debug===!0&&window.console&&console.log(e)}function r(t,r){n("Diagnostics from '"+r+"'");try{n("  "+e(t,window.top.document).contents().find("body")[0].scrollHeight+" for ...find('body')[0].scrollHeight"),n("  "+e(t.contentWindow.document).height()+" for ...contentWindow.document).height()"),n("  "+e(t.contentWindow.document.body).height()+" for ...contentWindow.document.body).height()")}catch(i){n("  unable to check in this state")}n("End diagnostics -> results vary by browser and when diagnostics are requested")}var i=e.extend({heightOffset:0,minHeight:0,callback:function(e){},debug:!1,diagnostics:!1},t);return n(i),this.each(function(){function t(t){i.diagnostics&&r(t,"resizeHeight");var s=e(t,window.top.document).contents().find("body"),o=s[0].scrollHeight+i.heightOffset;o<i.minHeight&&(n("new height is less than minHeight"),o=i.minHeight+i.heightOffset),n("New Height: "+o),t.style.height=o+"px",i.callback.apply(e(t),[{newFrameHeight:o}])}var s=0;n(this),i.diagnostics&&r(this,"each iframe");if(e.browser.safari||e.browser.opera){n("browser is webkit or opera"),e(this).load(function(){var e=0,r=this;r.style.height="0px";var i=function(){t(r)};s===0&&(e=500),n("load delay: "+e),setTimeout(i,e),s++});var o=e(this).attr("src");e(this).attr("src",""),e(this).attr("src",o)}else e(this).load(function(){t(this)})})}}(jQuery),function(e){typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function n(t){return e.isFunction(t)||typeof t=="object"?t:{top:t,left:t}}var t=e.scrollTo=function(t,n,r){return e(window).scrollTo(t,n,r)};return t.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0
:1,limit:!0},t.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!n)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||r.compatMode=="BackCompat"?r.body:r.documentElement})},e.fn.scrollTo=function(r,i,s){return typeof i=="object"&&(s=i,i=0),typeof s=="function"&&(s={onAfter:s}),r=="max"&&(r=9e9),s=e.extend({},t.defaults,s),i=i||s.duration,s.queue=s.queue&&s.axis.length>1,s.queue&&(i/=2),s.offset=n(s.offset),s.over=n(s.over),this._scrollable().each(function(){function p(e){u.animate(l,i,s.easing,e&&function(){e.call(this,a,s)})}if(r==null)return;var o=this,u=e(o),a=r,f,l={},c=u.is("html,body");switch(typeof a){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(a)){a=n(a);break}a=e(a,this);if(!a.length)return;case"object":if(a.is||a.style)f=(a=e(a)).offset()}var h=e.isFunction(s.offset)&&s.offset(o,a)||s.offset;e.each(s.axis.split(""),function(e,n){var r=n=="x"?"Left":"Top",i=r.toLowerCase(),d="scroll"+r,v=o[d],m=t.max(o,n);if(f)l[d]=f[i]+(c?0:v-u.offset()[i]),s.margin&&(l[d]-=parseInt(a.css("margin"+r))||0,l[d]-=parseInt(a.css("border"+r+"Width"))||0),l[d]+=h[i]||0,s.over[i]&&(l[d]+=a[n=="x"?"width":"height"]()*s.over[i]);else{var g=a[i];l[d]=g.slice&&g.slice(-1)=="%"?parseFloat(g)/100*m:g}s.limit&&/^\d+$/.test(l[d])&&(l[d]=l[d]<=0?0:Math.min(l[d],m)),!e&&s.queue&&(v!=l[d]&&p(s.onAfterFirst),delete l[d])}),p(s.onAfter)}).end()},t.max=function(t,n){var r=n=="x"?"Width":"Height",i="scroll"+r;if(!e(t).is("html,body"))return t[i]-e(t)[r.toLowerCase()]();var s="client"+r,o=t.ownerDocument.documentElement,u=t.ownerDocument.body;return Math.max(o[i],u[i])-Math.min(o[s],u[s])},t}),function(e){var t=function(e,t){return e<<t|e>>>32-t},n=function(e,t){var n,r,i,s,o;return i=e&2147483648,s=t&2147483648,n=e&1073741824,r=t&1073741824,o=(e&1073741823)+(t&1073741823),n&r?o^2147483648^i^s:n|r?o&1073741824?o^3221225472^i^s:o^1073741824^i^s:o^i^s},r=function(e,t,n){return e&t|~e&n},i=function(e,t,n){return e&n|t&~n},s=function(e,t,n){return e^t^n},o=function(e,t,n){return t^(e|~n)},u=function(e,i,s,o,u,a,f){return e=n(e,n(n(r(i,s,o),u),f)),n(t(e,a),i)},a=function(e,r,s,o,u,a,f){return e=n(e,n(n(i(r,s,o),u),f)),n(t(e,a),r)},f=function(e,r,i,o,u,a,f){return e=n(e,n(n(s(r,i,o),u),f)),n(t(e,a),r)},l=function(e,r,i,s,u,a,f){return e=n(e,n(n(o(r,i,s),u),f)),n(t(e,a),r)},c=function(e){var t,n=e.length,r=n+8,i=(r-r%64)/64,s=(i+1)*16,o=Array(s-1),u=0,a=0;while(a<n)t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|e.charCodeAt(a)<<u,a++;return t=(a-a%4)/4,u=a%4*8,o[t]=o[t]|128<<u,o[s-2]=n<<3,o[s-1]=n>>>29,o},h=function(e){var t="",n="",r,i;for(i=0;i<=3;i++)r=e>>>i*8&255,n="0"+r.toString(16),t+=n.substr(n.length-2,2);return t},p=function(e){e=e.replace(/\x0d\x0a/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t};e.extend({md5:function(e){var t=Array(),r,i,s,o,d,v,m,g,y,b=7,w=12,E=17,S=22,x=5,T=9,N=14,C=20,k=4,L=11,A=16,O=23,M=6,_=10,D=15,P=21;e=p(e),t=c(e),v=1732584193,m=4023233417,g=2562383102,y=271733878;for(r=0;r<t.length;r+=16)i=v,s=m,o=g,d=y,v=u(v,m,g,y,t[r+0],b,3614090360),y=u(y,v,m,g,t[r+1],w,3905402710),g=u(g,y,v,m,t[r+2],E,606105819),m=u(m,g,y,v,t[r+3],S,3250441966),v=u(v,m,g,y,t[r+4],b,4118548399),y=u(y,v,m,g,t[r+5],w,1200080426),g=u(g,y,v,m,t[r+6],E,2821735955),m=u(m,g,y,v,t[r+7],S,4249261313),v=u(v,m,g,y,t[r+8],b,1770035416),y=u(y,v,m,g,t[r+9],w,2336552879),g=u(g,y,v,m,t[r+10],E,4294925233),m=u(m,g,y,v,t[r+11],S,2304563134),v=u(v,m,g,y,t[r+12],b,1804603682),y=u(y,v,m,g,t[r+13],w,4254626195),g=u(g,y,v,m,t[r+14],E,2792965006),m=u(m,g,y,v,t[r+15],S,1236535329),v=a(v,m,g,y,t[r+1],x,4129170786),y=a(y,v,m,g,t[r+6],T,3225465664),g=a(g,y,v,m,t[r+11],N,643717713),m=a(m,g,y,v,t[r+0],C,3921069994),v=a(v,m,g,y,t[r+5],x,3593408605),y=a(y,v,m,g,t[r+10],T,38016083),g=a(g,y,v,m,t[r+15],N,3634488961),m=a(m,g,y,v,t[r+4],C,3889429448),v=a(v,m,g,y,t[r+9],x,568446438),y=a(y,v,m,g,t[r+14],T,3275163606),g=a(g,y,v,m,t[r+3],N,4107603335),m=a(m,g,y,v,t[r+8],C,1163531501),v=a(v,m,g,y,t[r+13],x,2850285829),y=a(y,v,m,g,t[r+2],T,4243563512),g=a(g,y,v,m,t[r+7],N,1735328473),m=a(m,g,y,v,t[r+12],C,2368359562),v=f(v,m,g,y,t[r+5],k,4294588738),y=f(y,v,m,g,t[r+8],L,2272392833),g=f(g,y,v,m,t[r+11],A,1839030562),m=f(m,g,y,v,t[r+14],O,4259657740),v=f(v,m,g,y,t[r+1],k,2763975236),y=f(y,v,m,g,t[r+4],L,1272893353),g=f(g,y,v,m,t[r+7],A,4139469664),m=f(m,g,y,v,t[r+10],O,3200236656),v=f(v,m,g,y,t[r+13],k,681279174),y=f(y,v,m,g,t[r+0],L,3936430074),g=f(g,y,v,m,t[r+3],A,3572445317),m=f(m,g,y,v,t[r+6],O,76029189),v=f(v,m,g,y,t[r+9],k,3654602809),y=f(y,v,m,g,t[r+12],L,3873151461),g=f(g,y,v,m,t[r+15],A,530742520),m=f(m,g,y,v,t[r+2],O,3299628645),v=l(v,m,g,y,t[r+0],M,4096336452),y=l(y,v,m,g,t[r+7],_,1126891415),g=l(g,y,v,m,t[r+14],D,2878612391),m=l(m,g,y,v,t[r+5],P,4237533241),v=l(v,m,g,y,t[r+12],M,1700485571),y=l(y,v,m,g,t[r+3],_,2399980690),g=l(g,y,v,m,t[r+10],D,4293915773),m=l(m,g,y,v,t[r+1],P,2240044497),v=l(v,m,g,y,t[r+8],M,1873313359),y=l(y,v,m,g,t[r+15],_,4264355552),g=l(g,y,v,m,t[r+6],D,2734768916),m=l(m,g,y,v,t[r+13],P,1309151649),v=l(v,m,g,y,t[r+4],M,4149444226),y=l(y,v,m,g,t[r+11],_,3174756917),g=l(g,y,v,m,t[r+2],D,718787259),m=l(m,g,y,v,t[r+9],P,3951481745),v=n(v,i),m=n(m,s),g=n(g,o),y=n(y,d);var H=h(v)+h(m)+h(g)+h(y);return H.toLowerCase()}})}(jQuery),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(e==null)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}return e};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-Infinity,i=-Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=Infinity,i=Infinity;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u<i&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return t==null||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return e==null?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:t<0?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t,n){t=k(t);var r=[],i=[];return T(e,function(e){(t.call(n,e)?r:i).push(e)}),[r,i]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){var n=0,r=t.slice();for(var i=0,s=r.length;i<s;i++)r[i]===x&&(r[i]=arguments[n++]);while(n<arguments.length)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),typeof define=="function"&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(e,t){if(typeof define=="function"&&define.amd)define(["underscore","jquery","exports"],function(n,r,i){e.Backbone=t(e,i,n,r)});else if(typeof exports!="undefined"){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,r){var i=e.Backbone,s=[],o=s.push,u=s.slice,a=s.splice;t.VERSION="1.1.2",t.$=r,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var f=t.Events={on:function(e,t,n){if(!c(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,r){if(!c(this,"once",e,[t,r])||!t)return this;var i=this,s=n.once(function(){i.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,r)},off:function(e,t,r){var i,s,o,u,a,f,l,h;if(!this._events||!c(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;u=e?[e]:n.keys(this._events);for(a=0,f=u.length;a<f;a++){e=u[a];if(o=this._events[e]){this._events[e]=i=[];if(t||r)for(l=0,h=o.length;l<h;l++)s=o[l],(t&&t!==s.callback&&t!==s.callback._callback||r&&r!==s.context)&&i.push(s);i.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=u.call(arguments,1);if(!c(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&h(n,t),r&&h(r,arguments),this},stopListening:function(e,t,r){var i=this._listeningTo;if(!i)return this;var s=!t&&!r;!r&&typeof t=="object"&&(r=this),e&&((i={})[e._listenId]=e);for(var o in i)e=i[o],e.off(t,r,this),(s||n.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(l.test(n)){var s=n.split(l);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},h=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t);return}},p={listenTo:"on",listenToOnce:"once"};n.each(p,function(e,t){f[t]=function(t,r,i){var s=this._listeningTo||(this._listeningTo={}),o=t._listenId||(t._listenId=n.uniqueId("l"));return s[o]=t,!i&&typeof r=="object"&&(i=this),t[e](r,i,this),this}}),f.bind=f.on,f.unbind=f.off,n.extend(t,f);var d=t.Model=function(e,t){var r=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(r=this.parse(r,t)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(d.prototype,f,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,r){var i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(s=e,r=t):(s={})[e]=t,r||(r={});if(!this._validate(s,r))return!1;o=r.unset,a=r.silent,u=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=n.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(i in s)t=s[i],n.isEqual(c[i],t)||u.push(i),n.isEqual(l[i],t)?delete this.changed[i]:this.changed[i]=t,o?delete c[i]:c[i]=t;if(!a){u.length&&(this._pending=r);for(var h=0,p=u.length;h<p;h++)this.trigger("change:"+u[h],this,c[u[h]],r)}if(f)return this;if(!a)while(this._pending)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var r in this.attributes)t[r]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var s in e){if(n.isEqual(i[s],t=e[s]))continue;(r||(r={}))[s]=t}return r},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,r=e.success;return e.success=function(n){if(!t.set(t.parse(n,e),e))return!1;r&&r(t,n,e),t.trigger("sync",t,n,e)},I(this,e),this.sync("read",this,e)},save:function(e,t,r){var i,s,o,u=this.attributes;e==null||typeof e=="object"?(i=e,r=t):(i={})[e]=t,r=n.extend({validate:!0},r);if(i&&!r.wait){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;i&&r.wait&&(this.attributes=n.extend({},u,i)),r.parse===void 0&&(r.parse=!0);var a=this,f=r.success;return r.success=function(e){a.attributes=u;var t=a.parse(e,r);r.wait&&(t=n.extend(i||{},t));if(n.isObject(t)&&!a.set(t,r))return!1;f&&f(a,e,r),a.trigger("sync",a,e,r)},I(this,r),s=this.isNew()?"create":r.patch?"patch":"update",s==="patch"&&(r.attrs=i),o=this.sync(s,this,r),i&&r.wait&&(this.attributes=u),o},destroy:function(e){e=e?n.clone(e):{};var t=this,r=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(n){(e.wait||t.isNew())&&i(),r&&r(t,n,e),t.isNew()||t.trigger("sync",t,n,e)};if(this.isNew())return e.success(),!1;I(this,e);var s=this.sync("delete",this,e);return e.wait||i(),s},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var r=this.validationError=this.validate(e,t)||null;return r?(this.trigger("invalid",this,r,n.extend(t,{validationError:r})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];n.each(v,function(e){d.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,remove:!1};n.extend(m.prototype,f,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,y))},remove:function(e,t){var r=!n.isArray(e);e=r?[e]:n.clone(e),t||(t={});var i,s,o,u;for(i=0,s=e.length;i<s;i++){u=e[i]=this.get(e[i]);if(!u)continue;delete this._byId[u.id],delete this._byId[u.cid],o=this.indexOf(u),this.models.splice(o,1),this.length--,t.silent||(t.index=o,u.trigger("remove",u,this,t)),this._removeReference(u,t)}return r?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var r=!n.isArray(e);e=r?e?[e]:[]:n.clone(e);var i,s,o,u,a,f,l,c=t.at,h=this.model,p=this.comparator&&c==null&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,m=[],y=[],b={},w=t.add,E=t.merge,S=t.remove,x=!p&&w&&S?[]:!1;for(i=0,s=e.length;i<s;i++){a=e[i]||{},a instanceof d?o=u=a:o=a[h.prototype.idAttribute||"id"];if(f=this.get(o))S&&(b[f.cid]=!0),E&&(a=a===u?u.attributes:a,t.parse&&(a=f.parse(a,t)),f.set(a,t),p&&!l&&f.hasChanged(v)&&(l=!0)),e[i]=f;else if(w){u=e[i]=this._prepareModel(a,t);if(!u)continue;m.push(u),this._addReference(u,t)}u=f||u,x&&(u.isNew()||!b[u.id])&&x.push(u),b[u.id]=!0}if(S){for(i=0,s=this.length;i<s;++i)b[(u=this.models[i]).cid]||y.push(u);y.length&&this.remove(y,t)}if(m.length||x&&x.length){p&&(l=!0),this.length+=m.length;if(c!=null)for(i=0,s=m.length;i<s;i++)this.models.splice(c+i,0,m[i]);else{x&&(this.models.length=0);var T=x||m;for(i=0,s=T.length;i<s;i++)this.models.push(T[i])}}l&&this.sort({silent:!0});if(!t.silent){for(i=0,s=m.length;i<s;i++)(u=m[i]).trigger("add",u,this,t);(l||x&&x.length)&&this.trigger("sort",this,t)}return r?e[0]:e},reset:function(e,t){t||(t={});for(var r=0,i=this.models.length;r<i;r++)this._removeReference(this.models[r],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return u.apply(this.models,arguments)},get:function(e){return e==null?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,r=this;return e.success=function(n){var i=e.reset?"reset":"set";r[i](n,e),t&&t(r,n,e),r.trigger("sync",r,n,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){t=t?n.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var r=this,i=t.success;return t.success=function(e,n){t.wait&&r.add(e,t),i&&i(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e;t=t?n.clone(t):{},t.collection=this;var r=new this.model(e,t);return r.validationError?(this.trigger("invalid",this,r.validationError,t),!1):r},_addReference:function(e,t){this._byId[e.cid]=e,e.id!=null&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(b,function(e){m.prototype[e]=function(){var t=u.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var w=["groupBy","countBy","sortBy","indexBy"];n.each(w,function(e){m.prototype[e]=function(t,r){var i=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,i,r)}});var E=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,f,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var r=e[t];n.isFunction(r
)||(r=this[e[t]]);if(!r)continue;var i=t.match(S),s=i[1],o=i[2];r=n.bind(r,this),s+=".delegateEvents"+this.cid,o===""?this.$el.on(s,r):this.$el.on(s,o,r)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(!this.el){var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var r=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(r,!1)}else this.setElement(n.result(this,"el"),!1)}}),t.sync=function(e,r,i){var s=N[e];n.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};i.url||(o.url=n.result(r,"url")||F()),i.data==null&&r&&(e==="create"||e==="update"||e==="patch")&&(o.contentType="application/json",o.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{});if(i.emulateHTTP&&(s==="PUT"||s==="DELETE"||s==="PATCH")){o.type="POST",i.emulateJSON&&(o.data._method=s);var u=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",s);if(u)return u.apply(this,arguments)}}o.type!=="GET"&&!i.emulateJSON&&(o.processData=!1),o.type==="PATCH"&&T&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(n.extend(o,i));return r.trigger("request",r,a,i),a};var T=typeof window!="undefined"&&!!window.ActiveXObject&&(!window.XMLHttpRequest||!(new XMLHttpRequest).dispatchEvent),N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},k=/\((.*?)\)/g,L=/(\(\?)?:\w+/g,A=/\*\w+/g,O=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,f,{initialize:function(){},route:function(e,r,i){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var s=this;return t.history.route(e,function(n){var o=s._extractParameters(e,n);s.execute(i,o),s.trigger.apply(s,["route:"+r].concat(o)),s.trigger("route",r,o),t.history.trigger("route",s,r,o)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(!this.routes)return;this.routes=n.result(this,"routes");var e,t=n.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(O,"\\$&").replace(k,"(?:$1)?").replace(L,function(e,t){return t?e:"([^/?]+)"}).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var r=e.exec(t).slice(1);return n.map(r,function(e,t){return t===r.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},_=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,P=/msie [\w.]+/,H=/\/$/,B=/#.*$/;M.started=!1,n.extend(M.prototype,f,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(H,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(_,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),i=document.documentMode,s=P.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(D,"/");if(s&&this._wantsHashChange){var o=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=o.hide().appendTo("body")[0].contentWindow,this.navigate(r)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var u=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&u.hash&&(this.fragment=this.getHash().replace(_,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0})},navigate:function(e,t){if(!M.started)return!1;if(!t||t===!0)t={trigger:!!t};var n=this.root+(e=this.getFragment(e||""));e=e.replace(B,"");if(this.fragment===e)return;this.fragment=e,e===""&&n!=="/"&&(n=n.slice(0,-1));if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}if(t.trigger)return this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),t.history=new M;var j=function(e,t){var r=this,i;e&&n.has(e,"constructor")?i=e.constructor:i=function(){return r.apply(this,arguments)},n.extend(i,r,t);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};d.extend=m.extend=C.extend=E.extend=M.extend=j;var F=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}};return t}),function(){window.Stacker={cacheSheets:!0,stubTimeout:500,initialize:function(e){var t;e==null&&(e="#workspace");if(!(t=$(e).get(0)))return;return this.workspace=new Stacker.Workspace(t)},isSameOrigin:function(e){var t,n;return t=document.createElement("a"),t.href=e,n=t.href.split("/",3).join("/"),!window.location.href.indexOf(n)},isStandardClick:function(e){return e.isTrigger||e.which===1&&!e.metaKey&&!e.ctrlKey},normalizePath:function(e){var t,n;return t=document.createElement("a"),t.href=e,n=t.pathname+t.search,n.replace(/^\/*/,"/")},extract:function(e,t){var n;return n=document.createElement("div"),n.innerHTML=e,$(n).find(t).get(0)}}}.call(this),function(){Stacker.history="pushState"in window.history?function(){var e,t,n,r,i;return t=0,e=0,i={0:{}},r=function(e,r,s,o){return i[++t]=e!=null?e:{},o==null&&(o=window.location.toString()),window.history[r]({_stacker:{id:t,title:s,url:o}},s,o),n(t)},n=function(t){var n;if(!(n=i[t]))return;return e=t,$(document).trigger("stacker:statechange",[n])},window.addEventListener("popstate",function(e){var t,r;if(!(t=(r=e.state)!=null?r._stacker:void 0))return;return $.extend(i[t.id],{restorePosition:!0}),n(t.id)},!1),{pushState:function(e,t,n){return r(e,"pushState",t,n)},replaceState:function(e,t,n){return r(e,"replaceState",t,n)},getState:function(t){return i[t!=null?t:e]}}}():void 0}.call(this),function(){this.JST||(this.JST={}),this.JST["stacker/templates/404"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="panel sheet error not_found">\n  <header>\n    <h1>The page you were looking for doesn&rsquo;t exist.</h1>\n  </header>\n  <div class="sheet_body">\n    <p>You may have mistyped the address or the page may have moved.</p>\n    <p><a href="#" onclick="history.back(); return false">&larr; Go back</a></p>\n  </div>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["stacker/templates/500"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="panel sheet error internal_server_error">\n  <header>\n    <h1>We&rsquo;re sorry, but something went wrong.</h1>\n  </header>\n  <div class="sheet_body">\n    <p>We&rsquo;ve been notified about this issue and we&rsquo;ll take a look at it shortly.</p>\n    <p><a href="#" onclick="history.back(); return false">&larr; Go back</a></p>\n    '),Stacker.env==="development"&&(t.push('\n      <p><a href="#" data-response-text="'),t.push(r(this.responseText)),t.push('" onclick="(function(document){document.write(this.getAttribute(\'data-response-text\'));document.close()}).call(this,window.open().document);return false">View server response</a></p>\n    ')),t.push("\n  </div>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){var e=[].slice;Stacker.Panel=function(){function t(e,t){this.el=e,this.container=t,this.status=200,this.hasLoaded=!1,this.initialize()}return t.stubInnerHTML="",t.stubOuterHTML='<div class="panel stub">',t.extract=function(e,t){return t==null&&(t="div.panel"),Stacker.extract(e,t)},t.createStubElement=function(e){var t;return t=$(this.stubOuterHTML+this.stubInnerHTML),t.attr("data-path",e),t.get(0)},t.createStub=function(e,t){return new this(this.createStubElement(e),t)},t.prototype.initialize=function(){var e,t;return e=(t=$(this.el).attr("data-path"))!=null?t:location.pathname+location.search,this.path==null&&(this.path=Stacker.normalizePath(e)),this.title=$(this.el).find("title").text()},t.prototype.notify=function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],(r=this.container)!=null?typeof r[n]=="function"?r[n].apply(r,[this].concat(e.call(t))):void 0:void 0},t.prototype.request=function(e,t){var n,r;r=e.responseText,n=e.preventReload;if(r)return this.handleSuccessResponse(this.status=200,r),this.hasLoaded=!0,typeof t=="function"?t():void 0;if(!this.hasLoaded||!n&&!!this.canBeReloaded())return $(this.el).addClass("loading"),$.ajax({url:this.path,data:{from_workspace:1},dataType:"html",beforeSend:function(e){return e.stacker=!0},complete:function(e){return function(n){var r,i;i=n.status,r=n.responseText,$(e.el).removeClass("loading");if(!e.canBeReplaced())return;return i===200||i===304?e.handleSuccessResponse(i,r):i>0&&e.handleErrorResponse(i,r),e.status=i,typeof t=="function"?t():void 0}}(this)});if(this.canBeReplaced())return this.replace(this.el),typeof t=="function"?t():void 0},t.prototype.handleSuccessResponse=function(e,t){return this.replace(this.constructor.extract(t)),this.hasLoaded=!0},t.prototype.handleErrorResponse=function(e,t){var n;return e===404?n=JST["stacker/templates/404"]:n=JST["stacker/templates/500"],this.replace(this.constructor.extract(n({status:e,responseText:t})))},t.prototype.replace=function(e){return e!==this.el&&($(this.el).replaceWith(e),this.el=e),this.initialize(),this.notify("didReplacePanel")},t.prototype.canBeReplaced=function(){return!0},t.prototype.canBeReloaded=function(){return!$(this.el).is("[data-behavior~=prevent_reload]")},t.prototype.isStub=function(){return $(this.el).hasClass("stub")},t.prototype.isLoading=function(){return $(this.el).hasClass("loading")},t}()}.call(this),function(){Stacker.ExclusiveCallback=function(){function e(){this.reset()}return e.prototype.define=function(e){return this.callback=e,function(t){return function(){if(t.callback===e)return e(),t.reset()}}(this)},e.prototype.timeout=function(e,t){var n;return n=this.define(t),setTimeout(n,e),n},e.prototype.reset=function(){return this.callback=null},e}()}.call(this),function(){var e=[].slice;Stacker.Container=function(){function r(e,t){this.el=e,this.workspace=t,this.id=++n,this.loadCallback=new Stacker.ExclusiveCallback,this.initialize()}var t,n;return n=0,t={},r.panelConstructor=Stacker.Panel,r.createStubElement=function(){var e;return e=$("<div class=container>"),e.addClass(this.className),e.get(0)},r.createStub=function(e){return new this(this.createStubElement(),e)},r.getPanelCache=function(){var e;return t[e=this.className]!=null?t[e]:t[e]={}},r.cachePanel=function(e){var t;return t=this.getPanelCache(),t[e.path]=e},r.findPanelForPath=function(e){var n,r,i;for(n in t){i=t[n];if(r=i[e])return r}},r.findPanelForElement=function(e){var n,r,i,s;for(n in t){i=t[n];for(s in i){r=i[s];if(r.el===e)return r}}},r.findOrCreatePanelForPathAndContainer=function(e,t){var n;return n=this.getPanelCache(),n[e]!=null?n[e]:n[e]=this.panelConstructor.createStub(e,t)},r.extract=function(e,t){return t==null&&(t="div.container"),Stacker.extract(e,t)},r.prototype.initialize=function(){var e;return this.setTitle((e=this.panel)!=null?e.title:void 0),$(this.el).attr("data-container-id",this.id),this.layout()},r.prototype.notify=function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],(r=this.workspace)!=null?typeof r[n]=="function"?r[n].apply(r,[this].concat(e.call(t))):void 0:void 0},r.prototype.findOrCreatePanelForPath=function(e){return this.constructor.findOrCreatePanelForPathAndContainer(e,this)},r.prototype.createPanelForElement=function(e){var t;return t=new this.constructor.panelConstructor(e,this),this.constructor.cachePanel(t)},r.prototype.createStubPanelForPath=function(e){return this.constructor.panelConstructor.createStub(e,this)},r.prototype.load=function(e,t,n){var r,i,s;return $.isFunction(t)&&(n=t,t={}),n==null&&(n=$.noop),s=t.response,e.isStub()?(r=this.loadCallback.timeout(Stacker.stubTimeout,function(r){return function(){return r.show(e,t),n(r,e,t)}}(this)),i=this.shouldPreventReload(e),e.request({responseText:s,preventReload:i},r)):(this.loadCallback.reset(),this.show(e,t),i=this.shouldPreventReload(e),e.request({responseText:s,preventReload:i}),n(this,e,t))},r.prototype.loadPathWithDefaultStack=function(e,t,n){var r;return r=this.constructor.panelConstructor.createStub(e,this),this.request(e,t,n)},r.prototype.show=function(e,t){return e!==this.panel&&(this.display(e,t),e.container=this,this.panel=e),this.notify("didShowPanel",e)},r.prototype.display=function(e,t){},r.prototype.request=function(e,t,n){return $.isFunction(t)&&(n=t,t={}),n==null&&(n=$.noop),$.ajax({url:e,data:{from_workspace:1},dataType:"html",success:function(e){return function(r,i){return e.replace(e.constructor.extract(r)),typeof n=="function"?n(e,e.panel,t):void 0}}(this)})},r.prototype.replace=function(e){return $(this.el).html(e),this.initialize()},r.prototype.didReplacePanel=function(e){return this.setTitle(e.title),this.layout(),this.notify("didReplacePanel",e)},r.prototype.setTitle=function(e){return this.title=e,this.notify("didChangeTitle",this.title)},r.prototype.layout=function(){},r.prototype.shouldPreventReload=function(e){return!1},r}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Stacker.FlatContainer=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.className="flat_container",n.prototype.initialize=function(){var e;if(e=this.getPanelElement())this.panel=this.createPanelForElement(e);return n.__super__.initialize.apply(this,arguments)},n.prototype.getPanelElement=function(){return $(this.el).find("> div.panel").get(0)},n.prototype.display=function(e){return $(this.el).html(e.el)},n}(Stacker.Container)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Stacker.Sheet=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.stubInnerHTML="<header><h1><a data-restore-position>",n.extract=function(e,t){return t==null&&(t="div.sheet:not(.inactive):last"),Stacker.extract(e,t)},n.createStubElement=function(e){var t;return t=Stacker.Panel.createStubElement.call(this,e),$(t).addClass("sheet").find("a").attr("href",e),t},n.prototype.initialize=function(){var e,t,r;return t=$(this.el),r=t.find("> header > h1"),e=r.find("> a"),t.attr("data-path")||t.attr("data-path",e.attr("href")),n.__super__.initialize.apply(this,arguments),this.header=r},n.prototype.canBeReplaced=function(){return this.isActive()||this.isStub()},n.prototype.canBeReloadedWhenStacked=function(){return!$(this.el).is("[data-behavior~=prevent_reload_when_stacked]")},n.prototype.isActive=function(){return!$(this.el).hasClass("inactive")},n.prototype.isStub=function(){return n.__super__.isStub.apply(this,arguments)||!this.isActive()&&!this.isCached()},n.prototype.isCached=function(){return this.cachedEl!=null},n.prototype.save=function(){return Stacker.cacheSheets&&this.status===200?($(this.el).trigger("beforeSheetSave",this),this.cachedEl=this.el.cloneNode(!0)):(this.cachedEl=null,this.header=null)},n.prototype.restore=function(){if(this.isActive())return;return this.isCached()?(this.replace(this.cachedEl),$(this.el).trigger("afterSheetRestore",this)):($(this.el).find("> div.sheet").remove(),$(this.el).removeClass("inactive"),$(this.el).addClass("stub"))},n.prototype.expireCache=function(){return this.isCached()&&(this.cachedEl=null),this.hasLoaded=!1},n.prototype.deactivate=function(){var e;if(this.isActive())return e=this.header.html(),this.inactiveSince=(new Date).getTime(),this.save(),$(this.el).html(this.constructor.stubInnerHTML).addClass("inactive").find("a").attr("href",this.path).html(e)},n}(Stacker.Panel)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Stacker.StackContainer=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.panelConstructor=Stacker.Sheet,r.className="stack_container",r.prototype.initialize=function(){var e,t,n,i;this.stack=[],i=this.getSheetElements();for(t=0,n=i.length;t<n;t++)e=i[t],this.stack.push(this.createPanelForElement(e));return this.panel=this.getActiveSheet(),r.__super__.initialize.apply(this,arguments)},r.prototype.display=function(e,t){var r;t==null&&(t={});if(n.call(this.stack,e)>=0){r=[];while(this.panel!==e)r.push(this.pop());return r}return t.replaceSheet&&this.pop(!0),this.push(e)},r.prototype.load=function(e,t,n){return t.forceReload&&e.expireCache(),r.__super__.load.apply(this,arguments)},r.prototype.push=function(e){return this.panel?(this.panel.deactivate(),$(this.panel.el).append(e.el)):$(this.el).html(e.el),this.stack.push(e),e.restore(),this.layout()},r.prototype.pop=function(e){var t,n;e==null&&(e=!1);if(!(t=this.panel))return;return this.stack.pop(),t.deactivate(),this.panel=this.getActiveSheet(),e?$(t.el).remove():((n=this.panel)!=null&&n.restore(),this.layout()),t},r.prototype.clear=function(){var e;e=[];while(this.panel)e.push(this.pop());return e},r.prototype.indexOf=function(e){var t,n,r,i,s;s=this.stack;for(t=r=0,i=s.length;r<i;t=++r){n=s[t];if(n.path===e)return t}return-1},r.prototype.getSheetElements=function(){return $(this.el).find("div.sheet")},r.prototype.getActiveSheet=function(){var e;if(e=this.stack.length)return this.stack[e-1]},r.prototype.layout=function(){var e,t,n,r;e=$(this.el),t=this.getSheetElements(),e.css({width:""});if(n=t.length)return r=e.width(),r+=20*(t.length-1),t.each(function(e){return e!==0&&$(this).css({marginLeft:"20px",marginBottom:"-20px"}),$(this).toggleClass("inactive",e!==n-1)}),e.css({width:r})},r.prototype.shouldPreventReload=function(e){return n.call(this.stack,e)>=0&&e.container===this&&e.isCached()&&!e.canBeReloadedWhenStacked()},r}(Stacker.Container)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].slice;Stacker.Workspace=function(){function u(t){this.el=t,this.containerLoadedPanel=e(this.containerLoadedPanel,this),this.didChangeState=e(this.didChangeState,this),this.didClickLink=e(this.didClickLink,this),$("a[href]").live("click",this.didClickLink),$(document).bind("stacker:statechange",this.didChangeState),this.states={},this.containers={},this.positions={},this.initialize(),this.id=0}var n,r,i,s,o;return u.prototype.initialize=function(){var e,t;t=$(this.el),e=t.children().first();if(!e.is("div.container"))return e.is("div.sheet")?e.wrap(Stacker.StackContainer.createStubElement()):t.wrapInner(Stacker.FlatContainer.createStubElement()),this.initialize();e.is(".stack_container")?this.register(this.container=new Stacker.StackContainer(e.get(0))):this.register(this.container=new Stacker.FlatContainer(e.get(0))),this.updateTitle(this.container.title),t.removeClass("loading");if(Stacker.history)return this.replaceState({cid:this.container.id},this.title,this.container.path)},u.prototype.pushState=function(e,t,n){return Stacker.history.pushState(e,t,n)},u.prototype.replaceState=function(e,t,n){return Stacker.history.replaceState(e,t,n)},u.prototype.getState=function(){return{url:Stacker.normalizePath(window.location),options:Stacker.history.getState()}},u.prototype.register=function(e){return this.containers[e.id]=e,e.workspace=this},u.prototype.didClickLink=function(e){var t,r;if(this.matchLinkClickEvent(e)){t=e.currentTarget,r=i(t);if(n(t,"stackerLinkClicked",r))return this.visit(t.href,r),e.preventDefault(),e.stopPropagation()}},u.prototype.matchLinkClickEvent=function(e){var t;return t=e.target.href,Stacker.isSameOrigin(t)&&Stacker.isStandardClick(e)},u.prototype.didChangeState=function(e){var t,n,r;if(this.initialized){if(n=this.getState())r=n.url,t=n.options,this.load(r,t)}else this.initialized=!0;return this.path=Stacker.normalizePath(window.location)},u.prototype.show=function(e){if(this.container!==e)return this.container=e,$(this.el).html(this.container.el),this.container.layout(),this.updateTitle(this.container.title)},u.prototype.visit=function(e,t){var r,i;t==null&&(t={}),i=Stacker.normalizePath(e);if(!n(this.el,"workspace:visit",e,i))return;return Stacker.history?(this.positions[Stacker.normalizePath(window.location)]=this.getScrollPosition(),r=this.container.panel,t=o(t),i===(r!=null?r.path:void 0)?r.request({responseText:t.response}):this.pushState(t,null,e)):window.location=e},u.prototype.load=function(e,t){var n,r,i;return t==null&&(t={}),n=this.findOrCreateContainerForOptions(t),i=Stacker.normalizePath(e),t.defaultStack?r=n.createStubPanelForPath(i):r=n.findOrCreatePanelForPath(i),$(this.el).trigger("workspace:beforeload",{location:e,path:i,container:n,panel:r}),$(r.el).trigger("panelLoading",r),t.defaultStack?n.loadPathWithDefaultStack(i,t,this.containerLoadedPanel):n.load(r,t,this.containerLoadedPanel)},u.prototype.findOrCreateContainerForOptions=function(e){var t,n;return e.cid||(t=r(e),t===this.container.constructor&&!e.replaceStack?n=this.container:this.register(n=t.createStub(this)),e.cid=n.id),this.containers[e.cid]},u.prototype.findPanel=function(e){var t,n;if(!e)return;if(_.isString(e))return n=Stacker.normalizePath(e),Stacker.Container.findPanelForPath(n);if(e.jquery&&e.get)return t=e.get(0),this.findPanel(t);if(_.isElement(e))return Stacker.Container.findPanelForElement(e)},u.prototype.containerLoadedPanel=function(e,t,n){var r;return this.show(e),r=n.restorePosition?(delete n.restorePosition,this.positions[t.path]):{top:0},this.setScrollPosition(r),this.scrollToAnchor(),$(t.el).trigger("panelDisplayed",t),$(this.el).trigger("workspace:load",{container:e,panel:t})},u.prototype.getScrollPosition=function(){return{top:$(window).scrollTop(),left:$(window).scrollLeft()}},u.prototype.setScrollPosition=function(e){var t,n,r;r=e!=null?e:{},n=r.top,t=r.left,n!=null&&$(window).scrollTop(n);if(t!=null)return $(window).scrollLeft(t)},u.prototype.scrollToAnchor=function(){var e,t,n;if(this.getScrollPosition().top===0&&(t=window.location.hash)){e=$(t);if(e.length)return n=e.offset().top,this.setScrollPosition({top:n})}},u.prototype.didReplacePanel=function(e,t){var n;if(((n=this.container)!=null?n.panel:void 0)===t)return this.scrollToAnchor(),$(t.el).trigger("panelReplaced",t)},u.prototype.didChangeTitle=function(e,t){if(e===this.container)return this.updateTitle(t)},u.prototype.updateTitle=function(e){if(e)return document.title=this.title=e},n=function(){var e,n,r,i;return n=arguments[0],i=arguments[1],e=3<=arguments.length?t.call(arguments,2):[],r=jQuery.Event(i),$(n).trigger(r,e),!r.isDefaultPrevented()},o=function(e){var t;return t=$.extend({},e),t.replaceStack||(t.replaceStack=t.defaultStack),t},i=function(e){return{bareWorkspace:s(e,"data-bare-workspace"),defaultStack:s(e,"data-default-stack"),replaceStack:s(e,"data-replace-stack"),replaceSheet:s(e,"data-replace-sheet"),restorePosition:s(e,"data-restore-position"),forceReload:s(e,"data-force-reload")}},s=function(){var e,n,r,i,s,o,u;i=arguments[0],r=2<=arguments.length?t.call(arguments,1):[],e=$(i);for(o=0,u=r.length;o<u;o++){n=r[o],s=e.attr(n);if(s!=null&&s!=="no"&&s!=="false")return!0}return!1},r=function(e){return e.bareWorkspace?Stacker.FlatContainer:Stacker.StackContainer},u}()}.call(this),function(){Stacker.env="production",$(function(){return setTimeout(function(){return Stacker.initialize()},10)}),$("a[data-remote], a[data-method], a[href^=#], a[target], a[data-stacker=false]").live("stackerLinkClicked",function(e){return e.preventDefault()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};bcx.AbstractAutoSave=function(){function t(t){this.input=t,this.makeStorageKeyAccessible=e(this.makeStorageKeyAccessible,this),this.autoSaveIsMoreRecentThanLastUpdate=e(this.autoSaveIsMoreRecentThanLastUpdate,this),this.clear=e(this.clear,this),this.save=e(this.save,this),this.restore=e(this.restore,this),this.findForm(),this.storageKey=this.generateStorageKey(),this.restore(),this.watchForChanges(),this.clearWhenSubmit(),this.makeStorageKeyAccessible()}return t.prototype.restore=function(){var e;if(e=bcx.storage.get(this.storageKey)){if(this.autoSaveIsMoreRecentThanLastUpdate()||!this.input.value)this.input.value=e;return typeof this.onRestore=="function"?this.onRestore():void 0}},t.prototype.save=function(){return bcx.storage.set(this.storageKey,this.input.value)},t.prototype.clear=function(){return bcx.storage.unset(this.storageKey)},t.prototype.autoSaveIsMoreRecentThanLastUpdate=function(){var e,t;return e=new Date(bcx.storage.ageOf(this.storageKey).toJSON()),t=new Date(this.input.getAttribute("data-updated-at")),e>t},t.prototype.makeStorageKeyAccessible=function(){return this.input.setAttribute("data-autosave-storage-key",this.storageKey)},t}()}.call(this),function(){bcx.avatars={},bcx.avatars.removeLinks=function(){return _($("img.avatar")).each(function(e){return $(e).parent("a").replaceWith(e),$(e).attr("alt","")})}}.call(this),function(){window.LRUCache=function(){function e(e){this.size=e,this.keys=[],this.values={}}return e.prototype.has=function(e){return e in this.values},e.prototype.read=function(e){return this.values[e]},e.prototype.touch=function(e){var t;return t=this.keys.indexOf(e),this.keys.splice(t,1),this.keys.unshift(e)},e.prototype.get=function(e){var t;return t=this.read(e),this.touch(e),t},e.prototype.put=function(e,t){return this.values[e]=t,this.keys.unshift(e),this.trim(),t},e.prototype.fetch=function(e,t){return this.has(e)?this.get(e):this.put(e,t())},e.prototype.trim=function(){var e,t,n,r,i;r=this.keys.splice(this.size),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(delete this.values[e]);return i},e}()}.call(this),function(){this.CalendarDateTime=function(){function t(e,t){this.calendarDate=e,this.calendarTime=t,this.year=this.calendarDate.year,this.month=this.calendarDate.month,this.day=this.calendarDate.day,this.hour=this.calendarTime.hour,this.minute=this.calendarTime.minute,this.second=this.calendarTime.second}var e;return t.iso8601Pattern=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(Z|[-+]?[\d:]+)$/,t.parse=function(e,t){var n,r;return n=CalendarDate.parse(e),r=CalendarTime.parse(t),new this(n,r)},t.prototype.isFuture=function(){return this.toLocalDate()>new Date},t.prototype.toLocalDate=function(){return new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0)},t.prototype.toUTCDate=function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))},t.prototype.toLocalString=function(){return e(this.toLocalDate())},t.prototype.toUTCString=function(){return e(this.toUTCDate())},t.prototype.toString=function(){return this.toLocalString()},e=function(e){return JSON.parse(JSON.stringify(e))},t}()}.call(this),function(){this.CalendarDate=function(){function e(e,t,n){this.date=new Date(Date.UTC(e,t-1)),this.date.setUTCDate(n),this.year=this.date.getUTCFullYear(),this.month=this.date.getUTCMonth()+1,this.day=this.date.getUTCDate(),this.value=this.date.getTime()}return e.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],e.abbreviatedMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.weekdayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.abbreviatedWeekdayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.firstDayOfWeek=0,e.cache=new LRUCache(512),e.today=function(){return this.parse(new Date)},e.parse=function(e){var t;return e==null&&(e=""),t=""+e,this.cache.fetch(t,function(n){return function(){var r,i,s;return e instanceof Date?new n(e.getFullYear(),e.getMonth()+1,e.getDate()):$.isArray(e)?(s=e[0],i=e[1],r=e[2],new n(s,i,r)):t.trim()?t.match(CalendarDateTime.iso8601Pattern)?n.parse(new Date(Date.parse(t))):n.parse(t.split("-")):n.today()}}(this))},e.prototype.beginningOfYear=function(){return new this.constructor(this.year,1,1)},e.prototype.beginningOfMonth=function(){return new this.constructor(this.year,this.month,1)},e.prototype.beginningOfWeek=function(e){var t;return e==null&&(e=this.constructor.firstDayOfWeek),t=this.date.getUTCDay()-e,t<0&&(t+=7),this.previous(t)},e.prototype.nextMonth=function(e,t){var n,r;e==null&&(e=1),t==null&&(t=1);if(e===0)return this.beginningOfMonth();n=this.month+e,r=this.year;while(n>12)n-=12,r++;while(n<1)n+=12,r--;return new this.constructor(r,n,t)},e.prototype.previousMonth=function(e){return e==null&&(e=1),this.nextMonth(-e)},e.prototype.next=function(e){return e==null&&(e=1),e===0?this:new this.constructor(this.year,this.month,this.day+e)},e.prototype.previous=function(e){return e==null&&(e=1),e===0?this:this.next(-e)},e.prototype.equals=function(e){return(e!=null?e.value:void 0)===this.value},e.prototype.is=function(e){return this.equals(e)},e.prototype.isnt=function(e){return!this.equals(e)},e.prototype.fallsOnSameYearAs=function(e){return this.year===(e!=null?e.year:void 0)},e.prototype.occursThisYear=function(){return this.fallsOnSameYearAs(this.constructor.today())},e.prototype.fallsOnSameMonthAs=function(e){return this.beginningOfMonth().equals(e!=null?e.beginningOfMonth():void 0)},e.prototype.fallsOnSameWeekAs=function(e){return this.beginningOfWeek().equals(e!=null?e.beginningOfWeek():void 0)},e.prototype.occursThisWeek=
function(){return this.fallsOnSameWeekAs(this.constructor.today())},e.prototype.isToday=function(){return this.equals(this.constructor.today())},e.prototype.isFuture=function(){return this.daysSince(this.constructor.today())>0},e.prototype.isPast=function(){return this.daysSince(this.constructor.today())<0},e.prototype.isWeekend=function(){var e;return(e=this.date.getUTCDay())===0||e===6},e.prototype.daysSince=function(e){if(e)return(this.date-e.date)/864e5},e.prototype.weeksSince=function(e){if(e)return this.beginningOfWeek().daysSince(e.beginningOfWeek())/7},e.prototype.getWeekNumber=function(){return this.beginningOfWeek()},e.prototype.getMonthName=function(){return this.constructor.monthNames[this.month-1]},e.prototype.getAbbreviatedMonthName=function(){return this.constructor.abbreviatedMonthNames[this.month-1]},e.prototype.getWeekdayName=function(){return this.constructor.weekdayNames[this.date.getUTCDay()]},e.prototype.getAbbreviatedWeekdayName=function(){return this.constructor.abbreviatedWeekdayNames[this.date.getUTCDay()]},e.prototype.getLocalDate=function(){return new Date(this.year,this.month-1,this.day)},e.prototype.compareTo=function(e){return this.date>(e!=null?e.date:void 0)?1:this.date<(e!=null?e.date:void 0)?-1:0},e.prototype.shortWithYear=function(){return""+this.getAbbreviatedMonthName()+" "+this.day+", "+this.year},e.prototype.longWithYear=function(){return""+this.getMonthName()+" "+this.day+", "+this.year},e.prototype.abbreviatedShortWithWeekday=function(){return""+this.getAbbreviatedWeekdayName()+", "+this.getAbbreviatedMonthName()+" "+this.day},e.prototype.dayThisWeek=function(){var e;e=this.constructor.today();if(this.equals(e))return"Today";if(this.fallsOnSameWeekAs(e))return this.getWeekdayName()},e.prototype.relativeDateLabel=function(){if(this.week!=null&&this.wday!=null)return"Week "+(this.week+1)+", "+this.constructor.weekdayNames[this.wday]},e.prototype.toString=function(){var e,t,n;return this.stringValue!=null?this.stringValue:this.stringValue=(n=this.year,t=this.month<10?"0"+this.month:this.month,e=this.day<10?"0"+this.day:this.day,""+n+"-"+t+"-"+e)},e}()}.call(this),function(){this.CalendarTime=function(){function t(e,t,n){var r,i,s;this.hour=e!=null?e:0,this.minute=t!=null?t:0,this.second=n!=null?n:0;if(!(0<=(r=this.hour)&&r<=23&&0<=(i=this.minute)&&i<=59&&0<=(s=this.second)&&s<=59))throw Error("invalid time ("+this.hour+", "+this.minute+", "+this.second+")");this.ampm=this.hour<12?"am":"pm",this.hour===0?this.hour12=12:this.hour>12?this.hour12=this.hour-12:this.hour12=this.hour}var e;return t.pattern=/^\s*(\d{1,2})(?:[.:]?([0-5]\d?)?)?(?:[.:]?([0-5]\d?)?)?(?:\s*([ap])(?:\.?m\.?)?|\s*[h]?)?\s*$/i,t.parse=function(e){var t,n,r,i,s,o,u,a,f;a=""+e;if(e instanceof Date)return r=e.getHours(),s=e.getMinutes(),u=e.getSeconds(),new this(r,s,u);if(a.match(CalendarDateTime.iso8601Pattern))return this.parse(new Date(Date.parse(a)));if(i=a.match(this.pattern))return f=i[0],r=i[1],s=i[2],u=i[3],n=i[4],r=parseInt(r,10),s=parseInt(s!=null?s:"0",10),u=parseInt(u!=null?u:"0",10),t=n!=null?n.match(/a/i):void 0,o=n!=null?n.match(/p/i):void 0,1<=r&&r<=11&&o&&(r+=12),r===12&&t&&(r=0),new this(r,s,u);throw Error("invalid time ("+e+")")},t.isValid=function(e){var t;try{return this.parse(e),!0}catch(n){return t=n,!1}},t.prototype.toString=function(t){var n;return t==null&&(t={}),n=[e(this.minute),e(this.second)],t.short&&this.second===0&&(n.pop(),this.minute===0&&n.pop()),n.length&&(n=":"+n.join(":")),t[12]?""+this.hour12+n+this.ampm:""+this.hour+n},t.prototype.toFriendlyString=function(){return this.toString({12:!0,"short":!0})},e=function(e){return e<10?"0"+e:""+e},t}()}.call(this),function(){this.Emoji={url:"https://bcx.basecamp-static.com/emoji",paths:{smile:"unicode/1f604.png",smiley:"unicode/1f603.png",grinning:"unicode/1f600.png",blush:"unicode/1f60a.png",relaxed:"unicode/263a.png",wink:"unicode/1f609.png",heart_eyes:"unicode/1f60d.png",kissing_heart:"unicode/1f618.png",kissing_closed_eyes:"unicode/1f61a.png",kissing:"unicode/1f617.png",kissing_smiling_eyes:"unicode/1f619.png",stuck_out_tongue_winking_eye:"unicode/1f61c.png",stuck_out_tongue_closed_eyes:"unicode/1f61d.png",stuck_out_tongue:"unicode/1f61b.png",flushed:"unicode/1f633.png",grin:"unicode/1f601.png",pensive:"unicode/1f614.png",relieved:"unicode/1f60c.png",unamused:"unicode/1f612.png",disappointed:"unicode/1f61e.png",persevere:"unicode/1f623.png",cry:"unicode/1f622.png",joy:"unicode/1f602.png",sob:"unicode/1f62d.png",sleepy:"unicode/1f62a.png",disappointed_relieved:"unicode/1f625.png",cold_sweat:"unicode/1f630.png",sweat_smile:"unicode/1f605.png",sweat:"unicode/1f613.png",weary:"unicode/1f629.png",tired_face:"unicode/1f62b.png",fearful:"unicode/1f628.png",scream:"unicode/1f631.png",angry:"unicode/1f620.png",rage:"unicode/1f621.png",triumph:"unicode/1f624.png",confounded:"unicode/1f616.png",laughing:"unicode/1f606.png",yum:"unicode/1f60b.png",mask:"unicode/1f637.png",sunglasses:"unicode/1f60e.png",sleeping:"unicode/1f634.png",dizzy_face:"unicode/1f635.png",astonished:"unicode/1f632.png",worried:"unicode/1f61f.png",frowning:"unicode/1f626.png",anguished:"unicode/1f627.png",smiling_imp:"unicode/1f608.png",imp:"unicode/1f47f.png",open_mouth:"unicode/1f62e.png",grimacing:"unicode/1f62c.png",neutral_face:"unicode/1f610.png",confused:"unicode/1f615.png",hushed:"unicode/1f62f.png",no_mouth:"unicode/1f636.png",innocent:"unicode/1f607.png",smirk:"unicode/1f60f.png",expressionless:"unicode/1f611.png",man_with_gua_pi_mao:"unicode/1f472.png",man_with_turban:"unicode/1f473.png",cop:"unicode/1f46e.png",construction_worker:"unicode/1f477.png",guardsman:"unicode/1f482.png",baby:"unicode/1f476.png",boy:"unicode/1f466.png",girl:"unicode/1f467.png",man:"unicode/1f468.png",woman:"unicode/1f469.png",older_man:"unicode/1f474.png",older_woman:"unicode/1f475.png",person_with_blond_hair:"unicode/1f471.png",angel:"unicode/1f47c.png",princess:"unicode/1f478.png",smiley_cat:"unicode/1f63a.png",smile_cat:"unicode/1f638.png",heart_eyes_cat:"unicode/1f63b.png",kissing_cat:"unicode/1f63d.png",smirk_cat:"unicode/1f63c.png",scream_cat:"unicode/1f640.png",crying_cat_face:"unicode/1f63f.png",joy_cat:"unicode/1f639.png",pouting_cat:"unicode/1f63e.png",japanese_ogre:"unicode/1f479.png",japanese_goblin:"unicode/1f47a.png",see_no_evil:"unicode/1f648.png",hear_no_evil:"unicode/1f649.png",speak_no_evil:"unicode/1f64a.png",skull:"unicode/1f480.png",alien:"unicode/1f47d.png",hankey:"unicode/1f4a9.png",fire:"unicode/1f525.png",sparkles:"unicode/2728.png",star2:"unicode/1f31f.png",dizzy:"unicode/1f4ab.png",boom:"unicode/1f4a5.png",anger:"unicode/1f4a2.png",sweat_drops:"unicode/1f4a6.png",droplet:"unicode/1f4a7.png",zzz:"unicode/1f4a4.png",dash:"unicode/1f4a8.png",ear:"unicode/1f442.png",eyes:"unicode/1f440.png",nose:"unicode/1f443.png",tongue:"unicode/1f445.png",lips:"unicode/1f444.png","+1":"unicode/1f44d.png","-1":"unicode/1f44e.png",ok_hand:"unicode/1f44c.png",facepunch:"unicode/1f44a.png",fist:"unicode/270a.png",v:"unicode/270c.png",wave:"unicode/1f44b.png",hand:"unicode/270b.png",open_hands:"unicode/1f450.png",point_up_2:"unicode/1f446.png",point_down:"unicode/1f447.png",point_right:"unicode/1f449.png",point_left:"unicode/1f448.png",raised_hands:"unicode/1f64c.png",pray:"unicode/1f64f.png",point_up:"unicode/261d.png",clap:"unicode/1f44f.png",muscle:"unicode/1f4aa.png",walking:"unicode/1f6b6.png",runner:"unicode/1f3c3.png",dancer:"unicode/1f483.png",couple:"unicode/1f46b.png",family:"unicode/1f46a.png",two_men_holding_hands:"unicode/1f46c.png",two_women_holding_hands:"unicode/1f46d.png",couplekiss:"unicode/1f48f.png",couple_with_heart:"unicode/1f491.png",dancers:"unicode/1f46f.png",ok_woman:"unicode/1f646.png",no_good:"unicode/1f645.png",information_desk_person:"unicode/1f481.png",raising_hand:"unicode/1f64b.png",massage:"unicode/1f486.png",haircut:"unicode/1f487.png",nail_care:"unicode/1f485.png",bride_with_veil:"unicode/1f470.png",person_with_pouting_face:"unicode/1f64e.png",person_frowning:"unicode/1f64d.png",bow:"unicode/1f647.png",tophat:"unicode/1f3a9.png",crown:"unicode/1f451.png",womans_hat:"unicode/1f452.png",athletic_shoe:"unicode/1f45f.png",mans_shoe:"unicode/1f45e.png",sandal:"unicode/1f461.png",high_heel:"unicode/1f460.png",boot:"unicode/1f462.png",shirt:"unicode/1f455.png",necktie:"unicode/1f454.png",womans_clothes:"unicode/1f45a.png",dress:"unicode/1f457.png",running_shirt_with_sash:"unicode/1f3bd.png",jeans:"unicode/1f456.png",kimono:"unicode/1f458.png",bikini:"unicode/1f459.png",briefcase:"unicode/1f4bc.png",handbag:"unicode/1f45c.png",pouch:"unicode/1f45d.png",purse:"unicode/1f45b.png",eyeglasses:"unicode/1f453.png",ribbon:"unicode/1f380.png",closed_umbrella:"unicode/1f302.png",lipstick:"unicode/1f484.png",yellow_heart:"unicode/1f49b.png",blue_heart:"unicode/1f499.png",purple_heart:"unicode/1f49c.png",green_heart:"unicode/1f49a.png",heart:"unicode/2764.png",broken_heart:"unicode/1f494.png",heartpulse:"unicode/1f497.png",heartbeat:"unicode/1f493.png",two_hearts:"unicode/1f495.png",sparkling_heart:"unicode/1f496.png",revolving_hearts:"unicode/1f49e.png",cupid:"unicode/1f498.png",love_letter:"unicode/1f48c.png",kiss:"unicode/1f48b.png",ring:"unicode/1f48d.png",gem:"unicode/1f48e.png",bust_in_silhouette:"unicode/1f464.png",busts_in_silhouette:"unicode/1f465.png",speech_balloon:"unicode/1f4ac.png",footprints:"unicode/1f463.png",thought_balloon:"unicode/1f4ad.png",dog:"unicode/1f436.png",wolf:"unicode/1f43a.png",cat:"unicode/1f431.png",mouse:"unicode/1f42d.png",hamster:"unicode/1f439.png",rabbit:"unicode/1f430.png",frog:"unicode/1f438.png",tiger:"unicode/1f42f.png",koala:"unicode/1f428.png",bear:"unicode/1f43b.png",pig:"unicode/1f437.png",pig_nose:"unicode/1f43d.png",cow:"unicode/1f42e.png",boar:"unicode/1f417.png",monkey_face:"unicode/1f435.png",monkey:"unicode/1f412.png",horse:"unicode/1f434.png",sheep:"unicode/1f411.png",elephant:"unicode/1f418.png",panda_face:"unicode/1f43c.png",penguin:"unicode/1f427.png",bird:"unicode/1f426.png",baby_chick:"unicode/1f424.png",hatched_chick:"unicode/1f425.png",hatching_chick:"unicode/1f423.png",chicken:"unicode/1f414.png",snake:"unicode/1f40d.png",turtle:"unicode/1f422.png",bug:"unicode/1f41b.png",bee:"unicode/1f41d.png",ant:"unicode/1f41c.png",beetle:"unicode/1f41e.png",snail:"unicode/1f40c.png",octopus:"unicode/1f419.png",shell:"unicode/1f41a.png",tropical_fish:"unicode/1f420.png",fish:"unicode/1f41f.png",dolphin:"unicode/1f42c.png",whale:"unicode/1f433.png",whale2:"unicode/1f40b.png",cow2:"unicode/1f404.png",ram:"unicode/1f40f.png",rat:"unicode/1f400.png",water_buffalo:"unicode/1f403.png",tiger2:"unicode/1f405.png",rabbit2:"unicode/1f407.png",dragon:"unicode/1f409.png",racehorse:"unicode/1f40e.png",goat:"unicode/1f410.png",rooster:"unicode/1f413.png",dog2:"unicode/1f415.png",pig2:"unicode/1f416.png",mouse2:"unicode/1f401.png",ox:"unicode/1f402.png",dragon_face:"unicode/1f432.png",blowfish:"unicode/1f421.png",crocodile:"unicode/1f40a.png",camel:"unicode/1f42b.png",dromedary_camel:"unicode/1f42a.png",leopard:"unicode/1f406.png",cat2:"unicode/1f408.png",poodle:"unicode/1f429.png",feet:"unicode/1f43e.png",bouquet:"unicode/1f490.png",cherry_blossom:"unicode/1f338.png",tulip:"unicode/1f337.png",four_leaf_clover:"unicode/1f340.png",rose:"unicode/1f339.png",sunflower:"unicode/1f33b.png",hibiscus:"unicode/1f33a.png",maple_leaf:"unicode/1f341.png",leaves:"unicode/1f343.png",fallen_leaf:"unicode/1f342.png",herb:"unicode/1f33f.png",ear_of_rice:"unicode/1f33e.png",mushroom:"unicode/1f344.png",cactus:"unicode/1f335.png",palm_tree:"unicode/1f334.png",evergreen_tree:"unicode/1f332.png",deciduous_tree:"unicode/1f333.png",chestnut:"unicode/1f330.png",seedling:"unicode/1f331.png",blossom:"unicode/1f33c.png",globe_with_meridians:"unicode/1f310.png",sun_with_face:"unicode/1f31e.png",full_moon_with_face:"unicode/1f31d.png",new_moon_with_face:"unicode/1f31a.png",new_moon:"unicode/1f311.png",waxing_crescent_moon:"unicode/1f312.png",first_quarter_moon:"unicode/1f313.png",moon:"unicode/1f314.png",full_moon:"unicode/1f315.png",waning_gibbous_moon:"unicode/1f316.png",last_quarter_moon:"unicode/1f317.png",waning_crescent_moon:"unicode/1f318.png",last_quarter_moon_with_face:"unicode/1f31c.png",first_quarter_moon_with_face:"unicode/1f31b.png",crescent_moon:"unicode/1f319.png",earth_africa:"unicode/1f30d.png",earth_americas:"unicode/1f30e.png",earth_asia:"unicode/1f30f.png",volcano:"unicode/1f30b.png",milky_way:"unicode/1f30c.png",stars:"unicode/1f320.png",star:"unicode/2b50.png",sunny:"unicode/2600.png",partly_sunny:"unicode/26c5.png",cloud:"unicode/2601.png",zap:"unicode/26a1.png",umbrella:"unicode/2614.png",snowflake:"unicode/2744.png",snowman:"unicode/26c4.png",cyclone:"unicode/1f300.png",foggy:"unicode/1f301.png",rainbow:"unicode/1f308.png",ocean:"unicode/1f30a.png",bamboo:"unicode/1f38d.png",gift_heart:"unicode/1f49d.png",dolls:"unicode/1f38e.png",school_satchel:"unicode/1f392.png",mortar_board:"unicode/1f393.png",flags:"unicode/1f38f.png",fireworks:"unicode/1f386.png",sparkler:"unicode/1f387.png",wind_chime:"unicode/1f390.png",rice_scene:"unicode/1f391.png",jack_o_lantern:"unicode/1f383.png",ghost:"unicode/1f47b.png",santa:"unicode/1f385.png",christmas_tree:"unicode/1f384.png",gift:"unicode/1f381.png",tanabata_tree:"unicode/1f38b.png",tada:"unicode/1f389.png",confetti_ball:"unicode/1f38a.png",balloon:"unicode/1f388.png",crossed_flags:"unicode/1f38c.png",crystal_ball:"unicode/1f52e.png",movie_camera:"unicode/1f3a5.png",camera:"unicode/1f4f7.png",video_camera:"unicode/1f4f9.png",vhs:"unicode/1f4fc.png",cd:"unicode/1f4bf.png",dvd:"unicode/1f4c0.png",minidisc:"unicode/1f4bd.png",floppy_disk:"unicode/1f4be.png",computer:"unicode/1f4bb.png",iphone:"unicode/1f4f1.png",phone:"unicode/260e.png",telephone_receiver:"unicode/1f4de.png",pager:"unicode/1f4df.png",fax:"unicode/1f4e0.png",satellite:"unicode/1f4e1.png",tv:"unicode/1f4fa.png",radio:"unicode/1f4fb.png",loud_sound:"unicode/1f50a.png",sound:"unicode/1f509.png",speaker:"unicode/1f508.png",mute:"unicode/1f507.png",bell:"unicode/1f514.png",no_bell:"unicode/1f515.png",loudspeaker:"unicode/1f4e2.png",mega:"unicode/1f4e3.png",hourglass_flowing_sand:"unicode/23f3.png",hourglass:"unicode/231b.png",alarm_clock:"unicode/23f0.png",watch:"unicode/231a.png",unlock:"unicode/1f513.png",lock:"unicode/1f512.png",lock_with_ink_pen:"unicode/1f50f.png",closed_lock_with_key:"unicode/1f510.png",key:"unicode/1f511.png",mag_right:"unicode/1f50e.png",bulb:"unicode/1f4a1.png",flashlight:"unicode/1f526.png",high_brightness:"unicode/1f506.png",low_brightness:"unicode/1f505.png",electric_plug:"unicode/1f50c.png",battery:"unicode/1f50b.png",mag:"unicode/1f50d.png",bathtub:"unicode/1f6c1.png",bath:"unicode/1f6c0.png",shower:"unicode/1f6bf.png",toilet:"unicode/1f6bd.png",wrench:"unicode/1f527.png",nut_and_bolt:"unicode/1f529.png",hammer:"unicode/1f528.png",door:"unicode/1f6aa.png",smoking:"unicode/1f6ac.png",bomb:"unicode/1f4a3.png",gun:"unicode/1f52b.png",hocho:"unicode/1f52a.png",pill:"unicode/1f48a.png",syringe:"unicode/1f489.png",moneybag:"unicode/1f4b0.png",yen:"unicode/1f4b4.png",dollar:"unicode/1f4b5.png",pound:"unicode/1f4b7.png",euro:"unicode/1f4b6.png",credit_card:"unicode/1f4b3.png",money_with_wings:"unicode/1f4b8.png",calling:"unicode/1f4f2.png","e-mail":"unicode/1f4e7.png",inbox_tray:"unicode/1f4e5.png",outbox_tray:"unicode/1f4e4.png",email:"unicode/2709.png",envelope_with_arrow:"unicode/1f4e9.png",incoming_envelope:"unicode/1f4e8.png",postal_horn:"unicode/1f4ef.png",mailbox:"unicode/1f4eb.png",mailbox_closed:"unicode/1f4ea.png",mailbox_with_mail:"unicode/1f4ec.png",mailbox_with_no_mail:"unicode/1f4ed.png",postbox:"unicode/1f4ee.png","package":"unicode/1f4e6.png",memo:"unicode/1f4dd.png",page_facing_up:"unicode/1f4c4.png",page_with_curl:"unicode/1f4c3.png",bookmark_tabs:"unicode/1f4d1.png",bar_chart:"unicode/1f4ca.png",chart_with_upwards_trend:"unicode/1f4c8.png",chart_with_downwards_trend:"unicode/1f4c9.png",scroll:"unicode/1f4dc.png",clipboard:"unicode/1f4cb.png",date:"unicode/1f4c5.png",calendar:"unicode/1f4c6.png",card_index:"unicode/1f4c7.png",file_folder:"unicode/1f4c1.png",open_file_folder:"unicode/1f4c2.png",scissors:"unicode/2702.png",pushpin:"unicode/1f4cc.png",paperclip:"unicode/1f4ce.png",black_nib:"unicode/2712.png",pencil2:"unicode/270f.png",straight_ruler:"unicode/1f4cf.png",triangular_ruler:"unicode/1f4d0.png",closed_book:"unicode/1f4d5.png",green_book:"unicode/1f4d7.png",blue_book:"unicode/1f4d8.png",orange_book:"unicode/1f4d9.png",notebook:"unicode/1f4d3.png",notebook_with_decorative_cover:"unicode/1f4d4.png",ledger:"unicode/1f4d2.png",books:"unicode/1f4da.png",book:"unicode/1f4d6.png",bookmark:"unicode/1f516.png",name_badge:"unicode/1f4db.png",microscope:"unicode/1f52c.png",telescope:"unicode/1f52d.png",newspaper:"unicode/1f4f0.png",art:"unicode/1f3a8.png",clapper:"unicode/1f3ac.png",microphone:"unicode/1f3a4.png",headphones:"unicode/1f3a7.png",musical_score:"unicode/1f3bc.png",musical_note:"unicode/1f3b5.png",notes:"unicode/1f3b6.png",musical_keyboard:"unicode/1f3b9.png",violin:"unicode/1f3bb.png",trumpet:"unicode/1f3ba.png",saxophone:"unicode/1f3b7.png",guitar:"unicode/1f3b8.png",space_invader:"unicode/1f47e.png",video_game:"unicode/1f3ae.png",black_joker:"unicode/1f0cf.png",flower_playing_cards:"unicode/1f3b4.png",mahjong:"unicode/1f004.png",game_die:"unicode/1f3b2.png",dart:"unicode/1f3af.png",football:"unicode/1f3c8.png",basketball:"unicode/1f3c0.png",soccer:"unicode/26bd.png",baseball:"unicode/26be.png",tennis:"unicode/1f3be.png","8ball":"unicode/1f3b1.png",rugby_football:"unicode/1f3c9.png",bowling:"unicode/1f3b3.png",golf:"unicode/26f3.png",mountain_bicyclist:"unicode/1f6b5.png",bicyclist:"unicode/1f6b4.png",checkered_flag:"unicode/1f3c1.png",horse_racing:"unicode/1f3c7.png",trophy:"unicode/1f3c6.png",ski:"unicode/1f3bf.png",snowboarder:"unicode/1f3c2.png",swimmer:"unicode/1f3ca.png",surfer:"unicode/1f3c4.png",fishing_pole_and_fish:"unicode/1f3a3.png",coffee:"unicode/2615.png",tea:"unicode/1f375.png",sake:"unicode/1f376.png",baby_bottle:"unicode/1f37c.png",beer:"unicode/1f37a.png",beers:"unicode/1f37b.png",cocktail:"unicode/1f378.png",tropical_drink:"unicode/1f379.png",wine_glass:"unicode/1f377.png",fork_and_knife:"unicode/1f374.png",pizza:"unicode/1f355.png",hamburger:"unicode/1f354.png",fries:"unicode/1f35f.png",poultry_leg:"unicode/1f357.png",meat_on_bone:"unicode/1f356.png",spaghetti:"unicode/1f35d.png",curry:"unicode/1f35b.png",fried_shrimp:"unicode/1f364.png",bento:"unicode/1f371.png",sushi:"unicode/1f363.png",fish_cake:"unicode/1f365.png",rice_ball:"unicode/1f359.png",rice_cracker:"unicode/1f358.png",rice:"unicode/1f35a.png",ramen:"unicode/1f35c.png",stew:"unicode/1f372.png",oden:"unicode/1f362.png",dango:"unicode/1f361.png",egg:"unicode/1f373.png",bread:"unicode/1f35e.png",doughnut:"unicode/1f369.png",custard:"unicode/1f36e.png",icecream:"unicode/1f366.png",ice_cream:"unicode/1f368.png",shaved_ice:"unicode/1f367.png",birthday:"unicode/1f382.png",cake:"unicode/1f370.png",cookie:"unicode/1f36a.png",chocolate_bar:"unicode/1f36b.png",candy:"unicode/1f36c.png",lollipop:"unicode/1f36d.png",honey_pot:"unicode/1f36f.png",apple:"unicode/1f34e.png",green_apple:"unicode/1f34f.png",tangerine:"unicode/1f34a.png",lemon:"unicode/1f34b.png",cherries:"unicode/1f352.png",grapes:"unicode/1f347.png",watermelon:"unicode/1f349.png",strawberry:"unicode/1f353.png",peach:"unicode/1f351.png",melon:"unicode/1f348.png",banana:"unicode/1f34c.png",pear:"unicode/1f350.png",pineapple:"unicode/1f34d.png",sweet_potato:"unicode/1f360.png",eggplant:"unicode/1f346.png",tomato:"unicode/1f345.png",corn:"unicode/1f33d.png",house:"unicode/1f3e0.png",house_with_garden:"unicode/1f3e1.png",school:"unicode/1f3eb.png",office:"unicode/1f3e2.png",post_office:"unicode/1f3e3.png",hospital:"unicode/1f3e5.png",bank:"unicode/1f3e6.png",convenience_store:"unicode/1f3ea.png",love_hotel:"unicode/1f3e9.png",hotel:"unicode/1f3e8.png",wedding:"unicode/1f492.png",church:"unicode/26ea.png",department_store:"unicode/1f3ec.png",european_post_office:"unicode/1f3e4.png",city_sunrise:"unicode/1f307.png",city_sunset:"unicode/1f306.png",japanese_castle:"unicode/1f3ef.png",european_castle:"unicode/1f3f0.png",tent:"unicode/26fa.png",factory:"unicode/1f3ed.png",tokyo_tower:"unicode/1f5fc.png",japan:"unicode/1f5fe.png",mount_fuji:"unicode/1f5fb.png",sunrise_over_mountains:"unicode/1f304.png",sunrise:"unicode/1f305.png",night_with_stars:"unicode/1f303.png",statue_of_liberty:"unicode/1f5fd.png",bridge_at_night:"unicode/1f309.png",carousel_horse:"unicode/1f3a0.png",ferris_wheel:"unicode/1f3a1.png",fountain:"unicode/26f2.png",roller_coaster:"unicode/1f3a2.png",ship:"unicode/1f6a2.png",boat:"unicode/26f5.png",speedboat:"unicode/1f6a4.png",rowboat:"unicode/1f6a3.png",anchor:"unicode/2693.png",rocket:"unicode/1f680.png",airplane:"unicode/2708.png",seat:"unicode/1f4ba.png",helicopter:"unicode/1f681.png",steam_locomotive:"unicode/1f682.png",tram:"unicode/1f68a.png",station:"unicode/1f689.png",mountain_railway:"unicode/1f69e.png",train2:"unicode/1f686.png",bullettrain_side:"unicode/1f684.png",bullettrain_front:"unicode/1f685.png",light_rail:"unicode/1f688.png",metro:"unicode/1f687.png",monorail:"unicode/1f69d.png",train:"unicode/1f68b.png",railway_car:"unicode/1f683.png",trolleybus:"unicode/1f68e.png",bus:"unicode/1f68c.png",oncoming_bus:"unicode/1f68d.png",blue_car:"unicode/1f699.png",oncoming_automobile:"unicode/1f698.png",car:"unicode/1f697.png",taxi:"unicode/1f695.png",oncoming_taxi:"unicode/1f696.png",articulated_lorry:"unicode/1f69b.png",truck:"unicode/1f69a.png",rotating_light:"unicode/1f6a8.png",police_car:"unicode/1f693.png",oncoming_police_car:"unicode/1f694.png",fire_engine:"unicode/1f692.png",ambulance:"unicode/1f691.png",minibus:"unicode/1f690.png",bike:"unicode/1f6b2.png",aerial_tramway:"unicode/1f6a1.png",suspension_railway:"unicode/1f69f.png",mountain_cableway:"unicode/1f6a0.png",tractor:"unicode/1f69c.png",barber:"unicode/1f488.png",busstop:"unicode/1f68f.png",ticket:"unicode/1f3ab.png",vertical_traffic_light:"unicode/1f6a6.png",traffic_light:"unicode/1f6a5.png",warning:"unicode/26a0.png",construction:"unicode/1f6a7.png",beginner:"unicode/1f530.png",fuelpump:"unicode/26fd.png",izakaya_lantern:"unicode/1f3ee.png",slot_machine:"unicode/1f3b0.png",hotsprings:"unicode/2668.png",moyai:"unicode/1f5ff.png",circus_tent:"unicode/1f3aa.png",performing_arts:"unicode/1f3ad.png",round_pushpin:"unicode/1f4cd.png",triangular_flag_on_post:"unicode/1f6a9.png",jp:"unicode/1f1ef-1f1f5.png",kr:"unicode/1f1f0-1f1f7.png",de:"unicode/1f1e9-1f1ea.png",cn:"unicode/1f1e8-1f1f3.png",us:"unicode/1f1fa-1f1f8.png",fr:"unicode/1f1eb-1f1f7.png",es:"unicode/1f1ea-1f1f8.png",it:"unicode/1f1ee-1f1f9.png",ru:"unicode/1f1f7-1f1fa.png",gb:"unicode/1f1ec-1f1e7.png",one:"unicode/0031-20e3.png",two:"unicode/0032-20e3.png",three:"unicode/0033-20e3.png",four:"unicode/0034-20e3.png",five:"unicode/0035-20e3.png",six:"unicode/0036-20e3.png",seven:"unicode/0037-20e3.png",eight:"unicode/0038-20e3.png",nine:"unicode/0039-20e3.png",zero:"unicode/0030-20e3.png",keycap_ten:"unicode/1f51f.png",1234:"unicode/1f522.png",hash:"unicode/0023-20e3.png",symbols:"unicode/1f523.png",arrow_up:"unicode/2b06.png",arrow_down:"unicode/2b07.png",arrow_left:"unicode/2b05.png",arrow_right:"unicode/27a1.png",capital_abcd:"unicode/1f520.png",abcd:"unicode/1f521.png",abc:"unicode/1f524.png",arrow_upper_right:"unicode/2197.png",arrow_upper_left:"unicode/2196.png",arrow_lower_right:"unicode/2198.png",arrow_lower_left:"unicode/2199.png",left_right_arrow:"unicode/2194.png",arrow_up_down:"unicode/2195.png",arrows_counterclockwise:"unicode/1f504.png",arrow_backward:"unicode/25c0.png",arrow_forward:"unicode/25b6.png",arrow_up_small:"unicode/1f53c.png",arrow_down_small:"unicode/1f53d.png",leftwards_arrow_with_hook:"unicode/21a9.png",arrow_right_hook:"unicode/21aa.png",information_source:"unicode/2139.png",rewind:"unicode/23ea.png",fast_forward:"unicode/23e9.png",arrow_double_up:"unicode/23eb.png",arrow_double_down:"unicode/23ec.png",arrow_heading_down:"unicode/2935.png",arrow_heading_up:"unicode/2934.png",ok:"unicode/1f197.png",twisted_rightwards_arrows:"unicode/1f500.png",repeat:"unicode/1f501.png",repeat_one:"unicode/1f502.png","new":"unicode/1f195.png",up:"unicode/1f199.png",cool:"unicode/1f192.png",free:"unicode/1f193.png",ng:"unicode/1f196.png",signal_strength:"unicode/1f4f6.png",cinema:"unicode/1f3a6.png",koko:"unicode/1f201.png",u6307:"unicode/1f22f.png",u7a7a:"unicode/1f233.png",u6e80:"unicode/1f235.png",u5408:"unicode/1f234.png",u7981:"unicode/1f232.png",ideograph_advantage:"unicode/1f250.png",u5272:"unicode/1f239.png",u55b6:"unicode/1f23a.png",u6709:"unicode/1f236.png",u7121:"unicode/1f21a.png",restroom:"unicode/1f6bb.png",mens:"unicode/1f6b9.png",womens:"unicode/1f6ba.png",baby_symbol:"unicode/1f6bc.png",wc:"unicode/1f6be.png",potable_water:"unicode/1f6b0.png",put_litter_in_its_place:"unicode/1f6ae.png",parking:"unicode/1f17f.png",wheelchair:"unicode/267f.png",no_smoking:"unicode/1f6ad.png",u6708:"unicode/1f237.png",u7533:"unicode/1f238.png",sa:"unicode/1f202.png",m:"unicode/24c2.png",passport_control:"unicode/1f6c2.png",baggage_claim:"unicode/1f6c4.png",left_luggage:"unicode/1f6c5.png",customs:"unicode/1f6c3.png",accept:"unicode/1f251.png",secret:"unicode/3299.png",congratulations:"unicode/3297.png",cl:"unicode/1f191.png",sos:"unicode/1f198.png",id:"unicode/1f194.png",no_entry_sign:"unicode/1f6ab.png",underage:"unicode/1f51e.png",no_mobile_phones:"unicode/1f4f5.png",do_not_litter:"unicode/1f6af.png","non-potable_water":"unicode/1f6b1.png",no_bicycles:"unicode/1f6b3.png",no_pedestrians:"unicode/1f6b7.png",children_crossing:"unicode/1f6b8.png",no_entry:"unicode/26d4.png",eight_spoked_asterisk:"unicode/2733.png",sparkle:"unicode/2747.png",negative_squared_cross_mark:"unicode/274e.png",white_check_mark:"unicode/2705.png",eight_pointed_black_star:"unicode/2734.png",heart_decoration:"unicode/1f49f.png",vs:"unicode/1f19a.png",vibration_mode:"unicode/1f4f3.png",mobile_phone_off:"unicode/1f4f4.png",a:"unicode/1f170.png",b:"unicode/1f171.png",ab:"unicode/1f18e.png",o2:"unicode/1f17e.png",diamond_shape_with_a_dot_inside:"unicode/1f4a0.png",loop:"unicode/27bf.png",recycle:"unicode/267b.png",aries:"unicode/2648.png",taurus:"unicode/2649.png",gemini:"unicode/264a.png",cancer:"unicode/264b.png",leo:"unicode/264c.png",virgo:"unicode/264d.png",libra:"unicode/264e.png",scorpius:"unicode/264f.png",sagittarius:"unicode/2650.png",capricorn:"unicode/2651.png",aquarius:"unicode/2652.png",pisces:"unicode/2653.png",ophiuchus:"unicode/26ce.png",six_pointed_star:"unicode/1f52f.png",atm:"unicode/1f3e7.png",chart:"unicode/1f4b9.png",heavy_dollar_sign:"unicode/1f4b2.png",currency_exchange:"unicode/1f4b1.png",copyright:"unicode/00a9.png",registered:"unicode/00ae.png",tm:"unicode/2122.png",x:"unicode/274c.png",bangbang:"unicode/203c.png",interrobang:"unicode/2049.png",exclamation:"unicode/2757.png",question:"unicode/2753.png",grey_exclamation:"unicode/2755.png",grey_question:"unicode/2754.png",o:"unicode/2b55.png",top:"unicode/1f51d.png",end:"unicode/1f51a.png",back:"unicode/1f519.png",on:"unicode/1f51b.png",soon:"unicode/1f51c.png",arrows_clockwise:"unicode/1f503.png",clock12:"unicode/1f55b.png",clock1230:"unicode/1f567.png",clock1:"unicode/1f550.png",clock130:"unicode/1f55c.png",clock2:"unicode/1f551.png",clock230:"unicode/1f55d.png",clock3:"unicode/1f552.png",clock330:"unicode/1f55e.png",clock4:"unicode/1f553.png",clock430:"unicode/1f55f.png",clock5:"unicode/1f554.png",clock530:"unicode/1f560.png",clock6:"unicode/1f555.png",clock7:"unicode/1f556.png",clock8:"unicode/1f557.png",clock9:"unicode/1f558.png",clock10:"unicode/1f559.png",clock11:"unicode/1f55a.png",clock630:"unicode/1f561.png",clock730:"unicode/1f562.png",clock830:"unicode/1f563.png",clock930:"unicode/1f564.png",clock1030:"unicode/1f565.png",clock1130:"unicode/1f566.png",heavy_multiplication_x:"unicode/2716.png",heavy_plus_sign:"unicode/2795.png",heavy_minus_sign:"unicode/2796.png",heavy_division_sign:"unicode/2797.png",spades:"unicode/2660.png",hearts:"unicode/2665.png",clubs:"unicode/2663.png",diamonds:"unicode/2666.png",white_flower:"unicode/1f4ae.png",100:"unicode/1f4af.png",heavy_check_mark:"unicode/2714.png",ballot_box_with_check:"unicode/2611.png",radio_button:"unicode/1f518.png",link:"unicode/1f517.png",curly_loop:"unicode/27b0.png",wavy_dash:"unicode/3030.png",part_alternation_mark:"unicode/303d.png",trident:"unicode/1f531.png",black_medium_square:"unicode/25fc.png",white_medium_square:"unicode/25fb.png",black_medium_small_square:"unicode/25fe.png",white_medium_small_square:"unicode/25fd.png",black_small_square:"unicode/25aa.png",white_small_square:"unicode/25ab.png",small_red_triangle:"unicode/1f53a.png",black_square_button:"unicode/1f532.png",white_square_button:"unicode/1f533.png",black_circle:"unicode/26ab.png",white_circle:"unicode/26aa.png",red_circle:"unicode/1f534.png",large_blue_circle:"unicode/1f535.png",small_red_triangle_down:"unicode/1f53b.png",white_large_square:"unicode/2b1c.png",black_large_square:"unicode/2b1b.png",large_orange_diamond:"unicode/1f536.png",large_blue_diamond:"unicode/1f537.png",small_orange_diamond:"unicode/1f538.png",small_blue_diamond:"unicode/1f539.png",basecamp:"basecamp.png",basecampy:"basecampy.png",bowtie:"bowtie.png",feelsgood:"feelsgood.png",finnadie:"finnadie.png",fu:"fu.png",goberserk:"goberserk.png",godmode:"godmode.png",hurtrealbad:"hurtrealbad.png",metal:"metal.png",neckbeard:"neckbeard.png",octocat:"octocat.png",rage1:"rage1.png",rage2:"rage2.png",rage3:"rage3.png",rage4:"rage4.png",shipit:"shipit.png",suspect:"suspect.png",trollface:"trollface.png"},emojify:function(e){return e.replace(/:([a-z0-9\+\-_]+):/g,function(e,t){var n;return(n=Emoji.paths[t])?'<img alt="'+t+'" height="20" src="'+Emoji.url+"/"+n+'" style="vertical-align:middle" width="20" />':":"+t+":"})}}}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(){function e(e){this.el=e,this.resetHeight=n(this.resetHeight,this),this.adjustHeight=n(this.adjustHeight,this),this.watchForChanges=n(this.watchForChanges,this),this.makeTestContainer=n(this.makeTestContainer,this),this.preventScrollBars=n(this.preventScrollBars,this),this.sourceContents=n(this.sourceContents,this),this.source=n(this.source,this),this.$el=$(this.el).css({resize:"none"}),this.heightLimit=this.$el.data("autoresize-limit"),this.$source=this.source(),this.originalHeight=this.$el.height(),this.$testContainer=this.makeTestContainer(),this.preventScrollBars(),setTimeout(function(e){return function(){return e.adjustHeight(),e.watchForChanges()}}(this),1)}return e.prototype.resizeBy=2,e.install=function(e){if(!$(e).is("[data-autoresize]"))return $(e).attr("data-autoresize",!0),new this(e)},e.prototype.source=function(){return this.$el},e.prototype.sourceContents=function(){return this.$source.val().replace(/\n/g,"<br>").replace(/</g,"&lt;").replace(/>/g,"&gt;")},e.prototype.preventScrollBars=function(){return this.$source.css("overflow","hidden")},e.prototype.makeTestContainer=function(){var e,t,n,r,i;e=$("<div>").css({position:"absolute",left:-9999,top:0,"word-wrap":"break-word"}),e.addClass("formatted_content hidden"),t=["fontSize","fontFamily","fontWeight","letterSpacing","lineHeight","textDecoration","padding","text-rendering"];for(r=0,i=t.length;r<i;r++)n=t[r],e.css(n,this.$source.css(n));return e.insertBefore(this.$el)},e.prototype.watchForChanges=function(){var e;return e=300,this.$el.prop("rows")===1&&!$.browser.mobile&&(e=5),this.$source.bind("keyup keydown paste change focus",_.throttle(function(e){return function(){return e.adjustHeight()}}(this),e)),this.$el.closest("form").bind("reset",function(e){return function(){return e.resetHeight()}}(this))},e.prototype.adjustHeight=function(){var e,t,n,r,i;return this.$testContainer.css("max-width",this.$source.width()),i=this.$testContainer.html("X").height(),this.$testContainer.html(this.sourceContents()),r=parseInt(this.$el.data("rows")||this.$el.attr("rows"))||!1,n=r===1?1:this.resizeBy*i,e=r?i*r+1:this.originalHeight,t=this.$testContainer.height()+n,this.heightLimit&&t>this.heightLimit&&(t=this.heightLimit),t<e&&(t=e),t=Math.round(t),this.$el.css("min-height",t)},e.prototype.resetHeight=function(){return this.$el.css("min-height",this.originalHeight)},e}(),t=function(e){function t(){return this.preventScrollBars=n(this.preventScrollBars,this),this.sourceContents=n(this.sourceContents,this),this.source=n(this.source,this),t.__super__.constructor.apply(this,arguments)}return i(t,e),t.prototype.source=function(){return this.$el.contents()
.find("body")},t.prototype.sourceContents=function(){return this.$source.html()},t.prototype.preventScrollBars=function(){return this.$source.parent("html").css({overflow:"hidden"})},t}(e),$.fn.autoResize=function(){return this.each(function(){return this.tagName.toLowerCase()==="iframe"?t.install(this):e.install(this)})}}.call(this),function(){var e;$.fn.addBehavior=function(t){var n;return n=e(this),n.push(t),this.attr("data-behavior",_(n).uniq().join(" "))},$.fn.removeBehavior=function(t){var n;return n=e(this),this.attr("data-behavior",_(n).without(t).join(" "))},$.fn.hasBehavior=function(t){return _.include(e(this),t)},e=function(e){return(e.attr("data-behavior")||"").split(" ")}}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};$.fn.fadeOutAndRemove=function(t){var n,r;return t==null&&(t={}),t.collapse?_.isArray(t.collapse)?(r=e.call(t.collapse,"width")>=0,n=e.call(t.collapse,"height")>=0):(r=t.collapse==="width",n=t.collapse==="height"):(r=!1,n=!0),$(this).animate({opacity:0},200,"linear",function(){var e,i,s;return e={marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0},r&&(e.width=0),n&&(e.height=0),i=t.duration||Math.sqrt($(this).height())*35,s=t.easing||"easeOutQuad",$(this).animate(e,i,s,function(){return $(this).remove()})})},$.fn.bounce=function(){return $(this).effect("bounce",{times:3},150)},$.fn.pulsate=function(){return $(this).effect("pulsate",{times:3},200)},$.fn.highlight=function(){return $(this).effect("highlight",{},1500)}}.call(this),function(){$.fn.computedStyle=function(){var e,t,n,r,i,s,o,u;if(!(e=this.get(0)))return{};r={};if(window.getComputedStyle){i=window.getComputedStyle(e,null);for(o=0,u=i.length;o<u;o++)n=i[o],t=n.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()}),r[t]=i.getPropertyValue(n)}else if(i=e.currentStyle)for(n in i)s=i[n],r[n]=s;return r}}.call(this),function(){$.fn.containsPoint=function(e,t){var n,r,i,s,o;return e.pageX&&e.pageY?this.containsPoint(e.pageX,e.pageY):this.length?(o=this.offset(),s=o.top,r=o.left,n=s+this.outerHeight(),i=r+this.outerWidth(),r<=e&&e<=i&&s<=t&&t<=n):!1}}.call(this),function(){$.fn.markAsClean=function(){return $(this).data("clean",$(this).find(":input").serialize())},$.fn.isClean=function(){return $(this).find(":input").serialize()===$(this).data("clean")},$.fn.isDirty=function(){return!$(this).isClean()}}.call(this),function(){var e=[].slice;$.fn.dispatch=function(){var t,n,r;return r=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],n=$.Event(r),this.trigger(n,t),n}}.call(this),function(){var e;e=function(t){var n,r,i,s,o,u;r=t.cloneNode(!1),r.id="",r.className="",n=$(r),n.css($(t).computedStyle()),u=t.childNodes;for(s=0,o=u.length;s<o;s++)i=u[s],i.nodeType===1?r.appendChild(e(i)):i.nodeType===3&&r.appendChild(i.cloneNode(!1));return r},$.fn.ghost=function(){return this.length?$(e(this.get(0))).css({position:"absolute",zIndex:999}).offset(this.offset()).appendTo("body"):this}}.call(this),function(){var e;e=function(e){var t,n;return t=$(e),(n=t.data("installed behaviors"))||t.data("installed behaviors",n={}),n},$.fn.install=function(t,n){var r;r=this.filter(function(){return!e(this)[t]});if(r.length)return n(r),r.each(function(){return e(this)[t]=!0})}}.call(this),function(e){e.fn.autoGrowInput=function(t){return t=e.extend({maxWidth:1e3,minWidth:0,comfortZone:70},t),this.filter("input:text").each(function(){var n=t.minWidth||e(this).width(),r="",i=e(this),s=e("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),u=function(){if(r===(r=i.val()))return;var e=r.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");s.html(e);var u=s.width(),a=u+t.comfortZone>=n?t.maxWidth:n,f=i.width(),l=a<f&&a>=n||a>n&&a<=t.maxWidth;l&&i.stop().animate({width:a},"fast")};s.insertAfter(i),e(this).bind("keyup keydown blur update",_.throttle(u,1e3))}),this}}(jQuery),function(){$.rails.href=function(e){return e.data("url")||e.attr("href")}}.call(this),function(){var e,t,n;e=jQuery,e.fn.truncate=function(e){var n;return n=this,n.each(function(){var n;return n=this,new t(n,e)})},t=function(){function t(t,n){this.opts=e.extend({},this.defaults,n),this.full_node=t,this.textShouldBeTruncated()&&(this.trailing_whitespace=!0,this.truncated_node=this.truncate(this.full_node,this.opts.max_length),this.install())}return t.prototype.defaults={allowable_overage:50,max_length:100,more:"…more",less:"less",css_more_class:"truncator-link truncator-more",css_less_class:"truncator-link truncator-less"},t.prototype.textShouldBeTruncated=function(){return this.charactersOverTheLimit()>this.opts.allowable_overage},t.prototype.contentLength=function(t){return e.trim(n(e(t).text())).length},t.prototype.charactersOverTheLimit=function(){return this.contentLength(this.full_node)-this.opts.max_length},t.prototype.install=function(){return e(this.full_node).hide(),this.truncated_node.insertAfter(e(this.full_node)),this.installMoreLink(),this.installLessLink()},t.prototype.installMoreLink=function(){return this.findNodeForMore(this.truncated_node).append(' <a href="#show more content" class="'+this.opts.css_more_class+'">'+this.opts.more+"</a>"),this.truncated_node.find("a:last").click(function(t){return function(){return t.truncated_node.hide(),e(t.full_node).show(),!1}}(this))},t.prototype.installLessLink=function(){return this.findNodeForLess(e(this.full_node)).append(' <a href="#show less content" class="'+this.opts.css_less_class+'">'+this.opts.less+"</a>"),e(this.full_node).find("a:last").click(function(t){return function(){return t.truncated_node.show(),e(t.full_node).hide(),!1}}(this))},t.prototype.truncate=function(t,n){var r;return t.nodeType===3?this.truncateText(t,n):(r=e(t).clone().empty(),e(t).contents().each(function(e){return function(t,i){var s,o;s=n-r.text().length;if(s===0)return;o=e.truncate(i,s);if(o)return r.append(o)}}(this)),r)},t.prototype.truncateText=function(t,r){var i;return i=n(t.data),this.trailing_whitespace&&(i=i.replace(/^ /,"")),i=i.slice(0,r),e("<div/>").text(i).html()},t.prototype.findNodeForMore=function(t){var n,r,i;return n=e(t),i=n.children(":last"),i?(r=i.css("display"),!r||r==="inline"?n:this.findNodeForMore(i)):t},t.prototype.findNodeForLess=function(t){var n,r;return n=e(t),r=n.children(":last"),r&&r.is("p")?r:t},t}(),n=function(e){return e.replace(/\s+/g," ")}}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=jQuery,u="placeholding",f=[p=33,h=34,s=35,o=36,a=37,g=38,d=39,i=40],l=f.concat([t=8,m=9,v=16,r=17,c=18,n=91]),x=function(e,t,n){var r;if(e.setSelectionRange)return e.focus(),e.setSelectionRange(t,n);if(e.createTextRange)return r=e.createTextRange(),r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r.select()},S=function(){if(w(this))return setTimeout(function(e){return function(){try{return e.setSelectionRange(0,0)}catch(t){}}}(this),0)},y=function(t){var n,r;if(w(this))if(n=t.which,T.call(l,n)>=0){if(r=t.which,T.call(f,r)>=0)return S.apply(this)}else{e(this).val("").removeClass(u);if(this.getAttribute("data-type")==="password")return this.type="password"}},E=function(){var t;if(this.value.length===0){t=e(this),t.addClass(u).val(this.getAttribute("data-placeholder")),this.type==="password"&&(this.type="text");if(t.is(":focus"))return S.apply(this)}},b=function(){return e(this).find("[data-placeholder]").each(function(){if(w(this))return e(this).val("")})},w=function(e){return e.value===e.getAttribute("data-placeholder")},e.fn.placeholder=function(t){var n;return t==null&&(t={clearOnSubmit:!0}),n=this,n.each(function(){var n;n=e(this),this.setAttribute("data-type",this.type),this.setAttribute("data-placeholder",this.getAttribute("placeholder")),this.removeAttribute("placeholder"),E.apply(this),n.bind("focus drop click",S),n.bind("keydown",y),n.bind("keyup blur",E);if(t.clearOnSubmit)return e(this.form).submit(b)})}}.call(this),function(){$.fn.preserveScrollOffset=function(e){var t;return this.length?(t=this.offset().top-$(window).scrollTop(),e.call(this),window.scrollTo(0,this.offset().top-t)):e.call(this)}}.call(this),function(){$.fn.repositionAt=function(e){var t,n;return t=this.parent(),this.remove(),(n=t.children().get(e-1))?this.insertBefore(n):this.appendTo(t)}}.call(this),function(){$.fn.resetForm=function(){return this.removeClass("submitting").get(0).reset(),this}}.call(this),function(){$.fn.slideIntoView=function(e){var t,n,r,i,s,o,u,a;e==null&&(e={});if($(this).data("slidingIntoView"))return this;r=(a=e.margin)!=null?a:15,i=this.offset().top-r,n=this.outerHeight()+r,t=i+n,u=$(window).scrollTop(),o=$(window).height(),s=u+o,e.duration==null&&(e.duration="fast"),e.onAfter=function(e){return function(){return $(e).data("slidingIntoView",!1)}}(this);if(i<=u)return e.offset={top:-r},$.scrollTo(this,e),$(this).data("slidingIntoView",!0);if(t>s)return e.offset={top:n-o},$.scrollTo(this,e),$(this).data("slidingIntoView",!0)}}.call(this),function(){var e,t,n,r,i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t={fast:200,slow:600},n=null,r=null,e=null,$(function(){var t;t=document.body.style;if("WebkitTransition"in t)return n="WebkitTransition",r="webkitTransitionEnd",e="webkitAnimationEnd";if("MozTransition"in t)return n="MozTransition",r="transitionend",e="animationend"}),$.fn.transition=function(e,i){var s,o,u,a,f,l,c;return i==null&&(i={}),s=(f=i.duration)!=null?f:"fast",s in t&&(s=t[s]),u=function(t){return function(){var o;return t.css(e),n?(o=!1,t.one(r,function(){return o=!0,t.css(n,""),typeof i.complete=="function"?i.complete():void 0}),setTimeout(function(){if(!o)return t.trigger(r)},s+800)):typeof i.complete=="function"?i.complete():void 0}}(this),n?(a=function(){var t;t=[];for(o in e)t.push(o);return t}(),e[""+n+"Property"]=a.join(", "),e[""+n+"Duration"]=""+s+"ms",e[""+n+"TimingFunction"]=(l=i.timing)!=null?l:"ease-in-out",e[""+n+"Delay"]=(c=i.delay)!=null?c:0,setTimeout(u,1)):u(),this},$.fn.onTransitionEnd=function(t,s){return s==null&&(s=t,t=null),n?this.one(""+r+" "+e,function(e){var n;if(!t||(n=e.originalEvent.propertyName,i.call(t.split(" "),n)>=0))return s()}):s(),this}}.call(this),function(){var e,t;t=/\/([^\/]+)\/(\d+)[^\/]*$/,e=function(e){var n,r,i,s,o;return o=(s=$(e).url())!=null?s.match(t):void 0,i=o[0],n=o[1],r=o[2],{collection:n,id:r}},$.fn.url=function(){return $(this).data("url")},$.fn.collection=function(){return e(this).collection},$.fn.id=function(){return e(this).id}}.call(this),function(){this.StorageAdapter=function(){function i(e,t){this.store=e,this.namespace=t}var e,t,n,r;return n=function(e){var t,n;return n=(new Date).getTime(),t=JSON.stringify(e),""+n+"\n"+t},t=function(e){return e!=null?e.split("\n",2):[]},r=function(e){var n,r,i;i=t(e),r=i[0],n=i[1];if(n)return JSON.parse(n)},e=function(e){var n,r,i;i=t(e),r=i[0],n=i[1];if(r)return new Date(parseInt(r,10))},i.prototype.get=function(e){var t;try{return r(this.store.getItem(""+this.namespace+":"+e))}catch(n){t=n}},i.prototype.set=function(e,t){var r;try{return this.store.setItem(""+this.namespace+":"+e,n(t))}catch(i){r=i}},i.prototype.unset=function(e){var t;try{return this.store.removeItem(""+this.namespace+":"+e)}catch(n){t=n}},i.prototype.has=function(e){var t;try{return this.store.getItem(""+this.namespace+":"+e)!=null}catch(n){t=n}},i.prototype.ageOf=function(t){var n;try{return e(this.store.getItem(""+this.namespace+":"+t))}catch(r){n=r}},i.prototype.touch=function(e){return this.set(e,this.get(e))},i.prototype.keys=function(){var e,t,n,r,i,s,o;try{r=""+this.namespace+":",n=r.length,s=this.store,o=[];for(t in s)i=s[t],t.slice(0,n)===r&&o.push(t.slice(n));return o}catch(u){return e=u,[]}},i.prototype.clear=function(){var e,t,n,r,i;r=this.keys(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.unset(e));return i},i}()}.call(this),function(){_.debounceConditionally=function(e,t,n){var r;return r=_.debounce(e,t),function(){return n.apply(this,arguments)?r.apply(this,arguments):e.apply(this,arguments)}}}.call(this),function(){_.mixin({inGroups:function(e,t){var n,r,i,s;return n=parseInt(e.length/t),i=e.length%t,r=[],s=0,_(t).times(function(t){return function(t){var o,u;return o=n+((u=i>0&&i>t)!=null?u:{1:0}),r.push(e.slice(s,s+o)),s+=o}}(this)),r}})}.call(this),function(){_.mixin({rand:function(e){return e[Math.floor(Math.random()*e.length)]}})}.call(this),function(){_.mixin({toSentence:function(e){return _(e).toArray().join(", ").replace(/,\s([^,]+)$/," and $1")}})}.call(this),function(){var __bind=function(e,t){return function(){return e.apply(t,arguments)}};this.BackgroundOperationProcessor=function(){function BackgroundOperationProcessor(e){this.operation=e,this.operationFailed=__bind(this.operationFailed,this),this.operationSucceeded=__bind(this.operationSucceeded,this),this.operationReloaded=__bind(this.operationReloaded,this),this.checkOperationStatus=__bind(this.checkOperationStatus,this)}return BackgroundOperationProcessor.prototype.pollIntervalId=null,BackgroundOperationProcessor.prototype.pollDelay=1e3,BackgroundOperationProcessor.prototype.run=function(){return this.operation.save({},{error:function(e){return function(){return e.operationFailed()}}(this),success:function(e){return function(){return e.startWatchingOperation()}}(this)})},BackgroundOperationProcessor.prototype.startWatchingOperation=function(){if(!this.pollIntervalId)return this.pollIntervalId=setInterval(this.checkOperationStatus,this.pollDelay)},BackgroundOperationProcessor.prototype.checkOperationStatus=function(){return this.operation.fetch({error:this.operationFailed,success:this.operationReloaded})},BackgroundOperationProcessor.prototype.stopWatchingOperation=function(){if(this.pollIntervalId)return clearInterval(this.pollIntervalId),this.pollIntervalId=null},BackgroundOperationProcessor.prototype.operationReloaded=function(){if(!this.operation.isStillRunning())return this.stopWatchingOperation(),this.operation.isSuccessful()?this.operationSucceeded():this.operationFailed()},BackgroundOperationProcessor.prototype.operationSucceeded=function(){var xhr;return xhr=new XMLHttpRequest,xhr.open("GET","/"+bcx.currentAccountSlug+this.operation.completionUrl(),!0),xhr.setRequestHeader("X-CSRF-Token",bcx.authenticityToken),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.setRequestHeader("Accept","text/javascript"),xhr.onload=function(_this){return function(){return eval(xhr.responseText),_this.trigger("processor:finished")}}(this),xhr.send(),this.trigger("processor:success")},BackgroundOperationProcessor.prototype.operationFailed=function(){return this.trigger("processor:failed")},BackgroundOperationProcessor.prototype.on=function(e,t){var n;return this.events==null&&(this.events={}),(n=this.events)[e]==null&&(n[e]=[]),this.events[e].push(t)},BackgroundOperationProcessor.prototype.trigger=function(e){var t,n,r,i,s,o;if((i=this.events)!=null?i[e]:void 0){s=this.events[e],o=[];for(n=0,r=s.length;n<r;n++)t=s[n],o.push(t());return o}},BackgroundOperationProcessor}()}.call(this),function(){var e,t;isNaN(Date.parse("2011-01-01T12:00:00-05:00"))&&(t=Date.parse,e=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(Z|[-+]?[\d:]+)$/,Date.parse=function(n){var r,i,s,o,u,a,f,l,c,h;n=n.toString();if(s=n.match(e))h=s[0],l=s[1],u=s[2],r=s[3],i=s[4],o=s[5],f=s[6],c=s[7],c!=="Z"&&(a=c.replace(":","")),n=""+l+"/"+u+"/"+r+" "+i+":"+o+":"+f+" GMT"+[a];return t(n)})}.call(this),function(){bcx.EmailAddressHelper={looksLikeEmailAddress:function(e){return!/\s/.test(e)&&/.+@.+\..+/.test(e)},extractEmailAddressesFrom:function(e){return _.uniq(e.match(/([\/+'a-z0-9._-]+@[a-z0-9.-]+\.[a-z0-9-]{2,23})/gi))}}}.call(this),function(){1,window.FileIcons={LIB:{AI:"AI",AIF:"AIF",AIFF:"AIFF",ASP:"WEB",BZ2:"ZIP",CFM:"WEB",CGI:"WEB",CSV:"CSV",DMG:"DMG",DOC:"DOC",DOCX:"DOCX",EML:"EML",EPS:"EPS",FLA:"FLA",GIF:"GIF",GDOC:"GDOC",GDRAW:"GDRAW",GFORM:"GFORM",GSHEET:"GSHEET",GSLIDES:"GSLIDES",GZ:"TGZ",HTML:"HTML",HTM:"HTM",INDD:"INDD",JPG:"JPG",JPEG:"JPEG",JSP:"WEB",KEY:"KEY",LINK:"WEB",M4A:"M4A",M4V:"M4V",MD:"MD",MOV:"MOV",MP3:"MP3",MP4:"MP4",MPEG:"MPEG",MPG:"MPG",NUMBERS:"NUMBERS",ODP:"ODP",ODS:"ODS",ODT:"ODT",PAGES:"PAGES",PDF:"PDF",PHP:"WEB",PL:"WEB",PNG:"PNG",POT:"POT",PPT:"PPT",PPTX:"PPTX",PS:"EPS",PSD:"PSD",RAR:"RAR",RM:"RM",RTF:"RTF",SIT:"SIT",SWF:"SWF",TAR:"TAR",TGZ:"TGZ",TIF:"TIF",TIFF:"TIFF",TXT:"TXT",VCF:"VCF",VSD:"VSD",WAV:"WAV",WEB:"WEB",WMA:"WMA",WMV:"WMV",XLS:"XLS",XLSX:"XLSX",XLSM:"XLS",ZIP:"ZIP"},SIZES:{small:"24x18",big:"32x32",jumbo:"86x100",enormous:"160x200"},URLS:{"icon_AIFF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_big-ea546f18b9d3dd291ba1f9f09cad4220.png","icon_AIFF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_big@2x-53f2b765de117509381b3df0065ec26b.png","icon_AIFF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_enormous-6ff3c13998233ca1253902b4cdc948a4.png","icon_AIFF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_enormous@2x-907a8528012f87b7cec9e8ad1dfadbdd.png","icon_AIFF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_jumbo-f6d9b5a574cbcb5dd2afa169565d973c.png","icon_AIFF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_jumbo@2x-f50463c96c306f201ce330d52a1c3a18.png","icon_AIFF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_small-ffa0f090f9648d583e0d37a988ae0098.png","icon_AIFF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIFF_small@2x-d13bdc43baaceeb300bf870b0bf47b74.png","icon_AIF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_big-c5836e3fc25130c85e83115cc90cd005.png","icon_AIF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_big@2x-44ae8912ca0d5cad623a01d5cb6055fb.png","icon_AIF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_enormous-7f6d298b6f4e6195254f82a4734f1a40.png","icon_AIF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_enormous@2x-99ccf59300f6d93a61acdd0247606108.png","icon_AIF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_jumbo-681fc68879b53fc84d00f714098bcf8c.png","icon_AIF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_jumbo@2x-e76a99c709b3d5ea9efad93f321df6aa.png","icon_AIF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_small-88a5bb43d34117b74b1e04313f09d3f8.png","icon_AIF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AIF_small@2x-b75dac6a5bbafc325c88569201912889.png","icon_AI_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_big-4e1ce18213ae2fe0db00838bf75dbf90.png","icon_AI_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_big@2x-0172490c4a59ab8c98f3faa8fca570bb.png","icon_AI_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_enormous-6a2ebdac9d53c1f81d1eac1e4c51f7d9.png","icon_AI_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_enormous@2x-bc13ffae4b23c499c298dcf1dad713ae.png","icon_AI_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_jumbo-0f59cca48a7cd1dd95cfe2d87322de1a.png","icon_AI_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_jumbo@2x-af9c531b51bd18dd6dce6bc78bb5298d.png","icon_AI_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_small-754d643c90a54932739954c956e4801a.png","icon_AI_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_AI_small@2x-e21ab5da89254115f48b1b9f6cb604ac.png","icon_CSV_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_big-1b633c475ed82115be42f046c57a1b2c.png","icon_CSV_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_big@2x-2485cc940323d4c679e455f822c93a37.png","icon_CSV_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_enormous-c3486af97d0f51d9185a62b435d63b64.png","icon_CSV_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_enormous@2x-652ba9d7d0a5b84114e458c0fabbd386.png","icon_CSV_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_jumbo-6c20e3685a8ea3b5eece1ba754d4bc67.png","icon_CSV_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_jumbo@2x-a84591ebda749ad377d90a0387371df8.png","icon_CSV_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_small-2365d6b9057b34155d775495bceab095.png","icon_CSV_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_CSV_small@2x-f3e337ebc3ee0d3ea4071ad7fbf796ac.png","icon_DMG_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_big-ac8a3295309f70f1a05bb35d370e5012.png","icon_DMG_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_big@2x-2c7e7b56e45cd860278c37df48846448.png","icon_DMG_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_enormous-96a90bd6bbfbf4431bc79eeacaf9bbc2.png","icon_DMG_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_enormous@2x-2b121632a4534cf9c1e7cbe1e05a2922.png","icon_DMG_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_jumbo-b047d84de1c4eb852dbc7f380cd7147d.png","icon_DMG_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_jumbo@2x-6c5d5b90c14fd48ddab303626af73766.png","icon_DMG_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_small-23493c77c23d1497cbce0a8d9693b7e6.png","icon_DMG_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DMG_small@2x-e7b30c9b143122dcaa1f44371004f1e2.png","icon_DOCX_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_big-c0be42ace1c839f710c504930398b626.png","icon_DOCX_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_big@2x-09deccd10d183266793c3fa2d4d757ca.png","icon_DOCX_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_enormous-e555b3a17e14721bc0744b059a60a9f9.png","icon_DOCX_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_enormous@2x-9a04a1e47dc92610f566f13b16fabe7e.png","icon_DOCX_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_jumbo-4721fecdab7c9bb4c2c6b28e6db78cc3.png","icon_DOCX_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_jumbo@2x-f63abfc0f8e34bb57dfee21c6ae76f27.png","icon_DOCX_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_small-fb18170e86c12fa567104f8082ae1d92.png","icon_DOCX_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOCX_small@2x-249e8b28c74d4ef87fe95bfcaa145c76.png","icon_DOC_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_big-337b50f8b483bd8707021358fce6caab.png","icon_DOC_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_big@2x-13ae3dd9e54fc9741fe5438726253456.png","icon_DOC_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_enormous-fd4e116c507533c50c2474d05d6846a7.png","icon_DOC_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_enormous@2x-d178fc4e2d6734f595a52e2f983dc2e9.png","icon_DOC_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_jumbo-3a7ea56eeaef96df4305ec2f4e16f123.png","icon_DOC_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_jumbo@2x-fefa4b4dbcef18d838ce2b143c84a592.png","icon_DOC_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_small-068815165b7810932d4cfb6f8ebca96b.png","icon_DOC_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_DOC_small@2x-d59d478e3ad2a4f3284c1c59be2267c7.png","icon_Deleted_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_big-27f497defcceae3d0844eeefa7c15764.png","icon_Deleted_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_big@2x-fea9341a2c117f6d5c560d4382801420.png","icon_Deleted_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_enormous-aeacc7a65b5b38f2014459aa3e9ac116.png","icon_Deleted_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_enormous@2x-627c7620fee61259abeba67589120df9.png","icon_Deleted_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_jumbo-df91a2bee6ed54808734db12200bbe0f.png","icon_Deleted_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_jumbo@2x-d7848dd3836cee1b893acb377493d266.png","icon_Deleted_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_small-0ac33c999edbd6fff613a203098a6fe4.png","icon_Deleted_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Deleted_small@2x-e03e00d49bd76c5783786d255f875fae.png","icon_EML_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_big-7ac0fcc23b2131b66f58d0e928510e7e.png","icon_EML_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_big@2x-f6bc9ba11028dd478fa2bbc204672966.png","icon_EML_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_enormous-d4f2bbba1e6a669993be0678732c323f.png","icon_EML_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_enormous@2x-2aff007075c3849c57c63e4466248c8e.png","icon_EML_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_jumbo-5e519e89fbff7d19dae2ead8fad00187.png","icon_EML_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_jumbo@2x-47e07fefc64e43d32d783c0c494888f7.png","icon_EML_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_small-61b47ef7d8d741615329bf8d91603ab3.png","icon_EML_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EML_small@2x-ca4fd0c703c9192bfce987fc95ddb9ea.png","icon_EPS_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_big-dbba76a2b59d71038e269faedd9e776c.png","icon_EPS_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_big@2x-d4862dd5cf166cb72f7bb8c33f030841.png","icon_EPS_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_enormous-4ca85349c04c02cf145a94be7d83bad6.png","icon_EPS_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_enormous@2x-da339d6664e19bb9f49f694df6cc1f54.png","icon_EPS_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_jumbo-16b154945d66ae280828de2787be48a8.png","icon_EPS_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_jumbo@2x-970c64e688dc38079cd650e8438d463c.png","icon_EPS_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_small-45100b6314f21ebda1e92bdea7c72e57.png","icon_EPS_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_EPS_small@2x-75be4e9bbe9ad4f58266f6216776a638.png","icon_FILE_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FILE_small@2x-7f19882a949844536d72bce40057e3cb.png","icon_FLA_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_big-4f310d3cf790faa63ffe375d9be494c8.png","icon_FLA_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_big@2x-08296a714a33f2ca59b6140eea35be03.png","icon_FLA_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_enormous-4bba7b2aa23f44d42778ab5f0936aeaf.png","icon_FLA_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_enormous@2x-3f75cd0e12f7faa017c6d3649d890651.png","icon_FLA_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_jumbo-4b69479752d3e84ddd7b3f6102939cfa.png","icon_FLA_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_jumbo@2x-e7a0cb04a338bd8b16bbb2e489aad604.png","icon_FLA_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_small-5534551d312b27994771948fbbcb6acb.png","icon_FLA_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_FLA_small@2x-0f13ef8c70ecc280b6c7d2ed0f02183c.png","icon_GDOC_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_big-68aeb6814a477ecd7c38344694f28b37.png","icon_GDOC_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_big@2x-7145eff09bc1458ea4a570ff6c6ee32b.png","icon_GDOC_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_enormous-7a237fe0b944fb18a9f469f4b824b1ff.png","icon_GDOC_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_enormous@2x-a57f0f86e9df428eb3d6379bef22c34a.png","icon_GDOC_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_jumbo-c1aad15564ffaa4a2d9061f4a1f4a6de.png","icon_GDOC_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_jumbo@2x-f3a14169f091ce2bf77b74f2ca377999.png","icon_GDOC_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_small-8b92e9bf11c68a6f4023a78257f9b253.png","icon_GDOC_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDOC_small@2x-d5688a43c5311caca31d86e9c07e3d0b.png","icon_GDRAW_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_big-30259291a62e9a487242b5260c2b11fa.png","icon_GDRAW_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_big@2x-fd0de476c7b9a1c52373d12e16b129f6.png","icon_GDRAW_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_enormous-02259ca13b1c7f6a3a4f154bf74208f2.png","icon_GDRAW_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_enormous@2x-887f5c457ae93127363f17e35db49e33.png","icon_GDRAW_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_jumbo-5aaa60352b1535875ed3b8a9f75e39f1.png","icon_GDRAW_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_jumbo@2x-64924fca32f517102631ac094ab2fda6.png","icon_GDRAW_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_small-bc1219dd354f95c2378d3b0baec44bd6.png","icon_GDRAW_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GDRAW_small@2x-384cd3d0f956eae772e405cb0a550d47.png","icon_GFORM_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_big-0482c74292aaee6167c16ab0d6fc029c.png","icon_GFORM_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_big@2x-58f59bf6b61caaf82dabb8d7b5dd7189.png","icon_GFORM_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_enormous-016a746ad2c5805a14db527789d6162b.png","icon_GFORM_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_enormous@2x-5cf8423dc3c9888de3b876e81dbc40ab.png","icon_GFORM_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_jumbo-f6d74a76728483d8c9e6d6650142ac45.png","icon_GFORM_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_jumbo@2x-ddfd1843a2cf3ebf37819e639b75a14c.png","icon_GFORM_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_small-e365eca0fdf785ba3a6772abf94ee8fa.png","icon_GFORM_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GFORM_small@2x-1fb7878cfb1145aa53f2e1ab8fe124ea.png","icon_GIF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_big-d1390f0efc22ed79e085d33aaa1a8fdd.png","icon_GIF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_big@2x-e919479c6d772f2288fc9759a8592000.png","icon_GIF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_enormous-df71c100f34a76f1e3b05b6b49d9a0a8.png","icon_GIF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_enormous@2x-2410a2e99dea94a7600306fb0243df4f.png","icon_GIF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_jumbo-5198647f65b229a353f243add5d5a47f.png","icon_GIF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_jumbo@2x-9de6f5db5628edcaf1fc3dec1a22edcd.png","icon_GIF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_small-2bdceeacad537e321d56e0ecc7be7a5b.png","icon_GIF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GIF_small@2x-39574557cdb66efaadb8e51c426edb7e.png","icon_GSHEET_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_big-5d53880953925338def206a8cd7e98af.png","icon_GSHEET_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_big@2x-eb642f415218cd270836d757bc93840b.png"
,"icon_GSHEET_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_enormous-a5ebd0886d9e55a1f72f160d3397664a.png","icon_GSHEET_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_enormous@2x-7995b2114700e34f60a515e6523f80a9.png","icon_GSHEET_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_jumbo-b0497054cf521e38704c7f8e75e1a029.png","icon_GSHEET_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_jumbo@2x-7b0e49f5ff03a2053f27d07a7d963e01.png","icon_GSHEET_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_small-e365eca0fdf785ba3a6772abf94ee8fa.png","icon_GSHEET_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSHEET_small@2x-6541d7c10cad95c60371bbdbd08f9673.png","icon_GSLIDES_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_big-49e8d52c672457582d799b3530468df0.png","icon_GSLIDES_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_big@2x-f5c0e54bf79859682c69f40e6cb4b862.png","icon_GSLIDES_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_enormous-13d1b5a69a253f27f6e2cde9c839dc83.png","icon_GSLIDES_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_enormous@2x-90e1aacaedda799a1bedf377d02b2187.png","icon_GSLIDES_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_jumbo-6692bb5e538f0923fd7555d090e21617.png","icon_GSLIDES_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_jumbo@2x-e3454f691c4097aeb282e280cc9161ae.png","icon_GSLIDES_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_small-c65cafb03097cf9d345ddd56933f62eb.png","icon_GSLIDES_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_GSLIDES_small@2x-67204f49efd7005a994ecae11f9deecc.png","icon_Generic_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Generic_big-546c36528921a7af224dd8bb02571cdf.png","icon_Generic_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Generic_big@2x-e5bcd6765e2e16f0cccbb44ed0b3c67c.png","icon_Generic_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Generic_enormous-74a44de19b5df70abbc5dafeb07d3e05.png","icon_Generic_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Generic_enormous@2x-9d9c65cd5eb77fbc684a464b0bce9a70.png","icon_Generic_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Generic_jumbo-e78888ecabd111d31b66d3c3eee54bf8.png","icon_Generic_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Generic_jumbo@2x-d6b73597746c4ed0908ea0c1732cdee8.png","icon_Generic_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_Generic_small-1af0728fd872d8eb4e19391163814f19.png","icon_HTML_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_big-c10c2ae6be093dc99f548b4b4707c894.png","icon_HTML_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_big@2x-87dc0f83c409f3d2d45e668d099cb969.png","icon_HTML_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_enormous-f3de158aa5fb7192af72cdd1ed9b5985.png","icon_HTML_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_enormous@2x-20d69c9947b8b6257f21a75af92d7d2e.png","icon_HTML_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_jumbo-92aca5f53f58552953b5f612a316029e.png","icon_HTML_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_jumbo@2x-146a60d20ee3ac0dfe91f749e7907a09.png","icon_HTML_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_small-35d894c6e0b277c0748e94f90ab808b9.png","icon_HTML_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTML_small@2x-35c2abaa86e78dce43a60ad823746536.png","icon_HTM_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_big-64c33f3f76fd354ddf1902e75df4554a.png","icon_HTM_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_big@2x-35682512a640bd5fb8ee18339ac537db.png","icon_HTM_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_enormous-5d05f883e2f17bc8f188c329a36df22a.png","icon_HTM_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_enormous@2x-1c906528bf5d74ad5da02f8c863a8741.png","icon_HTM_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_jumbo-a69f3fdf4e68072f4d70e0eb5a43b00a.png","icon_HTM_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_jumbo@2x-2cc98955879a6316aea09d29586f2f2e.png","icon_HTM_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_small-fd3ffb8696a25701aba247efc01f0c12.png","icon_HTM_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_HTM_small@2x-3ceec817ea43f24f88e53b396b4d8c1f.png","icon_INDD_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_big-dc03479a41f79cfa7f775dd881415448.png","icon_INDD_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_big@2x-6e2d2940fd263d6ae7c0caaeea7fef3d.png","icon_INDD_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_enormous-6947845a417eed042a5832b44f3eaf63.png","icon_INDD_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_enormous@2x-1bc1d4f95818641b6c942fa944716daf.png","icon_INDD_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_jumbo-4baca590176553b2350000402fe3eb2b.png","icon_INDD_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_jumbo@2x-1a5d8eb5edb525beb95c2e1d9cbbe958.png","icon_INDD_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_small-a45b3358164a3020c14ba178c58bacd9.png","icon_INDD_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_INDD_small@2x-da8e066c28d3c75ed6d2e06eb18d4c9b.png","icon_JPEG_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_big-7df7d3451988a3295e80d31660d8e38b.png","icon_JPEG_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_big@2x-a068fae26532c916e4737d6326908404.png","icon_JPEG_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_enormous-4bb56413aa2ac289d7749f1147ac4a85.png","icon_JPEG_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_enormous@2x-f263488f15a64c6928f439055a23e401.png","icon_JPEG_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_jumbo-e1efd512c43c277e306c4128a605bbf3.png","icon_JPEG_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_jumbo@2x-0bae1c488810de8cf7ba7769875a5b1e.png","icon_JPEG_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_small-bdd2658fc9e2d04309fa1cf614498a02.png","icon_JPEG_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPEG_small@2x-d50e271adc1ba4c47697569e3162b125.png","icon_JPG_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_big-a1256164bc7ed9bd9db5c07f4800658e.png","icon_JPG_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_big@2x-6ab17b62f9c8994d43459728a28e1b15.png","icon_JPG_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_enormous-414d324aea8b0d91e57924ab30c9248f.png","icon_JPG_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_enormous@2x-9530a77e704100667ec4530a1eff5180.png","icon_JPG_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_jumbo-a2d911583f314addd3b7973a1cf9a749.png","icon_JPG_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_jumbo@2x-212c88ba69a80dfbc3867e6cc4d4b34a.png","icon_JPG_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_small-79bae754bffa0f2e4e1e7a10824f0e86.png","icon_JPG_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_JPG_small@2x-b0153f9a00b1d64d892742fb785fcaf3.png","icon_KEY_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_big-d4f17214f704e9d27da6e0690a389ac0.png","icon_KEY_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_big@2x-eeb1e9b15cc9a8bbb8212de9dd3194af.png","icon_KEY_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_enormous-9e33ace36cfd5f04b68beb0d0e451d2c.png","icon_KEY_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_enormous@2x-575ea25f917293dd6a79d960fc20c472.png","icon_KEY_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_jumbo-ab7e7823a9062d0fe3094b0e7d58ab69.png","icon_KEY_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_jumbo@2x-d707cf5c6748c52d58bc861649552ffb.png","icon_KEY_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_small-4b9b4218612b02345201305764b2b3ec.png","icon_KEY_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_KEY_small@2x-169016f3416136e02f8ea70fc8c6e1d1.png","icon_LINK_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_big-37ad12e72e818aacc06ceed9ee80af54.png","icon_LINK_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_big@2x-bca30bcb957c679c63d81edf48eb4e8d.png","icon_LINK_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_enormous-5f5e7279a9788eeefe9b2fcdd4f26857.png","icon_LINK_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_enormous@2x-5d177bde0c03ec1ad559409f6118b6e5.png","icon_LINK_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_jumbo-bd7d76b721eec52cf9fcf854de8c7edc.png","icon_LINK_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_jumbo@2x-75245bec796bdfebf2827abe00b89b3b.png","icon_LINK_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_small-85beca6d7f62813e471d60716b82e81c.png","icon_LINK_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_LINK_small@2x-f20e0ea9f00ad9dc9a4765231a76a2d8.png","icon_M4A_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_big-daa2be13a5831ccb6e3a76f48e38ba0a.png","icon_M4A_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_big@2x-156d239266ce676abc2a35224b44bdad.png","icon_M4A_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_enormous-37a5e3449453e0ef257f9992a9bab8e0.png","icon_M4A_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_enormous@2x-f67b40f7c058a6e2f27cb04344a25fa3.png","icon_M4A_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_jumbo-c74c62a5236a61bdbc134fd61b4b5403.png","icon_M4A_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_jumbo@2x-68dd6037872153eeea879abe41d59222.png","icon_M4A_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_small-3cc395537a03a2668538e8d497cfa692.png","icon_M4A_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4A_small@2x-a5c2dbdb49a03e4b415a688784c2b310.png","icon_M4V_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_big-10f89b998ad408e3834896bfb46f848e.png","icon_M4V_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_big@2x-a937dbacb7d351c496fcb3211e6b9f26.png","icon_M4V_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_enormous-7d90210f8dab4164c62850e2c816cc83.png","icon_M4V_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_enormous@2x-1e2909d02edd714c380c347a148ec26a.png","icon_M4V_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_jumbo-3c23e57c3763b7c26c3b06bdc5ab517a.png","icon_M4V_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_jumbo@2x-f75b6028ee298c78e5ed974eb4019906.png","icon_M4V_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_small-de93a14749b3f9f99c58474e79831096.png","icon_M4V_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_M4V_small@2x-d1d185cdab8c6b1a151abea03f23f9f6.png","icon_MD_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_big-627cae2622ccd3839d4e2bfa5f3d4565.png","icon_MD_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_big@2x-34e576d4c9a8dda7105d3aad0bd61bbf.png","icon_MD_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_enormous-8c8cc3afbd8778d87ffcda0ee9cf8c4d.png","icon_MD_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_enormous@2x-62d44d4b4fc959189200c467d38abeb9.png","icon_MD_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_jumbo-609a3925452941879e3e01b6d03fbf1b.png","icon_MD_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_jumbo@2x-dbf822afd2e079e082369edd52bfc9ef.png","icon_MD_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_small-826e9278affef6854623e10bb2e73a12.png","icon_MD_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MD_small@2x-fa018a5c8cf7be953d1c02aab061e13a.png","icon_MOV_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_big-038042be81f81fa9696c9d79439bc81e.png","icon_MOV_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_big@2x-492a4d6531da68219895569561923fd8.png","icon_MOV_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_enormous-2397b57ddcfdf4e7d86140c4f99fcad0.png","icon_MOV_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_enormous@2x-aeca1a2bebe42065eff8d6f4f5b9e9fc.png","icon_MOV_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_jumbo-5cc90a31b010e9d3fcbd0276d3b8aff0.png","icon_MOV_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_jumbo@2x-c6502076ac690887286bc3f742a803a1.png","icon_MOV_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_small-79fbc4ed76b3d7d5f328f038a8b19fde.png","icon_MOV_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MOV_small@2x-419cd6a1acc3f16cf37694e3244c90a5.png","icon_MP3_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_big-460161b019ef4cba711e2a08c6363613.png","icon_MP3_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_big@2x-1a81d1e40c1546b26ef514a7515ae880.png","icon_MP3_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_enormous-b03505e8b04a4af200eb55cb089814af.png","icon_MP3_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_enormous@2x-febf9db21309729fbda98a3763f52ac9.png","icon_MP3_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_jumbo-e39e3412d79157f74345a1fc83f1f5c1.png","icon_MP3_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_jumbo@2x-b1fea914c29bda878e47dab095c4f446.png","icon_MP3_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_small-8782587960e58916c405fe55b3781ee2.png","icon_MP3_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP3_small@2x-2ac3d176ecce98df5318d2895094e8a8.png","icon_MP4_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_big-c43b72f749b64bacc93ddc3a755db099.png","icon_MP4_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_big@2x-fee7ad8d1705f93e0d28dc4354aaa847.png","icon_MP4_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_enormous-a70c228f158c6ec9c68b861f6079b3e1.png","icon_MP4_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_enormous@2x-98ef4581ed6daa28b56bb72675be0096.png","icon_MP4_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_jumbo-379e08870308f5a46a704ababec9c83e.png","icon_MP4_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_jumbo@2x-b290f55ac470e0668bfa5b70e2dfdea0.png","icon_MP4_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_small-486f74599ce1730d5ae12ae8085260a9.png","icon_MP4_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MP4_small@2x-a66c25a291cb8200ef32d76272a9ab3e.png","icon_MPEG_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_big-148fce412e3d0fb38f6e80e1a69ab4fa.png","icon_MPEG_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_big@2x-bca758cb1f9c5eb8da337cdd0c644792.png","icon_MPEG_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_enormous-bc6273462dde878940721b8acdbd4933.png","icon_MPEG_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_enormous@2x-161b7d47507e4141582655684bb5b6fc.png","icon_MPEG_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_jumbo-f5d9c6c04e16ef791b8d1b7b07a8d459.png","icon_MPEG_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_jumbo@2x-cb4d6ca681db6e219c1b5bdff9dde374.png","icon_MPEG_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_small-03fc3a1e7b124fc1181f21c71aaf3fa8.png","icon_MPEG_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPEG_small@2x-5192fc201e404489569563be4f2fa948.png","icon_MPG_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_big-43baa0f446f8da53551bdcf99d6ffc71.png","icon_MPG_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_big@2x-e1506c16fab1db194af3985612b9f9ff.png","icon_MPG_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_enormous-9692b0ab50946590fb04dbe3b2bf84dc.png","icon_MPG_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_enormous@2x-1eb20cd8f4f01ff02b62a73ed892db96.png","icon_MPG_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_jumbo-fe9196dc934791c3e70f1f9a919d244c.png","icon_MPG_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_jumbo@2x-b952f884c3189997bd0e4b07f2e054da.png","icon_MPG_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_small-834d0a94ea6e40ebeb6539cb7001be63.png","icon_MPG_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_MPG_small@2x-31c9a38e647e51f5d6cb20f06525c385.png","icon_NUMBERS_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_big-626113557eb5fdda5fcac7c41a063286.png","icon_NUMBERS_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_big@2x-ad6c52b43168b3abde77d0c34f8ffcd0.png","icon_NUMBERS_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_enormous-f3eeb461215785465ba6aee88243d542.png","icon_NUMBERS_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_enormous@2x-898002ccb8bb8bf593c07f7ce37ee43c.png","icon_NUMBERS_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_jumbo-15bd35fe6adfc9ced6aae6584648fc8f.png","icon_NUMBERS_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_jumbo@2x-9a9ee6defeed1158de8719c37e89abd9.png","icon_NUMBERS_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_small-5b5d68f04af7e2f4628582a80bc167c8.png","icon_NUMBERS_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_NUMBERS_small@2x-8bcff72269d9b8bbe76cc01acfbe2198.png","icon_ODP_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_big-fda192976861436b74aa93601ff7e4fc.png","icon_ODP_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_big@2x-4651a6cd87dfb838498ec99f5935b143.png","icon_ODP_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_enormous-8ab7b6d0d3fc53100bda3e7db7a6dc14.png","icon_ODP_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_enormous@2x-1f8511cf5c61370a0376540be6814543.png","icon_ODP_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_jumbo-d36cf68296e9990d8314587483cc59ef.png","icon_ODP_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_jumbo@2x-16762b9c127bd2b3c4d80d49756ce6ea.png","icon_ODP_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_small-68c5d2c69bb060d3e7134a7f4f626dde.png","icon_ODP_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODP_small@2x-5ce8ea8f5099ec07d86a273fba9e49f6.png","icon_ODS_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_big-fcbce5da532d0a5a790ef0e15fac1596.png","icon_ODS_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_big@2x-cf74339cee555c0db3a75ac02915bd12.png","icon_ODS_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_enormous-9adcd87fd7b1385738b1b15302bda1d5.png","icon_ODS_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_enormous@2x-efa9b8ccdfe8641bbfdbe0f59ee380e3.png","icon_ODS_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_jumbo-766339fdeeeef42fe38b761812e75fdf.png","icon_ODS_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_jumbo@2x-6d4c321ac706131b7ffa0fbc440472f9.png","icon_ODS_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_small-8521fa28ef05d64a07c37ffaae6e22ac.png","icon_ODS_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODS_small@2x-287b0b82d4514b6dbe40f5098fb407ad.png","icon_ODT_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_big-fa7525fe54aeb70dfc0648d3906a0644.png","icon_ODT_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_big@2x-2bb251c4135ec271060f6fa081d76571.png","icon_ODT_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_enormous-767b1b53e661feeac09ffa367045fb83.png","icon_ODT_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_enormous@2x-76cc04b5da2aa9741a1ce5884907f3a1.png","icon_ODT_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_jumbo-2ec8536b61aa2001d8cbfe2a988d455a.png","icon_ODT_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_jumbo@2x-b34b6699bc57fabad9c08634b2ee85c9.png","icon_ODT_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_small-1791b1dd7343af3f30df133e7e4c3ce3.png","icon_ODT_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ODT_small@2x-c526557013ae8dd09ac83c25b8d29bfe.png","icon_PAGES_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_big-6a4f37220c2ba0c1e0a301d7e141f8c6.png","icon_PAGES_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_big@2x-39b0b73e139190ad990d06e1484e3d7b.png","icon_PAGES_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_enormous-e5149bd84324f5d934787a9d975ba719.png","icon_PAGES_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_enormous@2x-e89636f4c9661131f659120a7d362b67.png","icon_PAGES_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_jumbo-99fb5620961068935b0725fbd3c8e213.png","icon_PAGES_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_jumbo@2x-ff142921a8b15d846b8f38bdb1c359ff.png","icon_PAGES_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_small-db86e4286ed7150d6fa0091f88489ae7.png","icon_PAGES_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PAGES_small@2x-9ec542ad6d0188444a3a4736c9f162e2.png","icon_PDF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_big-9d130b68757ec4e8f0e98a032946728d.png","icon_PDF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_big@2x-fcca90f4a1efd8f1244b7f43dcf88b4c.png","icon_PDF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_enormous-40a29bfa344bc287caf83975c1689f4d.png","icon_PDF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_enormous@2x-b8a44243c1039dedd76cb10299d27e12.png","icon_PDF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_jumbo-92ccab1eeabf6e5742b148901f8bbec3.png","icon_PDF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_jumbo@2x-3608bbe67205ce5903957ec44b7935a5.png","icon_PDF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_small-614b2b5f433bb6d30e8efd31d0c6aae9.png","icon_PDF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PDF_small@2x-82e289c29dd3b247e0a20979d82cabb4.png","icon_PNG_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_big-f2b3412798adbe77ddd0fca591b12835.png","icon_PNG_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_big@2x-2a09b108ed7a7fc1b87c6f498f0b8564.png","icon_PNG_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_enormous-1f91143f4cc08302f9d09963a3223ee0.png","icon_PNG_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_enormous@2x-bc8091a4e8c27d17e189d0877bb28bc6.png","icon_PNG_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_jumbo-557304e550011560ea1a8244227e9384.png","icon_PNG_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_jumbo@2x-72827b369099ba0bf0a5a122332459a7.png","icon_PNG_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_small-b26a39b21a83c4b8b0611366dd7dd058.png","icon_PNG_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PNG_small@2x-e6bf1c340328014afec517b10e9db346.png","icon_POT_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_big-058679d0baf655bbd47e910ad482fdf2.png","icon_POT_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_big@2x-f935020d984bcd31af895c3193c65a29.png","icon_POT_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_enormous-991a6c5f5e83e6ba7fc16e8159f5514c.png","icon_POT_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_enormous@2x-e1926f7581dba5139a23286a8aaac14f.png","icon_POT_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_jumbo-ea11c841b985819ed7f75492e5dbce94.png","icon_POT_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_jumbo@2x-6fce37b667cdcafae14f477043b5cbea.png","icon_POT_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_small-6bdd2f4be5f9d40a842dd940bef46e34.png","icon_POT_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_POT_small@2x-2f8e86a5e68c64397b3447af624923f9.png","icon_PPTX_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_big-32b84565bf60e17e6a22fd13a3de770f.png","icon_PPTX_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_big@2x-83935843f499f3436043db220afd1743.png","icon_PPTX_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_enormous-6e96c318363b1d1dd8e90292698ff87f.png","icon_PPTX_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_enormous@2x-ccc6fca57218da507088d87ea03da5b2.png","icon_PPTX_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_jumbo-fce407474e6cbfd784e9433b140a0bb5.png","icon_PPTX_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_jumbo@2x-d45762d84d5d5e19760022c14ebb40fd.png","icon_PPTX_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_small-f9136dcc9de8efbceb01c0417dfbbf85.png","icon_PPTX_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPTX_small@2x-99b8c0df2f908d8aefabde539aff3e00.png","icon_PPT_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_big-62b90811d2ff51be87b3bd6386f9b2b3.png","icon_PPT_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_big@2x-898e0c0207d92d43581c63decebb7582.png","icon_PPT_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_enormous-0080fef9a5c3c6d493e308c74a431cde.png","icon_PPT_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_enormous@2x-4e5e789e276dad44c264e11cf63b1055.png","icon_PPT_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_jumbo-5dcab0a7393c729078a4ac40f1332479.png","icon_PPT_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_jumbo@2x-59b182e970df472eb5e8e0d26a4a5e6e.png","icon_PPT_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_small-22b7bc00b61c6adec945987a7a82f4b3.png","icon_PPT_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PPT_small@2x-09eb73b347e32b0661401a877e2dfd0a.png","icon_PSD_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_big-8b7c1c309e3e271c6f4fba057231b35f.png","icon_PSD_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_big@2x-5d9113cf9552e7bd29fec536bf4db61f.png","icon_PSD_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_enormous-af909a183b56961fa657750324460ba6.png","icon_PSD_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_enormous@2x-c24466fc46f6960d8aa3cc68d9cb20fd.png","icon_PSD_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_jumbo-22f554899abfcc89bb733406e25f4328.png","icon_PSD_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_jumbo@2x-01831daba03c82447e9a541d35fcc150.png","icon_PSD_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_small-9da89fde2c750bfc694ca01c9c292c70.png","icon_PSD_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_PSD_small@2x-6766dff255ad0925dec1ce308aa010ad.png","icon_RAR_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_big-f2cc3707c1e88c4158e0f0e49f98ab85.png","icon_RAR_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_big@2x-9245917bb1451935e0f2c1faed108040.png","icon_RAR_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_enormous-97c32ff2fd714400574313d55eefe650.png","icon_RAR_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_enormous@2x-923b525175ce60cf486e3e2178b77faf.png","icon_RAR_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_jumbo-ed88e2ad1dbb46c75426d8781c46b7bf.png","icon_RAR_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_jumbo@2x-7a93a3f3473c835191fe24d3ab36b3fa.png","icon_RAR_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_small-b9cb52d762a8fd75760ea3f145e98236.png","icon_RAR_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RAR_small@2x-9d569d48e50a00c48a87a0ee4c7b1d6c.png","icon_RM_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_big-cb502fb3e229795563ebe01cf1337c4e.png","icon_RM_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_big@2x-73d29039529ab94e1fc700271dedf3a9.png","icon_RM_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_enormous-0f5dc57ba84fbf39a6a5c97066035038.png","icon_RM_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_enormous@2x-b0efbf45a2767605761b9833b934efdd.png","icon_RM_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_jumbo-059a21978cb8df773b049e542e8c2520.png","icon_RM_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_jumbo@2x-5b831f5338b3d435ff7937e290b45043.png","icon_RM_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_small-837c5ad9c32dc8d2dd976393c8b8bc47.png","icon_RM_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RM_small@2x-3072ddad4349dd31538ef728cac01771.png","icon_RTF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_big-88762e0ee2b75ed9d3112e3d7ac2be98.png","icon_RTF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_big@2x-c28051d8ddec65ef11de687ee198dc5f.png","icon_RTF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_enormous-9cf9d160df15744f458b3e7b1241cd47.png","icon_RTF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_enormous@2x-36b170b3947dee82366282ab948d1d6d.png","icon_RTF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_jumbo-bacefd2408a142d02eb6fedf3ab6113a.png","icon_RTF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_jumbo@2x-dca3dbe02f42e7c42ce66f50679c225c.png","icon_RTF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_small-6e3d61ad4e4a83618ef2b619e8fbc22f.png","icon_RTF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_RTF_small@2x-458cc66660531ce7786344e6a564489a.png"
,"icon_SIT_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_big-88df891b55f77d04b14abfcbcefeb5d2.png","icon_SIT_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_big@2x-103acaffcb46e0c559bbcb2eb43c76e0.png","icon_SIT_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_enormous-bc23126ef636e564bfa1b58844b6a524.png","icon_SIT_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_enormous@2x-c643db1b571345ce27fa3e2b3cf56c15.png","icon_SIT_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_jumbo-56248c7bb7d74597decab793b02903f4.png","icon_SIT_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_jumbo@2x-2e9751e0ae078e23e015c5310f4cf027.png","icon_SIT_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_small-9db54b12b919cb20d08344049f329072.png","icon_SIT_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SIT_small@2x-9e829da9d7d3e47b13db85b719497a56.png","icon_SWF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_big-f0af3df43b38509b96a856b6f084e028.png","icon_SWF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_big@2x-dbb12aff950cad2e118bfca329d0ee2c.png","icon_SWF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_enormous-11aa7516b13ef21e8aa5ca2754a3184b.png","icon_SWF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_enormous@2x-c95fc6dfd0c5b2e86b36e9ed6d42a45a.png","icon_SWF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_jumbo-4555b73d229468aeabaa89203a5d9477.png","icon_SWF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_jumbo@2x-946655d4a961e4e4632eb995ae6b8829.png","icon_SWF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_small-a61bfdfd94cdbb8688868056b4ce8dcd.png","icon_SWF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_SWF_small@2x-0366820860ccdf4fafb47a862557b21e.png","icon_TAR_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_big-b5bae8e2d3592489641736834d46b4e1.png","icon_TAR_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_big@2x-6aa28767e29180fd56b4ef5ed557898f.png","icon_TAR_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_enormous-3fc926b826f3757c3611e739e773bcc2.png","icon_TAR_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_enormous@2x-4affd1b10917f57e32ac52f0f828180e.png","icon_TAR_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_jumbo-d04c3860d88fb33b3ab2824af2d32869.png","icon_TAR_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_jumbo@2x-f9e520d46159a98eef7658a02b74d304.png","icon_TAR_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_small-4e19b9f1fa86a003e7d9b55a63bbbad1.png","icon_TAR_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TAR_small@2x-17d0e57ba05761bcf849d377716cafd3.png","icon_TGZ_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_big-284927f5c0c6bc0e775e7c6e8f897a31.png","icon_TGZ_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_big@2x-44daffb839711e0febf4d2d8cb34fbec.png","icon_TGZ_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_enormous-15173926d683ceca3879c827fa0f958e.png","icon_TGZ_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_enormous@2x-d18cfb313b2c120f2426d497172225ed.png","icon_TGZ_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_jumbo-64123ee0cda81bb4a809701f91f17614.png","icon_TGZ_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_jumbo@2x-3d42db5ecb2db1d0df160a564a80b9a6.png","icon_TGZ_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_small-2fc256aa71550b2e4b74e8c58a9f31ca.png","icon_TGZ_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TGZ_small@2x-37c8e9beff289f4dbaf6438a94e6fcd0.png","icon_TIFF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_big-b73a2057333e4b0686b548116a57131b.png","icon_TIFF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_big@2x-02820b2f75386f37d634d75665de6bd5.png","icon_TIFF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_enormous-9eae2caf1f277e1873932b74adc1cadc.png","icon_TIFF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_enormous@2x-a2282a0b5e5fa6fd1af1f3a0e648e143.png","icon_TIFF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_jumbo-7cc0cdd289b99698c82d823e73be0d87.png","icon_TIFF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_jumbo@2x-b511c8e071979560cc21bf053a51e886.png","icon_TIFF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_small-160f09cfe60f0cf0c30b96717d123059.png","icon_TIFF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIFF_small@2x-8a68435a679827560fec1f723da4eb5c.png","icon_TIF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_big-49afb902b3d41e893da4dc0f970f3b3c.png","icon_TIF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_big@2x-7d6a9ccdb059e42b5e97e3552fc5e7f4.png","icon_TIF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_enormous-914e3592703dacc64ba207a9d7f7e768.png","icon_TIF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_enormous@2x-05df00eccf9baa9c4cef78b1fed776a3.png","icon_TIF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_jumbo-75ed677abaf97a46616846cc60984fea.png","icon_TIF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_jumbo@2x-3033387aa6021fca5f9dd455bde9acca.png","icon_TIF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_small-befa4ab5a65839499af4b97280feba0c.png","icon_TIF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TIF_small@2x-6f8ee5ab5d767a0ff844e7c47f4ad434.png","icon_TXT_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_big-cd6497ff5892fb435dee58678825b90c.png","icon_TXT_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_big@2x-41b7410c71d6b63e30d5df9afc8688c0.png","icon_TXT_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_enormous-23358e60abf246f38faff702065ae489.png","icon_TXT_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_enormous@2x-06830b58d6d7762402327c99c67721d1.png","icon_TXT_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_jumbo-ae17e5f069bea2f623b401439e36099c.png","icon_TXT_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_jumbo@2x-1222faffd8ac324a9337170416b6d20d.png","icon_TXT_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_small-94c5f1a3f5cc020215377ccead4d8abc.png","icon_TXT_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_TXT_small@2x-e75e3d9d986eee1fd2c0f86aac279224.png","icon_VCF_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_big-f114e067b5697b5fe35fd509abeea08b.png","icon_VCF_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_big@2x-2e22bd21fbfef2fa7a6bf820ca5cda2f.png","icon_VCF_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_enormous-0e6068a1f3c4ddc723c12d00d0ffb19e.png","icon_VCF_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_enormous@2x-c004bbf53326bfef35e208b946c6f454.png","icon_VCF_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_jumbo-2da5a5e28b76dfeb0f7db0ce6f42dd98.png","icon_VCF_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_jumbo@2x-07a661357da78bd948ce5397307f8a6f.png","icon_VCF_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_small-619a8097b199b02e7892a934aa038f38.png","icon_VCF_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VCF_small@2x-33a47327e051e69b3d36b108cde0f844.png","icon_VSD_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_big-077da3266044e86db54bbcc4e048c1bc.png","icon_VSD_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_big@2x-1f517eacd53d29aadb950df94b32fd56.png","icon_VSD_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_enormous-c1eb71cef93fd261c21299bad2e77dd5.png","icon_VSD_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_enormous@2x-25f5072e6473e3d4b0d399d93be23eef.png","icon_VSD_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_jumbo-1f41fd6c3f1740a1c09f8394d5778293.png","icon_VSD_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_jumbo@2x-814d44c4c1e7676c974ad7443e809300.png","icon_VSD_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_small-05db95eadbaed8e002a5a1ff44bb3bfc.png","icon_VSD_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_VSD_small@2x-890331c36a582ba571ce69b0c8b16b01.png","icon_WAV_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_big-f04cb56d1d4cf7756fc56ee2ca99ab93.png","icon_WAV_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_big@2x-1a364946e2d0a20cdc117903fb5791f5.png","icon_WAV_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_enormous-098e9e4316acc3ca516176742a5c583b.png","icon_WAV_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_enormous@2x-78eea42f1f49c270398daad3352b6e53.png","icon_WAV_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_jumbo-e5d484173efcb4ece8ae7eeb79ec204c.png","icon_WAV_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_jumbo@2x-6dae433e7d1404a85b581d5ff6b13e5c.png","icon_WAV_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_small-d7dcdd78b5985d453e8833d906625ebb.png","icon_WAV_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WAV_small@2x-33707d108a5d824db9e59ea103d61498.png","icon_WEB_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_big-37ad12e72e818aacc06ceed9ee80af54.png","icon_WEB_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_big@2x-9b03050c36f1debcdd2b370afed02a7d.png","icon_WEB_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_enormous-563280dd6256eb4d404ac588de41e33d.png","icon_WEB_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_enormous@2x-0b935752f2d3936e7caedd39002e9bac.png","icon_WEB_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_jumbo-166ce1c79f5197a89a63f6aa72ab6e64.png","icon_WEB_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_jumbo@2x-25fcbf12971ad024237137c22d159cc2.png","icon_WEB_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_small-85beca6d7f62813e471d60716b82e81c.png","icon_WEB_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WEB_small@2x-9b22a65958bd2005cddb6cfcba85b850.png","icon_WMA_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_big-3b437bdb49119f2102dcda055461f58c.png","icon_WMA_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_big@2x-af11c3bea12780d6d4303a904415520c.png","icon_WMA_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_enormous-be0cd40e3e578019c3e538cf0538f635.png","icon_WMA_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_enormous@2x-ce2521bb343892319b97a419d4e2aa6a.png","icon_WMA_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_jumbo-d226b7139427d668725f27d2bf7c4239.png","icon_WMA_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_jumbo@2x-c029f9fd1c774326eba1cf203b3096f9.png","icon_WMA_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_small-093a28285db29d9b8ea693d69d430fd7.png","icon_WMA_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMA_small@2x-c62784952f7c3b5b3f8f6a6617ee6569.png","icon_WMV_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_big-e34e56e79a083e5e2c90f584160d4200.png","icon_WMV_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_big@2x-3f9e06f5377f927a847b141c4d3ccf1a.png","icon_WMV_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_enormous-e5fda7df063a4681c7078f46503d1f6c.png","icon_WMV_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_enormous@2x-c2b9a408ef33a53c00d08fd0377f94e0.png","icon_WMV_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_jumbo-7b13da7971bff396a3fb173c5a5ed050.png","icon_WMV_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_jumbo@2x-8a32b980333a134ac45fe1f0a2e93b56.png","icon_WMV_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_small-54149f216a4be2dffc59f0fae8d534d0.png","icon_WMV_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_WMV_small@2x-8e3e2918357f733e1c5f6a2063ca65b7.png","icon_XLSX_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_big-7c0dca7678f468d33f174e5d70fc7898.png","icon_XLSX_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_big@2x-6013a2675253aadace67aa96e6e53ffc.png","icon_XLSX_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_enormous-f5fb8f52562225be9d377dd63af0c4fa.png","icon_XLSX_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_enormous@2x-6b681d8acdc431212a2c021a529ddaed.png","icon_XLSX_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_jumbo-bb72ddc28f820b1c0aad003c7dd814ea.png","icon_XLSX_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_jumbo@2x-8a8ff22e61c963e7c126644ad13f1e40.png","icon_XLSX_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_small-039c4ac94a2ebac2002345080bbeccf0.png","icon_XLSX_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLSX_small@2x-62065ce0136862ff13fc8798056e5506.png","icon_XLS_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_big-186e2c4e9a6dfcde7cc3c1bff04f78b8.png","icon_XLS_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_big@2x-c2fc8a076ee2ce0e7b8a74636f910c25.png","icon_XLS_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_enormous-7ac62dc4bf3bbba876d1296301345cfd.png","icon_XLS_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_enormous@2x-d56f26d9a952d425f2109cc0fd45f79e.png","icon_XLS_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_jumbo-d8ca83d29d04ba869f94d0984be850dd.png","icon_XLS_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_jumbo@2x-8e2328130098ff1144f22efb62623871.png","icon_XLS_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_small-57887445e7cd59a7fd6946285b969e33.png","icon_XLS_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_XLS_small@2x-82df2645e4cea6e1b33de6bfa9152cb7.png","icon_ZIP_big.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_big-f0a78653ef58611e96b931a1ade13f0e.png","icon_ZIP_big@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_big@2x-0164b1b2fc1614eced138eda75689f23.png","icon_ZIP_enormous.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_enormous-b93566101c8d35bfd44a441af7c27fd7.png","icon_ZIP_enormous@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_enormous@2x-062c037e9977506b7a247ddd6ba7dc93.png","icon_ZIP_jumbo.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_jumbo-edb8f8be93a14ae228625af6d237f23d.png","icon_ZIP_jumbo@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_jumbo@2x-0c2cb915dcd33e45f8a96c5ba244b52d.png","icon_ZIP_small.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_small-f263884f7636b2bb4748a40c67c90431.png","icon_ZIP_small@2x.png":"https://bcx.basecamp-static.com/assets/file_icons/icon_ZIP_small@2x-5e02ad53dcefb07073654b90ec34584a.png"},path:function(e,t){return t==null&&(t="small"),FileIcons.asset(FileIcons.find(e),t)},asset:function(e,t){var n,r;return t==null&&(t="small"),n="icon_"+(e!=null?e:"Generic")+"_"+t+".png",(r=FileIcons.URLS[n])!=null?r:FileIcons.asset("Generic",t)},find:function(e){return FileIcons.LIB[e!=null?e.toUpperCase():void 0]}}}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,n){var r,i;this.options=n!=null?n:{},this.uninstall=t(this.uninstall,this),this.stop=t(this.stop,this),this.watchDistanceFromBottom=t(this.watchDistanceFromBottom,this),this.loadNextPage=t(this.loadNextPage,this),this.loadNextPageIfNearBottom=t(this.loadNextPageIfNearBottom,this),this.$container=$(e).addClass("infinite_page").on("infinite_page:uninstall",this.uninstall),(r=this.options).triggerDistance==null&&(r.triggerDistance=350),(i=this.options).url==null&&(i.url=""+window.location.pathname+".js"+window.location.search),this.setPage(this.$container.attr("data-infinite-page")),this.ajax=null,this.done=!1,this.options.immediate!=null?this.loadAll():(this.loadNextPageIfNearBottom(),this.watchDistanceFromBottom())}return e.install=function(e,t){if(!$(e).data("infinitePageInstalled"))return new this(e,t),$(e).data("infinitePageInstalled",!0)},e.prototype.loadAll=function(){var e;return this.loadNextPage(e=function(t){return function(){if(!t.done)return t.loadNextPage(e)}}(this))},e.prototype.distanceFromBottom=function(){return $(document).height()-$(window).height()-$(window).scrollTop()},e.prototype.loadNextPageIfNearBottom=function(){if(this.distanceFromBottom()<this.options.triggerDistance)return this.$container.is(":visible")?this.loadNextPage():this.stop()},e.prototype.setPage=function(e){return e==null&&(e=2),this.page=parseInt(e),this.$container.attr("data-infinite-page",this.page)},e.prototype.loadNextPage=function(e){var t;if(this.ajax&&this.ajax.readyState<4&&this.ajax.readyState>0)return;return this.$container.addClass("busy").trigger("infinite_page:start"),this.ajax=$.ajax({type:"GET",dataType:"html",url:this.options.url,data:$.extend({page:this.page},(t=this.options.data)!=null?t:{}),success:function(t){return function(n){return t.$container.removeClass("busy"),$.trim(n)||t.stop(),t.$container.append(n).trigger("infinite_page:load"),t.setPage(t.page+1),typeof e=="function"?e():void 0}}(this),error:function(e){return function(){return e.stop()}}(this)})},e.prototype.watchDistanceFromBottom=function(){return this.throttledLoadNextPageIfNearBottom=_.throttle(function(e){return function(){return e.loadNextPageIfNearBottom()}}(this),100),$(window).bind("scroll",this.throttledLoadNextPageIfNearBottom)},e.prototype.stop=function(){this.done=!0,this.$container.removeClass("infinite_page busy").trigger("infinite_page:stop");if(this.throttledLoadNextPageIfNearBottom!=null)return $(window).unbind("scroll",this.throttledLoadNextPageIfNearBottom)},e.prototype.uninstall=function(){return this.stop(),this.$container.off("infinite_page:uninstall").removeAttr("data-infinite-page").data("infinitePageInstalled",!1)},e}(),$.fn.infinitePage=function(t){return this.each(function(){return e.install(this,t)})}}.call(this);var wysihtml5={version:"0.4.0pre",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"﻿",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};(function(e,t){typeof define=="function"&&define.amd?define(e):typeof module!="undefined"&&typeof exports=="object"?module.exports=e():t.rangy=e()})(function(){function u(n,r){var i=typeof n[r];return i==t||i==e&&!!n[r]||i=="unknown"}function a(t,n){return typeof t[n]==e&&!!t[n]}function f(e,t){return typeof e[t]!=n}function l(e){return function(t,n){var r=n.length;while(r--)if(!e(t,n[r]))return!1;return!0}}function d(e){return e&&c(e,o)&&p(e,s)}function v(e){return a(e,"body")?e.body:e.getElementsByTagName("body")[0]}function w(e){typeof console!=n&&u(console,"log")&&console.log(e)}function E(e,t){g&&t?alert(e):w(e)}function S(e){b.initialized=!0,b.supported=!1,E("Rangy is not supported in this environment. Reason: "+e,b.config.alertOnFail)}function x(e){E("Rangy warning: "+e,b.config.alertOnWarn)}function k(e){return e.message||e.description||String(e)}function L(){if(!g||b.initialized)return;var e,t=!1,n=!1;u(document,"createRange")&&(e=document.createRange(),c(e,i)&&p(e,r)&&(t=!0));var s=v(document);if(!s||s.nodeName.toLowerCase()!="body"){S("No body element found");return}s&&u(s,"createTextRange")&&(e=s.createTextRange(),d(e)&&(n=!0));if(!t&&!n){S("Neither Range nor TextRange are available");return}b.initialized=!0,b.features={implementsDomRange:t,implementsTextRange:n};var o,a;for(var f in m)(o=m[f])instanceof M&&o.init(o,b);for(var l=0,h=C.length;l<h;++l)try{C[l](b)}catch(y){a="Rangy init listener threw an exception. Continuing. Detail: "+k(y),w(a)}}function O(e){e=e||window,L();for(var t=0,n=A.length;t<n;++t)A[t](e)}function M(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function _(e,t,n){var r=new M(e,t,function(t){if(!t.initialized){t.initialized=!0;try{n(b,t),t.supported=!0}catch(r){var i="Module '"+e+"' failed to load: "+k(r);w(i),r.stack&&w(r.stack)}}});return m[e]=r,r}function D(){}function P(){}var e="object",t="function",n="undefined",r=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],i=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],s=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],o=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],c=l(u),h=l(a),p=l(f),m={},g=typeof window!=n&&typeof document!=n,y={isHostMethod:u,isHostObject:a,isHostProperty:f,areHostMethods:c,areHostObjects:h,areHostProperties:p,isTextRange:d,getBody:v},b={version:"1.3.0-alpha.20150122",initialized:!1,isBrowser:g,supported:!0,util:y,features:{},modules:m,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==n?!0:rangyAutoInitialize}};b.fail=S,b.warn=x;var T;(({})).hasOwnProperty?(y.extend=T=function(e,t,n){var r,i;for(var s in t)t.hasOwnProperty(s)&&(r=e[s],i=t[s],n&&r!==null&&typeof r=="object"&&i!==null&&typeof i=="object"&&T(r,i,!0),e[s]=i);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},y.createOptions=function(e,t){var n={};return T(n,t),e&&T(n,e),n}):S("hasOwnProperty not supported"),g||S("Rangy can only run in a browser"),function(){var e;if(g){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{n.call(t.childNodes,0)[0].nodeType==1&&(e=function(e){return n.call(e,0)})}catch(r){}}e||(e=function(e){var t=[];for(var n=0,r=e.length;n<r;++n)t[n]=e[n];return t}),y.toArray=e}();var N;g&&(u(document,"addEventListener")?N=function(e,t,n){e.addEventListener(t,n,!1)}:u(document,"attachEvent")?N=function(e,t,n){e.attachEvent("on"+t,n)}:S("Document does not have required addEventListener or attachEvent method"),y.addListener=N);var C=[];b.init=L,b.addInitListener=function(e){b.initialized?e(b):C.push(e)};var A=[];b.addShimListener=function(e){A.push(e)},g&&(b.shim=b.createMissingNativeApi=O),M.prototype={init:function(){var e=this.dependencies||[];for(var t=0,n=e.length,r,i;t<n;++t){i=e[t],r=m[i];if(!r||!(r instanceof M))throw new Error("required module '"+i+"' not found");r.init();if(!r.supported)throw new Error("required module '"+i+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},warn:function(e){b.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){b.warn("DEPRECATED: "+e+" in module "+this.name+"is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},b.createModule=function(e){var t,n;arguments.length==2?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var r=_(e,n,t);b.initialized&&b.supported&&r.init()},b.createCoreModule=function(e,t,n){_(e,t,n)},b.RangePrototype=D,b.rangePrototype=new D,b.selectionPrototype=new P,b.createCoreModule("DomUtil",[],function(e,t){function u(e){var t;return typeof e.namespaceURI==n||(t=e.namespaceURI)===null||t=="http://www.w3.org/1999/xhtml"}function a(e){var t=e.parentNode;return t.nodeType==1?t:null}function f(e){var t=0;while(e=e.previousSibling)++t;return t}function l(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function c(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(o(n,r))return r;return null}function h(e,t,n){var r=n?t:t.parentNode;while(r){if(r===e)return!0;r=r.parentNode}return!1}function p(e,t){return h(e,t,!0)}function d(e,t,n){var r,i=n?e:e.parentNode;while(i){r=i.parentNode;if(r===t)return i;i=r}return null}function v(e){var t=e.nodeType;return t==3||t==4||t==8}function m(e){if(!e)return!1;var t=e.nodeType;return t==3||t==8}function g(e,t){var n=t.nextSibling,r=t.parentNode;return n?r.insertBefore(e,n):r.appendChild(e),e}function y(e,t,n){var r=e.cloneNode(!1);r.deleteData(0,t),e.deleteData(t,e.length-t),g(r,e);if(n)for(var i=0,s;s=n[i++];)s.node==e&&s.offset>t?(s.node=r,s.offset-=t):s.node==e.parentNode&&s.offset>f(e)&&++s.offset;return r}function b(e){if(e.nodeType==9)return e;if(typeof e.ownerDocument!=n)return e.ownerDocument;if(typeof e.document!=n)return e.document;if(e.parentNode)return b(e.parentNode);throw t.createError("getDocument: no document found for node")}function w(e){var r=b(e);if(typeof r.defaultView!=n)return r.defaultView;if(typeof r.parentWindow!=n)return r.parentWindow;throw t.createError("Cannot get a window object for node")}function E(e){if(typeof e.contentDocument!=n)return e.contentDocument;if(typeof e.contentWindow!=n)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function S(e){if(typeof e.contentWindow!=n)return e.contentWindow;if(typeof e.contentDocument!=n)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function x(e){return e&&r.isHostMethod(e,"setTimeout")&&r.isHostObject(e,"document")}function T(e,t,n){var i;e?r.isHostProperty(e,"nodeType")?i=e.nodeType==1&&e.tagName.toLowerCase()=="iframe"?E(e):b(e):x(e)&&(i=e.document):i=document;if(!i)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return i}function N(e){var t;while(t=e.parentNode)e=t;return e}function C(e,n,r,i){var s,o,u,a,l;if(e==r)return n===i?0:n<i?-1:1;if(s=d(r,e,!0))return n<=f(s)?-1:1;if(s=d(e,r,!0))return f(s)<i?-1:1;o=c(e,r);if(!o)throw new Error("comparePoints error: nodes have no common ancestor");u=e===o?o:d(e,o,!0),a=r===o?o:d(r,o,!0);if(u===a)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");l=o.firstChild;while(l){if(l===u)return-1;if(l===a)return 1;l=l.nextSibling}}function L(e){var t;try{return t=e.parentNode,!1}catch(n){return!0}}function A(e){if(!e)return"[No node]";if(k&&L(e))return"[Broken node]";if(v(e))return'"'+e.data+'"';if(e.nodeType==1){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+f(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function O(e){var t=b(e).createDocumentFragment(),n;while(n=e.firstChild)t.appendChild(n);return t}function _(e){this.root=e,this._next=e}function D(e){return new _(e)}function P(e,t){this.node=e,this.offset=t}function H(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var n="undefined",r=e.util;r.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),r.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var i=document.createElement("div");r.areHostMethods(i,["insertBefore","appendChild","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),r.isHostProperty(i,"innerHTML")||t.fail("Element is missing innerHTML property");var s=document.createTextNode("test");r.areHostMethods(s,["splitText","deleteData","insertData","appendData","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"])||!r.areHostProperties(s,["data"]))||t.fail("Incomplete Text Node implementation");var o=function(e,t){var n=e.length;while(n--)if(e[n]===t)return!0;return!1},k=!1;(function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br />",k=L(n),e.features.crashyTextNodes=k})();var M;typeof window.getComputedStyle!=n?M=function(e,t){return w(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=n?M=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found"),_.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t,n;if(this._current){t=e.firstChild;if(t)this._next=t;else{n=null;while(e!==this.root&&!(n=e.nextSibling))e=e.parentNode;this._next=n}}return this._current},detach:function(){this._current=this._next=this.root=null}},P.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+A(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},H.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},H.prototype.toString=function(){return this.message},e.dom={arrayContains:o,isHtmlNamespace:u,parentElement:a,getNodeIndex:f,getNodeLength:l,getCommonAncestor:c,isAncestorOf:h,isOrIsAncestorOf:p,getClosestAncestorIn:d,isCharacterDataNode:v,isTextOrCommentNode:m,insertAfter:g,splitDataNode:y,getDocument:b,getWindow:w,getIframeWindow:S,getIframeDocument:E,getBody:r.getBody,isWindow:x,getContentDocument:T,getRootContainer:N,comparePoints:C,isBrokenNode:L,inspectNode:A,getComputedStyleProperty:M,fragmentFromNodeChildren:O,createIterator:D,DomPosition:P},e.DOMException=H}),b.createCoreModule("DomRange",["DomUtil"],function(e,t){function g(e,t){return e.nodeType!=3&&(a(e,t.startContainer)||a(e,t.endContainer))}function y(e){return e.document||f(e.startContainer)}function b(e){return new i(e.parentNode,u(e))}function w(e){return new i(e.parentNode,u(e)+1)}function E(e,t,r){var i=e.nodeType==11?e.firstChild:e;return o(t)?r==t.length?n.insertAfter(e,t):t.parentNode.insertBefore(e,r==0?t:c(t,r)):r>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[r]),i}function S(e,t,n){J(e),J(t);if(y(t)!=y(e))throw new s("WRONG_DOCUMENT_ERR");var r=l(e.startContainer,e.startOffset,t.endContainer,t.endOffset),i=l(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?r<=0&&i>=0:r<0&&i>0}function x(e){var t;for(var n,r=y(e.range).createDocumentFragment(),i;n=e.next();){t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(i=e.getSubtreeIterator(),n.appendChild(x(i)),i.detach());if(n.nodeType==10)throw new s("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function T(e,t,r){var i,s;r=r||{stop:!1};for(var o,u;o=e.next();)if(e.isPartiallySelectedSubtree()){if(t(o)===!1){r.stop=!0;return}u=e.getSubtreeIterator(),T(u,t,r),u.detach();if(r.stop)return}else{i=n.createIterator(o);while(s=i.next())if(t(s)===!1){r.stop=!0;return}}}function N(e){var t;while(e.next())e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),N(t),t.detach()):e.remove()}function C(e){for(var t,n=y(e.range).createDocumentFragment(),r;t=e.next();){e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),r=e.getSubtreeIterator(),t.appendChild(C(r)),r.detach()):e.remove();if(t.nodeType==10)throw new s("HIERARCHY_REQUEST_ERR"
);n.appendChild(t)}return n}function k(e,t,n){var r=!!t&&!!t.length,i,s=!!n;r&&(i=new RegExp("^("+t.join("|")+")$"));var u=[];return T(new A(e,!1),function(t){if(r&&!i.test(t.nodeType))return;if(s&&!n(t))return;var a=e.startContainer;if(t==a&&o(a)&&e.startOffset==a.length)return;var f=e.endContainer;if(t==f&&o(f)&&e.endOffset==0)return;u.push(t)}),u}function L(e){var t=typeof e.getName=="undefined"?"Range":e.getName();return"["+t+"("+n.inspectNode(e.startContainer)+":"+e.startOffset+", "+n.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function A(e,t){this.range=e,this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&o(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===n&&!o(this.sc)?this.sc.childNodes[this.so]:h(this.sc,n,!0),this._last=this.ec===n&&!o(this.ec)?this.ec.childNodes[this.eo-1]:h(this.ec,n,!0))}}function H(e){return function(t,n){var r,i=n?t:t.parentNode;while(i){r=i.nodeType;if(d(e,r))return i;i=i.parentNode}return null}}function I(e,t){if(F(e,t))throw new s("INVALID_NODE_TYPE_ERR")}function q(e,t){if(!d(t,e.nodeType))throw new s("INVALID_NODE_TYPE_ERR")}function R(e,t){if(t<0||t>(o(e)?e.length:e.childNodes.length))throw new s("INDEX_SIZE_ERR")}function U(e,t){if(B(e,!0)!==B(t,!0))throw new s("WRONG_DOCUMENT_ERR")}function z(e){if(j(e,!0))throw new s("NO_MODIFICATION_ALLOWED_ERR")}function W(e,t){if(!e)throw new s(t)}function X(e){return m&&n.isBrokenNode(e)||!d(M,e.nodeType)&&!B(e,!0)}function V(e,t){return t<=(o(e)?e.length:e.childNodes.length)}function $(e){return!!e.startContainer&&!!e.endContainer&&!X(e.startContainer)&&!X(e.endContainer)&&V(e.startContainer,e.startOffset)&&V(e.endContainer,e.endOffset)}function J(e){if(!$(e))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function Z(e,t){J(e);var n=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,a=n===i;o(i)&&s>0&&s<i.length&&c(i,s,t),o(n)&&r>0&&r<n.length&&(n=c(n,r,t),a?(s-=r,i=n):i==n.parentNode&&s>=u(n)&&s++,r=0),e.setStartAndEnd(n,r,i,s)}function et(e){J(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function lt(e){e.START_TO_START=nt,e.START_TO_END=rt,e.END_TO_END=it,e.END_TO_START=st,e.NODE_BEFORE=ot,e.NODE_AFTER=ut,e.NODE_BEFORE_AND_AFTER=at,e.NODE_INSIDE=ft}function ct(e){lt(e),lt(e.prototype)}function ht(e,t){return function(){J(this);var n=this.startContainer,r=this.startOffset,i=this.commonAncestorContainer,s=new A(this,!0),o,u;n!==i&&(o=h(n,i,!0),u=w(o),n=u.node,r=u.offset),T(s,z),s.reset();var a=e(s);return s.detach(),t(this,n,r,n,r),a}}function pt(t,n){function i(e,t){return function(n){q(n,O),q(v(n),M);var r=(e?b:w)(n);(t?s:a)(this,r.node,r.offset)}}function s(e,t,r){var i=e.endContainer,s=e.endOffset;if(t!==e.startContainer||r!==e.startOffset){if(v(t)!=v(i)||l(t,r,i,s)==1)i=t,s=r;n(e,t,r,i,s)}}function a(e,t,r){var i=e.startContainer,s=e.startOffset;if(t!==e.endContainer||r!==e.endOffset){if(v(t)!=v(i)||l(t,r,i,s)==-1)i=t,s=r;n(e,i,s,t,r)}}var f=function(){};f.prototype=e.rangePrototype,t.prototype=new f,r.extend(t.prototype,{setStart:function(e,t){I(e,!0),R(e,t),s(this,e,t)},setEnd:function(e,t){I(e,!0),R(e,t),a(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],r=e[1],i=t,s=r;switch(e.length){case 3:s=e[2];break;case 4:i=e[2],s=e[3]}n(this,t,r,i,s)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:i(!0,!0),setStartAfter:i(!1,!0),setEndBefore:i(!0,!1),setEndAfter:i(!1,!1),collapse:function(e){J(this),e?n(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):n(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){I(e,!0),n(this,e,0,e,p(e))},selectNode:function(e){I(e,!1),q(e,O);var t=b(e),r=w(e);n(this,t.node,t.offset,r.node,r.offset)},extractContents:ht(C,n),deleteContents:ht(N,n),canSurroundContents:function(){J(this),z(this.startContainer),z(this.endContainer);var e=new A(this,!0),t=e._first&&g(e._first,this)||e._last&&g(e._last,this);return e.detach(),!t},splitBoundaries:function(){Z(this)},splitBoundariesPreservingPositions:function(e){Z(this,e)},normalizeBoundaries:function(){J(this);var e=this.startContainer,t=this.startOffset,r=this.endContainer,i=this.endOffset,s=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(r=e,i=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},a=function(n){var s=n.previousSibling;if(s&&s.nodeType==n.nodeType){e=n;var o=n.length;t=s.length,n.insertData(0,s.data),s.parentNode.removeChild(s);if(e==r)i+=t,r=e;else if(r==n.parentNode){var a=u(n);i==a?(r=n,i=o):i>a&&i--}}},f=!0;if(o(r))r.length==i&&s(r);else{if(i>0){var l=r.childNodes[i-1];l&&o(l)&&s(l)}f=!this.collapsed}if(f){if(o(e))t==0&&a(e);else if(t<e.childNodes.length){var c=e.childNodes[t];c&&o(c)&&a(c)}}else e=r,t=i;n(this,e,t,r,i)},collapseToPoint:function(e,t){I(e,!0),R(e,t),this.setStartAndEnd(e,t)}}),ct(t)}function dt(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:n.getCommonAncestor(e.startContainer,e.endContainer)}function vt(e,t,r,i,s){e.startContainer=t,e.startOffset=r,e.endContainer=i,e.endOffset=s,e.document=n.getDocument(t),dt(e)}function mt(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,dt(this)}var n=e.dom,r=e.util,i=n.DomPosition,s=e.DOMException,o=n.isCharacterDataNode,u=n.getNodeIndex,a=n.isOrIsAncestorOf,f=n.getDocument,l=n.comparePoints,c=n.splitDataNode,h=n.getClosestAncestorIn,p=n.getNodeLength,d=n.arrayContains,v=n.getRootContainer,m=e.features.crashyTextNodes;A.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,o(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e=this._current,t,n;!o(e)||e!==this.sc&&e!==this.ec?e.parentNode&&e.parentNode.removeChild(e):(t=e===this.sc?this.so:0,n=e===this.ec?this.eo:e.length,t!=n&&e.deleteData(t,n-t))},isPartiallySelectedSubtree:function(){var e=this._current;return g(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse(!1);else{e=new mt(y(this.range));var t=this._current,n=t,r=0,i=t,s=p(t);a(t,this.sc)&&(n=this.sc,r=this.so),a(t,this.ec)&&(i=this.ec,s=this.eo),vt(e,n,r,i,s)}return new A(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var O=[1,3,4,5,7,8,10],M=[2,9,11],_=[5,6,10,12],D=[1,3,4,5,7,8,10,11],P=[1,3,4,5,7,8],B=H([9,11]),j=H(_),F=H([6,10,12]),K=document.createElement("style"),Q=!1;try{K.innerHTML="<b>x</b>",Q=K.firstChild.nodeType==3}catch(G){}e.features.htmlParsingConforms=Q;var Y=Q?function(e){var t=this.startContainer,r=f(t);if(!t)throw new s("INVALID_STATE_ERR");var i=null;return t.nodeType==1?i=t:o(t)&&(i=n.parentElement(t)),i===null||i.nodeName=="HTML"&&n.isHtmlNamespace(f(i).documentElement)&&n.isHtmlNamespace(i)?i=r.createElement("body"):i=i.cloneNode(!1),i.innerHTML=e,n.fragmentFromNodeChildren(i)}:function(e){var t=y(this),r=t.createElement("body");return r.innerHTML=e,n.fragmentFromNodeChildren(r)},tt=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],nt=0,rt=1,it=2,st=3,ot=0,ut=1,at=2,ft=3;r.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){J(this),U(this.startContainer,t.startContainer);var n,r,i,s,o=e==st||e==nt?"start":"end",u=e==rt||e==nt?"start":"end";return n=this[o+"Container"],r=this[o+"Offset"],i=t[u+"Container"],s=t[u+"Offset"],l(n,r,i,s)},insertNode:function(e){J(this),q(e,D),z(this.startContainer);if(a(e,this.startContainer))throw new s("HIERARCHY_REQUEST_ERR");var t=E(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){J(this);var e,t;if(this.collapsed)return y(this).createDocumentFragment();if(this.startContainer===this.endContainer&&o(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=y(this).createDocumentFragment(),t.appendChild(e),t;var n=new A(this,!0);return e=x(n),n.detach(),e},canSurroundContents:function(){J(this),z(this.startContainer),z(this.endContainer);var e=new A(this,!0),t=e._first&&g(e._first,this)||e._last&&g(e._last,this);return e.detach(),!t},surroundContents:function(e){q(e,P);if(!this.canSurroundContents())throw new s("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())while(e.lastChild)e.removeChild(e.lastChild);E(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){J(this);var e=new mt(y(this)),t=tt.length,n;while(t--)n=tt[t],e[n]=this[n];return e},toString:function(){J(this);var e=this.startContainer;if(e===this.endContainer&&o(e))return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new A(this,!0);return T(n,function(e){(e.nodeType==3||e.nodeType==4)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){J(this);var t=e.parentNode,n=u(e);if(!t)throw new s("NOT_FOUND_ERR");var r=this.comparePoint(t,n),i=this.comparePoint(t,n+1);return r<0?i>0?at:ot:i>0?ut:ft},comparePoint:function(e,t){return J(this),W(e,"HIERARCHY_REQUEST_ERR"),U(e,this.startContainer),l(e,t,this.startContainer,this.startOffset)<0?-1:l(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Y,toHtml:function(){return et(this)},intersectsNode:function(e,t){J(this),W(e,"NOT_FOUND_ERR");if(f(e)!==y(this))return!1;var n=e.parentNode,r=u(e);W(n,"NOT_FOUND_ERR");var i=l(n,r,this.endContainer,this.endOffset),s=l(n,r+1,this.startContainer,this.startOffset);return t?i<=0&&s>=0:i<0&&s>0},isPointInRange:function(e,t){return J(this),W(e,"HIERARCHY_REQUEST_ERR"),U(e,this.startContainer),l(e,t,this.startContainer,this.startOffset)>=0&&l(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return S(this,e,!1)},intersectsOrTouchesRange:function(e){return S(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=l(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=l(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();return t==-1&&r.setStart(e.startContainer,e.startOffset),n==1&&r.setEnd(e.endContainer,e.endOffset),r}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return l(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset),l(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1&&t.setEnd(e.endContainer,e.endOffset),t}throw new s("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ft},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,p(e))<=0},containsRange:function(e){var t=this.intersection(e);return t!==null&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var r=n.pop();return t.setEnd(r,r.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return J(this),k(this,e,t)},getDocument:function(){return y(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var r=y(this),i=e.createRange(r);t=t||n.getBody(r),i.selectNodeContents(t);var s=this.intersection(i),o=0,u=0;return s&&(i.setEnd(s.startContainer,s.startOffset),o=i.toString().length,u=o+s.toString().length),{start:o,end:u,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);var r=[t],i,s=!1,o=!1,u,a,f;while(!o&&(i=r.pop()))if(i.nodeType==3)u=n+i.length,!s&&e.start>=n&&e.start<=u&&(this.setStart(i,e.start-n),s=!0),s&&e.end>=n&&e.end<=u&&(this.setEnd(i,e.end-n),o=!0),n=u;else{f=i.childNodes,a=f.length;while(a--)r.push(f[a])}},getName:function(){return"DomRange"},equals:function(e){return mt.rangesEqual(this,e)},isValid:function(){return $(this)},inspect:function(){return L(this)},detach:function(){}}),pt(mt,vt),r.extend(mt,{rangeProperties:tt,RangeIterator:A,copyComparisonConstants:ct,createPrototypeRange:pt,inspect:L,toHtml:et,getRangeDocument:y,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=mt}),b.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,r,i=e.dom,s=e.util,o=i.DomPosition,u=e.DomRange,a=i.getBody,f=i.getContentDocument,l=i.isCharacterDataNode;e.features.implementsDomRange&&function(){function l(e){var t=o.length,n;while(t--)n=o[t],e[n]=e.nativeRange[n];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function c(e,t,n,r,i){var s=e.startContainer!==t||e.startOffset!=n,o=e.endContainer!==r||e.endOffset!=i,u=!e.equals(e.nativeRange);if(s||o||u)e.setEnd(r,i),e.setStart(t,n)}var r,o=u.rangeProperties,h;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,l(this)},u.createPrototypeRange(n,c),r=n.prototype,r.selectNode=function(e){this.nativeRange.selectNode(e),l(this)},r.cloneContents=function(){return this.nativeRange.cloneContents()},r.surroundContents=function(e){this.nativeRange.surroundContents(e),l(this)},r.collapse=function(e){this.nativeRange.collapse(e),l(this)},r.cloneRange=function(){return new n(this.nativeRange.cloneRange())},r.refresh=function(){l(this)},r.toString=function(){return this.nativeRange.toString()};var p=document.createTextNode("test");a(document).appendChild(p);var d=document.createRange();d.setStart(p,0),d.setEnd(p,0);try{d.setStart(p,1),r.setStart=function(e,t){this.nativeRange.setStart(e,t),l(this)},r.setEnd=function(e,t){this.nativeRange.setEnd(e,t),l(this)},h=function(e){return function(t){this.nativeRange[e](t),l(this)}}}catch(v){r.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}l(this)},r.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}l(this)},h=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(r){this.nativeRange[t](n),this.nativeRange[e](n)}l(this)}}}r.setStartBefore=h("setStartBefore","setEndBefore"),r.setStartAfter=h("setStartAfter","setEndAfter"),r.setEndBefore=h("setEndBefore","setStartBefore"),r.setEndAfter=h("setEndAfter","setStartAfter"),r.selectNodeContents=function(e){this.setStartAndEnd(e,0,i.getNodeLength(e))},d.selectNodeContents(p),d.setEnd(p,3);var m=document.createRange();m.selectNodeContents(p),m.setEnd(p,4),m.setStart(p,2),d.compareBoundaryPoints(d.START_TO_END,m)==-1&&d.compareBoundaryPoints(d.END_TO_START,m)==1?r.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:r.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var g=document.createElement("div");g.innerHTML="123";var y=g.firstChild,b=a(document);b.appendChild(g),d.setStart(y,1),d.setEnd(y,2),d.deleteContents(),y.data=="13"&&(r.deleteContents=function(){this.nativeRange.deleteContents(),l(this)},r.extractContents=function(){var e=this.nativeRange.extractContents();return l(this),e}),b.removeChild(g),b=null,s.isHostMethod(d,"createContextualFragment")&&(r.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),a(document).removeChild(p),r.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return e=f(e,t,"createNativeRange"),e.createRange()}}();if(e.features.implementsTextRange){var c=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var r=n.parentElement();n=e.duplicate(),n.collapse(!1);var s=n.parentElement(),o=r==s?r:i.getCommonAncestor(r,s);return o==t?o:i.getCommonAncestor(t,o)},h=function(e){return e.compareEndPoints("StartToEnd",e)==0},p=function(e,t,n,r,s){var u=e.duplicate();u.collapse(n);var a=u.parentElement();i.isOrIsAncestorOf(t,a)||(a=t);if(!a.canHaveHTML){var f=new o(a.parentNode,i.getNodeIndex(a));return{boundaryPosition:f,nodeInfo:{nodeIndex:f.offset,containerElement:f.node}}}var c=i.getDocument(a).createElement("span");c.parentNode&&c.parentNode.removeChild(c);var h,p=n?"StartToStart":"StartToEnd",d,v,m,g,y=s&&s.containerElement==a?s.nodeIndex:0,b=a.childNodes.length,w=b,E=w;for(;;){E==b?a.appendChild(c):a.insertBefore(c,a.childNodes[E]),u.moveToElementText(c),h=u.compareEndPoints(p,e);if(h==0||y==w)break;if(h==-1){if(w==y+1)break;y=E}else w=w==y+1?y:E;E=Math.floor((y+w)/2),a.removeChild(c)}g=c.nextSibling;if(h==-1&&g&&l(g)){u.setEndPoint(n?"EndToStart":"EndToEnd",e);var S;if(/[\r\n]/.test(g.data)){var x=u.duplicate(),T=x.text.replace(/\r\n/g,"\r").length;S=x.moveStart("character",T);while((h=x.compareEndPoints("StartToEnd",x))==-1)S++,x.moveStart("character",1)}else S=u.text.length;m=new o(g,S)}else d=(r||!n)&&c.previousSibling,v=(r||n)&&c.nextSibling,v&&l(v)?m=new o(v,0):d&&l(d)?m=new o(d,d.data.length):m=new o(a,i.getNodeIndex(c));return c.parentNode.removeChild(c),{boundaryPosition:m,nodeInfo:{nodeIndex:E,containerElement:a}}},d=function(e,t){var n,r,s=e.offset,o=i.getDocument(e.node),u,f,c=a(o).createTextRange(),h=l(e.node);return h?(n=e.node,r=n.parentNode):(f=e.node.childNodes,n=s<f.length?f[s]:null,r=e.node),u=o.createElement("span"),u.innerHTML="&#feff;",n?r.insertBefore(u,n):r.appendChild(u),c.moveToElementText(u),c.collapse(!t),r.removeChild(u),h&&c[t?"moveStart":"moveEnd"]("character",s),c};r=function(e){this.textRange=e,this.refresh()},r.prototype=new u(document),r.prototype.refresh=function(){var e,t,n,r=c(this.textRange);h(this.textRange)?t=e=p(this.textRange,r,!0,!0).boundaryPosition:(n=p(this.textRange,r,!0,!1),e=n.boundaryPosition,t=p(this.textRange,r,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},r.prototype.getName=function(){return"WrappedTextRange"},u.copyComparisonConstants(r);var v=function(e){if(e.collapsed)return d(new o(e.startContainer,e.startOffset),!0);var t=d(new o(e.startContainer,e.startOffset),!0),n=d(new o(e.endContainer,e.endOffset),!1),r=a(u.getRangeDocument(e)).createTextRange();return r.setEndPoint("StartToStart",t),r.setEndPoint("EndToEnd",n),r};r.rangeToTextRange=v,r.prototype.toTextRange=function(){return v(this)},e.WrappedTextRange=r;if(!e.features.implementsDomRange||e.config.preferTextRange){var m=function(e){return e("return this;")()}(Function);typeof m.Range=="undefined"&&(m.Range=r),e.createNativeRange=function(e){return e=f(e,t,"createNativeRange"),a(e).createTextRange()},e.WrappedRange=r}}e.createRange=function(n){return n=f(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=f(e,t,"createRangyRange"),new u(e)},e.createIframeRange=function(n){return t.deprecationNotice("createIframeRange()","createRange(iframeEl)"),e.createRange(n)},e.createIframeRangyRange=function(n){return t.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),e.createRangyRange(n)},e.addShimListener(function(t){var n=t.document;typeof n.createRange=="undefined"&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),b.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){function y(e){return typeof e=="string"?/^backward(s)?$/i.test(e):!!e}function b(e,n){if(!e)return window;if(i.isWindow(e))return e;if(e instanceof J)return e.win;var r=i.getContentDocument(e,t,n);return i.getWindow(r)}function w(e){return b(e,"getWinSelection").getSelection()}function E(e){return b(e,"getDocSelection").document.selection}function S(e){var t=!1;return e.anchorNode&&(t=i.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1),t}function j(e,t,n){var r=n?"end":"start",i=n?"start":"end";e.anchorNode=t[r+"Container"],e.anchorOffset=t[r+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function F(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function I(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function q(t){var n;return t instanceof u?(n=e.createNativeRange(t.getDocument()),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof a?n=t.nativeRange:p.implementsDomRange&&t instanceof i.getWindow(t.startContainer).Range&&(n=t),n}function R(e){if(!e.length||e[0].nodeType!=1)return!1;for(var t=1,n=e.length;t<n;++t)if(!i.isAncestorOf(e[0],e[t]))return!1;return!0}function U(e){var n=e.getNodes();if(!R(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function z(e){return!!e&&typeof e.text!="undefined"}function W(e,t){var n=new a(t);e._ranges=[n],j(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function X(t){t._ranges.length=0;if(t.docSelection.type=="None")I(t);else{var n=t.docSelection.createRange();if(z(n))W(t,n);else{t.rangeCount=n.length;var r,i=v(n.item(0));for(var s=0;s<t.rangeCount;++s)r=e.createRange(i),r.selectNode(n.item(s)),t._ranges.push(r);t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed,j(t,t._ranges[t.rangeCount-1],!1)}}}function V(e,n){var r=e.docSelection.createRange(),i=U(n),s=v(r.item(0)),o=m(s).createControlRange();for(var u=0,a=r.length;u<a;++u)o.add(r.item(u));try{o.add(i)}catch(f){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}o.select(),X(e)}function J(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function K(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function G(e,t){var n=Q.length,r,i;while(n--){r=Q[n],i=r.selection;if(t=="deleteAll")K(i);else if(r.win==e)return t=="delete"?(Q.splice(n,1),!0):i}return t=="deleteAll"&&(Q.length=0),null}function et(e,n){var r=v(n[0].startContainer),i=m(r).createControlRange();for(var s=0,o,u=n.length;s<u;++s){o=U(n[s]);try{i.add(o)}catch(a){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}i.select(),X(e)}function st(e,t){if(e.win.document!=v(t))throw new f("WRONG_DOCUMENT_ERR")}function ot(t){return function(n,r){var i;this.rangeCount?(i=this.getRangeAt(0),i["set"+(t?"Start":"End")](n,r)):(i=e.createRange(this.win.document),i.setStartAndEnd(n,r)),this.setSingleRange(i,this.isBackward())}}function ut(e){var t=[],n=new l(e.anchorNode,e.anchorOffset),r=new l(e.focusNode,e.focusOffset),i=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined")for(var s=0,o=e.rangeCount;s<o;++s)t[s]=u.inspect(e.getRangeAt(s));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.config.checkSelectionRanges=!0;var n="boolean",r="number",i=e.dom,s=e.util,o=s.isHostMethod,u=e.DomRange,a=e.WrappedRange,f=e.DOMException,l=i.DomPosition,c,h,p=e.features,d="Control",v=i.getDocument,m=i.getBody,g=u.rangesEqual,x=o(window,"getSelection"),T=s.isHostObject(document,"selection");p.implementsWinGetSelection=x,p.implementsDocSelection=T;var N=T&&(!x||e.config.preferTextRange);N?(c=E,e.isSelectionValid=function(e){var t=b(e,"isSelectionValid").document,n=t.selection;return n.type!="None"||v(n.createRange().parentElement())==t}):x?(c=w,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=c;var C=c(),k=e.createNativeRange(document),L=m(document),A=s.areHostProperties(C,["anchorNode","focusNode","anchorOffset","focusOffset"]);p.selectionHasAnchorAndFocus=A;var O=o(C,"extend");p.selectionHasExtend=O;var M=typeof C.rangeCount==r;p.selectionHasRangeCount=M;var _=!1,D=!0,P=O?function(t,n){var r=u.getRangeDocument(n),i=e.createRange(r);i.collapseToPoint(n.endContainer,n.endOffset),t.addRange(q(i)),t.extend(n.startContainer,n.startOffset)}:null;s.areHostMethods(C,["addRange","getRangeAt","removeAllRanges"])&&typeof C.rangeCount==r&&p.implementsDomRange&&function(){var t=window.getSelection();if(t){var n=t.rangeCount,r=n>1,i=[],s=S(t);for(var o=0;o<n;++o)i[o]=t.getRangeAt(o);var u=m(document),a=u.appendChild(document.createElement("div"));a.contentEditable="false";var f=a.appendChild(document.createTextNode("   ")),l=document.createRange();l.setStart(f,1),l.collapse(!0),t.addRange(l),D=t.rangeCount==1,t.removeAllRanges();if(!r){var c=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(c&&parseInt(c[1])>=36)_=!1;else{var h=l.cloneRange();l.setStart(f,0),h.setEnd(f,3),h.setStart(f,2),t.addRange(l),t.addRange(h),_=t.rangeCount==2}}u.removeChild(a),t.removeAllRanges();for(o=0;o<n;++o)o==0&&s?P?P(t,i[o]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[o])):t.addRange(i[o])}}(),p.selectionSupportsMultipleRanges=_,p.collapsedNonEditableSelectionsSupported=D;var H=!1,B;L&&o(L,"createControlRange")&&(B=L.createControlRange(),s.areHostProperties(B,["item","add"])&&(H=!0)),p.implementsControlRange=H,A?h=function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:h=function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var $;o(C,"getRangeAt")?$=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:A&&($=function(t){var n=v(t.anchorNode),r=e.createRange(n);return r.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),r.collapsed!==this.isCollapsed&&r.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),r}),J.prototype=e.selectionPrototype;var Q=[],Y=function(e){if(e&&e instanceof J)return e.refresh(),e;e=b(e,"getNativeSelection");var t=G(e),n=c(e),r=T?E(e):null;return t?(t.nativeSelection=n,t.docSelection=r,t.refresh()):(t=new J(n,r,e),Q.push({win:e,selection:t})),t};e.getSelection=Y,e.getIframeSelection=function(n){return t.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),e.getSelection(i.getIframeWindow(n))};var Z=J.prototype;if(!N&&A&&s.areHostMethods(C,["removeAllRanges","addRange"])){Z.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),I(this)};var tt=function(e,t){P(e.nativeSelection,t),e.refresh()};M?Z.addRange=function(t,n){if(H&&T&&this.docSelection.type==d)V(this,t);else if(y(n)&&O)tt(this,t);else{var r;_?r=this.rangeCount:(this.removeAllRanges(),r=0);var i=q(t).cloneRange();try{this.nativeSelection.addRange(i)}catch(s){}this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==r+1){if(e.config.checkSelectionRanges){var o=$(this.nativeSelection,this.rangeCount-1);o&&!g(o,t)&&(t=new a(o))}this._ranges[this.rangeCount-1]=t,j(this,t,it(this.nativeSelection)),this.isCollapsed=h(this)}else this.refresh()}}:Z.addRange=function(e,t){y(t)&&O?tt(this,e):(this.nativeSelection.addRange(q(e)),this.refresh())},Z.setRanges=function(e){if(H&&T&&e.length>1)et(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(o(C,"empty")&&o(k,"select")&&H&&N))return t.fail("No means of selecting a Range or TextRange was found"),!1;Z.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var e;if(this.anchorNode)e=v(this.anchorNode);else if(this.docSelection.type==d){var t=this.docSelection.createRange();t.length&&(e=v(t.item(0)))}if(e){var n=m(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(r){}I(this)},Z.addRange=function(t){this.docSelection.type==d?V(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,j(this,t,!1))},Z.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?et(this,e):t&&this.addRange(e[0])}}Z.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new f("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var nt;if(N)nt=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=m(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==d?X(t):z(n)?W(t,n):I(t)};else if(o(C,"getRangeAt")&&typeof C.rangeCount==r)nt=function(t){if(H&&T&&t.docSelection.type==d)X(t);else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));j(t,t._ranges[t.rangeCount-1],it(t.nativeSelection)),t.isCollapsed=h(t)}else I(t)}};else{if(!A||typeof C.isCollapsed!=n||typeof k.collapsed!=n||!p.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;nt=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=$(n,0),e._ranges=[t],e.rangeCount=1,F(e),e.isCollapsed=h(e)):I(e)}}Z.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,r=this.anchorOffset;nt(this);if(e){var i=t.length;if(i!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=r)return!0;while(i--)if(!g(t[i],this._ranges[i]))return!0;return!1}};var rt=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var r=0,i=n.length;r<i;++r)g(t,n[r])||e.addRange(n[r]);e.rangeCount||I(e)};H&&T?Z.removeRange=function(e){if(this.docSelection.type==d){var t=this.docSelection.createRange(),n=U(e),r=v(t.item(0)),i=m(r).createControlRange(),s,o=!1;for(var u=0,a=t.length;u<a;++u)s=t.item(u),s!==n||o?i.add(t.item(u)):o=!0;i.select(),X(this)}else rt(this,e)}:Z.removeRange=function(e){rt(this,e)};var it;!N&&A&&p.implementsDomRange?(it=S,Z.isBackward=function(){return it(this)}):it=Z.isBackward=function(){return!1},Z.isBackwards=Z.isBackward,Z.toString=function(){var e=[];for(var t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},Z.collapse=function(t,n){st(this,t);var r=e.createRange(t);r.collapseToPoint(t,n),this.setSingleRange(r),this.isCollapsed=!0},Z.collapseToStart=function(){if(!this.rangeCount)throw new f("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},Z.collapseToEnd=function(){if(!this.rangeCount)throw new f("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},Z.selectAllChildren=function(t){st(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},Z.deleteFromDocument=function(){if(H&&T&&this.docSelection.type==d){var e=this.docSelection.createRange(),t;while(e.length)t=e.item(0),e.remove(t),t.parentNode.removeChild(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var r=0,i=n.length;r<i;++r)n[r].deleteContents();this.addRange(n[i-1])}}},Z.eachRange=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(e(this.getRangeAt(n)))return t},Z.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},Z.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},Z.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(r){n.push(r[e].apply(r,t))}),n},Z.setStart=ot(!0),Z.setEnd=ot(!1),e.rangePrototype.select=function(e){Y(this.getDocument()).setSingleRange(this,e)},Z.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&t.length==1?this.addRange(t[0],"backward"):this.setRanges(t)},Z.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)||!1},Z.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},Z.moveToBookmark=function(t){var n=[];for(var r=0,i,s;i=t.rangeBookmarks[r++];)s=e.createRange(this.win),s.moveToBookmark(i),n.push(s);t.backward?this.setSingleRange(n[0],"backward"):this.setRanges(n)},Z.toHtml=function(){var e=[];return this
.eachRange(function(t){e.push(u.toHtml(t))}),e.join("")},p.implementsTextRange&&(Z.getNativeTextRange=function(){var n,r;if(n=this.docSelection){var i=n.createRange();if(z(i))return i;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),Z.getName=function(){return"WrappedSelection"},Z.inspect=function(){return ut(this)},Z.detach=function(){G(this.win,"delete"),K(this)},J.detachAll=function(){G(null,"deleteAll")},J.inspect=ut,J.isDirectionBackward=y,e.Selection=J,e.selectionPrototype=Z,e.addShimListener(function(e){typeof e.getSelection=="undefined"&&(e.getSelection=function(){return Y(e)}),e=null})});var H=!1,B=function(e){H||(H=!0,!b.initialized&&b.config.autoInitialize&&L())};return g&&(document.readyState=="complete"?B():(u(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",B,!1),N(window,"load",B))),b},this);var Base=function(){};Base.extend=function(e,t){var n=Base.prototype.extend;Base._prototyping=!0;var r=new this;n.call(r,e),r.base=function(){},delete Base._prototyping;var i=r.constructor,s=r.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==s)this._constructing=!0,i.apply(this,arguments),delete this._constructing;else if(arguments[0]!=null)return(arguments[0].extend||n).call(arguments[0],r)};return s.ancestor=this,s.extend=this.extend,s.forEach=this.forEach,s.implement=this.implement,s.prototype=r,s.toString=this.toString,s.valueOf=function(e){return e=="object"?s:i.valueOf()},n.call(s,t),typeof s.init=="function"&&s.init(),s},Base.prototype={extend:function(e,t){if(arguments.length>1){var n=this[e];if(n&&typeof t=="function"&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var r=t.valueOf();t=function(){var e=this.base||Base.prototype.base;this.base=n;var t=r.apply(this,arguments);return this.base=e,t},t.valueOf=function(e){return e=="object"?t:r},t.toString=Base.toString}this[e]=t}else if(e){var i=Base.prototype.extend;!Base._prototyping&&typeof this!="function"&&(i=this.extend||i);var s={toSource:null},o=["constructor","toString","valueOf"],u=Base._prototyping?0:1;while(a=o[u++])e[a]!=s[a]&&i.call(this,a,e[a]);for(var a in e)s[a]||i.call(this,a,e[a])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var r in e)this.prototype[r]===undefined&&t.call(n,e[r],r,e)},implement:function(){for(var e=0;e<arguments.length;e++)typeof arguments[e]=="function"?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString:function(){return String(this.valueOf())}}),wysihtml5.browser=function(){function u(e){return+(/ipad|iphone|ipod/.test(e)&&e.match(/ os (\d+).+? like mac os x/)||[,0])[1]}function a(e){return+(e.match(/android (\d+)/)||[,0])[1]}var e=navigator.userAgent,t=document.createElement("div"),n=e.indexOf("MSIE")!==-1&&e.indexOf("Opera")===-1,r=e.indexOf("Gecko")!==-1&&e.indexOf("KHTML")===-1,i=e.indexOf("AppleWebKit/")!==-1,s=e.indexOf("Chrome/")!==-1,o=e.indexOf("Opera/")!==-1;return{USER_AGENT:e,supported:function(){var e=this.USER_AGENT.toLowerCase(),n="contentEditable"in t,r=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,i=document.querySelector&&document.querySelectorAll,s=this.isIos()&&u(e)<5||this.isAndroid()&&a(e)<4||e.indexOf("opera mobi")!==-1||e.indexOf("hpwos/")!==-1;return n&&r&&i&&!s},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return this.USER_AGENT.indexOf("Android")!==-1},supportsSandboxedIframes:function(){return n},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return n},hasCurrentStyleProperty:function(){return"currentStyle"in t},hasHistoryIssue:function(){return r&&navigator.platform.substr(0,3)==="Mac"},insertsLineBreaksOnReturn:function(){return r},supportsPlaceholderAttributeOn:function(e){return"placeholder"in e},supportsEvent:function(e){return"on"+e in t||function(){return t.setAttribute("on"+e,"return;"),typeof t["on"+e]=="function"}()},supportsEventsInIframeCorrectly:function(){return!o},supportsHTML5Tags:function(e){var t=e.createElement("div"),n="<article>foo</article>";return t.innerHTML=n,t.innerHTML.toLowerCase()===n},supportsCommand:function(){var e={formatBlock:n,insertUnorderedList:n||i,insertOrderedList:n||i},t={insertHTML:r};return function(n,r){var i=e[r];if(!i){try{return n.queryCommandSupported(r)}catch(s){}try{return n.queryCommandEnabled(r)}catch(o){return!!t[r]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return n},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return r||o||i},supportsGetAttributeCorrectly:function(){var e=document.createElement("td");return e.getAttribute("rowspan")!="1"},canSelectImagesInContentEditable:function(){return r||n||o},autoScrollsToCaret:function(){return!i},autoClosesUnclosedTags:function(){var e=t.cloneNode(!1),n,r;return e.innerHTML="<p><div></div>",r=e.innerHTML.toLowerCase(),n=r==="<p></p><div></div>"||r==="<p><div></div></p>",this.autoClosesUnclosedTags=function(){return n},n},supportsNativeGetElementsByClassName:function(){return String(document.getElementsByClassName).indexOf("[native code]")!==-1},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return o},supportsSpeechApiOn:function(t){var n=e.match(/Chrome\/(\d+)/)||[,0];return n[1]>=11&&("onwebkitspeechchange"in t||"speech"in t)},crashesWhenDefineProperty:function(e){return n&&(e==="XMLHttpRequest"||e==="XDomainRequest")},doesAsyncFocus:function(){return n},hasProblemsSettingCaretAfterImg:function(){return n},hasUndoInContextMenu:function(){return r||s||o},hasInsertNodeIssue:function(){return o},hasIframeFocusIssue:function(){return n}}}(),wysihtml5.lang.array=function(e){return{contains:function(t){if(e.indexOf)return e.indexOf(t)!==-1;for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return!0;return!1},without:function(t){t=wysihtml5.lang.array(t);var n=[],r=0,i=e.length;for(;r<i;r++)t.contains(e[r])||n.push(e[r]);return n},get:function(){var t=0,n=e.length,r=[];for(;t<n;t++)r.push(e[t]);return r}}},wysihtml5.lang.Dispatcher=Base.extend({on:function(e,t){return this.events=this.events||{},this.events[e]=this.events[e]||[],this.events[e].push(t),this},off:function(e,t){this.events=this.events||{};var n=0,r,i;if(e){r=this.events[e]||[],i=[];for(;n<r.length;n++)r[n]!==t&&t&&i.push(r[n]);this.events[e]=i}else this.events={};return this},fire:function(e,t){this.events=this.events||{};var n=this.events[e]||[],r=0;for(;r<n.length;r++)n[r].call(this,t);return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}}),wysihtml5.lang.object=function(e){return{merge:function(t){for(var n in t)e[n]=t[n];return this},get:function(){return e},clone:function(){var t={},n;for(n in e)t[n]=e[n];return t},isArray:function(){return Object.prototype.toString.call(e)==="[object Array]"}}},function(){var e=/^\s+/,t=/\s+$/,n=/[&<>"]/g,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};wysihtml5.lang.string=function(i){return i=String(i),{trim:function(){return i.replace(e,"").replace(t,"")},interpolate:function(e){for(var t in e)i=this.replace("#{"+t+"}").by(e[t]);return i},replace:function(e){return{by:function(t){return i.split(e).join(t)}}},escapeHTML:function(){return i.replace(n,function(e){return r[e]})}}}}(),function(e){function o(e){return l(e)?e:(e===e.ownerDocument.documentElement&&(e=e.ownerDocument.body),c(e))}function u(e){return e.replace(n,function(e,t){var n=(t.match(r)||[])[1]||"",o=s[n];t=t.replace(r,""),t.split(o).length>t.split(n).length&&(t+=n,n="");var u=t,a=t;return t.length>i&&(a=a.substr(0,i)+"..."),u.substr(0,4)==="www."&&(u="http://"+u),'<a href="'+u+'">'+a+"</a>"+n})}function a(e){var t=e._wysihtml5_tempElement;return t||(t=e._wysihtml5_tempElement=e.createElement("div")),t}function f(t){var n=t.parentNode,r=e.lang.string(t.data).escapeHTML(),i=a(n.ownerDocument);i.innerHTML="<span></span>"+u(r),i.removeChild(i.firstChild);while(i.firstChild)n.insertBefore(i.firstChild,t);n.removeChild(t)}function l(e){var n;while(e.parentNode){e=e.parentNode,n=e.nodeName;if(t.contains(n))return!0;if(n==="body")return!1}return!1}function c(r){if(t.contains(r.nodeName))return;if(r.nodeType===e.TEXT_NODE&&r.data.match(n)){f(r);return}var i=e.lang.array(r.childNodes).get(),s=i.length,o=0;for(;o<s;o++)c(i[o]);return r}var t=e.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),n=/((https?:\/\/|www\.)[^\s<]{3,})/gi,r=/([^\w\/\-](,?))$/i,i=100,s={")":"(","]":"[","}":"{"};e.dom.autoLink=o,e.dom.autoLink.URL_REG_EXP=n}(wysihtml5),function(e){var t=e.dom;t.addClass=function(e,n){var r=e.classList;if(r)return r.add(n);if(t.hasClass(e,n))return;e.className+=" "+n},t.removeClass=function(e,t){var n=e.classList;if(n)return n.remove(t);e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ")},t.hasClass=function(e,t){var n=e.classList;if(n)return n.contains(t);var r=e.className;return r.length>0&&(r==t||(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(r))}}(wysihtml5),wysihtml5.dom.contains=function(){var e=document.documentElement;if(e.contains)return function(e,t){return t.nodeType!==wysihtml5.ELEMENT_NODE&&(t=t.parentNode),e!==t&&e.contains(t)};if(e.compareDocumentPosition)return function(e,t){return!!(e.compareDocumentPosition(t)&16)}}(),wysihtml5.dom.convertToList=function(){function e(e,t){var n=e.createElement("li");return t.appendChild(n),n}function t(e,t){return e.createElement(t)}function n(n,r){if(n.nodeName==="UL"||n.nodeName==="OL"||n.nodeName==="MENU")return n;var i=n.ownerDocument,s=t(i,r),o=n.querySelectorAll("br"),u=o.length,a,f,l,c,h,p,d,v,m;for(m=0;m<u;m++){c=o[m];while((h=c.parentNode)&&h!==n&&h.lastChild===c){if(wysihtml5.dom.getStyle("display").from(h)==="block"){h.removeChild(c);break}wysihtml5.dom.insert(c).after(c.parentNode)}}a=wysihtml5.lang.array(n.childNodes).get(),f=a.length;for(m=0;m<f;m++){v=v||e(i,s),l=a[m],p=wysihtml5.dom.getStyle("display").from(l)==="block",d=l.nodeName==="BR";if(p){v=v.firstChild?e(i,s):v,v.appendChild(l),v=null;continue}if(d){v=v.firstChild?null:v;continue}v.appendChild(l)}return a.length===0&&e(i,s),n.parentNode.replaceChild(s,n),s}return n}(),wysihtml5.dom.copyAttributes=function(e){return{from:function(t){return{to:function(n){var r,i=0,s=e.length;for(;i<s;i++)r=e[i],typeof t[r]!="undefined"&&t[r]!==""&&(n[r]=t[r]);return{andTo:arguments.callee}}}}}},function(e){var t=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],n=function(t){return r(t)?parseInt(e.getStyle("width").from(t),10)<t.offsetWidth:!1},r=function(n){var r=0,i=t.length;for(;r<i;r++)if(e.getStyle(t[r]).from(n)==="border-box")return t[r]};e.copyStyles=function(r){return{from:function(i){n(i)&&(r=wysihtml5.lang.array(r).without(t));var s="",o=r.length,u=0,a;for(;u<o;u++)a=r[u],s+=a+":"+e.getStyle(a).from(i)+";";return{to:function(t){return e.setStyles(s).on(t),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(e){e.dom.delegate=function(t,n,r,i){return e.dom.observe(t,r,function(r){var s=r.target,o=e.lang.array(t.querySelectorAll(n));while(s&&s!==t){if(o.contains(s)){i.call(s,r);break}s=s.parentNode}})}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var e=function(e,t){var n=t.createElement("div");n.style.display="none",t.body.appendChild(n);try{n.innerHTML=e}catch(r){}return t.body.removeChild(n),n},t=function(e){if(e._wysihtml5_supportsHTML5Tags)return;for(var t=0,r=n.length;t<r;t++)e.createElement(n[t]);e._wysihtml5_supportsHTML5Tags=!0},n=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(n,r){r=r||document;var i;return typeof n=="object"&&n.nodeType?(i=r.createElement("div"),i.appendChild(n)):wysihtml5.browser.supportsHTML5Tags(r)?(i=r.createElement("div"),i.innerHTML=n):(t(r),i=e(n,r)),i}}(),wysihtml5.dom.getParentElement=function(){function e(e,t){return!t||!t.length?!0:typeof t=="string"?e===t:wysihtml5.lang.array(t).contains(e)}function t(e){return e.nodeType===wysihtml5.ELEMENT_NODE}function n(e,t,n){var r=(e.className||"").match(n)||[];return t?r[r.length-1]===t:!!r.length}function r(t,n,r){while(r--&&t&&t.nodeName!=="BODY"){if(e(t.nodeName,n))return t;t=t.parentNode}return null}function i(r,i,s,o,u){while(u--&&r&&r.nodeName!=="BODY"){if(t(r)&&e(r.nodeName,i)&&n(r,s,o))return r;r=r.parentNode}return null}return function(e,t,n){return n=n||50,t.className||t.classRegExp?i(e,t.nodeName,t.className,t.classRegExp,n):r(e,t.nodeName,n)}}(),wysihtml5.dom.getStyle=function(){function n(e){return e.replace(t,function(e){return e.charAt(1).toUpperCase()})}var e={"float":"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},t=/\-[a-z]/g;return function(t){return{from:function(r){if(r.nodeType!==wysihtml5.ELEMENT_NODE)return;var i=r.ownerDocument,s=e[t]||n(t),o=r.style,u=r.currentStyle,a=o[s];if(a)return a;if(u)try{return u[s]}catch(f){}var l=i.defaultView||i.parentWindow,c=(t==="height"||t==="width")&&r.nodeName==="TEXTAREA",h,p;if(l.getComputedStyle)return c&&(h=o.overflow,o.overflow="hidden"),p=l.getComputedStyle(r,null).getPropertyValue(t),c&&(o.overflow=h||""),p}}}}(),wysihtml5.dom.hasElementWithTagName=function(){function n(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=t++)}var e={},t=1;return function(t,r){var i=n(t)+":"+r,s=e[i];return s||(s=e[i]=t.getElementsByTagName(r)),s.length>0}}(),function(e){function r(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=n++)}var t={},n=1;e.dom.hasElementWithClassName=function(n,i){if(!e.browser.supportsNativeGetElementsByClassName())return!!n.querySelector("."+i);var s=r(n)+":"+i,o=t[s];return o||(o=t[s]=n.getElementsByClassName(i)),o.length>0}}(wysihtml5),wysihtml5.dom.insert=function(e){return{after:function(t){t.parentNode.insertBefore(e,t.nextSibling)},before:function(t){t.parentNode.insertBefore(e,t)},into:function(t){t.appendChild(e)}}},wysihtml5.dom.insertCSS=function(e){return e=e.join("\n"),{into:function(t){var n=t.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(t.createTextNode(e));var r=t.querySelector("head link");if(r){r.parentNode.insertBefore(n,r);return}var i=t.querySelector("head");i&&i.appendChild(n)}}},wysihtml5.dom.observe=function(e,t,n){t=typeof t=="string"?[t]:t;var r,i,s=0,o=t.length;for(;s<o;s++)i=t[s],e.addEventListener?e.addEventListener(i,n,!1):(r=function(t){"target"in t||(t.target=t.srcElement),t.preventDefault=t.preventDefault||function(){this.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){this.cancelBubble=!0},n.call(e,t)},e.attachEvent("on"+i,r));return{stop:function(){var i,s=0,o=t.length;for(;s<o;s++)i=t[s],e.removeEventListener?e.removeEventListener(i,n,!1):e.detachEvent("on"+i,r)}}},wysihtml5.dom.parse=function(){function s(e,t,n,s){wysihtml5.lang.object(i).merge(r).merge(t).get(),n=n||e.ownerDocument||document;var u=n.createDocumentFragment(),a=typeof e=="string",f,l,c;a?f=wysihtml5.dom.getAsDom(e,n):f=e;while(f.firstChild)c=f.firstChild,l=o(c,s),f.removeChild(c),l&&u.appendChild(l);return f.innerHTML="",f.appendChild(u),a?wysihtml5.quirks.getCorrectInnerHTML(f):f}function o(n,r){var i=n.nodeType,s=n.childNodes,u=s.length,a=e[i],f=0,l,c,h;c=a&&a(n);if(!c)return null;for(f=0;f<u;f++)h=o(s[f],r),h&&c.appendChild(h);if(r&&c.nodeName.toLowerCase()===t&&(!c.childNodes.length||!c.attributes.length)){l=c.ownerDocument.createDocumentFragment();while(c.firstChild)l.appendChild(c.firstChild);return l}return c}function u(e){var n,r,s=i.tags,o=e.nodeName.toLowerCase(),u=e.scopeName;if(e._wysihtml5)return null;e._wysihtml5=1;if(e.className==="wysihtml5-temp")return null;u&&u!="HTML"&&(o=u+":"+o),"outerHTML"in e&&!wysihtml5.browser.autoClosesUnclosedTags()&&e.nodeName==="P"&&e.outerHTML.slice(-4).toLowerCase()!=="</p>"&&(o="div");if(o in s){n=s[o];if(!n||n.remove)return null;n=typeof n=="string"?{rename_tag:n}:n}else{if(!e.firstChild)return null;n={rename_tag:t}}return r=e.ownerDocument.createElement(n.rename_tag||o),a(e,r,n),e=null,r}function a(e,t,r){var s={},o=r.set_class,u=r.add_class,a=r.set_attributes,f=r.check_attributes,c=i.classes,h=0,p=[],m=[],g=[],y=[],b,w,E,S,x,T,N;a&&(s=wysihtml5.lang.object(a).clone());if(f)for(x in f){N=d[f[x]];if(!N)continue;T=N(l(e,x)),typeof T=="string"&&(s[x]=T)}o&&p.push(o);if(u)for(x in u){N=v[u[x]];if(!N)continue;S=N(l(e,x)),typeof S=="string"&&p.push(S)}c["_wysihtml5-temp-placeholder"]=1,y=e.getAttribute("class"),y&&(p=p.concat(y.split(n))),b=p.length;for(;h<b;h++)E=p[h],c[E]&&m.push(E);w=m.length;while(w--)E=m[w],wysihtml5.lang.array(g).contains(E)||g.unshift(E);g.length&&(s["class"]=g.join(" "));for(x in s)try{t.setAttribute(x,s[x])}catch(C){}s.src&&(typeof s.width!="undefined"&&t.setAttribute("width",s.width),typeof s.height!="undefined"&&t.setAttribute("height",s.height))}function l(e,t){t=t.toLowerCase();var n=e.nodeName;if(n=="IMG"&&t=="src"&&c(e)===!0)return e.src;if(f&&"outerHTML"in e){var r=e.outerHTML.toLowerCase(),i=r.indexOf(" "+t+"=")!=-1;return i?e.getAttribute(t):null}return e.getAttribute(t)}function c(e){try{return e.complete&&!e.mozMatchesSelector(":-moz-broken")}catch(t){if(e.complete&&e.readyState==="complete")return!0}}function p(e){var t=e.nextSibling;if(!t||t.nodeType!==wysihtml5.TEXT_NODE){var n=e.data.replace(h,"");return e.ownerDocument.createTextNode(n)}t.data=e.data+t.data}var e={1:u,3:p},t="span",n=/\s+/,r={tags:{},classes:{}},i={},f=!wysihtml5.browser.supportsGetAttributeCorrectly(),h=/\uFEFF/g,d={url:function(){var e=/^https?:\/\//i;return function(t){return!t||!t.match(e)?null:t.replace(e,function(e){return e.toLowerCase()})}}(),src:function(){var e=/^(\/|https?:\/\/)/i;return function(t){return!t||!t.match(e)?null:t.replace(e,function(e){return e.toLowerCase()})}}(),href:function(){var e=/^(\/|https?:\/\/|mailto:)/i;return function(t){return!t||!t.match(e)?null:t.replace(e,function(e){return e.toLowerCase()})}}(),alt:function(){var e=/[^ a-z0-9_\-]/gi;return function(t){return t?t.replace(e,""):""}}(),numbers:function(){var e=/\D/g;return function(t){return t=(t||"").replace(e,""),t||null}}()},v={align_img:function(){var e={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(t){return e[String(t).toLowerCase()]}}(),align_text:function(){var e={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(t){return e[String(t).toLowerCase()]}}(),clear_br:function(){var e={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(t){return e[String(t).toLowerCase()]}}(),size_font:function(){var e={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(t){return e[String(t).charAt(0)]}}()};return s}(),wysihtml5.dom.removeEmptyTextNodes=function(e){var t,n=wysihtml5.lang.array(e.childNodes).get(),r=n.length,i=0;for(;i<r;i++)t=n[i],t.nodeType===wysihtml5.TEXT_NODE&&t.data===""&&t.parentNode.removeChild(t)},wysihtml5.dom.renameElement=function(e,t){var n=e.ownerDocument.createElement(t),r;while(r=e.firstChild)n.appendChild(r);return wysihtml5.dom.copyAttributes(["align","className"]).from(e).to(n),e.parentNode.replaceChild(n,e),n},wysihtml5.dom.replaceWithChildNodes=function(e){if(!e.parentNode)return;if(!e.firstChild){e.parentNode.removeChild(e);return}var t=e.ownerDocument.createDocumentFragment();while(e.firstChild)t.appendChild(e.firstChild);e.parentNode.replaceChild(t,e),e=t=null},function(e){function t(t){return e.getStyle("display").from(t)==="block"}function n(e){return e.nodeName==="BR"}function r(e){var t=e.ownerDocument.createElement("br");e.appendChild(t)}function i(e,i){if(!e.nodeName.match(/^(MENU|UL|OL)$/))return;var s=e.ownerDocument,o=s.createDocumentFragment(),u=e.previousElementSibling||e.previousSibling,a,f,l,c,h,p;if(i){u&&!t(u)&&r(o);while(p=e.firstElementChild||e.firstChild){f=p.lastChild;while(a=p.firstChild)l=a===f,c=l&&!t(a)&&!n(a),o.appendChild(a),c&&r(o);p.parentNode.removeChild(p)}}else while(p=e.firstElementChild||e.firstChild){if(p.querySelector&&p.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))while(a=p.firstChild)o.appendChild(a);else{h=s.createElement("p");while(a=p.firstChild)h.appendChild(a);o.appendChild(h)}p.parentNode.removeChild(p)}e.parentNode.replaceChild(o,e)}e.resolveList=i}(wysihtml5.dom),function(e){var t=document,n=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],r=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],i=["referrer","write","open","close"];e.dom.Sandbox=Base.extend({constructor:function(t,n){this.callback=t||e.EMPTY_FUNCTION,this.config=e.lang.object({}).merge(n).get(),this.iframe=this._createIframe()},insertInto:function(e){typeof e=="string"&&(e=t.getElementById(e)),e.appendChild(this.iframe)},getIframe:function(){return this.iframe},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var e=this.getIframe();e.parentNode.removeChild(e)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var n=this,r=t.createElement("iframe");return r.className="wysihtml5-sandbox",e.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(r),e.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(r.src="javascript:'<html></html>'"),r.onload=function(){r.onreadystatechange=r.onload=null,n._onLoadIframe(r)},r.onreadystatechange=function(){/loaded|complete/.test(r.readyState)&&(r.onreadystatechange=r.onload=null,n._onLoadIframe(r))},r},_onLoadIframe:function(s){if(!e.dom.contains(t.documentElement,s))return;var o=this,u=s.contentWindow,a=s.contentWindow.document,f=t.characterSet||t.charset||"utf-8",l=this._getHtml({charset:f,stylesheets:this.config.stylesheets});a.open("text/html","replace"),a.write(l),a.close(),this.getWindow=function(){return s.contentWindow},this.getDocument=function(){return s.contentWindow.document},u.onerror=function(e,t,n){throw new Error("wysihtml5.Sandbox: "+e,t,n)};if(!e.browser.supportsSandboxedIframes()){var c,h;for(c=0,h=n.length;c<h;c++)this._unset(u,n[c]);for(c=0,h=r.length;c<h;c++)this._unset(u,r[c],e.EMPTY_FUNCTION);for(c=0,h=i.length;c<h;c++)this._unset(a,i[c]);this._unset(a,"cookie","",!0)}this.loaded=!0,setTimeout(function(){o.callback(o)},0)},_getHtml:function(t){var n=t.stylesheets,r="",i=0,s;n=typeof n=="string"?[n]:n;if(n){s=n.length;for(;i<s;i++)r+='<link rel="stylesheet" href="'+n[i]+'">'}return t.stylesheets=r,e.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(t)},_unset:function(t,n,r,i){try{t[n]=r}catch(s){}try{t.__defineGetter__(n,function(){return r})}catch(s){}if(i)try{t.__defineSetter__(n,function(){})}catch(s){}if(!e.browser.crashesWhenDefineProperty(n))try{var o={get:function(){return r}};i&&(o.set=function(){}),Object.defineProperty(t,n,o)}catch(s){}}})}(wysihtml5),function(){var e={className:"class"};wysihtml5.dom.setAttributes=function(t){return{on:function(n){for(var r in t)n.setAttribute(e[r]||r,t[r])}}}}(),wysihtml5.dom.setStyles=function(e){return{on:function(t){var n=t.style;if(typeof e=="string"){n.cssText+=";"+e;return}for(var r in e)r==="float"?(n.cssFloat=e[r],n.styleFloat=e[r]):n[r]=e[r]}}},function(e){e.simulatePlaceholder=function(t,n,r){var i="placeholder",s=function(){n.hasPlaceholderSet()&&n.clear(),n.placeholderSet=!1,e.removeClass(n.element,i)},o=function(){n.isEmpty()&&(n.placeholderSet=!0,n.setValue(r),e.addClass(n.element,i))};t.on("set_placeholder",o).on("unset_placeholder",s).on("focus:composer",s).on("paste:composer",s).on("blur:composer",o),o()}}(wysihtml5.dom),function(e){var t=document.documentElement;"textContent"in t?(e.setTextContent=function(e,t){e.textContent=t},e.getTextContent=function(e){return e.textContent}):"innerText"in t?(e.setTextContent=function(e,t){e.innerText=t},e.getTextContent=function(e){return e.innerText}):(e.setTextContent=function(e,t){e.nodeValue=t},e.getTextContent=function(e){return e.nodeValue})}(wysihtml5.dom),wysihtml5.quirks.cleanPastedHTML=function(){function t(t,n,r){n=n||e,r=r||t.ownerDocument||document;var i,s=typeof t=="string",o,u,a,f,l=0;s?i=wysihtml5.dom.getAsDom(t,r):i=t;for(f in n){u=i.querySelectorAll(f),o=n[f],a=u.length;for(;l<a;l++)o(u[l])}return u=t=n=null,s?i.innerHTML:i}var e={"a u":wysihtml5.dom.replaceWithChildNodes};return t}(),wysihtml5.quirks.ensureProperClearing=function(){var e=function(){var e=this;setTimeout(function(){var t=e.innerHTML.toLowerCase();if(t=="<p>&nbsp;</p>"||t=="<p>&nbsp;</p><p>&nbsp;</p>")e.innerHTML=""},0)};return function(t){wysihtml5.dom.observe(t.element,["cut","keydown"],e)}}(),function(e){var t="%7E";e.quirks.getCorrectInnerHTML=function(n){var r=n.innerHTML;if(r.indexOf(t)===-1)return r;var i=n.querySelectorAll("[href*='~'], [src*='~']"),s,o,u,a;for(a=0,u=i.length;a<u;a++)s=i[a].href||i[a].src,o=e.lang.string(s).replace("~").by(t),r=e.lang.string(r).replace(o).by(s);return r}}(wysihtml5),function(e){var t="wysihtml5-quirks-redraw";e.quirks.redraw=function(n){e.dom.addClass(n,t),e.dom.removeClass(n,t);try{var r=n.ownerDocument;r.execCommand("italic",!1,null),r.execCommand("italic",!1,null)}catch(i){}}}(wysihtml5),function(e){function n(e){var t=0;if(e.parentNode)do t+=e.offsetTop||0,e=e.offsetParent;while(e);return t}var t=e.dom;e.Selection=Base.extend({constructor:function(e){window.rangy.init(),this.editor=e,this.composer=e.composer,this.doc=this.composer.doc},getBookmark:function(){var e=this.getRange();return e&&e.cloneRange()},setBookmark:function(e){if(!e)return;this.setSelection(e)},setBefore:function(e){var t=rangy.createRange(this.doc);return t.setStartBefore(e),t.setEndBefore(e),this.setSelection(t)},setAfter:function(e){var t=rangy.createRange(this.doc);return t.setStartAfter(e),t.setEndAfter(e),this.setSelection(t)},selectNode:function(n,r){var i=rangy.createRange(this.doc),s=n.nodeType===e.ELEMENT_NODE,o="canHaveHTML"in n?n.canHaveHTML:n.nodeName!=="IMG",u=s?n.innerHTML:n.data,a=u===""||u===e.INVISIBLE_SPACE,f=t.getStyle("display").from(n),l=f==="block"||f==="list-item";if(a&&s&&o&&!r)try{n.innerHTML=e.INVISIBLE_SPACE}catch(c){}o?i.selectNodeContents(n):i.selectNode(n),o&&a&&s?i.collapse(l):o&&a&&(i.setStartAfter(n),i.setEndAfter(n)),this.setSelection(i)},getSelectedNode:function(e){var t,n;if(e&&this.doc.selection&&this.doc.selection.type==="Control"){n=this.doc.selection.createRange();if(n&&n.length)return n.item(0)}return t=this.getSelection(this.doc),t.focusNode===t.anchorNode?t.focusNode:(n=this.getRange(this.doc),n?n.commonAncestorContainer:this.doc.body)},executeAndRestore:function(n,r){var i=this.doc.body,s=r&&i.scrollTop,o=r&&i.scrollLeft,u="_wysihtml5-temp-placeholder",a='<span class="'+u+'">'+e.INVISIBLE_SPACE+"</span>",f=this.getRange(this.doc),l,c,h,p,d;if(!f){n(i,i);return}e.browser.hasInsertNodeIssue()?this.doc.execCommand("insertHTML",!1,a):(p=f.createContextualFragment(a),f.insertNode(p));try{n(f.startContainer,f.endContainer)}catch(v){setTimeout(function(){throw v},0)}l=this.doc.querySelector("."+u),l?(d=rangy.createRange(this.doc),h=l.nextSibling,e.browser.hasInsertNodeIssue()&&h&&h.nodeName==="BR"?(c=this.doc.createTextNode(e.INVISIBLE_SPACE),t.insert(c).after(l),d.setStartBefore(c),d.setEndBefore(c)):(d.selectNode(l),d.deleteContents()),this.setSelection(d)):i.focus(),r&&(i.scrollTop=s,i.scrollLeft=o);try{l.parentNode.removeChild(l)}catch(m){}},executeAndRestoreSimple:function(e){var t=this.getRange(),n=this.doc.body,r,i,s,o,u;if(!t){e(n,n);return}o=t.getNodes([3]),i=o[0]||t.startContainer,s=o[o.length-1]||t.endContainer,u={collapsed:t.collapsed,startContainer:i,startOffset:i===t.startContainer?t.startOffset:0,endContainer:s,endOffset:s===t.endContainer?t.endOffset:s.length};try{e(t.startContainer,t.endContainer)}catch(a){setTimeout(function(){throw a},0)}r=rangy.createRange(this.doc);try{r.setStart(u.startContainer,u.startOffset)}catch(f){}try{r.setEnd(u.endContainer,u.endOffset)}catch(l){}try{this.setSelection(r)}catch(c){}},set:function(e,t){var n=rangy.createRange(this.doc);n.setStart(e,t||0),this.setSelection(n)},insertHTML:function(e){var t=rangy.createRange(this.doc),n=t.createContextualFragment(e),r=n.lastChild;this.insertNode(n),r&&this.setAfter(r)},insertNode:function(e){var t=this.getRange();t&&t.insertNode(e)},surround:function(e){var t=this.getRange();if(!t)return;try{t.surroundContents(e),this.selectNode(e)}catch(n){e.appendChild(t.extractContents()),t.insertNode(e)}},scrollIntoView:function(){var t=this.doc,r=5,i=t.documentElement.scrollHeight>t.documentElement.offsetHeight,s=t._wysihtml5ScrollIntoViewElement=t._wysihtml5ScrollIntoViewElement||function(){var n=t.createElement("span");return n.innerHTML=e.INVISIBLE_SPACE,n}(),o;i&&(this.insertNode(s),o=n(s),s.parentNode.removeChild(s),o>=t.body.scrollTop+t.documentElement.offsetHeight-r&&(t.body.scrollTop=o))},selectLine:function(){e.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var e=this.doc.defaultView,t=e.getSelection();t.modify("extend","left","lineboundary"),t.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var e=this.doc.selection.createRange(),t=e.boundingTop,n=this.doc.body.scrollWidth,r,i,s,o,u;if(!e.moveToPoint)return;t===0&&(s=this.doc.createElement("span"),this.insertNode(s),t=s.offsetTop,s.parentNode.removeChild(s)),t+=1;for(o=-10;o<n;o+=2)try{e.moveToPoint(o,t);break}catch(a){}r=t,i=this.doc.selection.createRange();for(u=n;u>=0;u--)try{i.moveToPoint(u,r);break}catch(f){}e.setEndPoint("EndToEnd",i),e.select()},getText:function(){var e=this.getSelection();return e?e.toString():""},getNodes:function(e,t){var n=this.getRange();return n?n.getNodes([e],t):[]},getRange:function(){var e=this.getSelection();return e&&e.rangeCount&&e.getRangeAt(0)},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(e){var t=this.doc.defaultView||this.doc.parentWindow,n=rangy.getSelection(t);return n.setSingleRange(e)}})}(wysihtml5),function(e,t){function i(e,t,n){if(!e.className)return!1;var r=e.className.match(n)||[];return r[r.length-1]===t}function s(e,t,n){e.className?(o(e,n),e.className+=" "+t):e.className=t}function o(e,t){e.className&&(e.className=e.className.replace(t,""))}function u(e,t){return e.className.replace(r," ")==t.className.replace(r," ")}function a(e){var t=e.parentNode;while(e.firstChild)t.insertBefore(e.firstChild,e);t.removeChild(e)}function f(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n=0,r=e.attributes.length,i,s,o;n<r;++n){i=e.attributes[n],o=i.name;if(o!="class"){s=t.attributes.getNamedItem(o);if(i.specified!=s.specified)return!1;if(i.specified&&i.nodeValue!==s.nodeValue)return!1}}return!0}function l(e,n){return t.dom.isCharacterDataNode(e)?n==0?!!e.previousSibling:n==e.length?!!e.nextSibling:!0:n>0&&n<e.childNodes.length}function c(e,n,r){var i;t.dom.isCharacterDataNode(n)&&(r==0?(r=t.dom.getNodeIndex(n),n=n.parentNode):r==n.length?(r=t.dom.getNodeIndex(n)+1,n=n.parentNode):i=t.dom.splitDataNode(n,r));if(!i){i=n.cloneNode(!1),i.id&&i.removeAttribute("id");var s;while(s=n.childNodes[r])i.appendChild(s);t.dom.insertAfter(i,n)}return n==e?i:c(e,i.parentNode,t.dom.getNodeIndex(i))}function h(t){this.isElementMerge=t.nodeType==e.ELEMENT_NODE,this.firstTextNode=this.isElementMerge?t.lastChild:t,this.textNodes=[this.firstTextNode]}function p(e,t,r,i){this.tagNames=e||[n],this.cssClass=t||"",this.similarClassRegExp=r,this.normalize=i,this.applyToAnyTagName=!1}var n="span",r=/\s+/g;h.prototype={doMerge:function(){var e=[]
,t,n,r;for(var i=0,s=this.textNodes.length;i<s;++i)t=this.textNodes[i],n=t.parentNode,e[i]=t.data,i&&(n.removeChild(t),n.hasChildNodes()||n.parentNode.removeChild(n));return this.firstTextNode.data=r=e.join(""),r},getLength:function(){var e=this.textNodes.length,t=0;while(e--)t+=this.textNodes[e].length;return t},toString:function(){var e=[];for(var t=0,n=this.textNodes.length;t<n;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}},p.prototype={getAncestorWithClass:function(n){var r;while(n){r=this.cssClass?i(n,this.cssClass,this.similarClassRegExp):!0;if(n.nodeType==e.ELEMENT_NODE&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&r)return n;n=n.parentNode}return!1},postApply:function(e,t){var n=e[0],r=e[e.length-1],i=[],s,o=n,u=r,a=0,f=r.length,l,c;for(var p=0,d=e.length;p<d;++p)l=e[p],c=this.getAdjacentMergeableTextNode(l.parentNode,!1),c?(s||(s=new h(c),i.push(s)),s.textNodes.push(l),l===n&&(o=s.firstTextNode,a=o.length),l===r&&(u=s.firstTextNode,f=s.getLength())):s=null;var v=this.getAdjacentMergeableTextNode(r.parentNode,!0);v&&(s||(s=new h(r),i.push(s)),s.textNodes.push(v));if(i.length){for(p=0,d=i.length;p<d;++p)i[p].doMerge();t.setStart(o,a),t.setEnd(u,f)}},getAdjacentMergeableTextNode:function(t,n){var r=t.nodeType==e.TEXT_NODE,i=r?t.parentNode:t,s,o=n?"nextSibling":"previousSibling";if(r){s=t[o];if(s&&s.nodeType==e.TEXT_NODE)return s}else{s=i[o];if(s&&this.areElementsMergeable(t,s))return s[n?"firstChild":"lastChild"]}return null},areElementsMergeable:function(e,n){return t.dom.arrayContains(this.tagNames,(e.tagName||"").toLowerCase())&&t.dom.arrayContains(this.tagNames,(n.tagName||"").toLowerCase())&&u(e,n)&&f(e,n)},createContainer:function(e){var t=e.createElement(this.tagNames[0]);return this.cssClass&&(t.className=this.cssClass),t},applyToTextNode:function(e){var n=e.parentNode;if(n.childNodes.length==1&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase()))this.cssClass&&s(n,this.cssClass,this.similarClassRegExp);else{var r=this.createContainer(t.dom.getDocument(e));e.parentNode.insertBefore(r,e),r.appendChild(e)}},isRemovable:function(n){return t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&e.lang.string(n.className).trim()==this.cssClass},undoToTextNode:function(e,t,n){if(!t.containsNode(n)){var r=t.cloneRange();r.selectNode(n),r.isPointInRange(t.endContainer,t.endOffset)&&l(t.endContainer,t.endOffset)&&(c(n,t.endContainer,t.endOffset),t.setEndAfter(n)),r.isPointInRange(t.startContainer,t.startOffset)&&l(t.startContainer,t.startOffset)&&(n=c(n,t.startContainer,t.startOffset))}this.similarClassRegExp&&o(n,this.similarClassRegExp),this.isRemovable(n)&&a(n)},applyToRange:function(t){var n=t.getNodes([e.TEXT_NODE]);if(!n.length)try{var r=this.createContainer(t.endContainer.ownerDocument);t.surroundContents(r),this.selectNode(t,r);return}catch(i){}t.splitBoundaries(),n=t.getNodes([e.TEXT_NODE]);if(n.length){var s;for(var o=0,u=n.length;o<u;++o)s=n[o],this.getAncestorWithClass(s)||this.applyToTextNode(s);t.setStart(n[0],0),s=n[n.length-1],t.setEnd(s,s.length),this.normalize&&this.postApply(n,t)}},undoToRange:function(t){var n=t.getNodes([e.TEXT_NODE]),r,i;if(n.length)t.splitBoundaries(),n=t.getNodes([e.TEXT_NODE]);else{var s=t.endContainer.ownerDocument,o=s.createTextNode(e.INVISIBLE_SPACE);t.insertNode(o),t.selectNode(o),n=[o]}for(var u=0,a=n.length;u<a;++u)r=n[u],i=this.getAncestorWithClass(r),i&&this.undoToTextNode(r,t,i);a==1?this.selectNode(t,n[0]):(t.setStart(n[0],0),r=n[n.length-1],t.setEnd(r,r.length),this.normalize&&this.postApply(n,t))},selectNode:function(t,n){var r=n.nodeType===e.ELEMENT_NODE,i="canHaveHTML"in n?n.canHaveHTML:!0,s=r?n.innerHTML:n.data,o=s===""||s===e.INVISIBLE_SPACE;if(o&&r&&i)try{n.innerHTML=e.INVISIBLE_SPACE}catch(u){}t.selectNodeContents(n),o&&r?t.collapse(!1):o&&(t.setStartAfter(n),t.setEndAfter(n))},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var r=n.intersection(t),i=r?r.toString():"";return n.detach(),i},isAppliedToRange:function(t){var n=[],r,i=t.getNodes([e.TEXT_NODE]);if(!i.length)return r=this.getAncestorWithClass(t.startContainer),r?[r]:!1;for(var s=0,o=i.length,u;s<o;++s){u=this.getTextSelectedByRange(i[s],t),r=this.getAncestorWithClass(i[s]);if(u!=""&&!r)return!1;n.push(r)}return n},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)}},e.selection.HTMLApplier=p}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.doc=this.composer.doc},support:function(e){return wysihtml5.browser.supportsCommand(this.doc,e)},exec:function(e,t){var n=wysihtml5.commands[e],r=wysihtml5.lang.array(arguments).get(),i=n&&n.exec,s=null;this.editor.fire("beforecommand:composer");if(i)r.unshift(this.composer),s=i.apply(n,r);else try{s=this.doc.execCommand(e,!1,t)}catch(o){}return this.editor.fire("aftercommand:composer"),s},state:function(e,t){var n=wysihtml5.commands[e],r=wysihtml5.lang.array(arguments).get(),i=n&&n.state;if(i)return r.unshift(this.composer),i.apply(n,r);try{return this.doc.queryCommandState(e)}catch(s){return!1}}}),wysihtml5.commands.bold={exec:function(e,t){return wysihtml5.commands.formatInline.exec(e,t,"b")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"b")}},function(e){function i(e,t){var n=t.length,i=0,s,o,u;for(;i<n;i++)s=t[i],o=r.getParentElement(s,{nodeName:"code"}),u=r.getTextContent(s),u.match(r.autoLink.URL_REG_EXP)&&!o?o=r.renameElement(s,"code"):r.replaceWithChildNodes(s)}function s(i,s){var o=i.doc,u="_wysihtml5-temp-"+ +(new Date),a=/non-matching-class/g,f=0,l,c,h,p,d,v,m,g,y;e.commands.formatInline.exec(i,t,n,u,a),c=o.querySelectorAll(n+"."+u),l=c.length;for(;f<l;f++){h=c[f],h.removeAttribute("class");for(y in s)h.setAttribute(y,s[y])}v=h,l===1&&(m=r.getTextContent(h),p=!!h.querySelector("*"),d=m===""||m===e.INVISIBLE_SPACE,!p&&d&&(r.setTextContent(h,s.text||h.href),g=o.createTextNode(" "),i.selection.setAfter(h),r.insert(g).after(h),v=g)),i.selection.setAfter(v)}var t,n="A",r=e.dom;e.commands.createLink={exec:function(e,t,n){var r=this.state(e,t);r?e.selection.executeAndRestore(function(){i(e,r)}):(n=typeof n=="object"?n:{href:n},s(e,n))},state:function(t,n){return e.commands.formatInline.state(t,n,"A")}}}(wysihtml5),function(e){var t=/wysiwyg-font-size-[0-9a-z\-]+/g;e.commands.fontSize={exec:function(n,r,i){return e.commands.formatInline.exec(n,r,"span","wysiwyg-font-size-"+i,t)},state:function(n,r,i){return e.commands.formatInline.state(n,r,"span","wysiwyg-font-size-"+i,t)}}}(wysihtml5),function(e){var t=/wysiwyg-color-[0-9a-z]+/g;e.commands.foreColor={exec:function(n,r,i){return e.commands.formatInline.exec(n,r,"span","wysiwyg-color-"+i,t)},state:function(n,r,i){return e.commands.formatInline.state(n,r,"span","wysiwyg-color-"+i,t)}}}(wysihtml5),function(e){function r(e,t,n){e.className?(i(e,n),e.className+=" "+t):e.className=t}function i(e,t){e.className=e.className.replace(t,"")}function s(t){return t.nodeType===e.TEXT_NODE&&!e.lang.string(t.data).trim()}function o(e){var t=e.previousSibling;while(t&&s(t))t=t.previousSibling;return t}function u(e){var t=e.nextSibling;while(t&&s(t))t=t.nextSibling;return t}function a(e){var t=e.ownerDocument,n=u(e),r=o(e);n&&!h(n)&&e.parentNode.insertBefore(t.createElement("br"),n),r&&!h(r)&&e.parentNode.insertBefore(t.createElement("br"),e)}function f(e){var t=u(e),n=o(e);t&&c(t)&&t.parentNode.removeChild(t),n&&c(n)&&n.parentNode.removeChild(n)}function l(e){var t=e.lastChild;t&&c(t)&&t.parentNode.removeChild(t)}function c(e){return e.nodeName==="BR"}function h(e){return c(e)?!0:t.getStyle("display").from(e)==="block"?!0:!1}function p(n,r,i,s){if(s)var o=t.observe(n,"DOMNodeInserted",function(n){var r=n.target,i;if(r.nodeType!==e.ELEMENT_NODE)return;i=t.getStyle("display").from(r),i.substr(0,6)!=="inline"&&(r.className+=" "+s)});n.execCommand(r,!1,i),o&&o.stop()}function d(t,n){t.selection.selectLine(),t.selection.surround(n),f(n),l(n),t.selection.selectNode(n,e.browser.displaysCaretInEmptyContentEditableCorrectly())}function v(t){return!!e.lang.string(t.className).trim()}var t=e.dom,n=["H1","H2","H3","H4","H5","H6","P","BLOCKQUOTE","DIV"];e.commands.formatBlock={exec:function(s,o,u,f,l){var c=s.doc,h=this.state(s,o,u,f,l),m=s.config.useLineBreaks,g=m?"DIV":"P",y;u=typeof u=="string"?u.toUpperCase():u;if(h){s.selection.executeAndRestoreSimple(function(){l&&i(h,l);var e=v(h);!e&&(m||u==="P")?(a(h),t.replaceWithChildNodes(h)):t.renameElement(h,u==="P"?"DIV":g)});return}if(u===null||e.lang.array(n).contains(u)){y=s.selection.getSelectedNode(),h=t.getParentElement(y,{nodeName:n});if(h){s.selection.executeAndRestore(function(){u&&(h=t.renameElement(h,u)),f&&r(h,f,l)});return}}if(s.commands.support(o)){p(c,o,u||g,f);return}h=c.createElement(u||g),f&&(h.className=f),d(s,h)},state:function(e,n,r,i,s){r=typeof r=="string"?r.toUpperCase():r;var o=e.selection.getSelectedNode();return t.getParentElement(o,{nodeName:r,className:i,classRegExp:s})}}}(wysihtml5),function(e){function r(e){var n=t[e];return n?[e.toLowerCase(),n.toLowerCase()]:[e.toLowerCase()]}function i(t,i,s){var o=t+":"+i;return n[o]||(n[o]=new e.selection.HTMLApplier(r(t),i,s,!0)),n[o]}var t={strong:"b",em:"i",b:"strong",i:"em"},n={};e.commands.formatInline={exec:function(e,t,n,r,s){var o=e.selection.getRange();if(!o)return!1;i(n,r,s).toggleRange(o),e.selection.setSelection(o)},state:function(n,r,s,o,u){var a=n.doc,f=t[s]||s,l;return!e.dom.hasElementWithTagName(a,s)&&!e.dom.hasElementWithTagName(a,f)?!1:o&&!e.dom.hasElementWithClassName(a,o)?!1:(l=n.selection.getRange(),l?i(s,o,u).isAppliedToRange(l):!1)}}}(wysihtml5),wysihtml5.commands.insertHTML={exec:function(e,t,n){e.commands.support(t)?e.doc.execCommand(t,!1,n):e.selection.insertHTML(n)},state:function(){return!1}},function(e){var t="IMG";e.commands.insertImage={exec:function(n,r,i){i=typeof i=="object"?i:{src:i};var s=n.doc,o=this.state(n),u,a;if(o){n.selection.setBefore(o),a=o.parentNode,a.removeChild(o),e.dom.removeEmptyTextNodes(a),a.nodeName==="A"&&!a.firstChild&&(n.selection.setAfter(a),a.parentNode.removeChild(a)),e.quirks.redraw(n.element);return}o=s.createElement(t);for(var f in i)o.setAttribute(f==="className"?"class":f,i[f]);n.selection.insertNode(o),e.browser.hasProblemsSettingCaretAfterImg()?(u=s.createTextNode(e.INVISIBLE_SPACE),n.selection.insertNode(u),n.selection.setAfter(u)):n.selection.setAfter(o)},state:function(n){var r=n.doc,i,s,o;return e.dom.hasElementWithTagName(r,t)?(i=n.selection.getSelectedNode(),i?i.nodeName===t?i:i.nodeType!==e.ELEMENT_NODE?!1:(s=n.selection.getText(),s=e.lang.string(s).trim(),s?!1:(o=n.selection.getNodes(e.ELEMENT_NODE,function(e){return e.nodeName==="IMG"}),o.length!==1?!1:o[0])):!1):!1}}}(wysihtml5),function(e){var t="<br>"+(e.browser.needsSpaceAfterLineBreak()?" ":"");e.commands.insertLineBreak={exec:function(n,r){n.commands.support(r)?(n.doc.execCommand(r,!1,null),e.browser.autoScrollsToCaret()||n.selection.scrollIntoView()):n.commands.exec("insertHTML",t)},state:function(){return!1}}}(wysihtml5),wysihtml5.commands.insertOrderedList={exec:function(e,t){var n=e.doc,r=e.selection.getSelectedNode(),i=wysihtml5.dom.getParentElement(r,{nodeName:"OL"}),s=wysihtml5.dom.getParentElement(r,{nodeName:"UL"}),o="_wysihtml5-temp-"+(new Date).getTime(),u,a;if(!i&&!s&&e.commands.support(t)){n.execCommand(t,!1,null);return}i?e.selection.executeAndRestore(function(){wysihtml5.dom.resolveList(i,e.config.useLineBreaks)}):s?e.selection.executeAndRestore(function(){wysihtml5.dom.renameElement(s,"ol")}):(e.commands.exec("formatBlock","div",o),a=n.querySelector("."+o),u=a.innerHTML===""||a.innerHTML===wysihtml5.INVISIBLE_SPACE||a.innerHTML==="<br>",e.selection.executeAndRestore(function(){i=wysihtml5.dom.convertToList(a,"ol")}),u&&e.selection.selectNode(i.querySelector("li"),!0))},state:function(e){var t=e.selection.getSelectedNode();return wysihtml5.dom.getParentElement(t,{nodeName:"OL"})}},wysihtml5.commands.insertUnorderedList={exec:function(e,t){var n=e.doc,r=e.selection.getSelectedNode(),i=wysihtml5.dom.getParentElement(r,{nodeName:"UL"}),s=wysihtml5.dom.getParentElement(r,{nodeName:"OL"}),o="_wysihtml5-temp-"+(new Date).getTime(),u,a;if(!i&&!s&&e.commands.support(t)){n.execCommand(t,!1,null);return}i?e.selection.executeAndRestore(function(){wysihtml5.dom.resolveList(i,e.config.useLineBreaks)}):s?e.selection.executeAndRestore(function(){wysihtml5.dom.renameElement(s,"ul")}):(e.commands.exec("formatBlock","div",o),a=n.querySelector("."+o),u=a.innerHTML===""||a.innerHTML===wysihtml5.INVISIBLE_SPACE||a.innerHTML==="<br>",e.selection.executeAndRestore(function(){i=wysihtml5.dom.convertToList(a,"ul")}),u&&e.selection.selectNode(i.querySelector("li"),!0))},state:function(e){var t=e.selection.getSelectedNode();return wysihtml5.dom.getParentElement(t,{nodeName:"UL"})}},wysihtml5.commands.italic={exec:function(e,t){return wysihtml5.commands.formatInline.exec(e,t,"i")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"i")}},function(e){var t="wysiwyg-text-align-center",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyCenter={exec:function(r,i){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r,i){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-left",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyLeft={exec:function(r,i){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r,i){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-right",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyRight={exec:function(r,i){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r,i){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-justify",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyFull={exec:function(r,i){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r,i){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(wysihtml5),wysihtml5.commands.redo={exec:function(e){return e.undoManager.redo()},state:function(e){return!1}},wysihtml5.commands.underline={exec:function(e,t){return wysihtml5.commands.formatInline.exec(e,t,"u")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"u")}},wysihtml5.commands.undo={exec:function(e){return e.undoManager.undo()},state:function(e){return!1}},function(e){function c(e){var t;while(t=e.querySelector("._wysihtml5-temp"))t.parentNode.removeChild(t)}var t=90,n=89,r=8,i=46,s=25,o="data-wysihtml5-selection-node",u="data-wysihtml5-selection-offset",a='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",f='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",l=e.dom;e.UndoManager=e.lang.Dispatcher.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.element=this.composer.element,this.position=0,this.historyStr=[],this.historyDom=[],this.transact(),this._observe()},_observe:function(){var s=this,o=this.composer.sandbox.getDocument(),u;l.observe(this.element,"keydown",function(e){if(e.altKey||!e.ctrlKey&&!e.metaKey)return;var r=e.keyCode,i=r===t&&!e.shiftKey,o=r===t&&e.shiftKey||r===n;i?(s.undo(),e.preventDefault()):o&&(s.redo(),e.preventDefault())}),l.observe(this.element,"keydown",function(e){var t=e.keyCode;if(t===u)return;u=t,(t===r||t===i)&&s.transact()});if(e.browser.hasUndoInContextMenu()){var h,p,d=function(){c(o),clearInterval(h)};l.observe(this.element,"contextmenu",function(){d(),s.composer.selection.executeAndRestoreSimple(function(){s.element.lastChild&&s.composer.selection.setAfter(s.element.lastChild),o.execCommand("insertHTML",!1,a),o.execCommand("insertHTML",!1,f),o.execCommand("undo",!1,null)}),h=setInterval(function(){o.getElementById("_wysihtml5-redo")?(d(),s.redo()):o.getElementById("_wysihtml5-undo")||(d(),s.undo())},400),p||(p=!0,l.observe(document,"mousedown",d),l.observe(o,["mousedown","paste","cut","copy"],d))})}this.editor.on("newword:composer",function(){s.transact()}).on("beforecommand:composer",function(){s.transact()})},transact:function(){var t=this.historyStr[this.position-1],n=this.composer.getValue();if(n===t)return;var r=this.historyStr.length=this.historyDom.length=this.position;r>s&&(this.historyStr.shift(),this.historyDom.shift(),this.position--),this.position++;var i=this.composer.selection.getRange(),a=i.startContainer||this.element,f=i.startOffset||0,l,c;a.nodeType===e.ELEMENT_NODE?l=a:(l=a.parentNode,c=this.getChildNodeIndex(l,a)),l.setAttribute(u,f),typeof c!="undefined"&&l.setAttribute(o,c);var h=this.element.cloneNode(!!n);this.historyDom.push(h),this.historyStr.push(n),l.removeAttribute(u),l.removeAttribute(o)},undo:function(){this.transact();if(!this.undoPossible())return;this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer")},redo:function(){if(!this.redoPossible())return;this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer")},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(e){this.element.innerHTML="";var t=0,n=e.childNodes,r=e.childNodes.length;for(;t<r;t++)this.element.appendChild(n[t].cloneNode(!0));var i,s,a;e.hasAttribute(u)?(i=e.getAttribute(u),a=e.getAttribute(o),s=this.element):(s=this.element.querySelector("["+u+"]")||this.element,i=s.getAttribute(u),a=s.getAttribute(o),s.removeAttribute(u),s.removeAttribute(o)),a!==null&&(s=this.getChildNodeByIndex(s,+a)),this.composer.selection.set(s,i)},getChildNodeIndex:function(e,t){var n=0,r=e.childNodes,i=r.length;for(;n<i;n++)if(r[n]===t)return n},getChildNodeByIndex:function(e,t){return e.childNodes[t]}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(e,t,n){this.parent=e,this.element=t,this.config=n,this._observeViewChange()},_observeViewChange:function(){var e=this;this.parent.on("beforeload",function(){e.parent.on("change_view",function(t){t===e.name?(e.parent.currentView=e,e.show(),setTimeout(function(){e.focus()},0)):e.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")===this.element)return;try{this.element.focus()}catch(e){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(e){var t=e.dom,n=e.browser;e.views.Composer=e.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,t,n){this.base(e,t,n),this.textarea=this.parent.textarea,this._initSandbox()},clear:function(){this.element.innerHTML=n.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(t){var n=this.isEmpty()?"":e.quirks.getCorrectInnerHTML(this.element);return t&&(n=this.parent.parse(n)),n},setValue:function(e,t){t&&(e=this.parent.parse(e));try{this.element.innerHTML=e}catch(n){this.element.innerText=e}},show:function(){this.iframe.style.display=this._displayStyle||"",this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=t.getStyle("display").from(this.iframe),this._displayStyle==="none"&&(this._displayStyle=null),this.iframe.style.display="none"},disable:function(){this.parent.fire("disable:composer"),this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer"),this.element.setAttribute("contentEditable","true")},focus:function(t){e.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var n=this.element.lastChild;t&&n&&(n.nodeName==="BR"?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return t.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==this.textarea.element.getAttribute("placeholder")&&this.placeholderSet},isEmpty:function(){var e=this.element.innerHTML.toLowerCase();return e===""||e==="<br>"||e==="<p></p>"||e==="<p><br></p>"||this.hasPlaceholderSet()},_initSandbox:function(){var e=this;this.sandbox=new t.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets}),this.iframe=this.sandbox.getIframe();var n=this.textarea.element;t.insert(this.iframe).after(n);if(n.form){var r=document.createElement("input");r.type="hidden",r.name="_wysihtml5_mode",r.value=1,t.insert(r).after(n)}},_create:function(){var r=this;this.doc=this.sandbox.getDocument(),this.element=this.doc.body,this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0),this.selection=new e.Selection(this.parent),this.commands=new e.Commands(this.parent),t.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element),t.addClass(this.element,this.config.composerClassName),this.config.style&&this.style(),this.observe();var i=this.config.name;i&&(t.addClass(this.element,i),t.addClass(this.iframe,i)),this.enable(),this.textarea.element.disabled&&this.disable();var s=typeof this.config.placeholder=="string"?this.config.placeholder:this.textarea.element.getAttribute("placeholder");s&&t.simulatePlaceholder(this.parent,this,s),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),this._initLineBreaking(),(this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element)&&!n.isIos()&&setTimeout(function(){r.focus(!0)},100),n.clearsContentEditableCorrectly()||e.quirks.ensureProperClearing(this),this.initSync&&this.config.sync&&this.initSync(),this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var r=this,i=n.canDisableAutoLinking(),s=n.doesAutoLinkingInContentEditable();i&&this.commands.exec("autoUrlDetect",!1);if(!this.config.autoLink)return;if(!s||s&&i)this.parent.on("newword:composer",function(){t.getTextContent(r.element).match(t.autoLink.URL_REG_EXP)&&r.selection.executeAndRestore(function(e,n){t.autoLink(n.parentNode)})}),t.observe(this.element,"blur",function(){t.autoLink(r.element)});var o=this.sandbox.getDocument().getElementsByTagName("a"),u=t.autoLink.URL_REG_EXP,a=function(n){var r=e.lang.string(t.getTextContent(n)).trim();return r.substr(0,4)==="www."&&(r="http://"+r),r};t.observe(this.element,"keydown",function(e){if(!o.length)return;var n=r.selection.getSelectedNode(e.target.ownerDocument),i=t.getParentElement(n,{nodeName:"A"},4),s;if(!i)return;s=a(i),setTimeout(function(){var e=a(i);if(e===s)return;e.match(u)&&i.setAttribute("href",e)},0)})},_initObjectResizing:function(){this.commands.exec("enableObjectResizing",!0);if(n.supportsEvent("resizeend")){var r=["width","height"],i=r.length,s=this.element;t.observe(s,"resizeend",function(t){var n=t.target||t.srcElement,o=n.style,u=0,a;if(n.nodeName!=="IMG")return;for(;u<i;u++)a=r[u],o[a]&&(n.setAttribute(a,parseInt(o[a],10)),o[a]="");e.quirks.redraw(s)})}},_initUndoManager:function(){this.undoManager=new e.UndoManager(this.parent)},_initLineBreaking:function(){function o(e){var n=t.getParentElement(e,{nodeName:["P","DIV"]},2);n&&r.selection.executeAndRestore(function(){r.config.useLineBreaks?t.replaceWithChildNodes(n):n.nodeName!=="P"&&t.renameElement(n,"p")})}var r=this,i=["LI","P","H1","H2","H3","H4","H5","H6"],s=["UL","OL","MENU"];this.config.useLineBreaks||t.observe(this.element,["focus","keydown"],function(){if(r.isEmpty()){var e=r.doc.createElement("P");r.element.innerHTML="",r.element.appendChild(e),n.displaysCaretInEmptyContentEditableCorrectly()?r.selection.selectNode(e,!0):(e.innerHTML="<br>",r.selection.setBefore(e.firstChild))}}),t.observe(this.doc,"keydown",function(n){var u=n.keyCode;if(n.shiftKey)return;if(u!==e.ENTER_KEY&&u!==e.BACKSPACE_KEY)return;var a=t.getParentElement(r.selection.getSelectedNode(),{nodeName:i},4);if(a){setTimeout(function(){var n=r.selection.getSelectedNode(),i;if(a.nodeName==="LI"){if(!n)return;i=t.getParentElement(n,{nodeName:s},2),i||o(n)}u===e.ENTER_KEY&&a.nodeName.match(/^H[1-6]$/)&&o(n)},0);return}r.config.useLineBreaks&&u===e.ENTER_KEY&&!e.browser.insertsLineBreaksOnReturn()&&(r.commands.exec("insertLineBreak"),n.preventDefault())})}})}(wysihtml5),function(e){var t=e.dom,n=document,r=window,i=n.createElement("div"),s=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],o=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],u=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",e.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],a=function(e){if(e.setActive)try{e.setActive()}catch(i){}else{var s=e.style,o=n.documentElement.scrollTop||n.body.scrollTop,u=n.documentElement.scrollLeft||n.body.scrollLeft,a={position:s.position,top:s.top,left:s.left,WebkitUserSelect:s.WebkitUserSelect};t.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(e),e.focus(),t.setStyles(a).on(e),r.scrollTo&&r.scrollTo(u,o)}};e.views.Composer.prototype.style=function(){var r=this,f=n.querySelector(":focus"),l=this.textarea.element,c=l.hasAttribute("placeholder"),h=c&&l.getAttribute("placeholder"),p=l.style.display,d=l.disabled,v;this.focusStylesHost=i.cloneNode(!1),this.blurStylesHost=i.cloneNode(!1),this.disabledStylesHost=i.cloneNode(!1),c&&l.removeAttribute("placeholder"),l===f&&l.blur(),l.disabled=!1,l.style.display=v="none";if(l.getAttribute("rows")&&t.getStyle("height").from(l)==="auto"||l.getAttribute("cols")&&t.getStyle("width").from(l)==="auto")l.style.display=v=p;t.copyStyles(o).from(l).to(this.iframe).andTo(this.blurStylesHost),t.copyStyles(s).from(l).to(this.element).andTo(this.blurStylesHost),t.insertCSS(u).into(this.element.ownerDocument),l.disabled=!0,t.copyStyles(o).from(l).to(this.disabledStylesHost),t.copyStyles(s).from(l).to(this.disabledStylesHost),l.disabled=d,l.style.display=p,a(l),l.style.display=v,t.copyStyles(o).from(l).to(this.focusStylesHost),t.copyStyles(s).from(l).to(this.focusStylesHost),l.style.display=p,t.copyStyles(["display"]).from(l).to(this.iframe);var m=e.lang.array(o).without(["display"]);return f?f.focus():l.blur(),c&&l.setAttribute("placeholder",h),this.parent.on("focus:composer",function(){t.copyStyles(m).from(r.focusStylesHost).to(r.iframe),t.copyStyles(s).from(r.focusStylesHost).to(r.element)}),this.parent.on("blur:composer",function(){t.copyStyles(m).from(r.blurStylesHost).to(r.iframe),t.copyStyles(s).from(r.blurStylesHost).to(r.element)}),this.parent.observe("disable:composer",function(){t.copyStyles(m).from(r.disabledStylesHost).to(r.iframe),t.copyStyles(s).from(r.disabledStylesHost).to(r.element)}),this.parent.observe("enable:composer",function(){t.copyStyles(m).from(r.blurStylesHost).to(r.iframe),t.copyStyles(s).from(r.blurStylesHost).to(r.element)}),this}}(wysihtml5),function(e){var t=e.dom,n=e.browser,r={66:"bold",73:"italic",85:"underline"};e.views.Composer.prototype.observe=function(){var i=this,s=this.getValue(),o=this.sandbox.getIframe(),u=this.element,a=n.supportsEventsInIframeCorrectly()?u:this.sandbox.getWindow(),f=["drop","paste"];t.observe(o,"DOMNodeRemoved",function(){clearInterval(l),i.parent.fire("destroy:composer")});var l=setInterval(function(){t.contains(document.documentElement,o)||(clearInterval(l),i.parent.fire("destroy:composer"))},250);t.observe(a,"focus",function(){i.parent.fire("focus").fire("focus:composer"),setTimeout(function(){s=i.getValue()},0)}),t.observe(a,"blur",function(){s!==i.getValue()&&i.parent.fire("change").fire("change:composer"),i.parent.fire("blur").fire("blur:composer")}),t.observe(u,"dragenter",function(){i.parent.fire("unset_placeholder")}),t.observe(u,f,function(){setTimeout(function(){i.parent.fire("paste").fire("paste:composer")},0)}),t.observe(u,"keyup",function(t){var n=t.keyCode;(n===e.SPACE_KEY||n===e.ENTER_KEY)&&i.parent.fire("newword:composer")}),this.parent.on("paste:composer",function(){setTimeout(function(){i.parent.fire("newword:composer")},0)}),n.canSelectImagesInContentEditable()||t.observe(u,"mousedown",function(e){var t=e.target;t.nodeName==="IMG"&&(i.selection.selectNode(t),e.preventDefault())}),n.hasHistoryIssue()&&n.supportsSelectionModify()&&t.observe(u,"keydown",function(e){if(!e.metaKey&&!e.ctrlKey)return;var t=e.keyCode,n=u.ownerDocument.defaultView,r=n.getSelection();if(t===37||t===39)t===37&&(r.modify("extend","left","lineboundary"),e.shiftKey||r.collapseToStart()),t===39&&(r.modify("extend","right","lineboundary"),e.shiftKey||r.collapseToEnd()),e.preventDefault()}),t.observe(u,"keydown",function(e){var t=e.keyCode,n=r[t];(e.ctrlKey||e.metaKey)&&!e.altKey&&n&&(i.commands.exec(n),e.preventDefault())}),t.observe(u,"keydown",function(t){var n=i.selection.getSelectedNode(!0),r=t.keyCode,s;n&&n.nodeName==="IMG"&&(r===e.BACKSPACE_KEY||r===e.DELETE_KEY)&&(s=n.parentNode,s.removeChild(n),s.nodeName==="A"&&!s.firstChild&&s.parentNode.removeChild(s),setTimeout(function(){e.quirks.redraw(u)},0),t.preventDefault())}),n.hasIframeFocusIssue()&&(t.observe(this.iframe,"focus",function(){setTimeout(function(){i.doc.querySelector(":focus")!==i.element&&i.focus()},0)}),t.observe(this.element,"blur",function(){setTimeout(function(){i.selection.getSelection().removeAllRanges()},0)}));var c={IMG:"Image: ",A:"Link: "};t.observe(u,"mouseover",function(e){var t=e.target,n=t.nodeName,r;if(n!=="A"&&n!=="IMG")return;var i=t.hasAttribute("title");i||(r=c[n]+(t.getAttribute("href")||t.getAttribute("src")),t.setAttribute("title",r))})}}(wysihtml5),function(e){var t=400;e.views.Synchronizer=Base.extend({constructor:function(e,t,n){this.editor=e,this.textarea=t,this.composer=n,this._observe()},fromComposerToTextarea:function(t){this.textarea.setValue(e.lang.string(this.composer.getValue()).trim(),t)},fromTextareaToComposer:function(e){var t=this.textarea.getValue();t?this.composer.setValue(t,e):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(e){this.editor.currentView.name==="textarea"?this.fromTextareaToComposer(e):this.fromComposerToTextarea(e)},_observe:function(){var n,r=this,i=this.textarea.element.form,s=function(){n=setInterval(function(){r.fromComposerToTextarea()},t)},o=function(){clearInterval(n),n=null};s(),i&&(e.dom.observe(i,"submit",function(){r.sync(!0)}),e.dom.observe(i,"reset",function(){setTimeout(function(){r.fromTextareaToComposer()},0)})),this.editor.on("change_view",function(e){e==="composer"&&!n?(r.fromTextareaToComposer(!0),s()):e==="textarea"&&(r.fromComposerToTextarea(!0),o())}),this.editor.on("destroy:composer",o)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(e,t,n){this.base(e,t,n),this._observe()},clear:function(){this.element.value=""},getValue:function(e){var t=this.isEmpty()?"":this.element.value;return e&&(t=this.parent.parse(t)),t},setValue:function(e,t){t&&(e=this.parent.parse(e)),this.element.value=e},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),t=this.element.getAttribute("placeholder")||null,n=this.element.value,r=!n;return e&&r||n===t},isEmpty:function(){return!wysihtml5
.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var e=this.element,t=this.parent,n={focusin:"focus",focusout:"blur"},r=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];t.on("beforeload",function(){wysihtml5.dom.observe(e,r,function(e){var r=n[e.type]||e.type;t.fire(r).fire(r+":textarea")}),wysihtml5.dom.observe(e,["paste","drop"],function(){setTimeout(function(){t.fire("paste").fire("paste:textarea")},0)})})}}),function(e){var t=e.dom,n="wysihtml5-command-dialog-opened",r="input, select, textarea",i="[data-wysihtml5-dialog-field]",s="data-wysihtml5-dialog-field";e.toolbar.Dialog=e.lang.Dispatcher.extend({constructor:function(e,t){this.link=e,this.container=t},_observe:function(){if(this._observed)return;var i=this,s=function(e){var t=i._serialize();t==i.elementToChange?i.fire("edit",t):i.fire("save",t),i.hide(),e.preventDefault(),e.stopPropagation()};t.observe(i.link,"click",function(){t.hasClass(i.link,n)&&setTimeout(function(){i.hide()},0)}),t.observe(this.container,"keydown",function(t){var n=t.keyCode;n===e.ENTER_KEY&&s(t),n===e.ESCAPE_KEY&&(i.fire("cancel"),i.hide())}),t.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",s),t.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){i.fire("cancel"),i.hide(),e.preventDefault(),e.stopPropagation()});var o=this.container.querySelectorAll(r),u=0,a=o.length,f=function(){clearInterval(i.interval)};for(;u<a;u++)t.observe(o[u],"change",f);this._observed=!0},_serialize:function(){var e=this.elementToChange||{},t=this.container.querySelectorAll(i),n=t.length,r=0;for(;r<n;r++)e[t[r].getAttribute(s)]=t[r].value;return e},_interpolate:function(e){var t,n,r,o=document.querySelector(":focus"),u=this.container.querySelectorAll(i),a=u.length,f=0;for(;f<a;f++){t=u[f];if(t===o)continue;if(e&&t.type==="hidden")continue;n=t.getAttribute(s),r=this.elementToChange?this.elementToChange[n]||"":t.defaultValue,t.value=r}},show:function(e){if(t.hasClass(this.link,n))return;var i=this,s=this.container.querySelector(r);this.elementToChange=e,this._observe(),this._interpolate(),e&&(this.interval=setInterval(function(){i._interpolate(!0)},500)),t.addClass(this.link,n),this.container.style.display="",this.fire("show");if(s&&!e)try{s.focus()}catch(o){}},hide:function(){clearInterval(this.interval),this.elementToChange=null,t.removeClass(this.link,n),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(e){var t=e.dom,n={position:"relative"},r={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},i={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},s={"x-webkit-speech":"",speech:""};e.toolbar.Speech=function(o,u){var a=document.createElement("input");if(!e.browser.supportsSpeechApiOn(a)){u.style.display="none";return}var f=o.editor.textarea.element.getAttribute("lang");f&&(s.lang=f);var l=document.createElement("div");e.lang.object(r).merge({width:u.offsetWidth+"px",height:u.offsetHeight+"px"}),t.insert(a).into(l),t.insert(l).into(u),t.setStyles(i).on(a),t.setAttributes(s).on(a),t.setStyles(r).on(l),t.setStyles(n).on(u);var c="onwebkitspeechchange"in a?"webkitspeechchange":"speechchange";t.observe(a,c,function(){o.execCommand("insertText",a.value),a.value=""}),t.observe(a,"click",function(e){t.hasClass(u,"wysihtml5-command-disabled")&&e.preventDefault(),e.stopPropagation()})}}(wysihtml5),function(e){var t="wysihtml5-command-disabled",n="wysihtml5-commands-disabled",r="wysihtml5-command-active",i="wysihtml5-action-active",s=e.dom;e.toolbar.Toolbar=Base.extend({constructor:function(t,n){this.editor=t,this.container=typeof n=="string"?document.getElementById(n):n,this.composer=t.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),this.show();var r=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),i=r.length,s=0;for(;s<i;s++)new e.toolbar.Speech(this,r[s])},_getLinks:function(t){var n=this[t+"Links"]=e.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+t+"]")).get(),r=n.length,i=0,s=this[t+"Mapping"]={},o,u,a,f,l;for(;i<r;i++)o=n[i],a=o.getAttribute("data-wysihtml5-"+t),f=o.getAttribute("data-wysihtml5-"+t+"-value"),u=this.container.querySelector("[data-wysihtml5-"+t+"-group='"+a+"']"),l=this._getDialog(o,a),s[a+":"+f]={link:o,group:u,name:a,value:f,dialog:l,state:!1}},_getDialog:function(t,n){var r=this,i=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']"),s,o;return i&&(s=new e.toolbar.Dialog(t,i),s.on("show",function(){o=r.composer.selection.getBookmark(),r.editor.fire("show:dialog",{command:n,dialogContainer:i,commandLink:t})}),s.on("save",function(e){o&&r.composer.selection.setBookmark(o),r._execCommand(n,e),r.editor.fire("save:dialog",{command:n,dialogContainer:i,commandLink:t})}),s.on("cancel",function(){r.editor.focus(!1),r.editor.fire("cancel:dialog",{command:n,dialogContainer:i,commandLink:t})})),s},execCommand:function(e,t){if(this.commandsDisabled)return;var n=this.commandMapping[e+":"+t];n&&n.dialog&&!n.state?n.dialog.show():this._execCommand(e,t)},_execCommand:function(e,t){this.editor.focus(!1),this.composer.commands.exec(e,t),this._updateLinkStates()},execAction:function(e){var t=this.editor;e==="change_view"&&(t.currentView===t.textarea?t.fire("change_view","composer"):t.fire("change_view","textarea"))},_observe:function(){var e=this,t=this.editor,r=this.container,i=this.commandLinks.concat(this.actionLinks),o=i.length,u=0;for(;u<o;u++)i[u].nodeName==="A"?s.setAttributes({href:"javascript:;",unselectable:"on"}).on(i[u]):s.setAttributes({unselectable:"on"}).on(i[u]);s.delegate(r,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(e){e.preventDefault()}),s.delegate(r,"[data-wysihtml5-command]","click",function(t){var n=this,r=n.getAttribute("data-wysihtml5-command"),i=n.getAttribute("data-wysihtml5-command-value");e.execCommand(r,i),t.preventDefault()}),s.delegate(r,"[data-wysihtml5-action]","click",function(t){var n=this.getAttribute("data-wysihtml5-action");e.execAction(n),t.preventDefault()}),t.on("focus:composer",function(){e.bookmark=null,clearInterval(e.interval),e.interval=setInterval(function(){e._updateLinkStates()},500)}),t.on("blur:composer",function(){clearInterval(e.interval)}),t.on("destroy:composer",function(){clearInterval(e.interval)}),t.on("change_view",function(t){setTimeout(function(){e.commandsDisabled=t!=="composer",e._updateLinkStates(),e.commandsDisabled?s.addClass(r,n):s.removeClass(r,n)},0)})},_updateLinkStates:function(){var n=this.commandMapping,o=this.actionMapping,u,a,f,l;for(u in n){l=n[u],this.commandsDisabled?(a=!1,s.removeClass(l.link,r),l.group&&s.removeClass(l.group,r),l.dialog&&l.dialog.hide()):(a=this.composer.commands.state(l.name,l.value),e.lang.object(a).isArray()&&(a=a.length===1?a[0]:!0),s.removeClass(l.link,t),l.group&&s.removeClass(l.group,t));if(l.state===a)continue;l.state=a,a?(s.addClass(l.link,r),l.group&&s.addClass(l.group,r),l.dialog&&(typeof a=="object"?l.dialog.show(a):l.dialog.hide())):(s.removeClass(l.link,r),l.group&&s.removeClass(l.group,r),l.dialog&&l.dialog.hide())}for(u in o)f=o[u],f.name==="change_view"&&(f.state=this.editor.currentView===this.editor.textarea,f.state?s.addClass(f.link,i):s.removeClass(f.link,i))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(e){var t,n={name:t,style:!0,toolbar:t,autoLink:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:e.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:t,supportTouchDevices:!0,cleanUp:!0};e.Editor=e.lang.Dispatcher.extend({constructor:function(t,r){this.textareaElement=typeof t=="string"?document.getElementById(t):t,this.config=e.lang.object({}).merge(n).merge(r).get(),this.textarea=new e.views.Textarea(this,this.textareaElement,this.config),this.currentView=this.textarea,this._isCompatible=e.browser.supported();if(!this._isCompatible||!this.config.supportTouchDevices&&e.browser.isTouchDevice()){var i=this;setTimeout(function(){i.fire("beforeload").fire("load")},0);return}e.dom.addClass(document.body,this.config.bodyClassName),this.composer=new e.views.Composer(this,this.textareaElement,this.config),this.currentView=this.composer,typeof this.config.parser=="function"&&this._initParser(),this.on("beforeload",function(){this.synchronizer=new e.views.Synchronizer(this,this.textarea,this.composer),this.config.toolbar&&(this.toolbar=new e.toolbar.Toolbar(this,this.config.toolbar))});try{console.log("Heya! This page is using wysihtml5 for rich text editing. Check out https://github.com/xing/wysihtml5")}catch(s){}},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(e){return this.currentView.getValue(e)},setValue:function(e,t){return this.fire("unset_placeholder"),e?(this.currentView.setValue(e,t),this):this.clear()},focus:function(e){return this.currentView.focus(e),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(t){var n=this.config.parser(t,this.config.parserRules,this.composer.sandbox.getDocument(),this.config.cleanUp);return typeof t=="object"&&e.quirks.redraw(t),n},_initParser:function(){this.on("paste:composer",function(){var t=!0,n=this;n.composer.selection.executeAndRestore(function(){e.quirks.cleanPastedHTML(n.composer.element),n.parse(n.composer.element)},t)})}})}(wysihtml5),Braintree=function(){function e(t,n){t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=n)}function t(e,t,n,r,i){this.stream=e,this.header=t,this.length=n,this.tag=r,this.sub=i}function i(e){var t,i,s="";for(t=0;t+3<=e.length;t+=3)i=parseInt(e.substring(t,t+3),16),s+=n.charAt(i>>6)+n.charAt(i&63);t+1==e.length?(i=parseInt(e.substring(t,t+1),16),s+=n.charAt(i<<2)):t+2==e.length&&(i=parseInt(e.substring(t,t+2),16),s+=n.charAt(i>>2)+n.charAt((i&3)<<4));while((s.length&3)>0)s+=r;return s}function s(e){var t="",i,s=0,o;for(i=0;i<e.length;++i){if(e.charAt(i)==r)break;v=n.indexOf(e.charAt(i));if(v<0)continue;s==0?(t+=E(v>>2),o=v&3,s=1):s==1?(t+=E(o<<2|v>>4),o=v&15,s=2):s==2?(t+=E(o),t+=E(v>>2),o=v&3,s=3):(t+=E(o<<2|v>>4),t+=E(v&15),s=0)}return s==1&&(t+=E(o<<2)),t}function o(e){var t=s(e),n,r=new Array;for(n=0;2*n<t.length;++n)r[n]=parseInt(t.substring(2*n,2*n+2),16);return r}function l(e,t,n){e!=null&&("number"==typeof e?this.fromNumber(e,t,n):t==null&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function c(){return new l(null)}function h(e,t,n,r,i,s){while(--s>=0){var o=t*this[e++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=o&67108863}return i}function p(e,t,n,r,i,s){var o=t&32767,u=t>>15;while(--s>=0){var a=this[e]&32767,f=this[e++]>>15,l=u*a+f*o;a=o*a+((l&32767)<<15)+n[r]+(i&1073741823),i=(a>>>30)+(l>>>15)+u*f+(i>>>30),n[r++]=a&1073741823}return i}function d(e,t,n,r,i,s){var o=t&16383,u=t>>14;while(--s>=0){var a=this[e]&16383,f=this[e++]>>14,l=u*a+f*o;a=o*a+((l&16383)<<14)+n[r]+i,i=(a>>28)+(l>>14)+u*f,n[r++]=a&268435455}return i}function E(e){return g.charAt(e)}function S(e,t){var n=y[e.charCodeAt(t)];return n==null?-1:n}function x(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function T(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0}function N(e){var t=c();return t.fromInt(e),t}function C(e,t){var n;if(t==16)n=4;else if(t==8)n=3;else if(t==256)n=8;else if(t==2)n=1;else if(t==32)n=5;else{if(t!=4){this.fromRadix(e,t);return}n=2}this.t=0,this.s=0;var r=e.length,i=!1,s=0;while(--r>=0){var o=n==8?e[r]&255:S(e,r);if(o<0){e.charAt(r)=="-"&&(i=!0);continue}i=!1,s==0?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=n,s>=this.DB&&(s-=this.DB)}n==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&l.ZERO.subTo(this,this)}function L(){var e=this.s&this.DM;while(this.t>0&&this[this.t-1]==e)--this.t}function A(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else{if(e!=4)return this.toRadix(e);t=2}var n=(1<<t)-1,r,i=!1,s="",o=this.t,u=this.DB-o*this.DB%t;if(o-->0){u<this.DB&&(r=this[o]>>u)>0&&(i=!0,s=E(r));while(o>=0)u<t?(r=(this[o]&(1<<u)-1)<<t-u,r|=this[--o]>>(u+=this.DB-t)):(r=this[o]>>(u-=t)&n,u<=0&&(u+=this.DB,--o)),r>0&&(i=!0),i&&(s+=E(r))}return i?s:"0"}function O(){var e=c();return l.ZERO.subTo(this,e),e}function M(){return this.s<0?this.negate():this}function _(e){var t=this.s-e.s;if(t!=0)return t;var n=this.t;t=n-e.t;if(t!=0)return this.s<0?-t:t;while(--n>=0)if((t=this[n]-e[n])!=0)return t;return 0}function D(e){var t=1,n;return(n=e>>>16)!=0&&(e=n,t+=16),(n=e>>8)!=0&&(e=n,t+=8),(n=e>>4)!=0&&(e=n,t+=4),(n=e>>2)!=0&&(e=n,t+=2),(n=e>>1)!=0&&(e=n,t+=1),t}function P(){return this.t<=0?0:this.DB*(this.t-1)+D(this[this.t-1]^this.s&this.DM)}function H(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function B(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function j(e,t){var n=e%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(e/this.DB),o=this.s<<n&this.DM,u;for(u=this.t-1;u>=0;--u)t[u+s+1]=this[u]>>r|o,o=(this[u]&i)<<n;for(u=s-1;u>=0;--u)t[u]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function F(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}var r=e%this.DB,i=this.DB-r,s=(1<<r)-1;t[0]=this[n]>>r;for(var o=n+1;o<this.t;++o)t[o-n-1]|=(this[o]&s)<<i,t[o-n]=this[o]>>r;r>0&&(t[this.t-n-1]|=(this.s&s)<<i),t.t=this.t-n,t.clamp()}function I(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){r-=e.s;while(n<this.t)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{r+=this.s;while(n<e.t)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()}function q(e,t){var n=this.abs(),r=e.abs(),i=n.t;t.t=i+r.t;while(--i>=0)t[i]=0;for(i=0;i<r.t;++i)t[i+n.t]=n.am(0,r[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&l.ZERO.subTo(t,t)}function R(e){var t=this.abs(),n=e.t=2*t.t;while(--n>=0)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function U(e,t,n){var r=e.abs();if(r.t<=0)return;var i=this.abs();if(i.t<r.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n==null&&(n=c());var s=c(),o=this.s,u=e.s,a=this.DB-D(r[r.t-1]);a>0?(r.lShiftTo(a,s),i.lShiftTo(a,n)):(r.copyTo(s),i.copyTo(n));var f=s.t,h=s[f-1];if(h==0)return;var p=h*(1<<this.F1)+(f>1?s[f-2]>>this.F2:0),d=this.FV/p,v=(1<<this.F1)/p,m=1<<this.F2,g=n.t,y=g-f,b=t==null?c():t;s.dlShiftTo(y,b),n.compareTo(b)>=0&&(n[n.t++]=1,n.subTo(b,n)),l.ONE.dlShiftTo(f,b),b.subTo(s,s);while(s.t<f)s[s.t++]=0;while(--y>=0){var w=n[--g]==h?this.DM:Math.floor(n[g]*d+(n[g-1]+m)*v);if((n[g]+=s.am(0,w,n,y,0,f))<w){s.dlShiftTo(y,b),n.subTo(b,n);while(n[g]<--w)n.subTo(b,n)}}t!=null&&(n.drShiftTo(f,t),o!=u&&l.ZERO.subTo(t,t)),n.t=f,n.clamp(),a>0&&n.rShiftTo(a,n),o<0&&l.ZERO.subTo(n,n)}function z(e){var t=c();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(l.ZERO)>0&&e.subTo(t,t),t}function W(e){this.m=e}function X(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function V(e){return e}function $(e){e.divRemTo(this.m,null,e)}function J(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function K(e,t){e.squareTo(t),this.reduce(t)}function Q(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function G(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Y(e){var t=c();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(l.ZERO)>0&&this.m.subTo(t,t),t}function Z(e){var t=c();return e.copyTo(t),this.reduce(t),t}function et(e){while(e.t<=this.mt2)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=e[t]&32767,r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;n=t+this.m.t,e[n]+=this.m.am(0,r,e,t,0,this.m.t);while(e[n]>=e.DV)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function tt(e,t){e.squareTo(t),this.reduce(t)}function nt(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function rt(){return(this.t>0?this[0]&1:this.s)==0}function it(e,t){if(e>4294967295||e<1)return l.ONE;var n=c(),r=c(),i=t.convert(this),s=D(e)-1;i.copyTo(n);while(--s>=0){t.sqrTo(n,r);if((e&1<<s)>0)t.mulTo(r,i,n);else{var o=n;n=r,r=o}}return t.revert(n)}function st(e,t){var n;return e<256||t.isEven()?n=new W(t):n=new G(t),this.exp(e,n)}function ot(e,t){return new l(e,t)}function ut(e,t){var n="",r=0;while(r+t<e.length)n+=e.substring(r,r+t)+"\n",r+=t;return n+e.substring(r,e.length)}function at(e){return e<16?"0"+e.toString(16):e.toString(16)}function ft(e,t){if(t<e.length+11)return alert("Message too long for RSA"),null;var n=new Array,r=e.length-1;while(r>=0&&t>0){var i=e.charCodeAt(r--);i<128?n[--t]=i:i>127&&i<2048?(n[--t]=i&63|128,n[--t]=i>>6|192):(n[--t]=i&63|128,n[--t]=i>>6&63|128,n[--t]=i>>12|224)}n[--t]=0;var s=0,o=0,u=0;while(t>2)u==0&&(o=vt.random.randomWords(1,0)[0]),s=o>>u&255,u=(u+8)%32,s!=0&&(n[--t]=s);return n[--t]=2,n[--t]=0,new l(n)}function lt(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function ct(e,t){e!=null&&t!=null&&e.length>0&&t.length>0?(this.n=ot(e,16),this.e=parseInt(t,16)):alert("Invalid RSA public key")}function ht(e){return e.modPowInt(this.e,this.n)}function pt(e){var t=ft(e,this.n.bitLength()+7>>3);if(t==null)return null;var n=this.doPublic(t);if(n==null)return null;var r=n.toString(16);return(r.length&1)==0?r:"0"+r}function dt(e){var t=this.encrypt(e);return t?i(t):null}e.prototype.get=function(e){e==undefined&&(e=this.pos++);if(e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},e.prototype.hexDigits="0123456789ABCDEF",e.prototype.hexByte=function(e){return this.hexDigits.charAt(e>>4&15)+this.hexDigits.charAt(e&15)},e.prototype.hexDump=function(e,t){var n="";for(var r=e;r<t;++r){n+=this.hexByte(this.get(r));switch(r&15){case 7:n+="  ";break;case 15:n+="\n";break;default:n+=" "}}return n},e.prototype.parseStringISO=function(e,t){var n="";for(var r=e;r<t;++r)n+=String.fromCharCode(this.get(r));return n},e.prototype.parseStringUTF=function(e,t){var n="",r=0;for(var i=e;i<t;){var r=this.get(i++);r<128?n+=String.fromCharCode(r):r>191&&r<224?n+=String.fromCharCode((r&31)<<6|this.get(i++)&63):n+=String.fromCharCode((r&15)<<12|(this.get(i++)&63)<<6|this.get(i++)&63)}return n},e.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,e.prototype.parseTime=function(e,t){var n=this.parseStringISO(e,t),r=this.reTime.exec(n);return r?(n=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4],r[5]&&(n+=":"+r[5],r[6]&&(n+=":"+r[6],r[7]&&(n+="."+r[7]))),r[8]&&(n+=" UTC",r[8]!="Z"&&(n+=r[8],r[9]&&(n+=":"+r[9]))),n):"Unrecognized time: "+n},e.prototype.parseInteger=function(e,t){var n=t-e;if(n>4){n<<=3;var r=this.get(e);if(r==0)n-=8;else while(r<128)r<<=1,--n;return"("+n+" bit)"}var i=0;for(var s=e;s<t;++s)i=i<<8|this.get(s);return i},e.prototype.parseBitString=function(e,t){var n=this.get(e),r=(t-e-1<<3)-n,i="("+r+" bit)";if(r<=20){var s=n;i+=" ";for(var o=t-1;o>e;--o){var u=this.get(o);for(var a=s;a<8;++a)i+=u>>a&1?"1":"0";s=0}}return i},e.prototype.parseOctetString=function(e,t){var n=t-e,r="("+n+" byte) ";n>20&&(t=e+20);for(var i=e;i<t;++i)r+=this.hexByte(this.get(i));return n>20&&(r+=String.fromCharCode(8230)),r},e.prototype.parseOID=function(e,t){var n,r=0,i=0;for(var s=e;s<t;++s){var o=this.get(s);r=r<<7|o&127,i+=7,o&128||(n==undefined?n=parseInt(r/40)+"."+r%40:n+="."+(i>=31?"bigint":r),r=i=0),n+=String.fromCharCode()}return n},t.prototype.typeName=function(){if(this.tag==undefined)return"unknown";var e=this.tag>>6,t=this.tag>>5&1,n=this.tag&31;switch(e){case 0:switch(n){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+n.toString(16)};case 1:return"Application_"+n.toString(16);case 2:return"["+n+"]";case 3:return"Private_"+n.toString(16)}},t.prototype.content=function(){if(this.tag==undefined)return null;var e=this.tag>>6;if(e!=0)return this.sub==null?null:"("+this.sub.length+")";var t=this.tag&31,n=this.posContent(),r=Math.abs(this.length);switch(t){case 1:return this.stream.get(n)==0?"false":"true";case 2:return this.stream.parseInteger(n,n+r);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(n,n+r);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+r);case 6:return this.stream.parseOID(n,n+r);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(n,n+r);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(n,n+r);case 23:case 24:return this.stream.parseTime(n,n+r)}return null},t.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub==null?"null":this.sub.length)+"]"},t.prototype.print=function(e){e==undefined&&(e=""),document.writeln(e+this);if(this.sub!=null){e+="  ";for(var t=0,n=this.sub.length;t<n;++t)this.sub[t].print(e)}},t.prototype.toPrettyString=function(e){e==undefined&&(e="");var t=e+this.typeName()+" @"+this.stream.pos;this.length>=0&&(t+="+"),t+=this.length,this.tag&32?t+=" (constructed)":(this.tag==3||this.tag==4)&&this.sub!=null&&(t+=" (encapsulates)"),t+="\n";if(this.sub!=null){e+="  ";for(var n=0,r=this.sub.length;n<r;++n)t+=this.sub[n].toPrettyString(e)}return t},t.prototype.posStart=function(){return this.stream.pos},t.prototype.posContent=function(){return this.stream.pos+this.header},t.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},t.decodeLength=function(e){var t=e.get(),n=t&127;if(n==t)return n;if(n>3)throw"Length over 24 bits not supported at position "+(e.pos-1);if(n==0)return-1;t=0;for(var r=0;r<n;++r)t=t<<8|e.get();return t},t.hasContent=function(n,r,i){if(n&32)return!0;if(n<3||n>4)return!1;var s=new e(i);n==3&&s.get();var o=s.get();if(o>>6&1)return!1;try{var u=t.decodeLength(s);return s.pos-i.pos+u==r}catch(a){return!1}},t.decode=function(n){n instanceof e||(n=new e(n,0));var r=new e(n),i=n.get(),s=t.decodeLength(n),o=n.pos-r.pos,u=null;if(t.hasContent(i,s,n)){var a=n.pos;i==3&&n.get(),u=[];if(s>=0){var f=a+s;while(n.pos<f)u[u.length]=t.decode(n);if(n.pos!=f)throw"Content size is not correct for container starting at offset "+a}else try{for(;;){var l=t.decode(n);if(l.tag==0)break;u[u.length]=l}s=a-n.pos}catch(c){throw"Exception while decoding undefined length content: "+c}}else n.pos+=s;return new t(r,o,s,i,u)};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="=",u,a=0xdeadbeefcafe,f=(a&16777215)==15715070;f&&navigator.appName=="Microsoft Internet Explorer"?(l.prototype.am=p,u=30):f&&navigator.appName!="Netscape"?(l.prototype.am=h,u=26):(l.prototype.am=d,u=28),l.prototype.DB=u,l.prototype.DM=(1<<u)-1,l.prototype.DV=1<<u;var m=52;l.prototype.FV=Math.pow(2,m),l.prototype.F1=m-u,l.prototype.F2=2*u-m;var g="0123456789abcdefghijklmnopqrstuvwxyz",y=new Array,b,w;b="0".charCodeAt(0);for(w=0;w<=9;++w)y[b++]=w;b="a".charCodeAt(0);for(w=10;w<36;++w)y[b++]=w;b="A".charCodeAt(0);for(w=10;w<36;++w)y[b++]=w;W.prototype.convert=X,W.prototype.revert=V,W.prototype.reduce=$,W.prototype.mulTo=J,W.prototype.sqrTo=K,G.prototype.convert=Y,G.prototype.revert=Z,G.prototype.reduce=et,G.prototype.mulTo=nt,G.prototype.sqrTo=tt,l.prototype.copyTo=x,l.prototype.fromInt=T,l.prototype.fromString=C,l.prototype.clamp=L,l.prototype.dlShiftTo=H,l.prototype.drShiftTo=B,l.prototype.lShiftTo=j,l.prototype.rShiftTo=F,l.prototype.subTo=I,l.prototype.multiplyTo=q,l.prototype.squareTo=R,l.prototype.divRemTo=U,l.prototype.invDigit=Q,l.prototype.isEven=rt,l.prototype.exp=it,l.prototype.toString=A,l.prototype.negate=O,l.prototype.abs=M,l.prototype.compareTo=_,l.prototype.bitLength=P,l.prototype.mod=z,l.prototype.modPowInt=st,l.ZERO=N(0),l.ONE=N(1),lt.prototype.doPublic=ht,lt.prototype.setPublic=ct,lt.prototype.encrypt=pt,lt.prototype.encrypt_b64=dt,"use strict";var vt={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};typeof module!="undefined"&&module.exports&&(module.exports=vt),vt.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var t,n,r,i,s,o=this._tables[0][4],u=this._tables[1],a=e.length,f=1;if(a!==4&&a!==6&&a!==8)throw new vt.exception.invalid("invalid aes key size");this._key=[i=e.slice(0),s=[]];for(t=a;t<4*a+28;t++){r=i[t-1];if(t%a===0||a===8&&t%a===4)r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[r&255],t%a===0&&(r=r<<8^r>>>24^f<<24,f=f<<1^(f>>7)*283);i[t]=i[t-a]^r}for(n=0;t;n++,t--)r=i[n&3?t:t-4],t<=4||n<4?s[n]=r:s[n]=u[0][o[r>>>24]]^u[1][o[r>>16&255]]^u[2][o[r>>8&255]]^u[3][o[r&255]]},vt.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e=this._tables[0],t=this._tables[1],n=e[4],r=t[4],i,s,o,u=[],a=[],f,l,c,h,p,d;for(i=0;i<256;i++)a[(u[i]=i<<1^(i>>7)*283)^i]=i;for(s=o=0;!n[s];s^=f||1,o=a[o]||1){h=o^o<<1^o<<2^o<<3^o<<4,h=h>>8^h&255^99,n[s]=h,r[h]=s,c=u[l=u[f=u[s]]],d=c*16843009^l*65537^f*257^s*16843008,p=u[h]*257^h*16843008;for(i=0;i<4;i++)e[i][s]=p=p<<24^p>>>8,t[i][h]=d=d<<24^d>>>8}for(i=0;i<5;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)},_crypt:function(e,t){if(e.length!==4)throw new vt.exception.invalid("invalid aes block size");var n=this._key[t],r=e[0]^n[0],i=e[t?3:1]^n[1],s=e[2]^n[2],o=e[t?1:3]^n[3],u,a,f,l=n.length/4-2,c,h=4,p=[0,0,0,0],d=this._tables[t],v=d[0],m=d[1],g=d[2],y=d[3],b=d[4];for(c=0;c<l;c++)u=v[r>>>24]^m[i>>16&255]^g[s>>8&255]^y[o&255]^n[h],a=v[i>>>24]^m[s>>16&255]^g[o>>8&255]^y[r&255]^n[h+1],f=v[s>>>24]^m[o>>16&255]^g[r>>8&255]^y[i&255]^n[h+2],o=v[o>>>24]^m[r>>16&255]^g[i>>8&255]^y[s&255]^n[h+3],h+=4,r=u,i=a,s=f;for(c=0;c<4;c++)p[t?3&-c:c]=b[r>>>24]<<24^b[i>>16&255]<<16^b[s>>8&255]<<8^b[o&255]^n[h++],u=r,r=i,i=s,s=o,o=u;return p}},vt.bitArray={bitSlice:function(e,t,n){return e=vt.bitArray._shiftRight(e.slice(t/32),32-(t&31)).slice(1),n===undefined?e:vt.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r,i=Math.floor(-t-n&31);return(t+n-1^t)&-32?r=e[t/32|0]<<32-i^e[t/32+1|0]>>>i:r=e[t/32|0]>>>i,r&(1<<n)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var n,r,i=e[e.length-1],s=vt.bitArray.getPartial(i);return s===32?e.concat(t):vt.bitArray._shiftRight(t,s,i|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length,n;return t===0?0:(n=e[t-1],(t-1)*32+vt.bitArray.getPartial(n))},clamp:function(e,t){if(e.length*32<t)return e;e=e.slice(0,Math.ceil(t/32));var n=e.length;return t&=31,n>0&&t&&(e[n-1]=vt.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return e===32?t:(n?t|0:t<<32-e)+e*1099511627776},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(vt.bitArray.bitLength(e)!==vt.bitArray.bitLength(t))return!1;var n=0,r;for(r=0;r<e.length;r++)n|=e[r]^t[r];return n===0},_shiftRight:function(e,t,n,r){var i,s=0,o;r===undefined&&(r=[]);for(;t>=32;t-=32)r.push(n),n=0;if(t===0)return r.concat(e);for(i=0;i<e.length;i++)r.push(n|e[i]>>>t),n=e[i]<<32-t;return s=e.length?e[e.length-1]:0,o=vt.bitArray.getPartial(s),r.push(vt.bitArray.partial(t+o&31,t+o>32?n:r.pop(),1)),r},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}},vt.codec.hex={fromBits:function(e){var t="",n,r;for(n=0;n<e.length;n++)t+=((e[n]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,vt.bitArray.bitLength(e)/4)},toBits:function(e){var t,n=[],r;e=e.replace(/\s|0x/g,""),r=e.length,e+="00000000";for(t=0;t<e.length;t+=8)n.push(parseInt(e.substr(t,8),16)^0);return vt.bitArray.clamp(n,r*4)}},vt.codec.utf8String={fromBits:function(e){var t="",n=vt.bitArray.bitLength(e),r,i;for(r=0;r<n/8;r++)(r&3)===0&&(i=e[r/4]),t+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],n,r=0;for(n=0;n<e.length;n++)r=r<<8|e.charCodeAt(n),(n&3)===3&&(t.push(r),r=0);return n&3&&t.push(vt.bitArray.partial(8*(n&3),r)),t}},vt.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var r="",i,s=0,o=vt.codec.base64._chars,u=0,a=vt.bitArray.bitLength(e);n&&(o=o.substr(0,62)+"-_");for(i=0;r.length*6<a;)r+=o.charAt((u^e[i]>>>s)>>>26),s<6?(u=e[i]<<6-s,s+=26,i++):(u<<=6,s-=6);while(r.length&3&&!t)r+="=";return r},toBits:function(e,t){e=e.replace(/\s|=/g,"");var n=[],r,i=0,s=vt.codec.base64._chars,o=0,u;t&&(s=s.substr(0,62)+"-_");for(r=0;r<e.length;r++){u=s.indexOf(e.charAt(r));if(u<0)throw new vt.exception.invalid("this isn't base64!");i>26?(i-=26,n.push(o^u>>>i),o=u<<32-i):(i+=6,o^=u<<32-i)}return i&56&&n.push(vt.bitArray.partial(i&56,o,1)),n}},vt.codec.base64url={fromBits:function(e){return vt.codec.base64.fromBits(e,1,1)},toBits:function(e){return vt.codec.base64.toBits(e,1)}},vt.beware===undefined&&(vt.beware={}),vt.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){vt.mode.cbc={name:"cbc",encrypt:function(e,t,n,r){if(r&&r.length)throw new vt.exception.invalid("cbc can't authenticate data");if(vt.bitArray.bitLength(n)!==128)throw new vt.exception.invalid("cbc iv must be 128 bits");var i,s=vt.bitArray,o=s._xor4,u=s.bitLength(t),a=0,f=[];if(u&7)throw new vt.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(i=0;a+128<=u;i+=4,a+=128)n=e.encrypt(o(n,t.slice(i,i+4))),f.splice(i,0,n[0],n[1],n[2],n[3]);return u=(16-(u>>3&15))*16843009,n=e.encrypt(o(n,s.concat(t,[u,u,u,u]).slice(i,i+4))),f.splice(i,0,n[0],n[1],n[2],n[3]),f},decrypt:function(e,t,n,r){if(r&&r.length)throw new vt.exception.invalid("cbc can't authenticate data");if(vt.bitArray.bitLength(n)!==128)throw new vt.exception.invalid("cbc iv must be 128 bits");if(vt.bitArray.bitLength(t)&127||!t.length)throw new vt.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var i,s=vt.bitArray,o=s._xor4,u,a,f=[];r=r||[];for(i=0;i<t.length;i+=4)u=t.slice(i,i+4),a=o(n,e.decrypt(u)),f.splice(i,0,a[0],a[1],a[2],a[3]),n=u;u=f[i-1]&255;if(u==0||u>16)throw new vt.exception.corrupt("pkcs#5 padding corrupt");a=u*16843009;if(!s.equal(s.bitSlice([a,a,a,a],0,u*8),s.bitSlice(f,f.length*32-u*8,f.length*32)))throw new vt.exception.corrupt("pkcs#5 padding corrupt");return s.bitSlice(f,0,f.length*32-u*8)}}},vt.misc.hmac=function(e,t){this._hash=t=t||vt.hash.sha256;var n=[[],[]],r,i=t.prototype.blockSize/32;this._baseHash=[new t,new t],e.length>i&&(e=t.hash(e));for(r=0;r<i;r++)n[0][r]=e[r]^909522486,n[1][r]=e[r]^1549556828;this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1])},vt.misc.hmac.prototype.encrypt=vt.misc.hmac.prototype.mac=function(e,t){var n=(new this._hash(this._baseHash[0])).update(e,t).finalize();return(new this._hash(this._baseHash[1])).update(n).finalize()},vt.hash.sha256=function(
e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},vt.hash.sha256.hash=function(e){return(new vt.hash.sha256).update(e).finalize()},vt.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){typeof e=="string"&&(e=vt.codec.utf8String.toBits(e));var t,n=this._buffer=vt.bitArray.concat(this._buffer,e),r=this._length,i=this._length=r+vt.bitArray.bitLength(e);for(t=512+r&-512;t<=i;t+=512)this._block(n.splice(0,16));return this},finalize:function(){var e,t=this._buffer,n=this._h;t=vt.bitArray.concat(t,[vt.bitArray.partial(1,1)]);for(e=t.length+2;e&15;e++)t.push(0);t.push(Math.floor(this._length/4294967296)),t.push(this._length|0);while(t.length)this._block(t.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){function r(e){return(e-Math.floor(e))*4294967296|0}var e=0,t=2,n;e:for(;e<64;t++){for(n=2;n*n<=t;n++)if(t%n===0)continue e;e<8&&(this._init[e]=r(Math.pow(t,.5))),this._key[e]=r(Math.pow(t,1/3)),e++}},_block:function(e){var t,n,r,i,s=e.slice(0),o=this._h,u=this._key,a=o[0],f=o[1],l=o[2],c=o[3],h=o[4],p=o[5],d=o[6],v=o[7];for(t=0;t<64;t++)t<16?n=s[t]:(r=s[t+1&15],i=s[t+14&15],n=s[t&15]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s[t&15]+s[t+9&15]|0),n=n+v+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(d^h&(p^d))+u[t],v=d,d=p,p=h,h=c+n|0,c=l,l=f,f=a,a=n+(f&l^c&(f^l))+(f>>>2^f>>>13^f>>>22^f<<30^f<<19^f<<10)|0;o[0]=o[0]+a|0,o[1]=o[1]+f|0,o[2]=o[2]+l|0,o[3]=o[3]+c|0,o[4]=o[4]+h|0,o[5]=o[5]+p|0,o[6]=o[6]+d|0,o[7]=o[7]+v|0}},vt.random={randomWords:function(e,t){var n=[],r,i=this.isReady(t),s;if(i===this._NOT_READY)throw new vt.exception.notReady("generator isn't seeded");i&this._REQUIRES_RESEED&&this._reseedFromPools(!(i&this._READY));for(r=0;r<e;r+=4)(r+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),s=this._gen4words(),n.push(s[0],s[1],s[2],s[3]);return this._gate(),n.slice(0,e)},setDefaultParanoia:function(e){this._defaultParanoia=e},addEntropy:function(e,t,n){n=n||"user";var r,i,s,o=(new Date).valueOf(),u=this._robins[n],a=this.isReady(),f=0;r=this._collectorIds[n],r===undefined&&(r=this._collectorIds[n]=this._collectorIdNext++),u===undefined&&(u=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length;switch(typeof e){case"number":t===undefined&&(t=1),this._pools[u].update([r,this._eventId++,1,t,o,1,e|0]);break;case"object":var l=Object.prototype.toString.call(e);if(l==="[object Uint32Array]"){s=[];for(i=0;i<e.length;i++)s.push(e[i]);e=s}else{l!=="[object Array]"&&(f=1);for(i=0;i<e.length&&!f;i++)typeof e[i]!="number"&&(f=1)}if(!f){if(t===undefined){t=0;for(i=0;i<e.length;i++){s=e[i];while(s>0)t++,s>>>=1}}this._pools[u].update([r,this._eventId++,2,t,o,e.length].concat(e))}break;case"string":t===undefined&&(t=e.length),this._pools[u].update([r,this._eventId++,3,t,o,e.length]),this._pools[u].update(e);break;default:f=1}if(f)throw new vt.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[u]+=t,this._poolStrength+=t,a===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(e){var t=this._PARANOIA_LEVELS[e!==undefined?e:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(e){var t=this._PARANOIA_LEVELS[e?e:this._defaultParanoia];return this._strength>=t?1:this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(this._collectorsStarted)return;if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new vt.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0},stopCollectors:function(){if(!this._collectorsStarted)return;window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1},addEventListener:function(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function(e,t){var n,r,i=this._callbacks[e],s=[];for(r in i)i.hasOwnProperty(r)&&i[r]===t&&s.push(r);for(n=0;n<s.length;n++)r=s[n],delete i[r]},_pools:[new vt.hash.sha256],_poolEntropy:[0],_reseedCount:0,_robins:{},_eventId:0,_collectorIds:{},_collectorIdNext:0,_strength:0,_poolStrength:0,_nextReseed:0,_key:[0,0,0,0,0,0,0,0],_counter:[0,0,0,0],_cipher:undefined,_defaultParanoia:6,_collectorsStarted:!1,_callbacks:{progress:{},seeded:{}},_callbackI:0,_NOT_READY:0,_READY:1,_REQUIRES_RESEED:2,_MAX_WORDS_PER_BURST:65536,_PARANOIA_LEVELS:[0,48,64,96,128,192,256,384,512,768,1024],_MILLISECONDS_PER_RESEED:3e4,_BITS_PER_RESEED:80,_gen4words:function(){for(var e=0;e<4;e++){this._counter[e]=this._counter[e]+1|0;if(this._counter[e])break}return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new vt.cipher.aes(this._key)},_reseed:function(e){this._key=vt.hash.sha256.hash(this._key.concat(e)),this._cipher=new vt.cipher.aes(this._key);for(var t=0;t<4;t++){this._counter[t]=this._counter[t]+1|0;if(this._counter[t])break}},_reseedFromPools:function(e){var t=[],n=0,r;this._nextReseed=t[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED;for(r=0;r<16;r++)t.push(Math.random()*4294967296|0);for(r=0;r<this._pools.length;r++){t=t.concat(this._pools[r].finalize()),n+=this._poolEntropy[r],this._poolEntropy[r]=0;if(!e&&this._reseedCount&1<<r)break}this._reseedCount>=1<<this._pools.length&&(this._pools.push(new vt.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=n,n>this._strength&&(this._strength=n),this._reseedCount++,this._reseed(t)},_mouseCollector:function(e){var t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0;vt.random.addEntropy([t,n],2,"mouse")},_loadTimeCollector:function(e){vt.random.addEntropy((new Date).valueOf(),2,"loadtime")},_fireEvent:function(e,t){var n,r=vt.random._callbacks[e],i=[];for(n in r)r.hasOwnProperty(n)&&i.push(r[n]);for(n=0;n<i.length;n++)i[n](t)}},function(){try{var e=new Uint32Array(32);crypto.getRandomValues(e),vt.random.addEntropy(e,1024,"crypto.getRandomValues")}catch(t){}}();for(k in vt.beware)vt.beware.hasOwnProperty(k)&&vt.beware[k]();return Braintree={sjcl:vt,version:"1.2.0"},Braintree.create=function(e){var n={publicKey:e},r=function(){return{key:vt.random.randomWords(8,0),encrypt:function(e){return this.encryptWithIv(e,vt.random.randomWords(4,0))},encryptWithIv:function(e,t){var n=new vt.cipher.aes(this.key),r=vt.codec.utf8String.toBits(e),i=vt.mode.cbc.encrypt(n,r,t),s=vt.bitArray.concat(t,i);return vt.codec.base64.fromBits(s)}}},i=function(){return{key:vt.random.randomWords(8,0),sign:function(e){var t=new vt.misc.hmac(this.key,vt.hash.sha256),n=t.encrypt(e);return vt.codec.base64.fromBits(n)}}},s=function(e){var t=[];if(e.typeName()=="INTEGER"){var n=e.posContent(),r=e.posEnd(),i=e.stream.hexDump(n,r).replace(/[ \n]/g,"");t.push(i)}if(e.sub!=null)for(var o=0;o<e.sub.length;o++)t=t.concat(s(e.sub[o]));return t},u=function(e){var n=o(e),r=t.decode(n),i=s(r);if(i.length!=2)throw"Malformed public key";var u=i[0],a=i[1],f=new lt;return f.setPublic(u,a),f},a=function(e){var t=u(n.publicKey),s=r(),o=i(),a=s.encrypt(e),f=o.sign(vt.codec.base64.toBits(a)),l=vt.bitArray.concat(s.key,o.key),c=vt.codec.base64.fromBits(l),h=t.encrypt_b64(c),p="$bt4|javascript_"+Braintree.version.replace(/\./g,"_")+"$";return p+h+"$"+a+"$"+f},f=new function(){this.encrypt=a,this.generateAesKey=r,this.generateRsaKey=u,this.publicKey=n.publicKey,this.version=Braintree.version,this.formEncrypter=new Braintree.FormEncrypter(this),this.onSubmitEncryptForm=this.formEncrypter.onSubmitEncryptForm};return vt.random.startCollectors(),f},function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.bt=e,this.onSubmitEncryptForm=t(this.onSubmitEncryptForm,this),this.encryptForm=t(this.encryptForm,this)}return e.prototype.create=function(e,t){var n,r,i;t==null&&(t={}),n=document.createElement(e);for(r in t)i=t[r],n.setAttribute(r,i);return n},e.prototype.inputElements=function(e){var t,n;return n=[],t=function(e){var r,i,s,o,u;o=e.children,u=[];for(i=0,s=o.length;i<s;i++)r=o[i],r.attributes["data-encrypted-name"]?u.push(n.push(r)):u.push(t(r));return u},t(e),n},e.prototype.encryptForm=function(e){var t,n,r,i,s,o,u,a;u=this.inputElements(e),a=[];for(s=0,o=u.length;s<o;s++)t=u[s],r=t.getAttribute("data-encrypted-name"),n=this.bt.encrypt(t.value),t.removeAttribute("name"),i=this.create("input",{value:n,type:"hidden",name:r}),a.push(e.appendChild(i));return a},e.prototype.extractForm=function(e){return window.jQuery&&e instanceof jQuery?e[0]:e instanceof Object?e:document.getElementById(e)},e.prototype.onSubmitEncryptForm=function(e,t){var n,r=this;t==null&&(t=function(e){return e}),e=this.extractForm(e),n=function(n){return r.encryptForm(e),t(n)};if(window.jQuery)return window.jQuery(e).submit(n);if(e.addEventListener)return e.addEventListener("submit",n,!1);if(e.attachEvent)return e.attachEvent("onsubmit",n)},e}(),Braintree.FormEncrypter=e}.call(this),Braintree}();var Queenbee={unhandledReadyCallbacks:[],DOM:{select:function(e){return window.jQuery?jQuery(e):typeof Prototype!="undefined"?$$(e):document.querySelectorAll(e)},ready:function(e){window.jQuery?jQuery(document).ready(e):typeof Prototype!="undefined"?document.on("dom:loaded",e):Queenbee.unhandledReadyCallbacks.unshift(e)}},Gateway:{configure:function(){var e=function(e){var t=Queenbee.DOM.select("meta[name="+e+"]")[0];return t?t.content:null};Queenbee.Gateway.environment=e("qb-environment"),Queenbee.Gateway.publicKey=e("qb-public-encryption-key"),Queenbee.Gateway.instance=Braintree.create(Queenbee.Gateway.publicKey)}},CreditCard:{testNumbers:["0000000000000000","378282246310005","371449635398431","378734493671000","30569309025904","38520000023237","4111111111111111","4012888888881881","4222222222222","4242424242424242","5555555555554444","5105105105105100","6011111111111117","6011000990139424"],isTestNumber:function(e){for(var t=0;t<Queenbee.CreditCard.testNumbers.length;t++)if(Queenbee.CreditCard.testNumbers[t]==e)return!0;return!1},validateNumber:function(e){if(String(e).replace(/\s+/g,"").length==0)return!1;if(Queenbee.Gateway.environment.match(/^production/)&&Queenbee.CreditCard.isTestNumber(e))return!1;e=String(e).replace(/\D+/g,"");var t=0;for(var n=0;n<e.length;n++){var r=(parseInt(e.substr(e.length-n-1,1))*(1+n%2)).toString();for(var i=0;i<r.length;i++)t+=parseInt(r.substr(i,1))}return t%10==0},validateCVV:function(e){return/^\d{3,4}$/.test(e)},validateZipCode:function(e){return/\w+/.test(e)},encryptForm:function(e){Queenbee.Gateway.instance.formEncrypter.encryptForm(e)}}};Queenbee.DOM.ready(Queenbee.Gateway.configure),function(e,t,n){function m(e,t,n){if(e.addEventListener){e.addEventListener(t,n,!1);return}e.attachEvent("on"+t,n)}function g(e){if(e.type=="keypress"){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return r[e.which]?r[e.which]:i[e.which]?i[e.which]:String.fromCharCode(e.which).toLowerCase()}function y(e,t){return e.sort().join(",")===t.sort().join(",")}function b(e){e=e||{};var t=!1,n;for(n in l){if(e[n]){t=!0;continue}l[n]=0}t||(d=!1)}function w(e,t,n,r,i,s){var o,u,f=[],c=n.type;if(!a[e])return[];c=="keyup"&&k(e)&&(t=[e]);for(o=0;o<a[e].length;++o){u=a[e][o];if(!r&&u.seq&&l[u.seq]!=u.level)continue;if(c!=u.action)continue;if(c=="keypress"&&!n.metaKey&&!n.ctrlKey||y(t,u.modifiers)){var h=!r&&u.combo==i,p=r&&u.seq==r&&u.level==s;(h||p)&&a[e].splice(o,1),f.push(u)}}return f}function E(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function S(e){if(e.preventDefault){e.preventDefault();return}e.returnValue=!1}function x(e){if(e.stopPropagation){e.stopPropagation();return}e.cancelBubble=!0}function T(e,t,n,r){if(B.stopCallback(t,t.target||t.srcElement,n,r))return;e(t,n)===!1&&(S(t),x(t))}function N(e,t,n){var r=w(e,t,n),i,s={},o=0,u=!1;for(i=0;i<r.length;++i)r[i].seq&&(o=Math.max(o,r[i].level));for(i=0;i<r.length;++i){if(r[i].seq){if(r[i].level!=o)continue;u=!0,s[r[i].seq]=1,T(r[i].callback,n,r[i].combo,r[i].seq);continue}u||T(r[i].callback,n,r[i].combo)}var a=n.type=="keypress"&&p;n.type==d&&!k(e)&&!a&&b(s),p=u&&n.type=="keydown"}function C(e){typeof e.which!="number"&&(e.which=e.keyCode);var t=g(e);if(!t)return;if(e.type=="keyup"&&h===t){h=!1;return}B.handleKey(t,E(e),e)}function k(e){return e=="shift"||e=="ctrl"||e=="alt"||e=="meta"}function L(){clearTimeout(c),c=setTimeout(b,1e3)}function A(){if(!u){u={};for(var e in r){if(e>95&&e<112)continue;r.hasOwnProperty(e)&&(u[r[e]]=e)}}return u}function O(e,t,n){return n||(n=A()[e]?"keydown":"keypress"),n=="keypress"&&t.length&&(n="keydown"),n}function M(e,t,n,r){function i(t){return function(){d=t,++l[e],L()}}function s(t){T(n,t,e),r!=="keyup"&&(h=g(t)),setTimeout(b,10)}l[e]=0;for(var o=0;o<t.length;++o){var u=o+1===t.length,a=u?s:i(r||D(t[o+1]).action);P(t[o],a,r,e,o)}}function _(e){return e==="+"?["+"]:e.split("+")}function D(e,t){var n,r,i,u=[];n=_(e);for(i=0;i<n.length;++i)r=n[i],o[r]&&(r=o[r]),t&&t!="keypress"&&s[r]&&(r=s[r],u.push("shift")),k(r)&&u.push(r);return t=O(r,u,t),{key:r,modifiers:u,action:t}}function P(e,t,n,r,i){f[e+":"+n]=t,e=e.replace(/\s+/g," ");var s=e.split(" "),o;if(s.length>1){M(e,s,t,n);return}o=D(e,n),a[o.key]=a[o.key]||[],w(o.key,o.modifiers,{type:o.action},r,e,i),a[o.key][r?"unshift":"push"]({callback:t,modifiers:o.modifiers,action:o.action,seq:r,level:i,combo:e})}function H(e,t,n){for(var r=0;r<e.length;++r)P(e[r],t,n)}var r={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},o={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},u,a={},f={},l={},c,h=!1,p=!1,d=!1;for(var v=1;v<20;++v)r[111+v]="f"+v;for(v=0;v<=9;++v)r[v+96]=v;m(t,"keypress",C),m(t,"keydown",C),m(t,"keyup",C);var B={bind:function(e,t,n){return e=e instanceof Array?e:[e],H(e,t,n),this},unbind:function(e,t){return B.bind(e,function(){},t)},trigger:function(e,t){return f[e+":"+t]&&f[e+":"+t]({},e),this},reset:function(){return a={},f={},this},stopCallback:function(e,t){return(" "+t.className+" ").indexOf(" mousetrap ")>-1?!1:t.tagName=="INPUT"||t.tagName=="SELECT"||t.tagName=="TEXTAREA"||t.isContentEditable},handleKey:N};e.Mousetrap=B,typeof define=="function"&&define.amd&&define(B)}(window,document),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m;n=function(){return document.querySelectorAll&&document.addEventListener};if(!n())return;isNaN(Date.parse("2011-01-01T12:00:00-05:00"))&&(u=Date.parse,i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(Z|[-+]?[\d:]+)$/,Date.parse=function(e){var t,n,r,s,o,a,f,l,c,h;e=e.toString();if(r=e.match(i))h=r[0],l=r[1],o=r[2],t=r[3],n=r[4],s=r[5],f=r[6],c=r[7],c!=="Z"&&(a=c.replace(":","")),e=""+l+"/"+o+"/"+t+" "+n+":"+s+":"+f+" GMT"+[a];return u(e)}),m="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),s="January February March April May June July August September October November December".split(" "),o=function(e){return("0"+e).slice(-2)},d=function(e,t){var n,r,i,u,a,f,l;return r=e.getDay(),n=e.getDate(),a=e.getMonth(),l=e.getFullYear(),i=e.getHours(),u=e.getMinutes(),f=e.getSeconds(),t.replace(/%([%aAbBcdeHIlmMpPSwyYZ])/g,function(t){var c,h,p,v;c=t[0],h=t[1];switch(h){case"%":return"%";case"a":return m[r].slice(0,3);case"A":return m[r];case"b":return s[a].slice(0,3);case"B":return s[a];case"c":return e.toString();case"d":return o(n);case"e":return n;case"H":return o(i);case"I":return o(d(e,"%l"));case"l":return i===0||i===12?12:(i+12)%12;case"m":return o(a+1);case"M":return o(u);case"p":return i>11?"PM":"AM";case"P":return i>11?"pm":"am";case"S":return o(f);case"w":return r;case"y":return o(l%100);case"Y":return l;case"Z":return(p=(v=e.toString().match(/\((\w+)\)$/))!=null?v[1]:void 0)!=null?p:""}})},e=function(){function e(e,t,n){this.date=new Date(Date.UTC(e,t-1)),this.date.setUTCDate(n),this.year=this.date.getUTCFullYear(),this.month=this.date.getUTCMonth()+1,this.day=this.date.getUTCDate(),this.value=this.date.getTime()}return e.fromDate=function(e){return new this(e.getFullYear(),e.getMonth()+1,e.getDate())},e.today=function(){return this.fromDate(new Date)},e.prototype.equals=function(e){return(e!=null?e.value:void 0)===this.value},e.prototype.is=function(e){return this.equals(e)},e.prototype.isToday=function(){return this.is(this.constructor.today())},e.prototype.occursOnSameYearAs=function(e){return this.year===(e!=null?e.year:void 0)},e.prototype.occursThisYear=function(){return this.occursOnSameYearAs(this.constructor.today())},e.prototype.daysSince=function(e){if(e)return(this.date-e.date)/864e5},e.prototype.daysPassed=function(){return this.constructor.today().daysSince(this)},e}(),t=function(){function t(t){this.date=t,this.calendarDate=e.fromDate(this.date)}return t.prototype.toString=function(){var e,t;return(e=this.timeElapsed())?""+e+" ago":(t=this.relativeWeekday())?""+t+" at "+this.formatTime():"on "+this.formatDate()},t.prototype.toTimeOrDateString=function(){return this.calendarDate.isToday()?this.formatTime():this.formatDate()},t.prototype.timeElapsed=function(){var e,t,n,r;return n=(new Date).getTime()-this.date.getTime(),r=Math.round(n/1e3),t=Math.round(r/60),e=Math.round(t/60),n<0?null:r<10?"a second":r<45?""+r+" seconds":r<90?"a minute":t<45?""+t+" minutes":t<90?"an hour":e<24?""+e+" hours":null},t.prototype.relativeWeekday=function(){var e;return e=this.calendarDate.daysPassed(),e>6?null:e===0?"today":e===1?"yesterday":d(this.date,"%A")},t.prototype.formatDate=function(){var e;return e="%b %e",this.calendarDate.occursThisYear()||(e+=", %Y"),d(this.date,e)},t.prototype.formatTime=function(){return d(this.date,"%l:%M%P")},t}(),f=function(e){return(new t(e)).formatDate()},l=function(e){return(new t(e)).toString()},c=function(e){return(new t(e)).toTimeOrDateString()},h=function(e){var n;if(n=(new t(e)).relativeWeekday())return n.charAt(0).toUpperCase()+n.substring(1)},r=!1,v=function(e){return r&&e(),document.addEventListener("time:elapse",e),(typeof Turbolinks!="undefined"&&Turbolinks!==null?Turbolinks.supported:void 0)?document.addEventListener("page:update",e):typeof jQuery=="function"?jQuery(document).on("ajaxSuccess",function(t,n){if(jQuery.trim(n.responseText))return e()}):void 0},a=function(e,t){return v(function(){var n,r,i,s,o;s=document.querySelectorAll(e),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],o.push(t(n));return o})},document.addEventListener("DOMContentLoaded",function(){var e;return r=!0,e="textContent"in document.body?"textContent":"innerText",a("time[data-local]:not([data-localized])",function(t){var n,r,i,s;n=t.getAttribute("datetime"),r=t.getAttribute("data-format"),i=t.getAttribute("data-local"),s=new Date(Date.parse(n));if(isNaN(s))return;return t.hasAttribute("title")||t.setAttribute("title",d(s,"%B %e, %Y at %l:%M%P %Z")),t[e]=function(){var e;switch(i){case"date":return t.setAttribute("data-localized",!0),f(s);case"time":return t.setAttribute("data-localized",!0),d(s,r);case"time-ago":return l(s);case"time-or-date":return c(s);case"weekday":return(e=h(s))!=null?e:""}}()})}),p=function(){var e;return e=document.createEvent("Events"),e.initEvent("time:elapse",!0,!0),document.dispatchEvent(e)},setInterval(p,6e4),this.LocalTime={relativeDate:f,relativeTimeAgo:l,relativeTimeOrDate:c,relativeWeekday:h,run:p,strftime:d}}.call(this),function(){window.bcx==null&&(window.bcx={}),_.extend(bcx,{models:{},collections:{},views:{},helpers:{},env:"production",searchHost:"search.basecamp.com",progressHost:"progress.basecamp.com",bucketColors:["3185c5","000099","3B9E93","009900","aa0000","ec61a2","cc6633","666666","000000","660099","ff9c00","e207c1","a5460d","650606","482a15","2c5322","b3a543","46647c"],storage:new StorageAdapter(window.localStorage,bcx.storageNamespace)})}.call(this),function(){var e,t,n,r,i;e="log debug info warn error assert clear dir dirxml trace\ngroup groupCollapsed groupEnd time timeEnd timeStamp\nprofile profileEnd count exception table".split(" "),window.console==null&&(window.console={});for(r=0,i=e.length;r<i;r++)t=e[r],(n=window.console)[t]==null&&(n[t]=function(){})}.call(this),function(){$(function(){return $("meta[name=csrf-token]").attr("content",$.cookie("csrf-token")),$("meta[name=csrf-param]").attr("content",$.cookie("csrf-param"))})}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=function(e){var n,r,i,s;return n=$(document.documentElement),r=(i=(s=n.attr("data-features"))!=null?s.split(" "):void 0)!=null?i:[],t.call(r,e)<0&&r.push(e),n.attr("data-features",r.join(" "))},window.File&&e("files_api")}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c=[].slice;n=(f=window.localStorage)!=null?f.debug:void 0,r={},(t=(l=window.chrome)!=null?l.csi:void 0)?s=function(e,n,r){var i,s;return s=t().pageT,e.apply(n,r),i=t().pageT-s,Math.round(i*100)/100}:s=function(e,t,n){var r;return r=(new Date).getTime(),e.apply(t,n),(new Date).getTime()-r},a=function(e){return o?u.push(e):e()},i=function(e){return function(){var t,i,o,u,f,l,h,p;t=1<=arguments.length?c.call(arguments,0):[],n&&a(function(){return console.group("[%s]",e)}),h=r[e],u=function(e,r){return a(function(){var i,o;try{i=s(e,this,t);if(n)return console.log("%sms: %s",i,r)}catch(u){o=u;if(n)return console.error("%s raised:\n%s",r,o)}})};for(f=0,l=h.length;f<l;f++)p=h[f],o=p[0],i=p[1],u(o,i);if(n)return a(function(){return console.groupEnd("[%s]",e)})}},e=function(e,t,n){var s,o;return n==null&&(n="(anonymous)"),s=[t,n],(o=r[e])?o.push(s):(r[e]=[s],$(document).bind(e,i(e)))},o=!1,u=[],_.extend(bcx,{on:function(t,n,r){var i,s,o,u,a;r==null&&(r=n,n=null),u=t.split(" "),a=[];for(s=0,o=u.length;s<o;s++)i=u[s],a.push(e(i,r,n));return a},trigger:function(e){return $(document).trigger(e)},pause:function(){return o=!0},resume:function(){return this.flush(),o=!1},flush:function(){var e;e=[];while(this.step())e.push(!0);return e},step:function(){var e;if(e=u.shift())return e(),!0},debug:function(){var e;n=!0;try{return window.localStorage.setItem("debug",!0)}catch(t){e=t}},stopDebugging:function(){var e;n=!1;try{return window.localStorage.removeItem("debug")}catch(t){e=t}}})}.call(this),function(){var e;$.support.touch="ontouchstart"in document.documentElement,$.browser.mobile=/iPhone|iP[ao]d|Android|Windows Phone|BlackBerry/.test(navigator.userAgent),$.support.placeholder=document.createElement("input").placeholder!=null,$.browser.mozilla&&/Trident/.test(navigator.userAgent)&&($.browser.mozilla=!1,$.browser.msie=!0),$.support.pdf=function(){if(navigator.mimeTypes["application/pdf"]!=null)return!0;try{return new ActiveXObject("AcroPDF.PDF"),!0}catch(t){return e=t,!1}}()}.call(this),function(){(new Image).src="https://bcx.basecamp-static.com/assets/spinners/dots-white-e44097762845077e6d87f6857cf985c9.gif",(new Image).src="https://bcx.basecamp-static.com/assets/spinners/dots-white@2x-39e4248011db52b5e9204c282885b849.gif",(new Image).src="https://bcx.basecamp-static.com/assets/icons/trash-afaa8a40d2bff9c033d6c65b14b63266.gif",(new Image).src="https://bcx.basecamp-static.com/assets/icons/trash@2x-45e90dc24d72db6879a80226a3df5647.png"}.call(this),function(){$(document).ready(function(){if(navigator.platform.match(/Win32/))return $(document.body).addClass("windows")})}.call(this),function(){var e,t;e={},t=function(e){return e.substring(e.lastIndexOf("/")+1)},$(function(){return _.each($("link[data-asset-path]"),function(n){return e[n.getAttribute("data-asset-path")]=t(n.href)}),_.each($("script[data-asset-path]"),function(n){return e[n.getAttribute("data-asset-path")]=t(n.src)})}),$(document).on("ajaxSuccess",function(t,n,r){var i,s;s=n.getResponseHeader("X-Asset-Paths");if(s!=null){try{s=JSON.parse(s)}catch(o){i=o,s=JSON.parse("["+s+"]")[0]}return _.each(s,function(t,n){if(e[n]!==t)return console.log("Assets have gone stale. Reloading."),Stacker.history=!1,e[n]=t})}})}.call(this),function(){$("a[data-behavior~=close_sheet]").live("click",function(e){var t,n,r;if(r=Stacker.workspace.container.stack)return t=r.length,r.length===1?Stacker.workspace.visit("/",{bareWorkspace:!0}):(n=r[r.length-2],Stacker.workspace.visit(n.path)),e.preventDefault()})}.call(this),function(){var e,t,n,r;e=$(document),t=!1,r=!1,n=function(t){var n,r,i,s;r=(new Date).getTime(),i=(s=window.localStorage)!=null?s.profilePageEvents:void 0,i&&console.profile(t),e.trigger(t),i&&console.profileEnd(),n=(new Date).getTime();if(Stacker.env==="development")return console.warn(""+t+" ("+(n-r)+"ms)")},e.ready(function(){return n("page:change"),n("page:update")}),e.bind("panelDisplayed",function(e,r){return r.isLoading()?(n("page:beforechange"),t=!0):(n("page:change"),n("page:update"),t=!1)}),e.bind("workspace:load",function(){return r=!0}),e.bind("panelReplaced",function(e,i){if(t||!r)t=!1,n("page:change");return r=!1,n("page:update")}),e.bind("ajaxSuccess",function(e,r,i){if(t)return;if(r.stacker)return;if(!$.trim(r.responseText))return;return n("page:update")})}.call(this),function(){$("div.sheet.inactive > header").live("click",function(e){var t,n,r,i;n=$(e.target);if(n.closest("h1 a, div.sheet:not(.inactive)").length)return;return t=$(this).find("h1 a"),i=t.attr("href"),r=t.data("bare-workspace")===!0,Stacker.workspace.visit(i,{restorePosition:!0,bareWorkspace:r}),!1}),$("[data-behavior~=reload_current_sheet]").live("click",function(e){return Stacker.workspace.visit(Stacker.normalizePath(window.location),{replaceSheet:!0}),!1}),$(function(){var e,t;return e=$("<style type=text/css>"),$("head").append(e),t=function(){var t;return t=$(window).height(),e.text("div.panel { min-height: "+t+"px };")},$(window).resize(t),t()}),$("[data-skip-stacker-links]").live("stackerLinkClicked",function(){return!1})}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/stacker/templates/404"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="panel sheet error not_found">\n  <header>\n    <h1>Oops!</h1>\n  </header>\n\n  <div class="sheet_body">\n    <h2>We can\'t find that page</h2>\n    <p>The link you clicked doesn\'t look quite right. Check to make <br>sure the spelling, capitalization, etc. are exactly right.</p>\n    <p><a href="#" onclick="history.back(); return false" class="button">&larr; Back to the previous page</a></p>\n  </div>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/stacker/templates/500"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="panel sheet error internal_server_error">\n  <header>\n    <h1>Oops! Something isn\'t working.</h1>\n  </header>\n\n  <div class="sheet_body">\n    <h2>This is our fault, not yours. We\'re sorry.</h2>\n    <p>It\'s likely this is a temporary glitch that will be fixed within <br>a few minutes. If you continue to see this error:</p>\n\n    <ul>\n      <li><a href="http://status.basecamp.com" target="_blank" class="decorated">Check out status site for an update</a></li>\n      <li><a href="https://basecamp.com/support" class="decorated">Tell us about this problem</a></li>\n      '),Stacker.env==="development"&&(t.push('\n        <li><a href="#" data-response-text="'),t.push(r(this.responseText)),t.push('" onclick="(function(document){document.write(this.getAttribute(\'data-response-text\'));document.close()}).call(this,window.open().document);return false" class="decorated">View server response</a></li>\n      ')),t.push('\n    </ul>\n\n    <p><a href="#" onclick="history.back(); return false" class="button">&larr; Back to the previous page</a></p>\n  </div>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){$(document).bind("page:change",function(){var e;if(e=location.pathname.match(/^\/(\d{7,})/))return bcx.currentAccountSlug=e[1]}),$(document).ajaxSend(function(e,t,n){if(!n.crossDomain&&!n.url.match(/^\/(\d{7,})/)&&bcx.currentAccountSlug)return n.url="/"+bcx.currentAccountSlug+n.url})}.call(this),function(){bcx.on("page:beforechange page:change","set bcx.currentBucket",function(){var e,t,n,r,i;if(r=location.pathname.match(/\/(projects|calendars)\/(\d+)/))i=[r[1],r[2]],t=i[0],n=i[1],(e=bcx[t].get(n))||(bcx[t].add({id:n}),e=bcx[t].get(n));return bcx.currentBucket=bcx.currentProject=e})}.call(this),function(){bcx.helpers.EmojiHelper=function(){function e(){}return e.prototype.emojify=function(e){return this.safe(Emoji.emojify(this.escape(e)))},e}()}.call(this),function(){bcx.helpers.HumanNameHelper=function(){function e(){}return e.prototype.humanize=function(e){return e==="calendar_event"?"event":e==="upload"?"file":e},e}()}.call(this),function(){bcx.helpers.PluralizeHelper=function(){function e(){}return e.prototype.pluralize=function(e,t,n){return n==null&&(n=""+t+"s"),(e!=null?e.length:void 0)!=null&&(e=e.length),e===1?""+e+" "+t:""+e+" "+n},e}()}.call(this),function(){bcx.helpers.TruncateHelper=function(){function e(){}return e.prototype.truncateWord=function(e,t){var n;return n=e.split(" "),n.length>t?n.splice(0,t).join(" ")+"…":e},e}()}.call(this),function(){}.call(this),function(){bcx.on("page:update","load Backbone sync tags",function(){var e;return e=function(e){var t;return t=$(e).remove(),{collection:bcx[t.attr("name")],attributes:JSON.parse(t.attr("value"))}},$("input[data-behavior~=backbone_model]").each(function(){var t,n,r;return r=e(this),n=r.collection,t=r.attributes,n.add(t,{merge:!0})}),$("input[data-behavior~=backbone_collection]").each(function(){var t,n,r;return r=e(this),n=r.collection,t=r.attributes,$(this).data("reset-collection")!=null&&n.reset(),n.add(t,{merge:!0})})})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;bcx.View=function(e){function o(){o.__super__.constructor.apply(this,arguments),typeof this.setup=="function"&&this.setup()}var r,i,s;t(o,e),o.include=function(){var e,t,r,i,s,o,u,a,f;t=1<=arguments.length?n.call(arguments,0):[],f=[];for(u=0,a=t.length;u<a;u++)e=t[u],i=this.prototype.setup,r=this.prototype.constructor,s=this.prototype,_.extend(this.prototype,e.prototype),_.extend(this,e),i&&i!==this.prototype.setup&&(o=this.prototype.setup,this.prototype.setup=function(){return i(),o()}),r&&r!==this.prototype.constructor&&(this.prototype.constructor=r),s&&s!==this.prototype?f.push(this.prototype=s):f.push(void 0);return f},s=bcx.helpers;for(i in s)r=s[i],o.include(r);return o.templatePrefix="templates/",o.prototype.withContext=function(e){return e==null&&(e={}),_.extend(_.extend({},this),e)},o.
prototype.JST=function(e,t){return t==null&&(t=this),JST["desktop/"+this.constructor.templatePrefix+e](t)},o.prototype.renderTemplate=function(e,t){var n;return t==null&&(t=this),n=new String(this.JST(e,t)),n.ecoSafe=!0,n},o}(Backbone.View)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};bcx.Autoview=function(r){function s(e){this.identifier=e.identifier,this.parentView=e.parentView,this.render=n(this.render,this),this.className==null&&(this.className=this.name),this.id=this.constructor.idFor(this.identifier),this.subviews=[],s.__super__.constructor.apply(this,arguments),$(this.el).attr("data-autoview","")}return i(s,r),s.views={},s.constructors={},s.viewName=function(e){return this.constructors[e]=this,this.prototype.name=e},s.constructorFor=function(e){return this.constructors[e]},s.get=function(e,t){return t==null&&(t="singleton"),this.views[this.constructorFor(e).idFor(t)]},s.idFor=function(e){return(""+this.prototype.name+"_"+e).replace(":","_")},s.findOrCreate=function(e,t){var n,r;return e==null&&(e="singleton"),t&&(e=""+t.identifier+"_"+e),(n=this.views)[r=this.idFor(e)]!=null?n[r]:n[r]=new this({identifier:e,parentView:t})},s.install=function(e,t){var n,r,i;return n=$(e),r=this.constructorFor(n.data("autoview-name")),i=r.findOrCreate(n.data("autoview-identifier"),t),i.install(e),i},s.uninstall=function(e){var t;return(t=this.views[$(e).attr("id")])!=null?t.uninstall():void 0},s.prototype.render=function(){return this.uninstallSubviews(),$(this.el).html(this.renderContents()),this.installSubviews(),$(this.el).trigger("autoview:render"),this.afterRender(),this},s.prototype.afterRender=function(){},s.prototype.renderContents=function(){return $("<div>").html(""+this.renderTemplate(this.name)).contents()},s.prototype.install=function(e){return this.placeholder&&this.uninstall(),this.placeholder=e,this.render(),$(e).replaceWith(this.el),this.delegateEvents(),this.afterInstall()},s.prototype.afterInstall=function(){},s.prototype.uninstall=function(){if(!this.placeholder)return;return this.beforeUninstall(),$(this.el).replaceWith(this.placeholder),this.placeholder=null},s.prototype.beforeUninstall=function(){},s.prototype.unregister=function(){return this.uninstall(),delete this.constructor.views[this.constructor.idFor(this.identifier)]},s.prototype.installSubviews=function(){return this.subviews=e(this.el,this)},s.prototype.uninstallSubviews=function(){return t(this.el),this.subviews=[]},s.prototype.findSubviewByName=function(e){return _.find(this.subviews,function(t){return t.name===e})},s.prototype.findSubviewById=function(e){return _.find(this.subviews,function(t){return t.id===e})},s}(bcx.View),e=function(e,t){var n,r,i,s,o;s=$(e).find("[data-autoview-name]"),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],o.push(bcx.Autoview.install(n,t));return o},t=function(e){var t,n,r,i,s;i=$(e).find("[data-autoview]"),s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(bcx.Autoview.uninstall(t));return s},bcx.on("page:beforechange page:update","install autoviews",function(){return e("body")}),$("div.sheet").live("beforeSheetSave",function(){return t(this)})}.call(this),function(){bcx.CalendarEventsLoader=function(){function e(e){this.display=e,this.rows=this.display.get("rows"),this.loadedDateRanges={}}return e.prototype.fetch=function(e){var t,n,r,i,s;r=this.determineRanges(e);if(r.length)return t=[this.display.getFirstDate(),this.display.getLastDate()],n=this.isDateRangeLoaded(t[0],t[1]),n||this.display.trigger("current_date_range:loading"),s=r[0][0].toString(),i=r[r.length-1][1].toString(),$.ajax(this.url(),{data:{window_start_date:s,window_end_date:i},dataType:"script",cache:!0,success:function(e){return function(){e.display.calendarEvents.addRecurrencesInRange(e.display.getFirstDate(),e.display.getLastDate()),e.markDateRangesLoaded(r);if(!n)return e.display.trigger("current_date_range:loaded",t[0])}}(this)})},e.prototype.url=function(){return this.display.bucket?""+this.display.bucket.url()+"/calendar_events":"/calendar/fetch_events"},e.prototype.determineRanges=function(e){var t,n,r,i;i=[],t=[this.display.getFirstDate(),this.display.getLastDate()],i.push(t);switch(e){case"forward":n=this.getDateRangeFor(t[1]),i.push(n),i.push(this.getDateRangeFor(n[1]));break;case"backward":r=this.getDateRangeFor(t[0].previous()),i.unshift(r),i.unshift(this.getDateRangeFor(r[0].previous()));break;default:i.push(this.getDateRangeFor(t[1])),i.unshift(this.getDateRangeFor(t[0].previous()))}return _(i).filter(function(e){return function(t){return!e.isDateRangeLoaded(t[0],t[1])}}(this))},e.prototype.getDateRangeFor=function(e){var t,n;return n=e.beginningOfMonth().beginningOfWeek(),t=n.next(-1+7*this.rows),[n,t]},e.prototype.isDateRangeLoaded=function(e,t){return this.loadedDateRanges[this.rangeKeyFor(e,t)]!=null},e.prototype.rangeKeyFor=function(e,t){return""+e.toString()+":"+t.toString()},e.prototype.markDateRangesLoaded=function(e){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.loadedDateRanges[this.rangeKeyFor(t[0],t[1])]=!0);return i},e}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.Model=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.bind("change",function(e){return function(){return e.memos={}}}(this)),this.memos={}}return t(n,e),n.memoize=function(e){var t,n;return(n=this.memoize).index==null&&(n.index=0),t=this.memoize.index++,function(){var n;return(n=this.memos)[t]!=null?n[t]:n[t]=e.apply(this,arguments)}},n.prototype.sync=function(e,t,n){return n==null&&(n={}),n.dataType="script",e==="trash"?this._trash(n):Backbone.sync(e,t,n)},n.prototype.parse=function(e,t){var n;try{return JSON.parse(e)}catch(r){return n=r,{}}},n.prototype.trash=function(e){return this.sync("trash",this,e)},n.prototype._trash=function(e){var t,n;return n=typeof this.url=="function"?this.url():this.url,n+="/trash",e.url=n,e.type="POST",t=e.success,e.success=function(e){return function(){return e.trigger("destroy"),e.trigger("sync"),typeof t=="function"?t():void 0}}(this),$.ajax(e)},n.prototype.calendarDate=function(e){var t;if(t=this.get(e))return CalendarDate.parse(t)},n.prototype.calendarTime=function(e){var t;if(t=this.get(e))return CalendarTime.parse(t)},n.prototype.date=function(e){var t;if(t=this.get(e))return Date.parse(t)},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.Account=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=function(){return"/account"},n.prototype.canCreateProjects=function(){return this.get("can_create_projects")},n.prototype.allowClientProjects=function(){return this.get("allow_client_projects")},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.Accounts=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.Account,n}(Backbone.Collection),bcx.accounts=new bcx.collections.Accounts}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.BackgroundOperation=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=function(){return this.isNew()?this.urlRoot:""+this.urlRoot+"/"+this.id},n.prototype.completionUrl=function(){return""+this.url()+"/completed"},n.prototype.isStillRunning=function(){var e;return(e=this.get("status"))==="pending"||e==="processing"},n.prototype.isSuccessful=function(){return this.get("status")==="completed"},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.AttachmentExport=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot="/attachment_exports",n}(bcx.BackgroundOperation)}.call(this),function(){bcx.bootstrap=function(e){var t,n,r,i,s;i=e.personId,r=e.identityId,n=e.hasClassicAccount,bcx.currentIdentityId=r,bcx.currentPerson=bcx.people.get(i),bcx.currentAccount=bcx.currentPerson.getAccount(),bcx.currentPerson.set("has_classic_account",n);if(window.localStorage!=null)try{s=window.localStorage.getItem("currentIdentityId"),s!=null&&parseInt(s)!==r&&window.localStorage.clear(),window.localStorage.setItem("currentIdentityId",r)}catch(o){t=o}return this.trigger("identity:set")}}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.Bucket=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot=function(){return"/"+bcx.currentAccountSlug+"/"+this.constructor.modelName.toLowerCase()+"s"},n.prototype.url=function(){var e;return this.isNew()?this.urlRoot():""+this.urlRoot()+"/"+((e=this.get("param"))!=null?e:this.id)},n.prototype.calendarUrl=function(){var e;return e=""+this.url()+"/calendar_events",this.isTemplate()&&(e+="/agenda"),e},n.prototype.getColor=function(){var e;return(e=this.get("color"))!=null?e:_(bcx.bucketColors).rand()},n.prototype.isUsed=function(){return this.get("topics_count")+this.get("attachments_count")>0},n.prototype.isActive=function(){return this.get("status_name")==="active"},n.prototype.isTeamMemberId=function(e){return _(this.team_members()).detect(function(t){return t.id===e})!=null},n.prototype.people=function(){var e,t;return(e=(t=this.bucketAccess())!=null?t.people():void 0)!=null?e:[]},n.prototype.team_members=function(){var e,t;return(e=(t=this.bucketAccess())!=null?t.team_members():void 0)!=null?e:[]},n.prototype.subscribers=function(){var e,t;return(e=(t=this.bucketAccess())!=null?t.subscribers():void 0)!=null?e:[]},n.prototype.unsubscribers=function(){var e,t;return(e=(t=this.bucketAccess())!=null?t.unsubscribers():void 0)!=null?e:[]},n.prototype.team_subscribers=function(){var e,t;return(e=(t=this.bucketAccess())!=null?t.team_subscribers():void 0)!=null?e:[]},n.prototype.team_unsubscribers=function(){var e,t;return(e=(t=this.bucketAccess())!=null?t.team_unsubscribers():void 0)!=null?e:[]},n.prototype.accesses=function(){var e,t;return(e=(t=this.bucketAccess())!=null?t.get("accesses"):void 0)!=null?e:[]},n.prototype.identifier=function(e){return e==null&&(e=""),""+this.constructor.modelName+":"+this.id+e},n.prototype.getBucketId=function(){return""+this.constructor.modelName.slice(0,1)+this.id},n}(bcx.Model),bcx.getBucket=function(e,t){var n,r;return t==null&&(r=e.split(":"),e=r[0],t=r[1]),n=e==="Project"?bcx.projects:bcx.calendars,n.get(t)}}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.BucketAccess=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}var n;return t(r,e),r.modelName="BucketAccess",r.prototype.people=function(){var e;return e=this.get("accesses"),n(e)},r.prototype.clients=function(){var e;return e=this.get("accesses").filter(function(e){return e.can_see_private===!1}),n(e)},r.prototype.team_members=function(){var e;return e=this.get("accesses").filter(function(e){return e.can_see_private===!0}),n(e)},r.prototype.subscribers=function(){var e;return e=this.get("accesses").filter(function(e){return e.wants_notifications===!0}),n(e)},r.prototype.unsubscribers=function(){var e;return e=this.get("accesses").filter(function(e){return e.wants_notifications===!1}),n(e)},r.prototype.team_subscribers=function(){return _(this.subscribers()).without(this.clients())},r.prototype.team_unsubscribers=function(){return _(this.unsubscribers()).without(this.clients())},n=function(e){var t;return _(function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(bcx.peopleAndGroups.get("person_"+t.person_id));return i}()).sortBy(function(e){return bcx.peopleAndGroups.comparator(e)})},r}(bcx.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.BucketAccesses=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.BucketAccess,n.prototype.url="/buckets/accesses",n.prototype.fetch=function(){var e;return e=$.getJSON(this.url),e.done(function(e){return function(t){return e.reset(t)}}(this)),e},n}(Backbone.Collection),bcx.bucketAccesses=new bcx.collections.BucketAccesses}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.Calendar=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.modelName="Calendar",n.prototype.isUsed=function(){return n.__super__.isUsed.apply(this,arguments)||this.get("calendar_events_count")>0},n.prototype.calendarIsUsed=function(){return this.isUsed()},n.prototype.peopleIds=function(){var e,t,n,r,i;r=this.people(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.id);return i},n.prototype.peopleNames=function(){var e;return function(){var t,n,r,i;r=this.people(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.get("name"));return i}.call(this).join(", ")},n.prototype.bucketAccess=function(){return bcx.bucketAccesses.get("Calendar:"+this.id)},n.prototype.calendarEvents=function(){return bcx.calendarEvents.filter(function(e){return function(t){return t.isSelectedBucket(e,"Calendar")}}(this))},n.prototype.isTemplate=function(){return!1},n.prototype.isDraft=function(){return!1},n.prototype.hasClients=function(){return!1},n.prototype.isClientProject=function(){return!1},n}(bcx.models.Bucket)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.Calendars=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.Calendar,n.prototype.comparator=function(e){var t;return(t=e.get("name"))!=null?t.trim().toLowerCase():void 0},n}(Backbone.Collection),bcx.calendars=new bcx.collections.Calendars}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.CalendarEvent=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.modelName="CalendarEvent",n.prototype.isAllDay=function(){return this.get("all_day")},n.prototype.isTimed=function(){return!this.isAllDay()},n.prototype.isSpanned=function(){return this.get("all_day")&&this.get("ends_at")&&this.get("starts_at")!==this.get("ends_at")},n.prototype.isPast=function(){return this.isTimed()?this.getStartsAt()<new Date-36e5:this.getEndDate().isPast()},n.prototype.doesOccurOn=function(e){var t;return this.getStartDate().date<=(t=e.date)&&t<=this.getEndDate().date},n.prototype.doesOccurBetween=function(e,t){var n,r;return n=this.getStartDate().date,r=this.getEndDate().date,e=e.date,t=t.date,n===e||(n>e?n<=t:e<=r)},n.prototype.doesOccurOnOrAfter=function(e){var t;return t=e.date,this.getStartDate().date>=t||this.getEndDate().date>=t},n.prototype.getStartDate=n.memoize(function(){return this.calendarDate("starts_at")}),n.prototype.getEndDate=n.memoize(function(){var e;return(e=this.calendarDate("ends_at"))!=null?e:this.getStartDate()}),n.prototype.getSpannedEndDate=n.memoize(function(){return this.isSpanned()?this.calendarDate("ends_at"):this.getStartDate()}),n.prototype.getDates=n.memoize(function(){var e,t,n,r,i,s;t=[e=this.getStartDate()];while(e.isnt(this.getEndDate()))t.push(e=e.next());if(this.bucket().isTemplate()){r=this.get("start_due_week"),n=this.get("start_due_wday");for(i=0,s=t.length;i<s;i++)e=t[i],e.week=r,e.wday=n,n===6?(r++,n=0):n++}return t}),n.prototype.getStartTime=n.memoize(function(){if(this.isTimed())return this.calendarTime("starts_at")}),n.prototype.getStartsAt=n.memoize(function(){return this.isTimed()?this.date("starts_at"):this.calendarDate("starts_at").date}),n.prototype.getCreatedAt=n.memoize(function(){var e;return(e=this.date("created_at"))!=null?e:new Date}),n.prototype.getRemindAt=n.memoize(function(){return this.date("remind_at")}),n.prototype.relativeDateLabelFor=function(e){var t,n;return this.isNew()?"Week 1, "+CalendarDate.weekdayNames[1]:(n=this.get(""+e+"_due_week"),t=this.get(""+e+"_due_wday"),"Week "+(n+1)+", "+CalendarDate.weekdayNames[t])},n.prototype.setStartDate=function(e){var t,n,r;if(this.isSpanned())return t=this.getEndDate(),n=t.daysSince(this.getStartDate()),this.set("starts_at",e.toString()),this.set("ends_at",e.next(n).toString());if(this.isAllDay())return r=e.toString(),this.set("starts_at",r),this.set("ends_at",r);if(this.isTimed())return r=(new CalendarDateTime(e,this.getStartTime())).toString(),this.set("starts_at",r),this.set("ends_at",r)},n.prototype.urlRoot=function(){return""+this.getBucketPath()+"/calendar_events"},n.prototype.getBucketPath=function(){return this.get("bucket_type")?this.bucket().url():""},n.prototype.showPath=function(){var e;if(this.id!=null)return e=""+this.urlRoot()+"/"+this.get("param"),this.isRecurrence()?""+e+"/recurrences/"+this.get("recurrence_number"):e},n.prototype.isSelectedBucket=function(e,t){return this.get("bucket_type")===t&&this.get("bucket_id")===e.id},n.prototype.summary=function(){return this.get("summary")},n.prototype.bucket=n.memoize(function(){var e;return e=this.get("bucket_type")==="Calendar"?bcx.calendars:bcx.projects,e.get(this.get("bucket_id"))}),n.prototype.subscriberIds=function(){var e,t,n,r,i,s;i=(r=this.get("subscribers"))!=null?r:[],s=[];for(t=0,n=i.length;t<n;t++)e=i[t],s.push("person_"+e);return s},n.prototype.subscribers=function(){var e;return bcx.peopleAndGroups.length?_(function(){var t,n,r,i;r=this.subscriberIds(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(bcx.peopleAndGroups.get(e));return i}.call(this)).compact():[]},n.prototype.participantsList=function(){return _(this.subscribers()).map(function(e){return e.get("name")}).sort().join(", ").replace(/,\s([^,]+)$/," and $1")},n.prototype.getColor=function(){var e,t;return(e=(t=this.bucket())!=null?t.getColor():void 0)!=null?e:bcx.bucketColors[0]},n.prototype.getBucketType=function(){return this.get("bucket_type")},n.prototype.getBucketName=function(){var e;return(e=this.bucket())!=null?e.get("name"):void 0},n.prototype.compareTo=function(e){var t,n,r,i;return i=this.getStartsAt(),n=e.getStartsAt(),i<n?-1:i>n?1:(r=this.getCreatedAt(),t=e.getCreatedAt(),r<t?-1:r>t?1:0)},n.prototype.reminderOffset=function(e){var t,n,r,i;return this.isNew()?this.isTimed()||e?"-30m":"0d":this.has("remind_at")?(i=this.getStartDate(),r=this.calendarDate("remind_at"),t=""+r.daysSince(i)+"d",this.isTimed()?(n=(this.getRemindAt()-this.getStartsAt())/1e3/60,n===-30||n===-60?""+n+"m":t):t):"false"},n.prototype.reminderTimeValue=function(){var e,t;return(e=(t=this.calendarTime("remind_at"))!=null?t.toFriendlyString():void 0)!=null?e:"7am"},n.prototype.isRecurring=function(){return this.has("freq")},n.prototype.isRecurringInfinitely=function(){return this.isRecurring()&&!this.has("count")&&!this.has("until_date")},n.prototype.isRecurrence=function(){return this.has("master_id")},n.prototype.isRepeating=function(){return this.isRecurrence()||this.isRecurring()},n.prototype.isLastRecurrence=function(){if(this.isRecurrence()&&!this.master().isRecurringInfinitely())return this.master().has("count")?this.master().get("count")===this.get("recurrence_number")+1:this.fromStartDate?this.master().getUntilDate().is(this.fromStartDate):this.master().getUntilDate().is(this.getStartDate())},n.prototype.needsRecurrencePrompt=function(){return this.isRepeating()&&this.fromStartDate},n.prototype.recurrences=function(){return this.collection.select(function(e){return function(t){return t.get("master_id")===e.get("id")}}(this))},n.prototype.master=n.memoize(function(){return this.collection.get(this.get("master_id"))}),n.prototype.getUntilDate=n.memoize(function(){if(this.isRecurring()&&this.has("until_date"))return this.calendarDate("until_date")}),n.prototype.getFreq=function(){return this.isRecurrence()?this.master().get("freq"):this.get("freq")},n.prototype.calendarDateForRecurrence=function(e,t){var n;n=this.calendarDate(e);switch(this.get("freq")){case"daily":return n.next(t);case"weekly":return n.next(t*7);case"monthly":return n.nextMonth(t,n.day);case"yearly":return n.nextMonth(t*12,n.day)}},n.prototype.remindAtForRecurrence=function(e){var t,n,r;if(!this.has("remind_at"))return;return n=this.get("next_reminder_recurrence"),e===n?this.get("remind_at"):(n&&(e-=n),t=this.calendarDateForRecurrence("remind_at",e),r=this.calendarTime("remind_at"),CalendarDateTime.parse(t,r).toString())},n.prototype.cloneAsRecurrence=function(e){var t,n,r,i,s,o,u;n=this.clone(),n.set({id:""+this.get("id")+"+"+e,master_id:this.get("id"),recurrence_number:e,comments_count:((o=this.get("comments_count_by_recurrence"))!=null?o[e]:void 0)||0}),n.setStartDate(this.calendarDateForRecurrence("starts_at",e)),(r=this.remindAtForRecurrence(e))&&n.set({remind_at:r}),u=["comments_count_by_recurrence","next_reminder_recurrence","freq","count","until_date"];for(i=0,s=u.length;i<s;i++)t=u[i],n.unset(t);return n},n.prototype.addRecurrence=function(e){return this.collection.add(this.cloneAsRecurrence(e),{merge:!0})},n.prototype.addRecurrencesInRange=function(e,t){var n,r,i;n=0,i=[];for(;;){n++;if(!_.contains(this.get("excluded_recurrences"),n)){r=this.cloneAsRecurrence(n);if(r.getStartDate().date>t.date||this.get("count")&&this.get("count")<=n||this.getUntilDate()&&this.getUntilDate()<r.getStartDate())break;r.doesOccurBetween(e,t)?i.push(this.collection.add(r,{merge:!0})):i.push(void 0)}else i.push(void 0)}return i},n.prototype.addTemplateRecurrences=function(e){var t,n,r,i,s,o,u;o=this.get("start_due_week"),s=this.get("start_due_wday"),n=this.get("end_due_week"),t=this.get("end_due_wday"),r=0,u=[];for(;;){r++;if(!_.contains(this.get("excluded_recurrences"),r)){switch(this.get("freq")){case"daily":s<6?s++:(o++,s=0),t<6?t++:(n++,t=0);break;case"weekly":o++,n++;break;case"monthly":o+=4,n+=4;break;case"yearly":o+=12,n+=12}i=this.cloneAsRecurrence(r),i.set({start_due_wday:s,start_due_week:o,end_due_wday:t,end_due_week:n});if(this.get("count")&&this.get("count")<=r||o>e)break;u.push(this.collection.add(i,{merge:!0}))}else u.push(void 0)}return u},n.prototype.excludeRecurrence=function(e){var t;return t=e.get("recurrence_number"),e.isLastRecurrence()?t===1?this.set({freq:null}):this.set({count:t,until_date:null}):(this.has("excluded_recurrences")?this.get("excluded_recurrences").push(t):this.set("excluded_recurrences",[t]),this.set("excluded_recurrence",t))},n.prototype.excludeRecurrenceAndFutureRecurrences=function(e){var t;return t=e.get("recurrence_number"),t===1?(this.set({count:1}),this.set({freq:null})):this.set({count:t,until_date:null})},n.prototype.createExcluded=function(e){var t;return this.master().excludeRecurrence(this),t=this.master(),t.save({},{success:function(n){return function(){return n.unset("id"),n.save({},{success:function(){return n.set("id",bcx.lastCalendarEventId),bcx.lastCalendarEventId=null,n.get("comments_count")?n.moveRecurrenceComments(t,e):typeof e=="function"?e():void 0}})}}(this)})},n.prototype.createRecurring=function(e){var t;return this.master().get("count")?this.set("count",this.master().get("count")-this.get("recurrence_number")):this.set("until_date",this.master().get("until_date")),this.set("freq",this.master().get("freq")),this.master().excludeRecurrenceAndFutureRecurrences(this),t=this.master(),t.save({},{success:function(n){return function(){return n.unset("id"),n.save({},{success:function(){return n.set("id",bcx.lastCalendarEventId),bcx.lastCalendarEventId=null,_(_(t.get("comments_count_by_recurrence")).keys()).detect(function(e){return e>=n.get("recurrence_number")})?n.moveRecurrenceComments(t,e):typeof e=="function"?e():void 0}})}}(this)})},n.prototype.moveRecurrenceComments=function(e,t){var n;return n=new BackgroundOperationProcessor(new bcx.MoveOperation({recurrence:this.get("recurrence_number"),move_future_recurrences:this.isRecurring(),source_resource_type:"CalendarEvent",source_resource_id:e.get("id"),destination_resource_type:"CalendarEvent",destination_resource_id:this.get("id"),destination_bucket_type:this.getBucketType(),destination_bucket_id:this.bucket().get("id")})),n.on("processor:success",function(e){return function(){return typeof t=="function"?t():void 0}}(this)),n.run()},n.prototype.exclude=function(e){return this.master().excludeRecurrence(this),this.master().save({},{success:function(t){return function(){return typeof e=="function"?e():void 0}}(this)})},n.prototype.excludeWithFutureRecurrences=function(e){return this.master().excludeRecurrenceAndFutureRecurrences(this),this.master().save({},{success:function(t){return function(){return typeof e=="function"?e():void 0}}(this)})},n}(bcx.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.CalendarEvents=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.CalendarEvent,n.prototype.initialRecurrenceDays=42,n.prototype.initialTemplateRecurrenceWeeks=7,n.prototype.initialize=function(){return this.bind("add",this.addInitialRecurrences),this.bind("change",this.replaceRecurrences),this.bind("remove",this.removeRecurrences)},n.prototype.comparator=function(e,t){return e.compareTo(t)},n.prototype.getCalendarEventsForRange=function(e,t){return _(this.models).select(function(n){return n.doesOccurBetween(e,t)})},n.prototype.getCalendarEventsForDate=function(e){return _(this.models).select(function(t){return t.doesOccurOn(e)})},n.prototype.getCalendarEventsOccurringOnOrAfter=function(e){return _(this.models).select(function(t){return t.doesOccurOnOrAfter(e)})},n.prototype.addInitialRecurrences=function(e){if(e.isRecurring())return e.bucket().isTemplate()?e.addTemplateRecurrences(this.initialTemplateRecurrenceWeeks):e.addRecurrencesInRange(e.getStartDate(),e.getEndDate().next(this.initialRecurrenceDays))},n.prototype.addRecurrencesInRange=function(e,t){return _(this.select(function(e){return e.isRecurring()})).each(function(n){return function(n){return n.addRecurrencesInRange(e,t)}}(this))},n.prototype.replaceRecurrences=function(e){var t,n,r,i;if(!e.getStartDate()||!e.getEndDate())return;(r=e.recurrences()).length&&this.remove(r);if(e.isRecurring())return e.bucket().isTemplate()?e.addTemplateRecurrences(this.initialTemplateRecurrenceWeeks):(i=e.getStartDate(),t=e.getEndDate().next(this.initialRecurrenceDays),r.length&&(n=_(r).last().getEndDate(),n.date>t.date&&(t=n)),e.addRecurrencesInRange(i,t))},n.prototype.removeRecurrences=function(e){if(e.isRecurring())return this.remove(e.recurrences())},n}(Backbone.Collection),bcx.calendarEvents=new bcx.collections.CalendarEvents}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.Project=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.modelName="Project",n.prototype.defaults={topics_count:0,todolists_count:0,documents_count:0,attachments_count:0,forwards_count:0,calendar_events_count:0},n.prototype.todos=function(e){var t;return e==null&&(e=bcx.todos),t=e.select(function(e){return function(t){return t.bucket()===e}}(this)),new bcx.collections.Todos(t,{sort:!0})},n.prototype.star=function(){return this.starred=!0},n.prototype.unstar=function(){return this.starred=!1},n.prototype.accessesUrl=function(){return""+this.url()+"/accesses"},n.prototype.isActive=function(){return this.get("status_name")==="active"},n.prototype.isDraft=function(){return this.get("status_name")==="draft"},n.prototype.isTemplate=function(){return this.get("status_name")==="template"},n.prototype.isUsed=function(){return n.__super__.isUsed.apply(this,arguments)||this.get("todolists_count")+this.get("documents_count")+this.get("forwards_count")+this.get("calendar_events_count")>0},n.prototype.calendarIsUsed=function(){return this.get("calendar_events_count")>0||this.hasDueTodos()},n.prototype.isClientProject=function(){return this.get("is_client_project")},n.prototype.hasClients=function(){return this.get("clients_count")>0},n.prototype.hasDueTodos=function(){return this.get("remaining_todos_count")>0&&bcx.todos.any(function(e){return function(t){return t.bucket()===e&&t.get("due_on")}}(this))},n.prototype.lastActiveDate=function(){var e;if(e=this.get("updated_at"))return e.match(/(.*?)T/)[1]},n.prototype.urlForLatestActivity=function(){return""+this.url()+"/events/"+this.lastActiveDate()},n.prototype.urlForTrashOperation=function(){return""+this.url()+"/trash_operation"},n.prototype.urlForPublish=function(){return""+this.url()+"/publish"},n.prototype.urlForTrash=function(){return""+this.url()+"/trash"},n.prototype.bucketAccess=function(){return bcx.bucketAccesses.get("Project:"+this.id)},n.prototype.toJSON=function(){return{name:this.get("name"),description:this.get("description"),color:this.getColor()}},n}(bcx.models.Bucket)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.Projects=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.Project,n.prototype.comparator=function(e){var t;return(t=e.get("name"))!=null?t.trim().toLowerCase():void 0},n.prototype.update=function(e){var t,n,r,i,s,o,u,a,f,l;r={};for(u=0,f=e.length;u<f;u++)t=e[u],n=t.id,r[n]=!0,(o=this.get(n))?o.set(t):this.add(t);s=this.reject(function(e){return r[e.id]});for(a=0,l=s.length;a<l;a++)i=s[a],this.remove(i);return this.sort({silent:!0})},n.prototype.active=function(){return this.filter(function(e){return e.isActive()})},n.prototype.draft=function(){return this.filter(function(e){return e.isDraft()})},n.prototype.activeOrDraft=function(){return this.filter(function(e){return e.isActive()||e.isDraft()})},n.prototype.activeOrDraftWithCalendarItems=function(){return this.filter(function(e){return(e.isActive()||e.isDraft())&&(e.get("calendar_events_count")>0||e.hasDueTodos())})},n.prototype.remove=function(e){return bcx.calendarEvents.remove(bcx.calendarEvents.select(function(t){return t.bucket()===e})),bcx.todos.remove(bcx.todos.select(function(t){return t.bucket()===e})),n.__super__.remove.apply(this,arguments)},n}(Backbone.Collection),bcx.projects=new bcx.collections.Projects}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.Person=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=function(){var e;return"/people/"+((e=this.get("param"))!=null?e:this.id)},n.prototype.avatarUrl=function(e){var t;return e==null&&(e="avatar"),(t=this.get("avatar_urls"))!=null?t[e]:void 0},n.prototype.getAccount=function(){return bcx.accounts.get(this.get("account_id"))},n.prototype.isAccountManager=function(){return this
.get("account_owner")},n.prototype.isAdmin=function(){return this.get("admin")},n.prototype.canCreateProjects=function(){return this.get("can_create_projects")},n.prototype.getStartOfWeek=function(){return this.get("start_of_week")},n.prototype.setStartOfWeek=function(e){return this.set("start_of_week",e)},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.People=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.Person,n}(Backbone.Collection),bcx.people=new bcx.collections.People}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},s=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};bcx.models.CalendarDisplay=function(e){function r(){return this.removeEventsFor=n(this.removeEventsFor,this),this.updateBlankSlate=n(this.updateBlankSlate,this),this.startOfWeekChanged=n(this.startOfWeekChanged,this),r.__super__.constructor.apply(this,arguments)}return i(r,e),r.prototype.defaults=function(){return{cursor:CalendarDate.today().beginningOfWeek(),rows:6,hiddenBucketData:"{}",calendarListVisibility:!0,todosSidebarVisibility:!1}},r.prototype.initialize=function(){return this.bucket=bcx.currentBucket,this.calendarEvents=bcx.calendarEvents,this.calendars=bcx.calendars,this.projects=bcx.projects,this.todos=bcx.todos,this.calendars.bind("all",this.updateBlankSlate),this.projects.bind("all",this.updateBlankSlate),this.todos.bind("all",this.updateBlankSlate),this.updateBlankSlate(),this.calendarEventsLoader=new bcx.CalendarEventsLoader(this),this.markCurrentDateRangeLoaded(),this.calendars.bind("remove",this.removeEventsFor),bcx.currentPerson.bind("change:start_of_week",this.startOfWeekChanged),this.key=this.storageKey(),this.bind("change",function(e){return function(){if(!e.saving&&!e.fetching)return e.save()}}(this)),this.fetch()},r.prototype.save=function(e){var t;e==null&&(e={});try{return this.saving=!0,this.set(e),bcx.storage.set(this.key,this)}catch(n){t=n}finally{this.saving=!1}},r.prototype.fetch=function(){var e;try{return this.fetching=!0,this.set(bcx.storage.get(this.key))}catch(t){e=t}finally{this.fetching=!1}},r.prototype.storageKey=function(){var e;return e="calendarDisplay",this.bucket?""+e+":"+this.bucket.identifier():e},r.prototype.startOfWeekChanged=function(e,t){var n;n=e.previous("start_of_week");if(n===0&&t===1)return this.set({cursor:this.cursor(1)});if(n===1&&t===0)return this.set({cursor:this.cursor(-1)})},r.prototype.afterContentChanges=function(e,t){return t==null&&(t=!0),t&&(e=this.debounce(e)),this.calendarEvents.bind("all",e),this.calendars.bind("all",e),this.projects.bind("all",e),this.todos.bind("all",e)},r.prototype.afterDisplayChanges=function(e,t){return t==null&&(t=!0),t&&(e=this.debounce(e)),this.bind("all",e)},r.prototype.afterChanges=function(e){return e=this.debounce(e),this.afterContentChanges(e,!1),this.afterDisplayChanges(e,!1)},r.prototype.debounce=function(e){return _.debounceConditionally(e,1,function(e){return function(){return!e.synchronous}}(this))},r.prototype.cursor=function(e){return e==null&&(e=0),this.get("cursor").next(e)},r.prototype.markCurrentDateRangeLoaded=function(){return this.calendarEventsLoader.markDateRangesLoaded([[this.getFirstDate(),this.getLastDate()]])},r.prototype.loadCurrentDateRange=function(e){return this.calendarEventsLoader.fetch(e)},r.prototype.getWeeks=function(){var e,t,n,r,i,s;e=this.cursor(-1),s=[];for(n=r=0,i=this.get("rows");0<=i?r<i:r>i;n=0<=i?++r:--r)s.push(function(){var n,r;r=[];for(t=n=0;n<7;t=++n)r.push(e=e.next());return r}());return s},r.prototype.getFirstWeek=function(){return this.getWeeks()[0]},r.prototype.getFirstDate=function(){return this.cursor()},r.prototype.getFirstSaturday=function(){return this.cursor(6)},r.prototype.getLastDate=function(){return this.cursor(-1+7*this.get("rows"))},r.prototype.getSignificantDate=function(){return this.getFirstSaturday().beginningOfMonth()},r.prototype.firstWeekContainsToday=function(){var e;return e=CalendarDate.today().toString(),s.call(_.invoke(this.getFirstWeek(),"toString"),e)>=0},r.prototype.getBeginningOfMonth=function(){return this.firstWeekContainsToday()?CalendarDate.today().beginningOfMonth():this.getFirstSaturday().beginningOfMonth()},r.prototype.getCalendarEvents=function(){var e;return e=this,this.calendarEvents.select(function(t){return e.getBucketVisibility(t.bucket())})},r.prototype.getCalendarEventsFor=function(e,t){return t!=null?this.getCalendarEventsForRange(e,t):this.getCalendarEventsForDate(e)},r.prototype.getCalendarEventsForRange=function(e,t){return _(this.getCalendarEvents()).select(function(n){return n.doesOccurBetween(e,t)})},r.prototype.getCalendarEventsForDate=function(e){return _(this.getCalendarEvents()).select(function(t){return t.doesOccurOn(e)})},r.prototype.getSpannedCalendarEventsFor=function(e,t){return _(this.getCalendarEventsFor(e,t)).select(function(e){return e.isSpanned()})},r.prototype.getAllDayCalendarEventsFor=function(e,t){return _.chain(this.getCalendarEventsFor(e,t)).select(function(e){return e.isAllDay()&&!e.isSpanned()}).sortBy(function(e){return e.bucket().collection.comparator(e.bucket())}).value()},r.prototype.getTimedCalendarEventsFor=function(e,t){return _(this.getCalendarEventsFor(e,t)).select(function(e){return e.isTimed()})},r.prototype.getTodos=function(){return this.todos.select(function(e){return function(t){return e.getBucketVisibility(t.bucket())}}(this))},r.prototype.getTodosFor=function(e){return(new bcx.collections.Todos(this.getTodos())).occurringOn(e).sortedByProject().toArray()},r.prototype.getSpannedLayoutFor=function(e,n){var r;return r=this.getSpannedCalendarEventsFor(e,n),t["for"](e,n,r)},r.prototype.getHiddenBucketData=r.memoize(function(){return JSON.parse(this.get("hiddenBucketData"))}),r.prototype.setHiddenBucketData=function(e){return this.set("hiddenBucketData",JSON.stringify(e))},r.prototype.getBucketVisibilityKey=function(e){return e.identifier()},r.prototype.getBucketVisibility=function(e){return this.currentBucket()?e===this.currentBucket():!(this.getBucketVisibilityKey(e)in this.getHiddenBucketData())&&!e.isTemplate()},r.prototype.setBucketVisibility=function(e,t){var n,r;return n=this.getHiddenBucketData(),r=this.getBucketVisibilityKey(e),t?delete n[r]:n[r]=!0,this.setHiddenBucketData(n)},r.prototype.toggleBucketVisibility=function(e){return this.setBucketVisibility(e,!this.getBucketVisibility(e))},r.prototype.getCalendarListVisibility=function(){return this.get("calendarListVisibility")},r.prototype.setCalendarListVisibility=function(e){return this.set("calendarListVisibility",e)},r.prototype.currentBucket=function(){return this.bucket},r.prototype.toggleCalendarListVisibility=function(){return this.setCalendarListVisibility(!this.getCalendarListVisibility())},r.prototype.getTodosSidebarVisibility=function(){return this.get("todosSidebarVisibility")},r.prototype.setTodosSidebarVisibility=function(e){return this.set("todosSidebarVisibility",e)},r.prototype.toggleTodosSidebarVisibility=function(){return this.setTodosSidebarVisibility(!this.getTodosSidebarVisibility())},r.prototype.getTitle=function(){var e;return this.firstWeekContainsToday()?"Next 6 weeks":(e=this.getFirstSaturday(),""+e.getMonthName()+" "+e.year)},r.prototype.lockNavigation=function(){return this.navigationLocked=!0},r.prototype.unlockNavigation=function(){return this.navigationLocked=!1},r.prototype.navigateToMonth=function(e){return this.navigationLocked?!1:this.set({cursor:e.beginningOfMonth().beginningOfWeek()})},r.prototype.navigateBackward=function(){return this.navigateToMonth(this.cursor(-1))},r.prototype.navigateForward=function(){return this.navigateToMonth(this.getLastDate())},r.prototype.navigateToToday=function(){return this.navigationLocked?!1:this.set({cursor:this.defaults().cursor})},r.prototype.isShowingCalendarEvent=function(e){return e.doesOccurBetween(this.getFirstDate(),this.getLastDate())},r.prototype.navigateToCalendarEvent=function(e){if(!this.isShowingCalendarEvent(e))return this.navigateToMonth(e.getStartDate())},r.prototype.setActiveCalendarEvent=function(e){var t,n,r;return r=(""+e).split("+"),t=r[0],n=r[1],n&&this.calendarEvents.get(t).addRecurrence(parseInt(n)),this.calendarEvent=this.calendarEvents.get(e),this.navigateToCalendarEvent(this.calendarEvent)},r.prototype.takeActiveCalendarEvent=function(){var e;if(e=this.calendarEvent)return delete this.calendarEvent,e},r.prototype.updateBlankSlate=function(){var e;e=this.blankSlate,this.blankSlate=this.calendars.length===0&&this.projects.active().length===0;if(this.blankSlate!==e)return this.trigger("change:blankSlate")},r.prototype.reset=function(){return this.set(this.defaults()),this.trigger("reset")},r.prototype.removeEventsFor=function(e){return this.calendarEvents.remove(e.calendarEvents())},r.prototype.toJSON=function(){return{hiddenBucketData:this.get("hiddenBucketData"),calendarListVisibility:this.get("calendarListVisibility"),todosSidebarVisibility:this.get("todosSidebarVisibility")}},r}(bcx.Model),t=function(){function t(e,t){this.startDate=e,this.endDate=t,this.size=1+this.endDate.daysSince(this.startDate),this.rows=[]}return t["for"]=function(e,t,n){var r,i,s,o;i=new this(e,t);for(s=0,o=n.length;s<o;s++)r=n[s],i.add(r);return i},t.prototype.add=function(t){var n,r,i,s,o;r=this.getSlotsFor(t);if(!r.length)return!1;o=this.rows;for(i=0,s=o.length;i<s;i++){n=o[i];if(n.occupy(r,t))return t}return n=new e(this.size),n.occupy(r,t),this.rows.push(n),t},t.prototype.getSlotHeight=function(e){var t,n,r,i,s,o;t=0,o=this.rows;for(n=i=0,s=o.length;i<s;n=++i)r=o[n],r.isFreeDuring([e])||(t=n+1);return t},t.prototype.getSlotsFor=function(e){var t,n,r,i,s;r=[],t=this.startDate;for(n=i=0,s=this.size;0<=s?i<s:i>s;n=0<=s?++i:--i)e.doesOccurOn(t)&&r.push(n),t=t.next();return r},t}(),e=function(){function e(e){this.occurrences=Array(e)}return e.prototype.isFreeDuring=function(e){var t,n,r;for(n=0,r=e.length;n<r;n++){t=e[n];if(this.occurrences[t])return!1}return!0},e.prototype.occupy=function(e,t){var n,r,i,s;if(this.isFreeDuring(e)){n={calendarEvent:t,width:e.length};for(i=0,s=e.length;i<s;i++)r=e[i],this.occurrences[r]=n,n=!0;return!0}},e.prototype.getOccurrences=function(){var e,t,n,r,i,s;t=[],s=this.occurrences;for(n=r=0,i=s.length;r<i;n=++r)e=s[n],e&&e!==!0&&t.push(_.extend({slot:n},e));return t},e}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.ContainableMoveOperation=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot="/containable_move_operations",n}(bcx.BackgroundOperation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.CopyOperation=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot="/copy_operations",n}(bcx.BackgroundOperation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.MoveOperation=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.urlRoot="/move_operations",n}(bcx.BackgroundOperation)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t=bcx.EmailAddressHelper.looksLikeEmailAddress,bcx.models.PersonOrGroup=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return r(i,n),i.prototype.setInput=function(e){var n;return this.clear({silent:!0}),e=e.trim(),n={input:e},e.length&&(t(e)?n.email_address=e:n.name=e),this.set(n)},i.prototype.isBlank=function(){return this.isNew()&&(this.has("input")===!1||this.get("input")==="")},i.prototype.hasUnknownName=function(){return this.has("name")&&this.isNew()},i.prototype.hasInvalidEmailAddress=function(){return this.has("email_address")&&!this.hasEmailAddress()},i.prototype.hasEmailAddress=function(){return this.has("email_address")&&t(this.get("email_address"))},i.prototype.firstName=function(){var e;return(e=this.get("name"))!=null?e.split(" ")[0]:void 0},i.prototype.isGroup=function(){return this.has("member_ids")},i.prototype.isSubgroup=function(){return this.isGroup()&&this.has("parent_id")},i.prototype.isPerson=function(){return!this.isGroup()},i.prototype.isNewlyInvitedPerson=function(){return this.isPerson()&&!this.has("name")&&this.hasEmailAddress()},i.prototype.emailAddressAlphanumeric=function(){return this.get("email_address").replace(/\W/g,"-")},i.prototype.members=function(){var t,n;if(this.isGroup()&&this.collection)return n=function(){var e,n,r,i;r=this.get("member_ids"),i=[];for(e=0,n=r.length;e<n;e++)t=r[e],i.push(this.collection.get(t));return i}.call(this),new e(n)},i.prototype.subgroups=function(){var e;if(!this.isSubgroup()&&!this.isPerson())return e=this.collection.filter(function(e){return function(t){return t.get("parent_id")===e.get("group_id")}}(this)),new bcx.collections.PeopleAndGroups(e)},i.prototype.group=function(){if(this.isSubgroup())return this.collection.find(function(e){return function(t){return t.get("group_id")===e.get("parent_id")}}(this))},i.prototype.isEnabled=function(){return this.isDisabled()===!1},i.prototype.isDisabled=function(){var e;return((e=this.collection)!=null?e.isDisabled:void 0)?this.collection.isDisabled(this):!1},i.prototype.mailbox=function(){if(this.has("email_address"))return this.get("email_address").split("@")[0]},i.prototype.searchString=function(){return""+this.get("name")+" "+this.get("email_address")},i}(Backbone.Model),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.prototype.comparator=function(e){return e.get("name")},t.prototype.enabled=function(){return this.filter(function(e){return e.isEnabled()})},t.prototype.disabled=function(){return this.filter(function(e){return e.isDisabled()})},t}(Backbone.Collection)}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t=bcx.EmailAddressHelper.looksLikeEmailAddress,bcx.collections.PeopleAndGroups=function(n){function s(){return s.__super__.constructor.apply(this,arguments)}return r(s,n),s.prototype.model=bcx.models.PersonOrGroup,s.prototype.url="/people_and_groups",s.prototype.load=function(e){return this.loaded?typeof e=="function"?e():void 0:(this.loader==null&&(this.loader=$.when(this.fetch(),bcx.bucketAccesses.fetch())),this.loader.done(function(t){return function(){return t.loaded=!0,delete t.loader,typeof e=="function"?e():void 0}}(this)))},s.prototype.loadParticipants=function(e){return this.fetch({url:"/projects/"+bcx.currentBucket.id+"/participants.json"}).done(e)},s.prototype.initialize=function(e,t){return t==null&&(t={}),this.disabledIds=t.disabledIds||[]},s.prototype.isDisabled=function(e){var t;return t=e.id,i.call(this.disabledIds,t)>=0},s.prototype.isEnabled=function(e){return!this.isDisabled(e)},s.prototype.comparator=function(e){var t;return(t=e.get("name"))!=null?t.toLowerCase():void 0},s.prototype.currentPerson=function(){var e;return this.get("person_"+((e=bcx.currentPerson)!=null?e.id:void 0))},s.prototype.people=function(){return this.select(function(e){return e.isPerson()})},s.prototype.groups=function(){return this.select(function(e){return e.isGroup()})},s.prototype.search=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p;e=e.trim(),r=this.createPatternMatchFor(e),s=[],p=this.models;for(f=0,c=p.length;f<c;f++)o=p[f],a=r(o),a!==void 0&&s.push({score:a,option:o});u=function(){var e,t,n,r;n=s.sort(function(e,t){return e.score-t.score}),r=[];for(e=0,t=n.length;e<t;e++)i=n[e],r.push(i.option);return r}(),n=[],t=[];for(l=0,h=u.length;l<h;l++)o=u[l],this.isDisabled(o)?t.push(o):n.push(o);return{enabledOptions:n,disabledOptions:t}},s.prototype.createPatternMatchFor=function(n){var r;return r=new RegExp(e(n),"i"),t(n)?function(e){var t;return(t=r.exec(e.get("email_address")))!=null?t.index:void 0}:function(e){var t;return(t=r.exec(e.get("name"))||r.exec(e.mailbox()))!=null?t.index:void 0}},s}(Backbone.Collection),e=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},bcx.peopleAndGroups=new bcx.collections.PeopleAndGroups}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.ProjectTemplate=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.modelName="ProjectTemplate",n}(bcx.models.Project)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.ProjectTemplates=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.ProjectTemplate,n}(bcx.collections.Projects),bcx.projectTemplates=new bcx.collections.ProjectTemplates}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.Todo=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.modelName="Todo",n.prototype.isAllDay=function(){return!0},n.prototype.isTimed=function(){return!1},n.prototype.urlRoot=function(){return""+this.getBucketPath()+"/todos"},n.prototype.getBucketPath=function(){return this.bucket().url()},n.prototype.showPath=function(){return""+this.urlRoot()+"/"+this.get("param")},n.prototype.togglePath=function(){return""+this.showPath()+"/toggle"},n.prototype.bucket=n.memoize(function(){return bcx.projects.get(this.get("project_id"))}),n.prototype.doesOccurOn=function(e){var t;return((t=this.getDueDate())!=null?t.value:void 0)===e.value},n.prototype.doesOccurOnOrAfter=function(e){var t;return((t=this.getDueDate())!=null?t.date:void 0)>=e.date},n.prototype.doesOccurBetween=function(e,t){var n,r;return e.date<=(n=(r=this.getDueDate())!=null?r.date:void 0)&&n<=t.date},n.prototype.getDueDate=n.memoize(function(){return this.calendarDate("due_on")}),n.prototype.setDueDate=function(e){return this.set("due_on",e.toString())},n.prototype.getStartDate=function(){return this.getDueDate()},n.prototype.setStartDate=function(e){return this.setDueDate(e)},n.prototype.getDates=n.memoize(function(){var e;return e=this.getDueDate(),this.bucket().isTemplate()&&(e.week=this.get("due_week"),e.wday=this.get("due_wday")),[e]}),n.prototype.summary=function(){return this.get("content")},n.prototype.assignee=n.memoize(function(){if(this.get("assignee_id"))return bcx.peopleAndGroups.get(""+this.get("assignee_type").toLowerCase()+"_"+this.get("assignee_id"))}),n.prototype.todolist=n.memoize(function(){return bcx.todolists.get(this.get("todolist_id"))}),n.prototype.compareTo=function(e){var t,n;return t=this.todolist().get("position"),n=e.todolist().get("position"),t===n?this.get("position")>e.get("position")?1:-1:t-n},n.prototype.toJSON=function(){var e;return e=n.__super__.toJSON.apply(this,arguments),delete e.due_at,e},n}(bcx.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.models.Todolist=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.modelName="Todolist",n.prototype.bucket=n.memoize(function(){return bcx.projects.get(this.get("project_id"))}),n.prototype.showPath=function(){return""+this.bucket().url()+"/todolists/"+this.get("param")},n}(bcx.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.Todolists=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.Todolist,n}(Backbone.Collection),bcx.todolists=new bcx.collections.Todolists}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.collections.Todos=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=bcx.models.Todo,n.prototype.initialize=function(e,t){this.options=t!=null?t:{};if(this.options.sort)return this.comparator=this.optionalComparator},n.prototype.optionalComparator=function(e,t){return e.compareTo(t)},n.prototype.occurringOn=function(e){var t;return t=this.select(function(t){return t.doesOccurOn(e)}),new this.constructor(t)},n.prototype.sortedByProject=function(){var e;return e=this.uniqueProjects().chain().invoke("todos",this).invoke("toArray").flatten().value(),new this.constructor(e)},n.prototype.uniqueProjects=function(){return new bcx.collections.Projects(_.uniq(this.invoke("bucket")))},n}(Backbone.Collection),bcx.todos=new bcx.collections.Todos}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},i=[].slice;e=function(e){function o(){return this.updateCalendarEventClasses=t(this.updateCalendarEventClasses,this),this.hide=t(this.hide,this),o.__super__.constructor.apply(this,arguments)}var n,s;return r(o,e),n="MM d, yy",s=function(e){return $.datepicker.formatDate(n,e.getLocalDate())},o.prototype.events={"submit form":"submitForm","click a[data-behavior=cancel]":"cancel","click a[data-behavior=delete]":"destroy",change:"updateCalendarEventClasses","change select[name=freq]":"freqChanged","change select[name=count]":"countChanged","change :radio[name=event_recurrence_choice]":"recurrenceOptionChosen"},o.prototype.initialize=function(){return this.calendarEvent=new bcx.models.CalendarEvent,this.peopleAndGroups=bcx.peopleAndGroups},o.prototype.render=function(){return o.__super__.render.apply(this,arguments),this.$("[data-behavior~=date_entry]").each(function(e){return function(t,n){return e.installDateEntryBehavior(n)}}(this)),this.updateCalendarEventClasses(),this.originalBucket=this.calendarEvent.isNew()?null:this.calendarEvent.bucket()},o.prototype.hide=function(){},o.prototype.updateCalendarEventClasses=function(){return _.defer(function(e){return function(){return e.isTimed()?$(e.el).removeClass("all_day").addClass("timed"):$(e.el).removeClass("timed").addClass("all_day"),e.isSpanned()?$(e.el).find("form").addClass("spanned"):$(e.el).find("form").removeClass("spanned")}}(this))},o.prototype.installDateEntryBehavior=function(e){var t,r,i,o;return r=$(e),i=r.find("[type=text]"),t=r.find("[type=hidden]"),o=CalendarDate.parse(t.val()),i.val(s(o)).datepicker({altField:t,altFormat:"yy-mm-dd",dateFormat:n,firstDay:CalendarDate.firstDayOfWeek,dayNamesMin:["S","M","T","W","T","F","S"],changeMonth:!1,changeYear:!1,gotoCurrent:!0,prevText:"Previous",selectOtherMonths:!0,showOtherMonths:!0,showAnim:!1,onSelect:function(e){return function(t,n){return e.dateSelected(r,t)}}(this),beforeShow:function(e){return function(t,n){return e.beforeShowPicker(r,n)}}(this)})},o.prototype.beforeShowPicker=function(e,t){t.dpDiv.addClass("calendar_event_picker notranslate"),this.setMinDates();if(e.find(":input[name=starts_at_date]").length)return e.attr("data-prev-date",this.dateEntry("starts_at_date","hidden").val())},o.prototype.setMinDates=function(){var e,t;return t=this.datePicker("starts_at_date","getDate"),e=this.datePicker("ends_at_date","getDate"),this.datePicker("ends_at_date","option",{minDate:t}),this.datePicker("until_date","option",{minDate:e})},o.prototype.dateSelected=function(e){return e.attr("data-dirty",!0),e.find(":input[name=starts_at_date]").length&&this.shiftEndsAtDate(),this.shiftUntilDate(),this.updateCalendarEventClasses()},o.prototype.shiftEndsAtDate=function(){var e,t,n,r;r=CalendarDate.parse(this.dateEntry("starts_at_date","hidden").val()),n=CalendarDate.parse(this.dateEntry("starts_at_date").attr("data-prev-date"));if(e=r.daysSince(n))return t=CalendarDate.parse(this.dateEntry("ends_at_date","hidden").val()),this.datePicker("ends_at_date","setDate",s(t.next(e)))},o.prototype.shiftUntilDate=function(){var e,t;e=this.datePicker("ends_at_date","getDate"),t=this.datePicker("until_date","getDate");if(e>t)return this.datePicker("until_date","setDate",e)},o.prototype.field=function(e){return this.$(":input[name='"+e+"']").val()},o.prototype.dateEntry=function(e,t){var n;return n=$("[data-behavior~=date_entry]:has([name="+e+"])"),t!=null?n.find("[type="+t+"]"):n},o.prototype.datePicker=function(){var e,t,n;return t=arguments[0],e=2<=arguments.length?i.call(arguments,1):[],(n=this.dateEntry(t,"text")).datepicker.apply(n,e)},o.prototype.isTimed=function(){return this.field("starts_at_time")&&this.field("starts_at_time").length&&!this.isSpanned()},o.prototype.isSpanned=function(){return this.field("starts_at_date")!==this.field("ends_at_date")},o.prototype.isFuture=function(){return this.isTimed()?CalendarDateTime.parse(this.field("starts_at_date"),this.field("starts_at_time")).isFuture():CalendarDate.parse(this.field("starts_at_date")).isFuture()},o.prototype.isPrivateChecked=function(){return this.$(":input[name~=private]:checked").length>0},o.prototype.isPrivate=function(){return this.$(":input[type=hidden][name~=private]").length?this.field("private"):this.$(":input[name~=private]").is(":checked")},o.prototype.updateCalendarEventAttributes=function(){var e,t,n,r,i;i=this.$(":input[name=bucket]").val().split(":"),t=i[0],e=i[1],this.calendarEvent.set({summary:this.field("summary"),description:this.field("description"),"private":this.isPrivate(),bucket_type:t,bucket_id:e}),this.isTimed()?(r=CalendarDateTime.parse(this.field("starts_at_date"),this.field("starts_at_time")),this.calendarEvent.set({all_day:!1,starts_at:r.toString(),ends_at:r.toString()})):this.isSpanned()?this.calendarEvent.set({all_day:!0,starts_at:this.field("starts_at_date"),ends_at:this.field("ends_at_date")}):this.calendarEvent.set({all_day:!0,starts_at:this.field("starts_at_date"),ends_at:this.field("starts_at_date")}),n=this.field("freq")||null,this.calendarEvent.set({freq:n});if(n)switch(this.$(":input[name=event_recurrence_end]:checked").val()){case"forever":return this.calendarEvent.set({count:null,until_date:null});case"count":return this.calendarEvent.set({count:this.field("count"),until_date:null});case"until":return this.calendarEvent.set({count:null,until_date:this.field("until_date")})}},o.prototype.submitForm=function(e){return this.calendarEvent.isRepeating()?this.calendarEvent.isLastRecurrence()?(this.markAsBusy(),this.choice="excluded",this.editRepeatingEvent()):this.showRecurrencePrompt("change"):(this.markAsBusy(),this.updateCalendarEventAttributes(),this.calendarEvent.save({},{error:function(e){return function(){return e.calendarEventRequestFailed()}}(this),success:function(e){return function(){return e.originalBucketChanged()?e.moveBuckets():e.calendarEventRequestSucceeded()}}(this)})),!1},o.prototype.selectedBucket=function(){var e;if(e=this.$(":input[name=bucket]").val())return bcx.getBucket(e)},o.prototype.originalBucketChanged=function(){var e;if(this.originalBucket&&(e=this.selectedBucket()))return e!==this.originalBucket},o.prototype.moveBuckets=function(e){var t,n;return e==null&&(e=function(e){return function(){return e.calendarEventRequestSucceeded()}}(this)),n=this.selectedBucket(),t=new BackgroundOperationProcessor(new bcx.MoveOperation({source_resource_type:"CalendarEvent",source_resource_id:this.calendarEvent.get("id"),destination_bucket_type:n.constructor.modelName,destination_bucket_id:n.id})),t.on("processor:success",function(t){return function(){return e()}}(this)),t.on("processor:failed",function(e){return function(){return e.calendarEventRequestFailed()}}(this)),t.run()},o.prototype.destroy=function(e){var t;return t="Are you sure you want to delete this event?",this.calendarEvent.isRepeating()?this.calendarEvent.isLastRecurrence()?confirm(t)?(this.markAsBusy(),this.choice="excluded",this.destroyRepeatingEvent()):this.cancelDestroy():this.showRecurrencePrompt("destroy"):confirm(t)&&(this.markAsBusy(),this.calendarEvent.trash({error:function(e){return function(){return e.calendarEventRequestFailed()}}(this),success:function(e){return function(){return e.calendarEventRequestSucceeded()}}(this)})),!1},o.prototype.cancelDestroy=function(){},o.prototype.cancel=function(e){return this.hide(),!1},o.prototype.calendarEventRequestFailed=function(){return console.warn("failure!")},o.prototype.calendarEventRequestSucceeded=function(){return this.markAsNotBusy(),this.hide()},o.prototype.calendarEventRecurrenceRequestSucceeded=function(){return this.calendarEventRequestSucceeded()},o.prototype.markAsBusy=function(){return this.$("form").addClass("busy")},o.prototype.markAsNotBusy=function(){return this.$("form").removeClass("busy")},o.prototype.getSelectedSubscribers=function(){var e,t;return e=bcx.peopleAndGroups.get("person_"+bcx.currentPerson.id),t=this.calendarEvent.subscribers(),e&&this.calendarEvent.isNew()&&t.push(e),t},o.prototype.isEditorForTemplate=function(){return!1},o.prototype.freqChanged=function(e){var t;return t=$(e.target).val(),this.$("div.recurrence_end").toggle(!!t),this.$("label[data-role~=freqtext]").text(this.freqText(t))},o.prototype.freqText=function(e){switch(e){case"daily":return"days";case"weekly":return"weeks";case"monthly":return"months";case"yearly":return"years"}},o.prototype.recurrenceDescription=function(){var e,t,n,r,i,s;return n=this.calendarEvent.master(),r=this.freqText(n.getFreq()),i=r.replace(/s$/,""),t="Every "+i,(e=n.get("count"))?t+=" for "+e+" "+r+", starting on "+n.getStartDate().longWithYear()+".":(s=n.getUntilDate())?t+=" from "+n.getStartDate().longWithYear()+" to "+s.longWithYear()+".":t+=", starting on "+n.getStartDate().longWithYear()+"."},o.prototype.countChanged=function(e){return $(e.target).closest("li").find(":radio").prop("checked",!0)},o.prototype.showRecurrencePrompt=function(e){return this.$("[data-role~=expanded_recurrence_prompt]").html(this.renderRecurrencePrompt(e)),this.$("[data-behavior~=recurrence_prompt]").expand().closest(".balloon").addClass("recurrence_prompt")},o.prototype.renderRecurrencePrompt=function(e){var t;return this.recurrenceChangeContext=e,t=_.extend({calendarEvent:this.calendarEvent},function(){switch(this.recurrenceChangeContext){case"change":return{action:"change",verb:"changing"};case"move":return this.recurrenceChangeContext="change",{action:"move",verb:"moving"};case"destroy":return{action:"delete",verb:"deleting"}}}.call(this)),JST["desktop/templates/calendar_event_editor/recurrence_prompt"](t)},o.prototype.recurrenceOptionChosen=function(e){this.$(":input").attr("disabled",!0).closest("div").addClass("busy");if((this.choice=$(e.target).val())==="cancel")return this.hide();switch(this.recurrenceChangeContext){case"change":return this.editRepeatingEvent();case"destroy":return this.destroyRepeatingEvent()}},o.prototype.editRepeatingEvent=function(){this.$("form.calendar_event_editor_form").length&&this.updateCalendarEventAttributes();switch(this.choice){case"recurring":return this.calendarEvent.isRecurrence()?this.calendarEvent.createRecurring(function(e){return function(){return e.calendarEventRecurrenceRequestSucceeded
()}}(this)):this.calendarEvent.save({},{success:function(e){return function(){return e.calendarEvent.fromStartDate=null,e.originalBucketChanged()?e.moveBuckets(function(){return e.calendarEventRecurrenceRequestSucceeded()}):e.calendarEventRecurrenceRequestSucceeded()}}(this)});case"excluded":return this.calendarEvent.createExcluded(function(e){return function(){return e.calendarEventRecurrenceRequestSucceeded()}}(this))}},o.prototype.destroyRepeatingEvent=function(){switch(this.choice){case"recurring":return this.calendarEvent.isRecurrence()?this.calendarEvent.excludeWithFutureRecurrences(function(e){return function(){return e.calendarEventRecurrenceRequestSucceeded()}}(this)):this.calendarEvent.trash({success:function(e){return function(){return e.calendarEventRecurrenceRequestSucceeded()}}(this)});case"excluded":return this.calendarEvent.exclude(function(e){return function(){return e.calendarEventRecurrenceRequestSucceeded()}}(this))}},o}(bcx.Autoview),bcx.AbstractCalendarEventEditor=e}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};bcx.views.AddTaggingView=function(t){function s(){return this.autocompleteTagName=e(this.autocompleteTagName,this),s.__super__.constructor.apply(this,arguments)}var i;return n(s,t),s.viewName("add_tagging"),s.prototype.events={"keydown input[type=text]":"keyPressed","click input[type=submit]":"addTagging","click [data-behavior~=cancel]":"cancel"},s.prototype.afterInstall=function(){var e;return e=this.taggingsView,this.existingTaggings=e.existingTaggings,this.existingTagNames=e.existingTagNames,this.render()},s.prototype.afterRender=function(){return this.$input=this.$("input[type=text]"),this.$tags=this.$("div.choose_tags"),this.$submit=this.$("input[type=submit]"),this.$input.placeholder({clearOnSubmit:!1}),this.$input.focus(),this.initializeAutocompletion()},s.prototype.initializeAutocompletion=function(){return this.getTagNamesForAutocompletion(function(e){return function(t){return e.$input.autocomplete({appendTo:e.$tags,source:e.autocompleteTagName,delay:0,open:function(){return e.$tags.find("ul.ui-autocomplete").removeAttr("style")},select:function(t,n){if(n.item)return e.$input.val(n.item.value)}})}}(this))},s.prototype.autocompleteTagName=function(e,t){var n,i;return i=e.term.trim(),n=RegExp("(^|\\s)"+$.ui.autocomplete.escapeRegex(i),"i"),this.getTagNamesForAutocompletion(function(e){return function(i){return t(_(i).select(function(t){return n.test(t)&&r.call(e.existingTagNames,t)<0}))}}(this))},s.prototype.getTagNamesForAutocompletion=function(e){return this.tagNamesForAutocompletion?e(this.tagNamesForAutocompletion):$.ajax({url:"/"+bcx.currentAccountSlug+"/tags.json",dataType:"json",global:!1,success:function(t){return function(n){return e(t.tagNamesForAutocompletion=n)}}(this)})},s.prototype.hasTagName=function(e){var t;return t=i(e),_(this.existingTagNames).detect(function(e){return t===i(e)})},s.prototype.keyPressed=function(e){if(e.keyCode===13)return this.addTagging()},s.prototype.addTagging=function(e){var t;return t=this.$input.trigger("keydown").val().trim(),t.length&&!this.hasTagName(t)?(e=$(this.el).dispatch("tagging:add",t,this),e.isDefaultPrevented()||this.disable()):this.$input.focus(),!1},s.prototype.disable=function(){return this.$input.attr("disabled",!0),this.$submit.attr("disabled",!0),this.$submit.val("Adding...")},s.prototype.refresh=function(){return this.taggingsView.refresh()},s.prototype.afterRefresh=function(){return this.afterInstall()},s.prototype.cancel=function(e){return $(this.el).collapse(),!1},i=function(e){return e.toLowerCase().trim().replace(/\s\s+/," ")},s}(bcx.Autoview)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};bcx.views.AutocompletePeopleSuggestions=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.displayElement="[data-role~=suggestions_view]",r.prototype.template="desktop/templates/autocomplete_people_suggestions",r.prototype.initialize=function(){return this.model.bind("change",function(e){return function(){return e.render()}}(this)),this.suggestions=new e,this.suggestions.bind("selection:changed",function(e){return function(){return e.update()}}(this))},r.prototype.events={"focus input":"render","keydown input":"onKeyPress","touchstart [data-behavior~=select_suggestion]":"onSelectSuggestion","mouseenter [data-behavior~=select_suggestion]":"onSelectSuggestion","click [data-behavior~=select_suggestion]":"onClickSuggestion",clickoutside:"clear"},r.prototype.render=function(e){return this.suggestions.generate(this.model.get("input"),this.collection),this.suggestions.selectFirst(),this.$(this.displayElement).html(JST[this.template](this.withContext({results:this.suggestions.results,selected:this.suggestions.selected(),showInvalidMessage:e&&this.model.hasInvalidEmailAddress(),showUnknownMessage:e&&this.model.hasUnknownName()})))},r.prototype.update=function(){var e;return this.$("[data-suggestion-id].selected").removeClass("selected"),this.$("[data-suggestion-id="+((e=this.suggestions.selected())!=null?e.id:void 0)+"]").addClass("selected")},r.prototype.clear=function(){return this.$(this.displayElement).html("")},r.prototype.commit=function(e,t){var n,r,i,s;if(s=this.suggestions.selected()){n=jQuery.Event("suggestions:commit",{triggeredBy:e}),i=function(){var e,t,n,i;if(s.isGroup()){n=s.get("member_ids"),i=[];for(e=0,t=n.length;e<t;e++)r=n[e],i.push(this.collection.get(r));return i}return[s]}.call(this),$(this.el).trigger(n,[{suggestion:s,people:i}]),n.isDefaultPrevented()&&t.preventDefault();if(n.isPropagationStopped())return t.stopPropagation()}},r.prototype.cancel=function(){var e;return e=this.$("input[type=text]"),e.val()?e.val(""):e.blur(),this.clear()},r.prototype.onKeyPress=function(e){switch(e.which){case $.ui.keyCode.TAB:return this.commit("tabKey",e);case $.ui.keyCode.ENTER:return this.commit("enterKey",e);case $.ui.keyCode.ESCAPE:return this.cancel(),e.preventDefault();case $.ui.keyCode.DOWN:return this.suggestions.selectNext(),e.preventDefault();case $.ui.keyCode.UP:return this.suggestions.selectPrevious(),e.preventDefault()}},r.prototype.onSelectSuggestion=function(e){return this.suggestions.selectById($(e.currentTarget).data("suggestion-id"))},r.prototype.onClickSuggestion=function(e){return this.commit("click",e)},r}(bcx.View),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.minInputLength=2,t.prototype.maxNumberOfResults=10,t.prototype.comparator=function(e){return(e.get("name")||"").toLowerCase()},t.prototype.generate=function(e,t){return this.input=(e||"").trim(),this.input.length<this.minInputLength?(this.results={},this.reset([])):(this.results=t.search(e),this.results.enabledOptions=_.sortBy(this.results.enabledOptions.slice(0,this.maxNumberOfResults),this.comparator),this.results.disabledOptions=_.sortBy(this.results.disabledOptions.slice(0,this.maxNumberOfResults),this.comparator),this.reset(this.results.enabledOptions))},t.prototype.selected=function(){return this.models[this.selectedIndex]},t.prototype.selectById=function(e){var t;return t=this.detect(function(t){return t.id===e}),this.changeSelection(this.models.indexOf(t))},t.prototype.selectFirst=function(){return this.changeSelection(0)},t.prototype.selectLast=function(){return this.changeSelection(this.models.length-1)},t.prototype.selectNext=function(){var e;return e=this.selectedIndex+1,this.models[e]?this.changeSelection(e):this.selectFirst()},t.prototype.selectPrevious=function(){var e;return e=this.selectedIndex-1,this.models[e]?this.changeSelection(e):this.selectLast()},t.prototype.changeSelection=function(e){return this.selectedIndex=e,this.trigger("selection:changed"),this.selected()},t}(Backbone.Collection)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=bcx.EmailAddressHelper.extractEmailAddressesFrom,bcx.views.AdhocSubscriber=function(n){function i(){return this.replace=t(this.replace,this),this.appendTo=t(this.appendTo,this),this.deactivate=t(this.deactivate,this),i.__super__.constructor.apply(this,arguments)}return r(i,n),i.prototype.className="person field",i.prototype.template="desktop/templates/adhoc_subscriber",i.prototype.events={"focus input":"activate","input:change input":"changeModel","paste input":"inputPasted","suggestions:commit":"suggestionPicked",focusoutside:"deactivate",clickoutside:"deactivate"},i.prototype.initialize=function(e){return this.options=e,this.inputModel=new this.collection.model,this.inputModel.bind("change",function(e){return function(){return e.update()}}(this)),this.model||(this.model=this.inputModel),this.subscribable=this.options.subscribable,this.suggestionsView=new bcx.views.AutocompletePeopleSuggestions({el:this.el,model:this.inputModel,collection:this.collection})},i.prototype.render=function(){return $(this.el).html(JST[this.template](this)),this.updateHiddenInputs(),this.updateAllClassNames()},i.prototype.activate=function(){return $(this.el).addClass("focused")},i.prototype.deactivate=function(){return $(this.el).removeClass("focused"),this.updateAllClassNames()},i.prototype.changeModel=function(){return this.model=this.inputModel,this.model.setInput(this.getHumanInput())},i.prototype.inputPasted=function(t){var n;return n=$(t.currentTarget),n.bind("input",function(t){var r;return r=e(n.val()),r.length&&n.val(r[0]),n.unbind("input",arguments.callee)})},i.prototype.suggestionPicked=function(e,t){return e.preventDefault(),this.trigger("replace",this,t.suggestion)},i.prototype.update=function(){return this.updateHiddenInputs(),this.updateBlankClassName(),this.model.hasInvalidEmailAddress()||$(this.el).removeClass("invalid"),$(this.el).removeClass("unknown")},i.prototype.updateHiddenInputs=function(){return this.$("[data-role~=person_id_input]").val(this.model.get("person_id")),this.$("[data-role~=person_id_input]").attr("disabled",this.model.isNew()),this.$("[data-role~=email_address_input]").val(this.model.get("email_address")),this.$("[data-role~=email_address_input]").attr("disabled",this.model.has("id")||this.model.isBlank())},i.prototype.updateAllClassNames=function(){return this.updateBlankClassName(),this.updateInvalidClassName(),this.updateUnknownClassName()},i.prototype.updateBlankClassName=function(){return $(this.el).toggleClass("blank",this.model.isBlank())},i.prototype.updateInvalidClassName=function(){return $(this.el).toggleClass("invalid",this.model.hasInvalidEmailAddress())},i.prototype.updateUnknownClassName=function(){return $(this.el).toggleClass("unknown",this.model.hasUnknownName())},i.prototype.getHumanInput=function(){return this.$("[data-role~=human_input]").val()},i.prototype.appendTo=function(e){return this.render(),$(e).append(this.el)},i.prototype.replace=function(e){return this.render(),$(e).replaceWith(this.el)},i}(bcx.View)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=bcx.EmailAddressHelper.extractEmailAddressesFrom,bcx.views.InviteeField=function(n){function i(){return this.remove=t(this.remove,this),this.replace=t(this.replace,this),this.appendTo=t(this.appendTo,this),this.modelRemoved=t(this.modelRemoved,this),this.modelReplaced=t(this.modelReplaced,this),i.__super__.constructor.apply(this,arguments)}return r(i,n),i.prototype.className="person invitee field",i.prototype.template="desktop/templates/invitee_field",i.prototype.events={"focus input":"inputFocused","input:change input":"inputChanged","paste input":"inputPasted","suggestions:commit":"suggestionPicked","click [data-behavior~=remove_invitee]":"removeControlClicked"},i.prototype.initialize=function(e){return this.options=e,this.selection=this.options.selection,this.install(),this.suggestionsView=new bcx.views.AutocompletePeopleSuggestions({el:this.el,model:this.model,collection:this.collection})},i.prototype.install=function(){return this.model.bind("replace",this.modelReplaced),this.model.bind("remove",this.modelRemoved)},i.prototype.uninstall=function(){return this.model.unbind("replace",this.modelReplaced),this.model.unbind("remove",this.modelRemoved),this.unbind(),this.removeFromNewSuperpowersForm()},i.prototype.render=function(){return $(this.el).html(JST[this.template](this)),this.updateHiddenInputs(),this.updateAllClassNames(),this.addToNewSuperpowersForm()},i.prototype.update=function(){return this.updateHiddenInputs(),this.updateBlankClassName(),this.model.hasInvalidEmailAddress()||$(this.el).removeClass("invalid"),$(this.el).removeClass("unknown")},i.prototype.updateHiddenInputs=function(){return this.$("[data-role~=email_address_input]").val(this.model.get("email_address"))},i.prototype.updateAllClassNames=function(){return this.updateBlankClassName(),this.updateInvalidClassName(),this.updateUnknownClassName(),this.updateDisabledClassName()},i.prototype.updateBlankClassName=function(){return $(this.el).toggleClass("blank",this.model.isBlank())},i.prototype.updateInvalidClassName=function(){return $(this.el).toggleClass("invalid",this.model.hasInvalidEmailAddress())},i.prototype.updateUnknownClassName=function(){return $(this.el).toggleClass("unknown",this.model.hasUnknownName())},i.prototype.updateDisabledClassName=function(){return $(this.el).toggleClass("disabled",this.collection.isDisabled(this.model))},i.prototype.inputFocused=function(){var e;return e=$(this.el).closest("[data-behavior~=invitees]"),e.hasClass("loading")?($(this.el).attr("readonly","readonly"),!1):($(this.el).addClass("focused"),this.events.clickoutside="inputLostFocus",this.events.focusoutside="inputLostFocus",this.delegateEvents(),$(this.el).trigger("invitee:focus"))},i.prototype.inputLostFocus=function(){return $(this.el).removeClass("focused"),delete this.events.clickoutside,delete this.events.focusoutside,this.delegateEvents(),this.render(),$(this.el).trigger("invitee:blur")},i.prototype.inputChanged=function(e,t){return this.model.setInput(t.currentValue)},i.prototype.inputPasted=function(t){var n;return n=$(t.currentTarget),n.bind("input",function(t){var r;return r=e(n.val()),r.length&&n.val(r[0]),n.unbind("input",arguments.callee)})},i.prototype.suggestionPicked=function(e,t){return e.preventDefault(),this.selection.replace(this.model,t.suggestion)},i.prototype.removeControlClicked=function(e){return $(e.target).addClass("activated"),this.selection.remove(this.model)},i.prototype.modelReplaced=function(e){return this.trigger("replace",this,e)},i.prototype.modelRemoved=function(){return this.remove()},i.prototype.appendTo=function(e){return this.render(),$(e).append(this.el)},i.prototype.replace=function(e){return this.render(),$(e).replaceWith(this.el)},i.prototype.remove=function(){return this.uninstall(),$(this.el).delay(50).animate({opacity:0},200,"linear",function(e){return function(){return $(e.el).animate({height:0},Math.sqrt($(e.el).height())*50,"easeOutQuad",function(){return $(e.el).remove(),$(document).trigger("invitee:removed")})}}(this))},i.prototype.addToNewSuperpowersForm=function(){var e;if((e=this.options.parent)!=null?!e.isClientList():!void 0)if(this.model.isNewlyInvitedPerson()&&this.removable())return $("#new_superpowers").append(JST["desktop/templates/new_superpowers"]({invitee:this.model}))},i.prototype.removeFromNewSuperpowersForm=function(){var e;if((e=this.options.parent)!=null?!e.isClientList():!void 0)return $("#new_superpowers #invitee-"+this.model.emailAddressAlphanumeric()).remove()},i.prototype.readOnly=function(){return this.model.has("id")||this.model.hasEmailAddress()},i.prototype.removable=function(){return this.readOnly()&&this.collection.isEnabled(this.model)},i.prototype.inputNameForEmailAddress=function(){var e;return((e=this.options.parent)!=null?e.isClientList():void 0)?"client_invitees[][email_address]":"invitees[][email_address]"},i}(bcx.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};bcx.views.InviteeFieldGroup=function(t){function r(){return this.memberRemoved=e(this.memberRemoved,this),this.groupRemoved=e(this.groupRemoved,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.className="",r.prototype.template="desktop/templates/invitee_field_group",r.prototype.events={"click [data-behavior~=remove_group]":"removeControlClicked"},r.prototype.initialize=function(e){return this.options=e,this.group=this.model,this.members=_.clone(this.group.members().models),this.selection=this.options.selection,this.views=[],this.install()},r.prototype.install=function(){var e,t,n,r,i;this.group.bind("remove",this.groupRemoved),r=this.members,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.bind("remove",this.memberRemoved));return i},r.prototype.uninstall=function(){var e,t,n,r,i,s,o,u;this.group.unbind("remove",this.groupRemoved),o=this.members;for(n=0,i=o.length;n<i;n++)e=o[n],e.unbind("remove",this.memberRemoved);u=this.views;for(r=0,s=u.length;r<s;r++)t=u[r],t.uninstall();return this.unbind()},r.prototype.render=function(){return this.enabled=this.group.members().enabled(),this.disabled=this.group.members().disabled(),$(this.el).html(JST[this.template](this)),this.renderCollection("enabled",this.enabled),this.renderCollection("disabled",this.disabled)},r.prototype.renderCollection=function(e,t){var n,r,i;return n=function(){var e,n,s;s=[];for(e=0,n=t.length;e<n;e++)r=t[e],i=this.createView(r),i.render(),s.push(i.el);return s}.call(this),this.$("[data-role="+e+"_invitees]").append(n)},r.prototype.createView=function(e){var t;return t=new bcx.views.InviteeField({model:e,collection:this.collection,selection:this.selection,className:"grouped person invitee field",parent:this}),this.views.push(t),t},r.prototype.removeControlClicked=function(e){return $(e.target).addClass("activated"),this.selection.remove(this.group),this.selection.remove(this.members,{silent:!0})},r.prototype.groupRemoved=function(){return this.remove()},r.prototype.memberRemoved=function(e){return e.unbind("remove",this.memberRemoved),this.members=_(this.members).without(e)},r.prototype.replace=function(e){return this.render(),$(e).replaceWith(this.el)},r.prototype.remove=function(){return this.uninstall(),$(this.el).delay(50).animate({opacity:0},200,"linear",function(e){return function(){return $(e.el).animate({height:0},Math.min(Math.sqrt($(e.el).height())*35,400),"easeOutQuad",function(){return $(e.el).remove(),$(document).trigger("invitee:removed")})}}(this))},r.prototype.isClientList=function(){var e;return(e=this.options.parent)!=null?e.isClientList():void 0},r}(bcx.View)}.call(this),function(){var e,t,n=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty,i=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t=bcx.collections.PeopleAndGroups,e=bcx.views.AdhocSubscriber,bcx.views.AdhocSubscriberList=function(r){function s(){return this.replaceView=n(this.replaceView,this),this.addView=n(this.addView,this),s.__super__.constructor.apply(this,arguments)}return i(s,r),s.prototype.firsthumanInput="[data-role~=human_input]:first",s.prototype.events={"input:change div.field:last-child":"lastFieldChanged"},s.prototype.initialize=function(){var e,n,r,i;this.collection=new t($(this.el).data("people"),{disabledIds:$(this.el).data("disabled-people-ids")}),this.subscribable=$(this.el).data("subscribable"),i=this.getOutsideSubscribers();for(n=0,r=i.length;n<r;n++)e=i[n],this.addView(e);return this.addView()},s.prototype.getOutsideSubscribers=function(){var e,t,n,r,i;t=$(this.el).data("outside-subscribers")||[],i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(new this.collection.model(e));return i},s.prototype.createView=function(t){var n;return n=new e({model:t,collection:this.collection,selection:this.selection,subscribable:this.subscribable}),n.bind("replace",this.replaceView)},s.prototype.addView=function(e){var t;return e||(e=new this.collection.model),t=this.createView(e),t.appendTo(this.el)},s.prototype.replaceView=function(e,t){var n;return n=this.createView(t),n.replace(e.el),$(n.el).is(":last-child")&&this.addView(),this.focusNextField(n.el)},s.prototype.lastFieldChanged=function(e,t){if(t.currentValue.length>5)return this.addView()},s.prototype.focusNextField=function(e){return $(e).next("div.field").find(this.firsthumanInput).focus()},s.prototype.focus=function(){return this.$(this.firsthumanInput).focus()},s}(bcx.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.views.AgendaView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.viewName("agenda"),n.prototype.events={"click a[data-behavior=toggle_all]":"toggleAll"},n.prototype.weeks=12,n.prototype.initialize=function(){this.renderLater=_.debounce(this.render),this.bucket=bcx.getBucket(this.identifier),this.isTemplate=this.bucket.isTemplate(),this.calendarEvents=bcx.calendarEvents,this.addRecurrences(),this.calendarEvents.bind("all",this.renderLater),this.todos=bcx.todos,this.todos.bind("all",this.renderLater);if(this.bucket.constructor.modelName==="Project")return bcx.peopleAndGroups.loadParticipants(this.renderLater)},n.prototype.render=function(){return this.itemGroups=this.itemsGroupedByDate(),this.itemGroups.length&&(this.allPast=_(this.itemGroups).all(function(e){return e.date.isPast()}),this.allPast?this.showAll():this.allUpcoming=_(this.itemGroups).all(function(e){return!e.date.isPast()})),n.__super__.render.apply(this,arguments)},n.prototype.addRecurrences=function(){var e,t,n,r,i;r=this.bucketCalendarEvents(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],e.isRecurring()?this.isTemplate?i.push(e.addTemplateRecurrences(this.weeks)):i.push(e.addRecurrencesInRange(e.getStartDate(),CalendarDate.today().next(this.weeks*7))):i.push(void 0);return i},n.prototype.bucketCalendarEvents=function(){return this.calendarEvents.select(function(e){return function(t){return t.bucket()===e.bucket}}(this))},n.prototype.filteredCalendarEvents=function(){return this.bucketCalendarEvents()},n.prototype.bucketTodos=function(){var e,t;return(t=typeof (e=this.bucket).todos==="function"?e.todos().toArray():void 0)!=null?t:[]},n.prototype.itemsGroupedByDate=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;r={},t=[],l=this.filteredCalendarEvents().concat(this.bucketTodos());for(i=0,u=l.length;i<u;i++){n=l[i],c=n.getDates();for(s=0,a=c.length;s<a;s++)e=c[s],r[e]==null&&(r[e]={CalendarEvents:[],Todos:[],date:e}),r[e][n.constructor.modelName+"s"].push(n)}h=_(r).keys().sort();for(o=0,f=h.length;o<f;o++)e=h[o],t.push(r[e]);return t},n.prototype.toggleAll=function(){return $(this.el).toggleClass("show_all"),!1},n.prototype.showAll=function(){return $(this.el).addClass("show_all")},n}(bcx.Autoview)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=bcx.EmailAddressHelper.looksLikeEmailAddress,bcx.views.AutocompleteSubscribersView=function(n){function s(e){this.subscribable=e.subscribable,this.bucket=e.bucket,this.isPrivate=e.isPrivate,this.addGroup=t(this.addGroup,this),this.renderSubscriber=t(this.renderSubscriber,this),this.renderAutocompleteItem=t(this.renderAutocompleteItem,this),this.renderAutocompleteMenu=t(this.renderAutocompleteMenu,this),this.selectAutocompleteItem=t(this.selectAutocompleteItem,this),this.optionsForAutocomplete=t(this.optionsForAutocomplete,this),s.__super__.constructor.apply(this,arguments)}return r(s,n),s.templatePrefix="templates/autocomplete_subscribers/",s.prototype.events={"click a[data-behavior~=remove]":"removeSubscriber"},s.prototype.initialize=function(){return this.peopleAndGroups=bcx.peopleAndGroups,this.peopleAndGroups.load(function(e){return function(){return e.people=e.peopleAndGroups.people(),e.groups=e.peopleAndGroups.groups(),e.bucketPeople=e.isPrivate?e.bucket.team_members():e.bucket.people(),e.unsubscribers=e.bucket.unsubscribers()}}(this))},s.prototype.render=function(){return $(this.el).html(this.JST("index")),this.afterRender(),this.installed=!0},s.prototype.update=function(e){return e==null&&(e={}),this.installed&&(this.previouslySelectedPeople=_.uniq(this.selectedPeople().concat(this.previouslySelectedPeople))),_.extend(this,e),this.initialize(),this.render()},s.prototype.afterRender=function(){return this.$input=this.$("input[data-behavior~=new_subscriber]"),this.$subscribers=this.$("ul[data-role~=subscribers]"),this.initializeAutocompletion()},s.prototype.initializeAutocompletion=function(){return this.$input.autocomplete({appendTo:this.$("[data-role~=choose_subscribers]"),source:this.optionsForAutocomplete,select:this.selectAutocompleteItem,delay:0,minLength:0,autoFocus:!0}),this.autocomplete=this.$input.data("ui-autocomplete"),this.autocomplete._renderMenu=this.renderAutocompleteMenu,this.autocomplete._renderItem=this.renderAutocompleteItem},s.prototype.optionsForAutocomplete=function(t,n){var r,i,s,o,u,a;return o=t.term.trim(),u=RegExp("(^|\\s)"+$.ui.autocomplete.escapeRegex(o),"i"),s=this.availableGroups().concat(this.availablePeople()),r=_(s).select(function(e){return u.test(e.searchString())}),a=_(r).map(function(e){return{model:e}}),r.length===0&&e(o)&&(i=new bcx.models.PersonOrGroup({email_address:o}),a.push({model:i})),n(a)},s.prototype.selectAutocompleteItem=function(e,t){var n;return e.stopPropagation(),e.preventDefault(),$(e.target).val("").focus(),n=t.item.model,n.isGroup()?this.addGroup(n):this.addSubscriber(n)},s.prototype.renderAutocompleteMenu=function(e,t){var n,r,s,o,u,a,f,l,c,h;n=[],s=[];for(o=0,a=t.length;o<a;o++)r=t[o],r.model.isGroup()||(l=r.model,i.call(this.bucketPeople,l)>=0)?n.push(r):s.push(r);s.length>1?s.unshift({heading:"These people can't see this calendar. Loop them in to share by email only:"}):s.length===1&&s.unshift({heading:"This person can't see this calendar. Loop them in to share by email only:"}),c=n.concat(s),h=[];for(u=0,f=c.length;u<f;u++)r=c[u],h.push(this.autocomplete._renderItemData(e,r));return h},s.prototype.renderAutocompleteItem=function(e,t){return t.heading?$("<li><h2>"+t.heading+"</h2></li>").appendTo(e):$(this.renderSubscriber(t.model)).appendTo(e)},s.prototype.availablePeople=function(){return _(this.people).without(this.selectedPeople())},s.prototype.availableBucketPeople=function(){return _(this.bucketPeople).without(this.selectedPeople())},s.prototype.availableGroups=function(){var e,t,n,r,s;return n=this.availableBucketPeople(),n.length?(r=_(n).pluck("id"),s=_(this.unsubscribers).pluck("id"),e=new bcx.models.PersonOrGroup({name:"Everyone",member_ids:r}),t=[e].concat(this.groups),_(t).select(function(e){return _(e.get("member_ids")).any(function(e){return i.call(r,e)>=0&&!(i.call(s,e)>=0)})})):[]},s.prototype.subscribers=function(){var e;return this.previouslySelectedPeople?_.intersection(this.previouslySelectedPeople,this.bucketPeople):(e=this.subscribable.subscribers(),this.subscribable.isNew()&&e.push(this.peopleAndGroups.currentPerson()),e)},s.prototype.renderSubscriber=function(e){var t,n,r;return n=i.call(this.unsubscribers,e)>=0,r=i.call(this.bucketPeople,e)<0,t=this.subscribable.isNew()&&e===this.peopleAndGroups.currentPerson(),this.JST("subscriber",{model:e,isDisabled:n,isOutsideSubscriber:r,forceSubscriber:t,pluralize:this.pluralize})},s.prototype.addSubscriber=function(e){return this.$subscribers.append(this.renderSubscriber(e)),this.trigger("change")},s.prototype.addGroup=function(e){var t,n;return t=_(this.availableBucketPeople()).select(function(t){var n;return n=t.id,i.call(e.get("member_ids"),n)>=0}),n=_(t).select(function(e){return function(t){return i.call(e.unsubscribers,t)>=0}}(this)),t=_(t).without(n),this.$subscribers.append(this.JST("group",{group:e,people:t,unsubscribers:n,renderSubscriber:this.renderSubscriber})),this.trigger("change")},s.prototype.removeSubscriber=function(e){var t,n,r;return r=$(e.target).closest("li[data-role~=subscriber]"),t=$(e.target).closest("li[data-role~=subscriber_group]"),n=t.find("li[data-role~=subscriber]"),n.length===1||r.length===0?t.fadeOutAndRemove():r.fadeOutAndRemove(),!1},s.prototype.selectedPeople=function(){var e;return e=this.$subscribers.find("li[data-role~=subscriber]").map(function(){return $(this).data("id")}),_(this.people).select(function(t){var n;return n=t.id,i.call(e,n)>=0})},s.prototype.newSubscriberEmails=function(){var e;return e=this.$subscribers.find("li[data-role~=subscriber]").map(function(){return $(this).data("new-subscriber-email")}),_(_.toArray(e)).compact()},s}(bcx.View)}.call(this),function(){bcx.views.Autoresize=function(){function e(){}return e.prototype.setup=function(){return $(this.el).bind("autoview:render",function(e){return function(){return e.autoresize()}}(this))},e.prototype.autoresize=function(){return this.$("[data-behavior~=autoresize]").each(function(){return $(this).focus().autoResize()})},e}()}.call(this),function(){var e,t,n,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},f=function(e,t){return function(){return e.apply(t,arguments)}},l=[].slice;bcx.views.BucketOperationToolView=function(e){function u(){return u.__super__.constructor.apply(this,arguments)}var s;return a(u,e),s=function(e,t,n){var r,i,s;return s=e.projects,r=e.calendars,i=bcx.currentBucket.constructor.modelName,i==="Project"?(s=s.filter(function(e){return e.id!==parseInt(bcx.currentBucket.id)}),t==="CopyOperation"&&s.unshift({id:bcx.currentBucket.id,name:bcx.currentBucket.get("name")})):r=r.filter(function(e){return e.id!==parseInt(bcx.currentBucket.id)}),n!=="CalendarEvent"&&(r=[]),{projects:s,calendars:r}},u.prototype.events={expand:"expanded",collapse:"collapsed"},u.prototype.initialize=function(){return this.label=this.$el.data("label"),this.newBucketOperationPath=this.$el.data("new-bucket-operation-path"),this.bucketOperationType=this.$el.data("bucket-operation-type"),this.sourceResourceType=this.$el.data("source-resource-type"),this.sourceResourceId=this.$el.data("source-resource-id"),this.sourceResourceHumanName=this.$el.data("source-resource-human-name"),this.initializeSubviews()},u.prototype.initializeSubviews=function(){var e;return e=this.getFormViewConstructor(),this.formView=new e({el:this.$("[data-role=form]").get(0)}),this.formView.toolView=this,this.formForNewProjectView=new r({el:this.$("[data-role=form_for_new_project]").get(0)}),this.formForNewProjectView.toolView=this,this.errorView=new n({el:this.$("[data-role=error]").get(0)}),this.conflictView=new t({el:this.$("[data-role=conflict]").get(0)}),this.conflictView.toolView=this},u.prototype.expanded=function(){return this.fetchNewBucketOperationDetails().done(function(e){return function(t){return t.conflict?e.prepareAndShowConflictView(t.conflict):e.prepareAndShowFormView(t.buckets)}}(this)).fail(function(e){return function(){return e.showErrorView()}}(this))},u.prototype.fetchNewBucketOperationDetails=function(){return $.ajax({url:this.newBucketOperationPath,accepts:"application/json",dataType:"json",data:{source_resource_type:this.sourceResourceType,source_resource_id:this.sourceResourceId}})},u.prototype.collapsed=function(){return this.reset()},u.prototype.reset=function(){return this.formView.show(),this.formView.reset(),this.formForNewProjectView.hide(),this.formForNewProjectView
.reset(),this.conflictView.hide(),this.conflictView.reset()},u.prototype.getFormViewConstructor=function(){switch(this.sourceResourceType){case"Todo":return o;default:return i}},u.prototype.prepareAndShowFormView=function(e){var t,n,r;return r=s(e,this.bucketOperationType,this.sourceResourceType),n=r.projects,t=r.calendars,this.formView.show(),this.formView.populateDestinationBucketOptions(this.label,n,t)},u.prototype.showFormForNewProjectView=function(){return this.formView.hide(),this.formForNewProjectView.show()},u.prototype.showErrorView=function(){return this.formView.hide(),this.formForNewProjectView.hide(),this.$el.removeClass("busy"),this.errorView.show()},u.prototype.prepareAndShowConflictView=function(e){return this.formView.hide(),this.formForNewProjectView.hide(),this.conflictView.setConflict(e),this.conflictView.show()},u}(bcx.View),s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.hide=function(){return this.$el.hide()},t.prototype.show=function(){return this.$el.show()},t.prototype.reset=function(){},t.prototype.getBucketOperationConstructor=function(e){switch(e){case"CopyOperation":return bcx.CopyOperation;case"MoveOperation":return bcx.MoveOperation;case"ContainableMoveOperation":return bcx.ContainableMoveOperation}},t}(bcx.View),e=function(e){function t(){return this.submitted=f(this.submitted,this),t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.events=function(){return{submit:"submitted"}},t.prototype.initialize=function(){return this.$submit=this.$("input[type=submit]"),this.$preserveTodoAssignmentsLabel=this.$("[data-role=preserve_todo_assignments_label]")},t.prototype.show=function(){return t.__super__.show.apply(this,arguments),this.updateCopyOptionsVisibility()},t.prototype.updateCopyOptionsVisibility=function(){var e,t;return e=$("article.comment[data-creator-id]").length+$("[data-comments-counter]").length>0,this.$("[data-role=keep_comments_label]").toggle(e),t=$("[data-behavior~=todo_due_date_present]").length>0,this.$("[data-role=preserve_due_dates_label]").toggle(t)},t.prototype.submitted=function(e){var t,n,r;return e.preventDefault(),t=this.getBucketOperationConstructor(this.toolView.bucketOperationType),n=new t(this.getBucketOperationOptions()),this.setCopyOperationOptions(n),r=new BackgroundOperationProcessor(n),r.on("processor:failed",function(e){return function(){return e.toolView.showErrorView()}}(this)),r.run()},t.prototype.getBucketOperationOptions=function(){return{source_resource_type:this.toolView.sourceResourceType,source_resource_id:this.toolView.sourceResourceId}},t.prototype.setCopyOperationOptions=function(e){var t,n,r,i,s;i=["keep_comments","preserve_todo_assignments","preserve_due_dates"],s=[];for(n=0,r=i.length;n<r;n++)t=i[n],this.$("[data-role="+t+"_option]").is(":checked")?s.push(e.set(t,!0)):s.push(void 0);return s},t}(s),i=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var t,n,r;return a(i,e),n=function(){var e,t;return e=$('<optgroup label="…a new project">'),t=$('<option value="create_project_option">Start a new project</option>'),e.append(t)},r=function(e,t){var n,r,i,s,o,u,a,f,l;i=bcx.currentBucket.constructor.modelName,n=$("<option disabled>"+t.label+"</option>").attr("selected",!!t.labelSelected),s=[n];for(f=0,l=e.length;f<l;f++)u=e[f],o=i==="Project"&&u.id===parseInt(bcx.currentBucket.id),a=o?"This project ("+u.name+")":u.name,r=$("<option value='Project:"+u.id+"'>").text(a),s.push(r);return s},t=function(e,t){var n,r,i,s,o,u,a;s=bcx.currentBucket.constructor.modelName,n=$("<option disabled>"+t.label+"</option>").attr("selected",!!t.labelSelected),o=[n];for(u=0,a=e.length;u<a;u++)i=e[u],r=$("<option value='Calendar:"+i.id+"'>").text(i.name),o.push(r);return o},i.prototype.events=function(){return _.extend(i.__super__.events.apply(this,arguments),{"change [data-role=destination_bucket_select]":"destinationBucketChanged"})},i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments),this.form=this.$("form"),this.$destinationBucketSelect=this.$("[data-role=destination_bucket_select]"),this.$newProjectNameInput=this.$("[data-role=new_project_name]"),this.$noDestinationsNotice=this.$("[data-role=no_destinations_notice]"),this.$privacyExplanation=this.$("[data-role=privacy_explanation]")},i.prototype.updateCopyOptionsVisibility=function(){var e;return i.__super__.updateCopyOptionsVisibility.apply(this,arguments),e=$("[data-behavior~=todo_assignee_present]").length>0,this.$preserveTodoAssignmentsLabel.toggle(e)},i.prototype.populateDestinationBucketOptions=function(e,i,s){var o,u,a,f,c,h,p,d;return p=this.showsNewProjectOption(),d=i.length>0,c=s.length>0,h=p+d+c>1,a=[],(h||p)&&a.push($("<option disabled selected>"+e+" to…</option>")),u=h?(f=p&&d?[n()].concat(l.call(r(i,{label:"…an existing project"}))):p?[n()]:d?r(i,{label:"…a project"}):[],o=c?t(s,{label:"…a calendar"}):[],l.call(f).concat(l.call(o))):d?r(i,{label:"Choose a project…",labelSelected:!0}):c?t(s,{label:"Choose a calendar…",labelSelected:!0}):p?[n()]:[],u.length?(a.push.apply(a,u),this.$destinationBucketSelect.empty().append(a).attr("disabled",!1).show().focus()):this.showNoDestinationsNotice()},i.prototype.showsNewProjectOption=function(){return bcx.currentPerson.canCreateProjects()},i.prototype.destinationBucketChanged=function(e){this.$submit.attr("disabled",!1);if($(e.target).val()==="create_project_option")return this.toolView.showFormForNewProjectView()},i.prototype.reset=function(){return this.resetDestinationBucketSelect(),this.hideNoDestinationsNotice()},i.prototype.resetDestinationBucketSelect=function(){return this.$destinationBucketSelect.html("<option>Loading…</option>").attr("disabled",!0)},i.prototype.getBucketOperationOptions=function(){var e,t,n;return n=this.getDestinationBucketTypeAndId(),t=n.destinationBucketType,e=n.destinationBucketId,_.extend(i.__super__.getBucketOperationOptions.apply(this,arguments),{destination_bucket_type:t,destination_bucket_id:e})},i.prototype.getDestinationBucketTypeAndId=function(){var e,t,n;return n=this.$destinationBucketSelect.val().split(":"),t=n[0],e=n[1],{destinationBucketType:t,destinationBucketId:e}},i.prototype.showNoDestinationsNotice=function(){return this.form.hide(),this.$noDestinationsNotice.show()},i.prototype.hideNoDestinationsNotice=function(){return this.form.show(),this.$noDestinationsNotice.hide()},i}(e),o=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}var t,n;return a(r,e),t=function(e){return e["private"]?$("<option data-private='true' value='"+e.id+"'>").text(""+e.name+" (hidden from the client)"):$("<option value='"+e.id+"'>").text(e.name)},n=function(e){return _.map(e,t)},r.prototype.events=function(){return _.extend(r.__super__.events.apply(this,arguments),{"change [data-role=destination_container_select]":"destinationTodolistChanged"})},r.prototype.initialize=function(){return r.__super__.initialize.apply(this,arguments),this.$destinationTodolistSelect=this.$("[data-role=destination_container_select]"),this.$noDestinationTodolistsNotice=this.$("[data-role=no_destination_todolists_notice]")},r.prototype.showsNewProjectOption=function(){return!1},r.prototype.destinationBucketChanged=function(e){this.hideNoDestinationTodolistsNotice(),this.resetDestinationTodolistSelect(),this.$submit.attr("disabled",!0);if($(e.target).val()!=="create_project_option")return this.$destinationTodolistSelect.show(),this.fetchDestinationTodolistOptions().done(function(e){return function(t){return e.populateDestinationTodolistOptions(t)}}(this)).fail(function(e){return function(){return e.toolView.showErrorView()}}(this))},r.prototype.fetchDestinationTodolistOptions=function(){var e,t,n;return n=this.getDestinationBucketTypeAndId(),t=n.destinationBucketType,e=n.destinationBucketId,$.ajax({url:"/projects/"+e+"/todolists.json",accepts:"application/json"})},r.prototype.populateDestinationTodolistOptions=function(e){var t,r;return r=[],t=n(e),t.length?(r.push($("<option disabled selected>In the list…</option>")),r.push.apply(r,t),this.$destinationTodolistSelect.empty().append(r).attr("disabled",!1).focus()):this.showNoDestinationTodolistsNotice()},r.prototype.destinationTodolistChanged=function(){return this.$submit.attr("disabled",!1),this.$destinationTodolistSelect.find(":selected").data("private")?this.$privacyExplanation.hide():this.$privacyExplanation.show()},r.prototype.reset=function(){return r.__super__.reset.apply(this,arguments),this.resetDestinationTodolistSelect(),this.hideNoDestinationTodolistsNotice(),this.$privacyExplanation.hide()},r.prototype.resetDestinationTodolistSelect=function(){return this.$destinationTodolistSelect.html("<option>Loading…</option>").attr("disabled",!0).hide()},r.prototype.getBucketOperationOptions=function(){return _.extend(r.__super__.getBucketOperationOptions.apply(this,arguments),{destination_container_type:"Todolist",destination_container_id:this.getDestinationTodolistId()})},r.prototype.getDestinationTodolistId=function(){return this.$destinationTodolistSelect.val()},r.prototype.getBucketOperationConstructor=function(){return bcx.ContainableMoveOperation},r.prototype.showNoDestinationTodolistsNotice=function(){return this.resetDestinationTodolistSelect(),this.$noDestinationTodolistsNotice.show(),Beanstalk.logEvent("MoveATodo","showNoDestinationTodolistsNotice")},r.prototype.hideNoDestinationTodolistsNotice=function(){return this.$noDestinationTodolistsNotice.hide()},r}(i),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.events=function(){return _.extend(t.__super__.events.apply(this,arguments),{"keyup input[data-role=new_project_name]":"newProjectNameChanged"})},t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.$newProjectNameInput=this.$("[data-role=new_project_name]"),this.$projectsLimitReachedNotice=this.$("[data-role=projects_limit_reached_notice]")},t.prototype.show=function(){return t.__super__.show.apply(this,arguments),bcx.currentAccount.canCreateProjects()?this.$newProjectNameInput.focus():this.showProjectsLimitReachedNotice()},t.prototype.updateCopyOptionsVisibility=function(){return t.__super__.updateCopyOptionsVisibility.apply(this,arguments),this.$preserveTodoAssignmentsLabel.hide()},t.prototype.reset=function(){return this.$newProjectNameInput.val(""),this.hideProjectsLimitReachedNotice()},t.prototype.getBucketOperationOptions=function(){return _.extend(t.__super__.getBucketOperationOptions.apply(this,arguments),{new_project_name:this.$newProjectNameInput.val()})},t.prototype.newProjectNameChanged=function(){return $.trim(this.$newProjectNameInput.val())?this.$submit.attr("disabled",!1):this.$submit.attr("disabled",!0)},t.prototype.showProjectsLimitReachedNotice=function(){return this.$("input").attr("disabled",!0).blur(),this.$projectsLimitReachedNotice.show()},t.prototype.hideProjectsLimitReachedNotice=function(){return this.$("input").attr("disabled",!1),this.$projectsLimitReachedNotice.hide()},t}(e),n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t}(s),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.templateName="bucket_operation_tool_conflict",t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments)},t.prototype.render=function(){if(this.conflict)return this.label==null&&(this.label=this.toolView.label),this.sourceResourceHumanName==null&&(this.sourceResourceHumanName=this.toolView.sourceResourceHumanName),this.$el.html(this.renderTemplate(this.templateName))},t.prototype.show=function(){var e;return this.render(),((e=this.conflict.status)==="pending"||e==="processing")&&this.startWatchingConflict(),t.__super__.show.apply(this,arguments)},t.prototype.reset=function(){return this.stopWatchingConflict()},t.prototype.setConflict=function(e){this.conflict=e},t.prototype.startWatchingConflict=function(){var e,t;return e=this.getBucketOperationConstructor(this.conflict.type),t=new e({id:this.conflict.id}),this.processor=new BackgroundOperationProcessor(t),this.processor.startWatchingOperation()},t.prototype.stopWatchingConflict=function(){var e;return(e=this.processor)!=null?e.stopWatchingOperation():void 0},t}(s)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this.performDragNavigation=t(this.performDragNavigation,this),this.updateBlankSlate=t(this.updateBlankSlate,this),this.updateCalendarListVisibility=t(this.updateCalendarListVisibility,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.viewName("calendar_display"),n.prototype.events={"click [data-behavior~=toggle_calendar_list]":"toggleCalendarListClicked","click [data-behavior~=add_calendar]":"addCalendarClicked","click [data-behavior~=edit_bucket]":"editBucketClicked","click [data-behavior~=toggle_bucket]":"toggleBucketClicked","calendardate:click":"calendarDateClicked","calendaritem:select":"calendarItemSelected","calendaritem:deselect":"calendarItemDeselected","calendaritemeditor:hide":"calendarItemEditorHidden","project_editor:hide":"calendarOrProjectEditorClosed","calendar_editor:hide":"calendarOrProjectEditorClosed","calendaritem:dragstart":"calendarItemStartedDragging","calendaritem:dragmove":"calendarItemMoved","calendaritem:dragend":"calendarItemDropped","calendaritem:dragover [data-behavior~=navigate]":"calendarItemDraggedOverNavigateButton","calendaritem:dragout  [data-behavior~=navigate]":"calendarItemDraggedOutOfNavigateButton","calendargrid:beforeanimate":"lockNavigation","calendargrid:afteranimate":"unlockNavigation"},n.prototype.initialize=function(){return this.display=new bcx.models.CalendarDisplay,this.display.bind("reset",function(e){return function(){return e.calendarItemEditor.unregister(),e.render()}}(this)),this.display.bind("change:calendarListVisibility",this.updateCalendarListVisibility),this.display.bind("change:blankSlate",this.updateBlankSlate),this.updateCalendarListVisibility()},n.prototype.installSubviews=function(){return n.__super__.installSubviews.apply(this,arguments),this.calendarEditor=this.findSubviewByName("calendar_editor"),this.calendarEditor.hide(),this.projectEditor=this.findSubviewByName("project_editor"),this.projectEditor.hide(),this.calendarItemEditor=this.findSubviewByName("calendar_item_editor"),this.calendarItemEditor.hide(),this.calendarGrid=this.findSubviewByName("calendar_grid")},n.prototype.install=function(){var e;return e=n.__super__.install.apply(this,arguments),this.updateBlankSlate(),e},n.prototype.render=function(){var e;return(e=$(this.placeholder).data("calendar-event-id"))&&this.display.setActiveCalendarEvent(e),n.__super__.render.apply(this,arguments)},n.prototype.toggleCalendarListClicked=function(e){return this.calendarItemEditor.hide(),this.display.toggleCalendarListVisibility(),!1},n.prototype.updateCalendarListVisibility=function(){return this.display.getCalendarListVisibility()?$(this.el).addClass("calendar_list_visible"):$(this.el).removeClass("calendar_list_visible")},n.prototype.updateBlankSlate=function(){var e;return e=$(this.el).closest("div.panel"),this.display.blankSlate?(e.addClass("blank_slate"),this.addCalendarClicked()):(e.removeClass("blank_slate"),this.calendarEditor.hide())},n.prototype.addCalendarClicked=function(e){var t;return this.loadPeopleAndAccesses(),t=this.$("section.calendars h4"),this.calendarEditor.showWith(new bcx.models.Calendar,t.get(0)),!1},n.prototype.editBucketClicked=function(e){var t,n,r;return this.loadPeopleAndAccesses(),r=$(e.currentTarget).get(0),t=this.display.currentBucket(),n=t.constructor.modelName==="Calendar"?this.calendarEditor:this.projectEditor,n.isVisibleWith(t)?n.hide():(n.showWith(t,r),$(r).addClass("activated")),!1},n.prototype.calendarOrProjectEditorClosed=function(e){var t;return t=$(this.el).find("li.activated[data-bucket-type]"),$(t).removeClass("activated")},n.prototype.loadPeopleAndAccesses=function(){return bcx.peopleAndGroups.load()},n.prototype.toggleBucketClicked=function(e){var t;return t=this.findBucketByElement(e.currentTarget),this.display.toggleBucketVisibility(t),!1},n.prototype.findBucketByElement=function(e){var t,n,r;t=$(e).closest("[data-bucket-type]"),r=t.data("bucket-type"),n=t.data("bucket-id");if(r==="calendar")return bcx.calendars.get(n);if(r==="project")return bcx.projects.get(n)},n.prototype.calendarDateClicked=function(e,t){var n,r;return this.calendarItemEditor.visible?this.calendarItemEditor.hide():(n=new bcx.models.CalendarEvent({summary:"New event",all_day:!0,starts_at:t.toString(),until_date:t.next().toString()}),(r=this.display.currentBucket())&&n.set({bucket_type:r.constructor.modelName,bucket_id:r.id}),this.calendarItemElement=this.calendarGrid.insertAllDayCalendarEventElement(n),this.calendarGrid.selectCalendarItemElement(this.calendarItemElement,n))},n.prototype.calendarItemSelected=function(e,t){return this.loadPeopleAndAccesses(),this.calendarItemEditor.isVisibleWith(t)?this.calendarItemEditor.repositionRelativeTo(e.target):this.calendarItemEditor.showWith(t,e.target)},n.prototype.calendarItemDeselected=function(){return this.calendarItemElement&&$(this.calendarItemElement).remove(),this.calendarItemEditor.hide(!0)},n.prototype.calendarItemEditorHidden=function(){return this.calendarGrid.deselectCalendarItemElement()},n.prototype.calendarItemStartedDragging=function(e,t){if(this.calendarItemEditor.visible)return this.calendarItemEditor.hide()},n.prototype.calendarItemMoved=function(e,t){var n,r,i;return n=t.calendarItem,r=t.fromStartDate,i=t.offset,n.setStartDate(r.next(i))},n.prototype.calendarItemDropped=function(e,t){var n,r;return n=t.calendarItem,r=t.fromStartDate,n.constructor.modelName==="CalendarEvent"&&n.isRepeating()?n.getStartDate()!==r&&(n.fromStartDate=r,n.isLastRecurrence()?n.createExcluded():this.calendarItemEditor.showWith(n,this.calendarGrid.findDraggedElements())):n.save(),this.resetDragNavigation(),this.display.navigateToCalendarEvent(n)},n.prototype.calendarItemDraggedOverNavigateButton=function(e,t){return this.dragNavigationElement=e.currentTarget,this.dragNavigationInterval!=null?this.dragNavigationInterval:this.dragNavigationInterval=window.setInterval(this.performDragNavigation,500)},n.prototype.calendarItemDraggedOutOfNavigateButton=function(e,t){return this.dragNavigationElement=null},n.prototype.resetDragNavigation=function(){if(this.dragNavigationInterval)return window.clearInterval(this.dragNavigationInterval),this.dragNavigationInterval=null,this.dragNavigationElement=null},n.prototype.performDragNavigation=function(){return this.dragNavigationElement?$(this.dragNavigationElement).click():this.resetDragNavigation()},n.prototype.lockNavigation=function(){return this.display.lockNavigation()},n.prototype.unlockNavigation=function(){return this.display.unlockNavigation()},n}(bcx.Autoview),bcx.views.CalendarDisplayView=e}.call(this),function(){bcx.views.Popover=function(){function e(){}return e.recordName=function(e){return this.prototype.recordName=e},e.prototype.recordName="record",e.prototype.setup=function(){return $(document).bind("popover:show",function(e){return function(t){if(t.target!==e.el)return e.hide()}}(this)),this.visible=!0,this.hide()},e.prototype.showWith=function(e,t){var n;return this[this.recordName]=e,n=this.visible,this.hide(!0),this.render(),this.visible=!0,$(this.el).show().trigger("popover:show"),typeof this.afterShow=="function"&&this.afterShow(n),t&&this.repositionRelativeTo(t),this.bindWindowEvents(),this.autofocus()},e.prototype.show=function(){return this.showWith(null)},e.prototype.hide=function(e){e==null&&(e=!1);if(this.visible)return this.unbindWindowEvents(),$(this.el).trigger("popover:hide").hide(),typeof this.afterHide=="function"&&this.afterHide(e),this.visible=!1},e.prototype.repositionRelativeTo=function(e){return $(this.el).offset($(e).offset())},e.prototype.isVisibleWith=function(e){return this.visible&&this[this.recordName]===e},e.prototype.isDirty=function(){return $(this.el).isDirty()},e.prototype.bindWindowEvents=function(){$(window).bind("click.popover",function(e){return function(t){if(!$(t.target).closest("#"+e.id).length)return e.hide(),!1}}(this)),$(document).bind("keydown.popover",function(e){return function(t){if(t.keyCode!==$.ui.keyCode.ESCAPE)return;if(e.visible&&!e.isDirty())return e.hide(),!1}}(this));if(!$.browser.mobile)return $(window).bind("resize.popover",function(e){return function(){return e.hide()}}(this))},e.prototype.unbindWindowEvents=function(){return $(window).unbind(".popover"),$(document).unbind(".popover")},e.prototype.autofocus=function(){return this.$(":input:first").focus()},e}()}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this.render=t(this.render,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.viewName("calendar_editor"),n.include(bcx.views.Popover),n.recordName("calendar"),n.prototype.events={"submit form":"submitForm","click [data-behavior~=cancel]":"cancel","click [data-behavior~=delete]":"destroy","suggestions:commit":"suggestionPicked"},n.prototype.initialize=function(){return this.calendar=new bcx.models.Calendar,this.peopleAndGroups=bcx.peopleAndGroups},n.prototype.suggestionPicked=function(e){return e.stopPropagation()},n.prototype.render=function(){var e;return e=n.__super__.render.apply(this,arguments),this.renderAccesses(),this.setupPlaceholder(),e},n.prototype.renderAccesses=function(){return this.peopleAndGroups.load(function(e){return function(){return e.$("[data-behavior~=calendar_accesses]").html(""+e.renderTemplate("calendar_accesses")),e.setupInviteesView(),e.initializeSlider()}}(this))},n.prototype.afterShow=function(){return this.initializeSlider()},n.prototype.setupInviteesView=function(){var e,t,n,r,i,s,o;s=this.$("[data-behavior~=calendar_invitees]"),o=[];for(r=0,i=s.length;r<i;r++)e=s[r],t=_(bcx.peopleAndGroups.models).reject(function(e){return e.id==="person_"+bcx.currentPerson.id}),$(e).data("people",t),n=new bcx.views.CalendarInviteeFieldList({el:e}),n.render(),n.focus(),o.push($(e).data("view",n));return o},n.prototype.setupPlaceholder=function(){return $(this.el).find("[data-behavior~=placeholder]").placeholder()},n.prototype.submitForm=function(e){return this.$("form").addClass("busy"),this.calendar.save(this.getCalendarAttributes(),{success:function(e){return function(){return e.hide()}}(this),error:function(){return console.warn("failure!")}}),!1},n.prototype.getRemovedPeopleFromInviteesView=function(){var e,t;e=this.$("div.change_accesses [data-behavior~=calendar_invitees]")[0];if(e&&(t=$(e).data("view")))return t.removedPeople},n.prototype.getCalendarAttributes=function(){var e;return{name:this.$("[name=name]").val(),color:this.$("[name=color]:checked").val(),invitees:function(){var t,n,r,i;r=this.$("input[data-role~=email_address_input]"),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push({email_address:e.value});return i}.call(this),remove_people:this.getRemovedPeopleFromInviteesView()}},n.prototype.cancel=function(){return this.hide()},n.prototype.afterHide=function(e){if(!e)return $(this.el).trigger("calendar_editor:hide")},n.prototype.initializeSlider=function(){return this.$("[data-behavior~=slider]:visible").slider()},n.prototype.destroy=function(){return confirm("Are you sure you want to delete this calendar?")&&(this.$("form").addClass("busy"),this.calendar.trash({success:function(){return Stacker.workspace.visit("/"+bcx.currentAccountSlug+"/calendar",{bareWorkspace:!0})},error:function(){return console.warn("failure!")}})),!1},n}(bcx.Autoview)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.viewName("calendar_event_editor/recurrence_prompt"),t.prototype.showRecurrencePrompt=function(e){return $(this.el).html(this.renderRecurrencePrompt("destroy"))},t.prototype.markAsBusy=function(){return $(this.el).closest(".tool").addClass("busy")},t.prototype.hide=function(){return _.defer(function(e){return function(){return $(e.el).parent().find("[data-behavior~=recurring_cancel]").click()}}(this))},t.prototype.cancelDestroy=function(){return this.hide()},t.prototype.calendarEventRecurrenceRequestSucceeded=function(){return $(".sheet.inactive:last").find("h1 > a").click()},t}(bcx.AbstractCalendarEventEditor)}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};bcx.views.Locking=function(){function t(){}return t.prototype.setup=function(){return this.lockCount=0,this.onUnlock=[]},t.prototype.retainLock=function(){return this.lockCount++},t.prototype.releaseLock=function(){var e;this.lockCount--;if(this.lockCount===0){e=[];while(this.onUnlock.length)e.push(this.onUnlock.shift()());return e}},t.prototype.whenUnlocked=function(t){if(this.lockCount===0)return t();if(e.call(this.onUnlock,t)<0)return this.onUnlock.push(t)},t}()}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=function(e){function n(){return this.endDrag=t(this.endDrag,this),this.onKeyPress=t(this.onKeyPress,this),this.onDragInterval=t(this.onDragInterval,this),this.onDragOver=t(this.onDragOver,this),this.performDrag=t(this.performDrag,this),this.cursorChanged=t(this.cursorChanged,this),this.updateToday=t(this.updateToday,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.viewName("calendar_grid"),n.include(bcx.views.Locking),n.prototype.events={"click div.event":"calendarItemClicked","click div.date":"calendarDateClicked","mousedown div.event":"startDrag"},n.prototype.initialize=function(){return this.today=CalendarDate.today(),this.display=this.parentView.display,this.display.bind("change:cursor",this.cursorChanged),this.display.afterChanges(function(e){return function(){return e.whenUnlocked(e.render)}}(this)),this.display.bind("current_date_range:loaded",function(e){return function(t){if(e.display.getFirstDate()===t)return e.whenUnlocked(e.render)}}(this)),this.display.loadCurrentDateRange(),setInterval(this.updateToday,1e4)},n.prototype.updateToday=function(){var e;e=CalendarDate.today();if(!e.equals(this.today))return this.today=e,this.whenUnlocked(this.render)},n.prototype.afterRender=function(){return this.highlightDraggedCalendarItem(),this.reselectCalendarItem(),this.selectActiveCalendarEvent()},n.prototype.renderCalendarEvent=function(e){return JST["desktop/templates/calendar_event"]({calendarEvent:e,emojify:this.emojify})},n.prototype.renderTodo=function(e){return JST["desktop/templates/calendar_todo"]({todo:e,emojify:this.emojify,truncateWord:this.truncateWord})},n.prototype.cursorChanged=function(e,t){var n;n=Math.abs(e.previous("cursor").daysSince(t));if(!this.shouldAnimateForNavigation()||n===1)return this.render(),this.display.loadCurrentDateRange();switch(t.compareTo(e.previous("cursor"))){case-1:return this.display.loadCurrentDateRange("backward"),this.animate(-1);case 1:return this.display.loadCurrentDateRange("forward"),this.animate(1)}},n.prototype.shouldAnimateForNavigation=function(){return!this.display.synchronous},n.prototype.animate=function(e){var t,n,r,i,s,o,u,a,f,l,c,h;this.retainLock(),$(this.el).trigger("calendargrid:beforeanimate"),t=this.$("div.grid_content"),n=this.$("div.weeks"),o=e===1?"append":"prepend",s=n.height(),n[o](this.getWeeksForAnimation()),i=n.height(),r=0,u=e===1?[-6]:[0,6],h=(c=n.find("div.week")).slice.apply(c,u);for(f=0,l=h.length;f<l;f++)a=h[f],r+=$(a).height();return t.css({overflow:"hidden",position:"relative",height:s}),n.css({position:"absolute",top:e===1?0:s-i,width:"100%"}),t.transition({height:r},{duration:600}),n.transition({top:e===1?r-i:0},{duration:600,complete:function(r){return function(){var i;return u=e===1?[0,-6]:[6],(i=n.find("div.week")).slice.apply(i,u).remove(),t.css({overflow:"",position:"",height:""}),n.css({position:"",top:"",width:""}),r.releaseLock(),$(r.el).trigger("calendargrid:afteranimate")}}(this)})},n.prototype.getWeeksForAnimation=function(){var e,t,n,r,s,o,u;e=function(){var e,n,r,i;r=this.$("div.week"),i=[];for(e=0,n=r.length;e<n;e++)t=r[e],i.push($(t).data("date"));return i}.call(this),n=[],o=this.renderContents().find("div.week");for(r=0,s=o.length;r<s;r++)t=o[r],(u=$(t).data("date"),i.call(e,u)<0)&&n.push(t);return $(n)},n.prototype.insertAllDayCalendarEventElement=function(e){var t,n,r;n=$(this.renderCalendarEvent(e)).get(0),t=CalendarDate.parse(e.get("starts_at"));if(r=this.findElementForCalendarDate(t))return $(r).find("div.events.all_day").append(n),n},n.prototype.calendarItemClicked=function(e){var t;if(!$(e.target).is(":input"))return t=$(e.currentTarget).is(".selected"),t&&$(e.currentTarget).hasBehavior("calendar_todo")?this.deselectCalendarItemElement():t||this.selectCalendarItemElement(e.currentTarget),!1},n.prototype.calendarDateClicked=function(e){var t;if(!$(e.target).is(":input"))return t=this.findCalendarDateForElement(e.currentTarget),$(e.currentTarget).trigger("calendardate:click",t),!1},n.prototype.findCalendarItemForElement=function(e){var t;return t=$(e).data("id"),$(e).hasBehavior("calendar_todo")?this.display.todos.get(t):this.display.calendarEvents.get(t)},n.prototype.findCalendarDateForElement=function(e){return CalendarDate.parse($(e).data("date"))},n.prototype.findElementForCalendarDate=function(e){return this.$("div.date[data-date='"+e+"']").get(0)},n.prototype.findElementForCalendarItem=function(e){var t,n;return t="div.event[data-id='"+e.id+"']",n="[data-behavior~=calendar_todo]",e.constructor.modelName==="Todo"?this.$(""+t+n).get(0):this.$(""+t+":not("+n+")").get(0)},n.prototype.selectCalendarItemElement=function(e,t){return this.deselectCalendarItemElement(),this.calendarItemElement=e,this.calendarItem=t!=null?t:this.findCalendarItemForElement(e),$(e).addClass("selected"),$(e).trigger("calendaritem:select",this.calendarItem)},n.prototype.selectCalendarItem=function(e){var t;return t=this.findElementForCalendarItem(e),this.selectCalendarItemElement(t,e)},n.prototype.selectActiveCalendarEvent=function(){var e;if(e=this.display.takeActiveCalendarEvent())return _.defer(function(t){return function(){return t.selectCalendarItem(e)}}(this))},n.prototype.deselectCalendarItemElement=function(){if(!this.calendarItemElement)return;return $(this.calendarItemElement).removeClass("selected"),$(this.calendarItemElement).trigger("calendaritem:deselect",this.calendarItem),this.calendarItem=this.calendarItemElement=null},n.prototype.reselectCalendarItem=function(){var e;if(this.calendarItem){if(e=this.findElementForCalendarItem(this.calendarItem))return this.calendarItem=this.findCalendarItemForElement(e),this.selectCalendarItem(this.calendarItem);if(this.calendarItem.constructor.modelName==="Todo")return $(this.el).trigger("calendaritem:deselect")}},n.prototype.classesForDate=function(e){var t;return t=["date"],(this.display.firstWeekContainsToday()||e.fallsOnSameMonthAs(this.display.getBeginningOfMonth()))&&t.push("current_month"),e.equals(this.today)&&t.push("today"),t.join(" ")},n.prototype.classesForSpannedEventFrom=function(e,t){var n,r,s,o,u;return r=["event"],r.push("slot_"+e.slot),r.push("width_"+e.width),t=function(){var e,n,r;r=[];for(e=0,n=t.length;e<n;e++)s=t[e],r.push(s.toString());return r}(),n=e.calendarEvent,(o=n.getStartDate().toString(),i.call(t,o)<0)&&r.push("wraps_prev"),(u=n.getEndDate().toString(),i.call(t,u)<0)&&r.push("wraps_next"),r.join(" ")},n.prototype.startDrag=function(e){var t,n,r,i,s,o;if(r=this.detectDateFromMouseEvent(e)){t=$(e.currentTarget);if(n=this.findCalendarItemForElement(t))return e.preventDefault(),$(window).one("mouseup",this.endDrag),$(window).bind("mousemove",this.performDrag),$(window).bind("keydown",this.onKeyPress),$(this.el).bind("calendaritem:dragover"
,this.onDragOver),o=t.offset(),i=o.left,s=o.top,this.dragging={fromDate:r,fromPageX:e.pageX,fromPageY:e.pageY,fromXOffset:e.pageX-i,fromYOffset:e.pageY-s,fromStartDate:n.getStartDate(),offset:0,calendarItem:n,originalEl:e.currentTarget}}},n.prototype.performDrag=function(e){var t,n;return this.dragging.$ghost||(t=Math.abs(e.pageX-this.dragging.fromPageX),n=Math.abs(e.pageY-this.dragging.fromPageY),t+n>=3&&(this.createDragGhost(),this.createDragInterval(),$(this.el).trigger("calendaritem:dragstart",this.dragging))),this.updateDragging(e),this.updateDragGhost(e)},n.prototype.updateDragging=function(e){var t,n;n=this.dragging.dragArea,t=this.detectDragAreaFromMouseEvent(e),n&&t!==n&&$(n).trigger("calendaritem:dragout",this.dragging),this.dragging.pageX=e.pageX,this.dragging.pageY=e.pageY;if(this.dragging.dragArea=t)return $(t).trigger("calendaritem:dragover",this.dragging)},n.prototype.onDragOver=function(e){var t,n;if(t=this.detectDateFromDragArea(this.dragging.dragArea,this.dragging)){(n=this.dragging.toDate)||(this.dragging.toDate=n=t);if(n&&!n.equals(t))return this.dragging.toDate=t,this.dragging.offset=t.daysSince(this.dragging.fromDate),$(this.el).trigger("calendaritem:dragmove",this.dragging)}},n.prototype.createDragGhost=function(){var e;return e=$(this.dragging.originalEl),this.dragging.$ghost=e.ghost().addClass("ghost_event").addClass(e.is(".wraps_prev")?"wraps_prev":void 0).addClass(e.is(".wraps_next")?"wraps_next":void 0),this.highlightDraggedCalendarItem()},n.prototype.updateDragGhost=function(e){var t;return(t=this.dragging.$ghost)!=null?t.offset({left:e.pageX-this.dragging.fromXOffset,top:e.pageY-this.dragging.fromYOffset}):void 0},n.prototype.findDraggedElements=function(){var e,t;if(e=(t=this.dragging)!=null?t.calendarItem:void 0)return this.$("div.event[data-id='"+e.id+"']")},n.prototype.highlightDraggedCalendarItem=function(){if(this.dragging)return this.findDraggedElements().addClass("dragging")},n.prototype.removeDragGhost=function(){var e,t,n,r,i,s;return t=this.findDraggedElements(),this.retainLock(),r=this.dragging.$ghost,e=this.$("div.date[data-date='"+this.dragging.toDate+"']"),n=e.closest("div.week").find("div.event[data-id='"+this.dragging.calendarItem.id+"']"),i=function(e){return function(){return t.removeClass("dragging"),r.remove(),e.releaseLock()}}(this),(s=n.offset())?r.transition({top:s.top,left:s.left,width:n.width()},{timing:"ease-in",complete:i}):i()},n.prototype.createDragInterval=function(){return this.dragging.interval=window.setInterval(this.onDragInterval,50)},n.prototype.onDragInterval=function(){return this.updateDragging(this.dragging)},n.prototype.removeDragInterval=function(){return window.clearInterval(this.dragging.interval),this.dragging.interval=null},n.prototype.onKeyPress=function(e){if(e.keyCode===$.ui.keyCode.ESCAPE)return e.preventDefault(),this.dragging.toDate=this.dragging.fromStartDate,this.dragging.offset=0,$(this.el).trigger("calendaritem:dragmove",this.dragging),this.render(),this.endDrag()},n.prototype.endDrag=function(){return this.dragging.$ghost&&(this.removeDragInterval(),this.removeDragGhost(),$(this.el).trigger("calendaritem:dragend",this.dragging)),$(window).unbind("mousemove",this.performDrag),$(window).unbind("keydown",this.onKeyPress),$(this.el).unbind("calendaritem:dragover",this.onDragOver),this.dragging=!1},n.prototype.detectDragAreaFromMouseEvent=function(e){return _($("[data-behavior~=calendar_event_drag_area]")).detect(function(t){return $(t).containsPoint(e)})},n.prototype.detectDateFromMouseEvent=function(e){var t;if(t=this.detectDragAreaFromMouseEvent(e))return this.detectDateFromDragArea(t,e)},n.prototype.detectDateFromDragArea=function(e,t){var n,r,i,s,o,u,a;n=$(e).closest("div.week");if(!n.length)return;return s=CalendarDate.parse(n.find("div.date:first").attr("data-date")),o=n.offset().left,u=n.width(),r=u/7,i=t.pageX-o,a=Math.floor(i/r),s.next(a)},n}(bcx.Autoview)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};bcx.views.CalendarInviteeField=function(t){function i(){return this.currentPersonCanChangeAccess=e(this.currentPersonCanChangeAccess,this),i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.removable=function(){return this.readOnly()&&this.model.isEnabled()&&this.currentPersonCanChangeAccess()},i.prototype.currentPersonCanChangeAccess=function(){var e,t,n,i,s,o;i=this.options.parent;if(bcx.currentPerson.isAdmin()||(s=this.model.id,r.call(i.selectedPeopleIds,s)<0))return!0;if(n=$(i.el).closest("[data-calendar-id]").data("calendar-id"))return t=(o=bcx.calendars.get(n))!=null?o.accesses():void 0,e=_(t).find(function(e){return function(t){return t.person_id===e.model.get("person_id")}}(this)),e&&e.creator_id===bcx.currentPerson.id},i}(bcx.views.InviteeField)}.call(this),function(){var e,t,n,r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};n=bcx.collections.PeopleAndGroups,e=bcx.views.InviteeField,t=bcx.views.InviteeFieldGroup,bcx.views.InviteeFieldList=function(s){function u(){return this.inviteeBlur=i(this.inviteeBlur,this),this.updateNewSuperpowersPrompt=i(this.updateNewSuperpowersPrompt,this),this.resetView=i(this.resetView,this),this.replaceView=i(this.replaceView,this),this.addView=i(this.addView,this),u.__super__.constructor.apply(this,arguments)}return o(u,s),u.prototype.firsthumanInput="[data-role~=human_input]:first",u.prototype.events={"invitee:focus":"lastFieldFocused","invitee:blur":"inviteeBlur",reset:"reset","reset:disabledIds":"resetDisabledIds"},u.prototype.initialize=function(){var e,t;return t=$(this.el).data("disabled-people-ids"),e=$(this.el).data("disabled-group-ids"),this.disabledIds=t.concat(e),this.collection=new n($(this.el).data("people"),{disabledIds:this.disabledIds}),this.selection=new r([new this.collection.model,new this.collection.model,new this.collection.model]),this.selection.each(this.addView),this.selection.bind("add",this.addView),this.selection.bind("reset",this.resetView)},u.prototype.flushAndReplaceSelection=function(e){var t,n;return n=function(){var n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.collection.get("person_"+t));return i}.call(this),n.push(new this.collection.model,new this.collection.model,new this.collection.model),this.selection.reset(n)},u.prototype.viewConstructorFor=function(n){return n.isGroup()?t:e},u.prototype.createView=function(e){var t,n;return t=this.viewConstructorFor(e),n=new t({model:e,collection:this.collection,selection:this.selection,parent:this}),n.bind("replace",this.replaceView)},u.prototype.addView=function(e){var t;return t=this.createView(e),t.appendTo(this.el)},u.prototype.replaceView=function(e,t){var n;return n=this.createView(t),n.replace(e.el),this.focusNextField(n.el)},u.prototype.resetView=function(){return $(this.el).html(""),this.selection.each(this.addView)},u.prototype.updateNewSuperpowersPrompt=function(){return bcx.currentPerson.isAdmin()&&_.any(this.selection.newPeople())?$(this.el).next("#new_superpowers_prompt").show():$(this.el).next("#new_superpowers_prompt").hide()},u.prototype.lastFieldFocused=function(e){if(this.$("div.blank.field").size()===1)return this.selection.add(new this.collection.model)},u.prototype.inviteeBlur=function(){return this.updateNewSuperpowersPrompt(),this.lastFieldFocused()},u.prototype.focusNextField=function(e){return $(e).next("div.field").find(this.firsthumanInput).focus()},u.prototype.focus=function(){return this.$(this.firsthumanInput).focus()},u.prototype.reset=function(){return this.selection.reset([new this.collection.model,new this.collection.model,new this.collection.model])},u.prototype.reload=function(){return this.collection=new n($(this.el).data("people"),{disabledIds:this.disabledIds}),this.reset()},u.prototype.isClientList=function(){return $(this.el).data("is-client")},u.prototype.resetDisabledIds=function(e,t){return this.disabledIds=t.personIds.concat(t.groupIds),this.reload()},u}(bcx.View),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return o(t,e),t.prototype.add=function(e,n){var r,i,s,o;n==null&&(n={}),_.isArray(e)||(e=[e]);for(s=0,o=e.length;s<o;s++)i=e[s],(r=this.get(i.cid))&&this.remove(r,n);return t.__super__.add.call(this,e,n)},t.prototype.replace=function(e,t){return this.remove(t),this.remove(e,{silent:!0}),this.add(t,{silent:!0}),t.isGroup()&&this.add(t.members().enabled(),{silent:!0}),e.trigger("replace",t),this.trigger("replace",e,t)},t.prototype.newPeople=function(){return _.select(this.models,function(e){return e.isNewlyInvitedPerson()})},t}(Backbone.Collection)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=bcx.views.CalendarInviteeField,bcx.views.CalendarInviteeFieldList=function(n){function i(){return this.isInSelectedPeople=t(this.isInSelectedPeople,this),this.replaceView=t(this.replaceView,this),this.onAddSelection=t(this.onAddSelection,this),this.onRemoveSelection=t(this.onRemoveSelection,this),i.__super__.constructor.apply(this,arguments)}return r(i,n),i.prototype.initialize=function(){var e,t;return i.__super__.initialize.apply(this,arguments),this.removedPeople=[],this.selectedPeopleIds=_((t=$(this.el).data("selected-people-ids"))!=null?t:[]).reject(function(e){return e==="person_"+bcx.currentPerson.id}),this.selectionPeople=function(){var t,n,r,i;r=this.selectedPeopleIds,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.collection.get(e));return i}.call(this),this.selectionPeople.push(new this.collection.model,new this.collection.model,new this.collection.model),this.selection.reset(this.selectionPeople),this.selection.bind("remove",this.onRemoveSelection)},i.prototype.viewConstructorFor=function(t){return t.isGroup()?i.__super__.viewConstructorFor.apply(this,arguments):e},i.prototype.onRemoveSelection=function(e){if(this.isInSelectedPeople(e))return this.removedPeople.push(e.get("person_id"))},i.prototype.onAddSelection=function(e){if(this.isInSelectedPeople(e))return this.removedPeople=_(this.removedPeople).without(e.get("person_id"))},i.prototype.replaceView=function(e,t){return i.__super__.replaceView.apply(this,arguments),this.onAddSelection(t)},i.prototype.reset=function(){return this.selection.reset(this.selectionPeople)},i.prototype.reload=function(){return i.__super__.reload.apply(this,arguments),this.removedPeople=[]},i.prototype.isInSelectedPeople=function(e){return e.get("person_id")&&this.selectedPeopleIds.indexOf(e.id)>=0},i}(bcx.views.InviteeFieldList)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.views.CalendarItemEditorView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.templatePrefix="templates/calendar_event_editor/",n.viewName("calendar_item_editor"),n.include(bcx.views.Popover),n.recordName("calendarItem"),n.prototype.timedReminderOffsets=[["None","false"],["30 minutes before","-30m"],["1 hour before","-60m"],["Day of the event at...","0d"],["1 day before at...","-1d"],["2 days before at...","-2d"]],n.prototype.allDayReminderOffsets=[["None","false"],["Day of the event at...","0d"],["1 day before at...","-1d"],["2 days before at...","-2d"]],n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),this.display=this.parentView.display,this.display.bind("reset",this.hide),this.events=_.extend({},this.events,{"change select[data-behavior~=bucket_selector]":"bucketChanged","click [data-role~=privacy_toggle] input:checkbox":"privacyChanged","popover:hide":"cancelRecurrenceChange","change select[data-behavior~=reminder_offset]":"reminderOffsetChanged"}),this.delegateEvents()},n.prototype.render=function(){this.todo=null;if(this.calendarItem)return this.calendarItem.constructor.modelName==="Todo"?this.todo=this.calendarItem:this.calendarEvent=this.calendarItem,n.__super__.render.apply(this,arguments)},n.prototype.afterShow=function(){if(!this.todo)return this.updatePrivacyToggle(),this.setupPeopleDependentFields(),this.setupPlaceholder()},n.prototype.updateCalendarEventClasses=function(){return n.__super__.updateCalendarEventClasses.apply(this,arguments),_.defer(function(e){return function(){return e.toggleReminderFields()}}(this))},n.prototype.afterHide=function(e){if(!e)return $(this.el).trigger("calendaritemeditor:hide")},n.prototype.slideBalloonIntoView=function(){return _.defer(function(e){return function(){return e.$("> div.balloon").slideIntoView()}}(this))},n.prototype.repositionRelativeTo=function(e){var t,n,r,i,s,o,u,a,f,l;return i=$(e),r=$(e).find("> span.event"),n=r.outerWidth()>i.outerWidth()?i:r,t=this.$("> div.balloon"),l=n.offset(),u=l.left,f=l.top,o=n.width(),s=t.outerWidth()+t.find("> span.arrow").outerWidth(),a=$(document).width(),u+o+s>a?(this.setArrowOrientation("left"),$(this.el).offset({top:f,left:u})):(this.setArrowOrientation("right"),$(this.el).offset({top:f,left:u+o})),this.slideBalloonIntoView()},n.prototype.setArrowOrientation=function(e){var t;return t=this.$("> div.balloon"),e==="right"?t.removeClass("left_side").addClass("right_side"):t.removeClass("right_side").addClass("left_side")},n.prototype.autofocus=function(){$(":input[name=summary], :input[name=description]").autoResize();if(this.calendarEvent.isNew())return $(":input[name=summary]").focus().select()},n.prototype.setupPlaceholder=function(){return $(this.el).find("[data-behavior~=placeholder]").placeholder()},n.prototype.setupPeopleDependentFields=function(){var e;return e=this.$("select[data-behavior~=bucket_selector]"),e.attr("disabled",!0),this.installAutocompleteSubscribersView(),this.peopleAndGroups.load(function(t){return function(){return e.attr("disabled",!1),t.$("fieldset[data-role=subscriber_fields]").replaceWith(t.JST("subscriber_fields")),t.installAutocompleteSubscribersView()}}(this))},n.prototype.installAutocompleteSubscribersView=function(){var e,t;if((e=this.$("div[data-role~=autocomplete_placeholder]")).length)return t={el:e,subscribable:this.calendarEvent,bucket:this.selectedBucket(),isPrivate:this.isPrivateChecked()},this.subscribersView=new bcx.views.AutocompleteSubscribersView(t),this.subscribersView.bind("change",function(e){return function(){return e.slideBalloonIntoView()}}(this)),this.subscribersView.render()},n.prototype.bucketChanged=function(){return this.updatePrivacyToggle(),this.subscribersView.update({bucket:this.selectedBucket()})},n.prototype.privacyChanged=function(){return this.subscribersView.update({isPrivate:this.isPrivateChecked()})},n.prototype.updateCalendarEventAttributes=function(){var e,t,r;return n.__super__.updateCalendarEventAttributes.apply(this,arguments),t=this.getRemindAt(),r=this.subscribersView.selectedPeople().map(function(e){return e.get("person_id")}),e=this.subscribersView.newSubscriberEmails(),this.calendarEvent.set({remind_at:t,subscribers:r,new_subscriber_emails:e})},n.prototype.updatePrivacyToggle=function(){var e;return e=this.$("[data-role~=privacy_toggle]"),this.currentPersonCanChangePrivacy()?e.show():(e.hide(),e.find("input[type=checkbox]").prop("checked",!1))},n.prototype.getReminderOffset=function(){var e,t;return e=this.isTimed()?"timed":"all_day",(t=this.field(""+e+"_reminder_offset"))!=null?t:"false"},n.prototype.getRemindAt=function(){var e,t,n,r,i,s,o,u,a;r=this.getReminderOffset();if(r==="false")return null;e=this.calendarEvent.getStartDate(),s=this.calendarEvent.getStartsAt(),o=CalendarDateTime.parse(e,this.field("reminder_time"));if(n=(u=r.match(/(.+)m$/))!=null?u[1]:void 0)o=new Date(s+parseInt(n)*60*1e3);if(t=(a=r.match(/(.+)d$/))!=null?a[1]:void 0)e=e.next(parseInt(t));return i=CalendarDateTime.parse(e,o),i.toString()},n.prototype.reminderOffsetChanged=function(){return this.toggleReminderTime()},n.prototype.toggleReminderTime=function(){var e;return e=/d$/.test(this.getReminderOffset()),this.$("[data-role~=reminder_time]").toggle(e)},n.prototype.toggleReminderFields=function(){return this.$("fieldset[data-role~=reminder_fields]").toggle(this.isFuture()),this.toggleReminderTime()},n.prototype.currentPersonCanChangePrivacy=function(){var e;if(e=this.selectedBucket())return e.isClientProject()&&e.isTeamMemberId("person_"+bcx.currentPerson.id)},n.prototype.currentPersonCanChangeBucket=function(){return this.calendarEvent.isNew()||bcx.currentPerson.isAdmin()||bcx.currentPerson.id===this.calendarEvent.get("creator_id")},n.prototype.calendarEventRequestSucceeded=function(){var e;return e=this.calendarEvent.subscribers(),this.display.setBucketVisibility(this.calendarEvent.bucket(),!0),this.calendarEvent.isNew()&&e.length&&(e.length>1||e[0].get("person_id")!==bcx.currentPerson.id)?this.markAsNotified():(this.markAsNotBusy(),this.hide())},n.prototype.calendarEventRequestFailed=function(){return this.markAsFailed()},n.prototype.markAsNotified=function(){var e;return e=$(this),this.updateAlertText("data-succeeded-text"),this.$("form").addClass("succeeded").onTransitionEnd(function(){return setTimeout(function(t){return function(){return e.trigger("hide")}}(this),1e3)})},n.prototype.markAsFailed=function(){return this.updateAlertText("data-failed-text"),this.$("form").addClass("failed").onTransitionEnd(function(){return setTimeout(function(e){return function(){return e.$("form").removeClass("failed busy")}}(this),1250)})},n.prototype.updateAlertText=function(e){var t;return t=this.$("form").find("[data-behavior~=calendar_alert]"),t.html(t.attr(e))},n.prototype.submitForm=function(){if(!this.todo)return this.storeLastUsedBucket(),n.__super__.submitForm.apply(this,arguments)},n.prototype.storeLastUsedBucket=function(){return this.lastUsedBucket=this.selectedBucket()},n.prototype.cancelRecurrenceChange=function(){var e;if((e=this.calendarEvent)!=null?e.fromStartDate:void 0)return this.calendarEvent.setStartDate(this.calendarEvent.fromStartDate),this.calendarEvent.fromStartDate=null},n}(bcx.AbstractCalendarEventEditor)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.viewName("calendar_jump"),t.include(bcx.views.Popover),t.recordName("cursor"),t.prototype.className="position_reference",t.prototype.events={"click [data-direction=backward]":"navigateBackward","click [data-direction=forward]":"navigateForward","click [data-date]":"monthClicked"},t.prototype.initialize=function(){return this.display=this.parentView.display,this.cursor=this.display.getSignificantDate()},t.prototype.getFirstMonth=function(){var e;return e=CalendarDate.today().year%2,this.cursor.year%2===e?this.cursor.beginningOfYear():this.cursor.beginningOfYear().previous().beginningOfYear()},t.prototype.navigateBackward=function(){return this.cursor=this.cursor.nextMonth(-24),this.render(),!1},t.prototype.navigateForward=function(){return this.cursor=this.cursor.nextMonth(24),this.render(),!1},t.prototype.monthClicked=function(e){var t;return t=CalendarDate.parse($(e.currentTarget).data("date")),this.display.navigateToMonth(t),this.hide(),!1},t}(bcx.Autoview)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.viewName("calendar_list"),t.prototype.initialize=function(){return this.renderLater=_.debounce(this.render),this.calendars=bcx.calendars,this.calendars.bind("all",this.renderLater),this.projects=bcx.projects,this.projects.bind("all",this.renderLater),this.display=this.parentView.display,this.display.bind("change:hiddenBucketData",this.renderLater),bcx.bucketAccesses.bind("all",this.renderLater),bcx.todos.bind("all",this.renderLater)},t}(bcx.Autoview)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this.hideSpinner=t(this.hideSpinner,this),this.showSpinner=t(this.showSpinner,this),this.cursorChanged=t(this.cursorChanged,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.viewName("calendar_navigation"),n.prototype.tagName="header",n.prototype.events={"click [data-behavior~=navigate]":"navigationButtonClicked","click [data-behavior~=jump_to_month]":"jumpToMonthLinkClicked"},n.prototype.initialize=function(){return this.display=this.parentView.display,this.display.afterDisplayChanges(this.cursorChanged),this.display.bind("current_date_range:loading",this.showSpinner),this.display.bind("current_date_range:loaded",this.hideSpinner)},n.prototype.installSubviews=function(){return n.__super__.installSubviews.apply(this,arguments),this.jump=this.findSubviewByName("calendar_jump")},n.prototype.cursorChanged=function(){return this.jump.hide(),this.render()},n.prototype.navigationButtonClicked=function(e){var t;t=$(e.currentTarget).data("direction");switch(t){case"backward":this.display.navigateBackward();break;case"forward":this.display.navigateForward();break;case"today":this.display.navigateToToday()}return!1},n.prototype.jumpToMonthLinkClicked=function(e){return this.jump.visible?this.jump.hide():this.jump.showWith(this.display.getSignificantDate()),!1},n.prototype.showSpinner=function(){return this.showingSpinner=!0,this.$("span.busy").show()},n.prototype.hideSpinner=function(){return this.showingSpinner=!1,this.$("span.busy").hide()},n}(bcx.Autoview)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.views.GoogleDocPreview=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.events={"click [data-behavior~=sign_in]":"authorize",reset:"reset"},n.prototype.render=function(){return this.isPreviewable()&&this.browserSupportsPreviews()?this.buildPreview():this.loadedFile||this.loadFile(function(e){return function(){return e.render()}}(this)),$(this.el).html(JST["desktop/templates/google_doc_preview"](this)),$(this.el).trigger("view:render")},n.prototype.loadFile=function(e){var t;return this.loadedFile=!0,t=this.google.isAuthorized(),this.google.authorize(!0,function(n){return function(){return n.google.isAuthorized()?n.google.fetchMetadata(n.google.fileId,function(t){return t&&!t.error?(n.file=t,n.updateAttachmentName(),Beanstalk.logEvent("GoogleDocPreview","authorizedWithAccess")):(n.error=!0,Beanstalk.logEvent("GoogleDocPreview","authorizedWithoutAccess")),e()}):(t&&e(),Beanstalk.logEvent("GoogleDocPreview","unauthorized"))}}(this))},n.prototype.isPreviewable=function(){var e;return(e=this.file)!=null?e.embedLink:void 0},n.prototype.browserSupportsPreviews=function(){return!$.browser.msie||parseInt($.browser.version)!==11},n.prototype.previewURL=function(){var e;if(this.file.embedLink)return e=/\?/.test(this.file.embedLink)?"&":"?",""+this.file.embedLink+e+"overridemobile=true"},n.prototype.buildPreview=function(){var e;return $(this.el).addClass("loading"),e=$('<iframe src="'+this.previewURL()+'" class="offscreen">'),$("html").append(e),e.one("load",function(t){return function(){return setTimeout(function(){$(t.el).find("[data-role~=iframe_container]").prepend(e),e.removeClass("offscreen"),$(t.el).addClass("loaded").removeClass("loading");if($(t.el).closest("#enlarger").length)return $(t.el).closest("figure").addClass("with_preview"),$(t.el).closest("figure").find("[data-role~=enlarged]").hide(),$(t.el).attr("data-role","enlarged"),$(window).trigger("resize")},750)}}(this))},n.prototype.updateAttachmentName=function(){var e,t,n,r;r=$(this.el).data(),t=r.attachmentName,e=r.attachmentCreatorId,n=r.attachmentUpdatePath;if(t&&t!==this.file.title)if(bcx.currentPerson.admin||bcx.currentPerson.id===e)return $.ajax(n,{type:"PUT",data:{attachment:{name:this.file.title}}})},n.prototype.reset=function(){return this.error=this.file=this.loadedFile=null,this.render()},n.prototype.authorize=function(){return this.google.isAuthorized()?Beanstalk.logEvent("GoogleDocPreview","switchAccount"):Beanstalk.logEvent("GoogleDocPreview","authorize"),this.google.deauthorize(),this.google.authorize(!1)},n}(bcx.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=function(e,t){return function(){return e.apply(t,arguments)}};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.template="desktop/templates/membership_suggestions",t}(bcx.views.AutocompletePeopleSuggestions),bcx.views.MemberField=function(t){function i(){return this.remove=r(this.remove,this),this.replace=r(this.replace,this),this.appendTo=r(this.appendTo,this),this.modelRemoved=r(this.modelRemoved,this),this.modelReplaced=r(this.modelReplaced,this),i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.className="person invitee member field",i.prototype.template="desktop/templates/member_field",i.prototype.events={"focus input":"inputFocused","input:change input":"inputChanged","suggestions:commit":"suggestionPicked","click [data-behavior~=remove_member]":"removeControlClicked"},i.prototype.initialize=function(t){return this.options=t,this.selection=this.options.selection,this.install(),this.suggestionsView=new e({el:this.el,model:this.model,collection:this.collection})},i.prototype.install=function(){return this.model.bind("replace",this.modelReplaced),this.model.bind("remove",this.modelRemoved)},i.prototype.uninstall=function(){return this.model.unbind("replace",this.modelReplaced),this.model.unbind("remove",this.modelRemoved),this.unbind()},i.prototype.render=function(){return $(this.el).html(JST[this.template](this)),this.updateHiddenInputs(),this.updateAllClassNames()},i.prototype.update=function(){return this.updateHiddenInputs(),this.updateBlankClassName(),$(this.el).removeClass("invalid"),$(this.el).removeClass("unknown")},i.prototype.updateHiddenInputs=function(){return this.$("[data-role~=person_id_input]").val(this.model.get("person_id"))},i.prototype.updateAllClassNames=function(){return this.updateBlankClassName(),this.updateUnknownClassName(),this.updateDisabledClassName()},i.prototype.updateBlankClassName=function(){return $(this.el).toggleClass("blank",this.model.isBlank())},i.prototype.updateUnknownClassName=function(){return $(this.el).toggleClass("unknown",this.model.hasUnknownName())},i.prototype.updateDisabledClassName=function(){return $(this.el).toggleClass("disabled",this.model.isDisabled())},i.prototype.inputFocused=function(){return $(this.el).addClass("focused"),this.events.clickoutside="inputLostFocus",this.events.focusoutside="inputLostFocus",this.delegateEvents()},i.prototype.inputLostFocus=function(){return $(this.el).removeClass("focused"),delete this.events.clickoutside,delete this.events.focusoutside,this.delegateEvents(),this.render()},i.prototype.inputChanged=function(e,t){return this.model.setInput(t.currentValue)},i.prototype.suggestionPicked=function(e,t){return e.preventDefault(),this.selection.replace(this.model,t.suggestion)},i.prototype.removeControlClicked=function(e){return $(e.target).addClass("activated"),this.selection.remove(this.model)},i.prototype.modelReplaced=function(e){return this.trigger("replace",this,e)},i.prototype.modelRemoved=function(){return this.remove()},i.prototype.appendTo=function(e){return this.render(),$(e).append(this.el)},i.prototype.replace=function(e){return this.render(),$(e).replaceWith(this.el)},i.prototype.remove=function(){return this.uninstall(),$(this.el).delay(50).animate({opacity:0},200,"linear",function(e){return function(){return $(e.el).animate({height:0},Math.sqrt($(e.el).height())*50,"easeOutQuad",function(){return $(e.el).remove()})}}(this))},i.prototype.readOnly=function(){return this.model.has("id")},i.prototype.removable=function(){return this.readOnly()&&this.model.isEnabled()},i}(bcx.View)}.call(this),function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=bcx.collections.PeopleAndGroups,e=bcx.views.MemberField,bcx.views.MemberFieldList=function(i){function o(){return this.resetView=r(this.resetView,this),this.replaceView=r(this.replaceView,this),this.addView=r(this.addView,this),o.__super__.constructor.apply(this,arguments)}return s(o,i),o.prototype.firsthumanInput="[data-role~=human_input]:first",o.prototype.events={"focus div.field:last-child":"lastFieldFocused"},o.prototype.initialize=function(){return this.disabledIds=$(this.el).data("disabled-ids"),this.collection=new t($(this.el).data("people"),{disabledIds:this.disabledIds}),this.selection=new n([new this.collection.model,new this.collection.model,new this.collection.model]),this.selection.each(this.addView),this.selection.bind("add",this.addView),this.selection.bind("reset",this.resetView)},o.prototype.createView=function(t){var n,r;return n=e,r=new n({model:t,collection:this.collection,selection:this.selection}),r.bind("replace",this.replaceView)},o.prototype.addView=function(e){var t;return t=this.createView(e),t.appendTo(this.el)},o.prototype.replaceView=function(e,t){var n;return n=this.createView(t),n.replace(e.el),this.focusNextField(n.el)},o.prototype.resetView=function(){return $(this.el).html(""),this.selection.each(this.addView)},o.prototype.lastFieldFocused=function(e){if(this.$("div.blank.field").size()===1)return this.selection.add(new this.collection.model)},o.prototype.focusNextField=function(e){return $(e).next("div.field").find(this.firsthumanInput).focus()},o.prototype.focus=function(){return this.$(this.firsthumanInput).focus()},o.prototype.reset=function(){return this.selection.reset([new this.collection.model,new this.collection.model,new this.collection.model])},o.prototype.reload=function(){return this.collection=new t($(this.el).data("people"),{disabledIds:this.disabledIds}),this.reset()},o}(bcx.View),n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return s(t,e),t.prototype.add=function(e,n){var r,i,s,o;n==null&&(n={}),_.isArray(e)||(e=[e]);for(s=0,o=e.length;s<o;s++)i=e[s],(r=this.get(i.cid))&&this.remove(r,n);return t.__super__.add.call(this,e,n)},t.prototype.replace=function(e,t){return this.remove(t),this.remove(e,{silent:!0}),this.add(t,{silent:!0}),t.isGroup()&&this.add(t.members().enabled(),{silent:!0}),e.trigger("replace",t),this.trigger("replace",e,t)},t}(Backbone.Collection)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.viewName("project_dates"),t.prototype.numberOfDays=2,t.prototype.initialize=function(){return this.today=CalendarDate.today(),t.__super__.initialize.apply(this,arguments)},t.prototype.render=function(){return t.__super__.render.apply(this,arguments),this.updateSheetMargin()},t.prototype.updateSheetMargin=function(){var e;return e=$("div.project > div.sheet_body"),e.toggleClass("has_upcoming_events",this.itemGroups.length>0)},t.prototype.filteredCalendarEvents=function(){var e;return e=t.__super__.filteredCalendarEvents.apply(this,arguments),this.isTemplate?e:_(e).select(function(e){return function(t){return!t.isPast()&&t.doesOccurOnOrAfter
(e.today)}}(this))},t.prototype.bucketTodos=function(){return[]},t.prototype.itemsGroupedByDate=function(){var e;return e=t.__super__.itemsGroupedByDate.apply(this,arguments),this.isTemplate||(e=_(e).reject(function(e){return e.date.isPast()})),_(e).first(this.numberOfDays)},t.prototype.dateLabelFor=function(e){return e.value===this.today.value?"Today":e.occursThisYear()?""+e.getMonthName()+" "+e.day:""+e.getMonthName()+" "+e.day+", "+e.year},t.prototype.untilDateFor=function(e){return e.isSpanned()&&this.isTemplate?"(until "+e.relativeDateLabelFor("end")+")":e.isSpanned()&&e.getEndDate().isFuture()?"(until "+this.dateLabelFor(e.getEndDate())+")":""},t}(bcx.views.AgendaView)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.viewName("project_editor"),t.include(bcx.views.Popover),t.recordName("project"),t.prototype.events={"submit form":"submitForm","click [data-behavior~=cancel]":"cancel"},t.prototype.initialize=function(){return this.project=new bcx.models.Project},t.prototype.submitForm=function(){return this.$("form").addClass("busy"),this.project.save(this.getProjectAttributes(),{success:function(e){return function(){return e.hide()}}(this),error:function(){return console.warn("failure!")}}),!1},t.prototype.getProjectAttributes=function(){return{color:this.$("[name=color]:checked").val()}},t.prototype.cancel=function(){return this.hide()},t.prototype.afterHide=function(e){if(!e)return $(this.el).trigger("project_editor:hide")},t}(bcx.Autoview)}.call(this),function(){var e,t,n,r,i,s,o,u,a=function(e,t){return function(){return e.apply(t,arguments)}},f={}.hasOwnProperty,l=function(e,t){function r(){this.constructor=e}for(var n in t)f.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};u=function(){function e(e){this.project=e,this.scrollTo=a(this.scrollTo,this),this.selector="section[data-collection-name="+this.name+"]",this.counter==null&&(this.counter=""+this.name+"_count")}return e.prototype.url=function(e){return e==null&&(e=""),""+this.project.url()+"/"+this.name+e},e.prototype.count=function(){return this.project.get(this.counter)},e.prototype.pluralizedCount=function(){var e;switch(e=this.count()){case 0:return""+this.title+"s";case 1:return"1 "+this.title;default:return""+e+" "+this.title+"s"}},e.prototype.isInProject=function(){return this.project.get(""+this.name+"_count")!==0},e.prototype.isNotInProject=function(){return this.project.get(""+this.name+"_count")===0},e.prototype.scrollTo=function(){return $.scrollTo(this.selector,500,{offset:-40})},e.prototype.open=function(){return Stacker.workspace.visit(this.url())},e.prototype.create=function(){return $(""+this.selector+" > article.new").expand(),setTimeout(this.scrollTo,10)},e}(),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.name="topics",t.prototype.title="Discussion",t.prototype.pitch="Discussion",t.prototype.create=function(){return Stacker.workspace.visit(""+this.project.url()+"/messages/new")},t}(u),r=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.name="attachments",t.prototype.title="File",t.prototype.pitch="File",t}(u),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.name="todolists",t.prototype.title="To-do",t.prototype.pitch="To-do list",t.prototype.counter="remaining_todos_count",t.prototype.pluralizedCount=function(){var e;switch(e=this.count()){case 0:switch(e=this.project.get("completed_todos_count")){case 0:return""+this.title+"s";case 1:return"1 completed to-do";default:return""+e+" completed to-dos"}break;case 1:return"1 "+this.title;default:return""+e+" "+this.title+"s"}},t}(u),n=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.name="documents",t.prototype.title="Text document",t.prototype.pitch="Text document",t.prototype.create=function(){return Stacker.workspace.visit(""+this.url()+"/new")},t}(u),i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.name="forwards",t.prototype.title="Forwarded email",t.prototype.pitch="Forwarded email",t.prototype.isNotInProject=function(){return!1},t}(u),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return l(t,e),t.prototype.name="calendar_events",t.prototype.title="Event",t.prototype.pitch="Event",t.prototype.pluralizedCount=function(){return"Events"},t.prototype.isInProject=function(){return t.__super__.isInProject.apply(this,arguments)||this.project.get("completed_todos_count")!==0||this.project.get("remaining_todos_count")!==0},t.prototype.isNotInProject=function(){return!this.isInProject()},t.prototype.url=function(){return this.project.calendarUrl()},t.prototype.create=function(){return Stacker.workspace.visit(this.url()+"#create")},t}(u),s=function(s){function u(){return this.toolLinkClicked=a(this.toolLinkClicked,this),u.__super__.constructor.apply(this,arguments)}return l(u,s),u.viewName("project_toolbar"),u.tools=[t,o,r,n,i,e],u.prototype.events={"click a[data-tool-name]":"toolLinkClicked"},u.prototype.initialize=function(){var e;return this.project=bcx.projects.get(this.identifier),this.project.bind("change",this.render),this.tools=function(){var t,n,r,i;r=this.constructor.tools,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(new e(this.project));return i}.call(this)},u.prototype.toolLinkClicked=function(e){var t,n,r;if(!Stacker.isStandardClick(e))return;return t=$(e.currentTarget),n=t.data("tool-name"),r=this.findTool(n),r.isInProject()?e.shiftKey?r.scrollTo():r.open():r.create(),!1},u.prototype.findTool=function(e){return _.detect(this.tools,function(t){return t.name===e})},u.prototype.visibleToolsInProject=function(){return _.select(this.tools,function(e){return e.isInProject()})},u.prototype.visibleToolsNotInProject=function(){return _.select(this.tools,function(e){return e.isNotInProject()})},u}(bcx.Autoview)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.views.RelativeDatePicker=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template="desktop/templates/relative_date_picker",n.prototype.events={"mousedown a[data-wday]":"onDaySelect","mousedown a[data-behavior~=toggle_week]":"startAutoToggleWeek","mouseout a[data-behavior~=toggle_week]":"stopAutoToggleWeek","mouseup a[data-behavior~=toggle_week]":"stopAutoToggleWeek"},n.prototype.initialize=function(e){return this.options=e,this.due_week=this.options.due_week,this.due_week=this.due_week===""?0:parseInt(this.due_week),this.current_week=this.due_week,this.due_wday=parseInt(this.options.due_wday)},n.prototype.render=function(){return $(this.el).html(JST[this.template](this))},n.prototype.onDaySelect=function(e){return e.preventDefault(),e.stopPropagation(),this.due_wday=parseInt($(e.target).data("wday")),this.due_week=this.current_week,this.options.onDatePick&&this.options.onDatePick(this.current_week,this.due_wday),this.blurDayField()},n.prototype.setWeekAndDay=function(e,t){this.current_week=e,this.due_week=this.current_week,this.due_wday=t;if(this.options.onDatePick)return this.options.onDatePick(this.current_week,this.due_wday)},n.prototype.startAutoToggleWeek=function(e){var t;return e.preventDefault(),e.stopPropagation(),$(e.target).hasBehavior("next")&&(t="next"),this.toggleWeek(t),this.auto_toggle_timer=setTimeout(function(e){return function(){return e.auto_toggle_interval=setInterval(function(){return e.toggleWeek(t)},100)}}(this),500)},n.prototype.stopAutoToggleWeek=function(){return clearTimeout(this.auto_toggle_timer),clearInterval(this.auto_toggle_interval)},n.prototype.toggleWeek=function(e){return e==="next"?this.nextWeek():this.previousWeek()},n.prototype.nextWeek=function(){return this.current_week+=1,this.render(),this.blurDayField()},n.prototype.previousWeek=function(){return this.current_week>0&&(this.current_week-=1),this.render(),this.blurDayField()},n.prototype.blurDayField=function(){return setTimeout(function(){return $("input[data-relative-date]").blur()},10)},n}(bcx.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.viewName("single_calendar_display"),t.prototype.updateBlankSlate=function(){},t}(bcx.views.CalendarDisplayView)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=bcx.collections.PeopleAndGroups,bcx.views.SubscriberList=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return n(i,t),i.prototype.template="desktop/templates/subscribers",i.prototype.events={"change input:checkbox":"subscriberChanged","click [data-behavior~=subscriber_select_all]":"selectAll","click [data-behavior~=subscriber_select_none]":"selectNone","click [data-behavior~=subscriber_select_remembered]":"selectRemembered","click [data-group-id]":"toggleGroup"},i.prototype.initialize=function(){return this.project=bcx.currentProject,this.people=new e($(this.el).data("people")),this.currentPerson=this.people.get("person_"+bcx.currentPerson.id),this.people.remove(this.currentPerson),this.is_private=$(this.el).data("private"),this.client_ids=$(this.el).data("client-ids"),this.showCurrentPerson=$(this.el).data("keep-current-person"),this.subscribable=$(this.el).data("subscribable"),this.is_subscribable_new=$(this.el).data("new-subscribable"),this.subscriberIds=this.initialSubscriberIds(),this.groups=new e($(this.el).data("groups")),this.cleanupGroups(),this.teamPeople=new e(this.people.select(function(e){return function(t){var n;return n=t.id,r.call(e.client_ids,n)<0}}(this))),this.teamGroups=new e(this.groups.select(function(e){return function(t){return _(t.get("member_ids")).without(e.client_ids).length}}(this))),this.cleanupTeamGroups(),this.adjustPrivacyToggleVisibility(),this.adjustSubscriberListVisibilty(this.people.length)},i.prototype.render=function(){return $(this.el).html(JST[this.template](this)),this.initialSelection(),this.toggleGroupActivation(),$(document).trigger("subscriber_list:render")},i.prototype.privatize=function(){return this.is_private=!0,this.render(),this.adjustSubscriberListVisibilty(this.teamPeople.length)},i.prototype.publicize=function(){return this.is_private=!1,this.render(),this.adjustSubscriberListVisibilty(this.people.length)},i.prototype.activePeople=function(){return this.is_private?this.teamPeople:this.people},i.prototype.activeGroups=function(){return this.is_private?this.teamGroups:this.groups},i.prototype.initialSubscriberIds=function(){return this.is_subscribable_new&&this.subscribable!=="comment"?this.getSubscribersForNewSubscribables():$(this.el).data("subscriber-ids")},i.prototype.subscriberChanged=function(e){return this.selectGroupsForSubscriberId(parseInt($(e.currentTarget).val())),this.setSubscribersForNewSubscribables()},i.prototype.setSubscribersForNewSubscribables=function(){if(this.is_subscribable_new)return bcx.storage.set("initialSubscribers:"+bcx.currentProject.id,this.selectedSubscriberIds())},i.prototype.getSubscribersForNewSubscribables=function(){var e;return(e=bcx.storage.get("initialSubscribers:"+bcx.currentProject.id))!=null?e:[]},i.prototype.selectedSubscriberIds=function(){return $(this.el).find(":checkbox:checked").map(function(){return parseInt(this.value)}).toArray()},i.prototype.initialSelection=function(){return this.subscriberIds.length?this.selectRemembered():this.subscribable==="message"?this.selectAll():this.selectNone()},i.prototype.selectAll=function(){return $(this.el).find(":checkbox").prop("checked",!0),$(this.el).find("[data-group-id]").toggleClass("activated",!0),!1},i.prototype.selectNone=function(){return $(this.el).find(":checkbox").prop("checked",!1),$(this.el).find("[data-group-id]").toggleClass("activated",!1),!1},i.prototype.selectRemembered=function(){return this.selectNone(),$(this.el).find(":checkbox").each(function(e){return function(t,n){var i;i=parseInt(n.value);if(r.call(e.subscriberIds,i)>=0)return $(n).prop("checked",!0),e.selectGroupsForSubscriberId(i)}}(this)),!1},i.prototype.selectGroupsForSubscriberId=function(e){return this.groups.each(function(t){return function(n){if(r.call(t.groupMemberIds(n),e)>=0)return $(t.el).find("[data-group-id~="+n.id+"]").toggleClass("activated",t.areAllGroupMembersChecked(n))}}(this))},i.prototype.toggleGroup=function(e){var t,n,i;return e.preventDefault(),t=$(e.currentTarget),t.toggleClass("activated"),$(this.el).find("[data-parent-group-id="+t.data("group-id")+"]").toggleClass("activated",t.hasClass("activated")),i=t.data("member-ids"),n=$(this.el).find(":checkbox").filter(function(){var e;return e=parseInt(this.value),r.call(i,e)>=0}),n.prop("checked",t.hasClass("activated")),t.hasClass("activated")||this.selectActiveGroupMembers(),this.setSubscribersForNewSubscribables()},i.prototype.groupMemberIds=function(e){var t,n,r;return this.groupMembers==null&&(this.groupMembers={}),(n=this.groupMembers)[r=e.id]!=null?n[r]:n[r]=_.map(_.compact(function(){var n,r,i,s;i=e.get("member_ids"),s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this.people.get(t));return s}.call(this)),function(e){return e.get("person_id")})},i.prototype.teamGroupMemberIds=function(e){var t,n,r;return this.teamGroupMembers==null&&(this.teamGroupMembers={}),(n=this.teamGroupMembers)[r=e.id]!=null?n[r]:n[r]=_.map(_.compact(function(){var n,r,i,s;i=e.get("member_ids"),s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this.teamPeople.get(t));return s}.call(this)),function(e){return e.get("person_id")})},i.prototype.toggleGroupActivation=function(){return this.groups.each(function(e){return function(t){return $(e.el).find("[data-group-id~="+t.id+"]").toggleClass("activated",e.areAllGroupMembersChecked(t))}}(this))},i.prototype.areAllGroupMembersChecked=function(e){var t;return t=$(this.el).find(":checkbox:checked").map(function(){return parseInt(this.value)}).get(),_.all(this.groupMemberIds(e),function(e){return _.include(t,e)})},i.prototype.selectActiveGroupMembers=function(){var e;return e=$(this.el).find(":checkbox"),$(this.el).find("a.activated[data-group-id]").each(function(){var t,n;return n=$(this).data("member-ids"),t=e.filter(function(){var e;return e=parseInt(this.value),r.call(n,e)>=0}),t.prop("checked",!0)})},i.prototype.cleanupGroups=function(){var e;return e=this.groups.filter(function(e){return function(t){var n;return n=e.groupMemberIds(t),n.length===0||t.isSubgroup()&&n.length>=e.people.length}}(this)),this.groups.remove(e)},i.prototype.cleanupTeamGroups=function(){var e;return e=this.teamGroups.filter(function(e){return function(t){var n;return n=e.teamGroupMemberIds(t),n.length===0||t.isSubgroup()&&n.length>=e.teamPeople.length}}(this)),this.teamGroups.remove(e)},i.prototype.adjustPrivacyToggleVisibility=function(){var e,t;return bcx.currentAccount.allowClientProjects()&&this.project.isClientProject()&&!_(this.client_ids).include(this.currentPerson.id)?(e=this.people.select(function(e){return function(t){var n;return n=t.id,r.call(e.client_ids,n)>=0}}(this)),e.length&&(t=e.map(function(e){return e.get("name")}).sort().join(", ").replace(/,\s([^,]+)$/," and $1"),$("span[data-behavior~=client_list]").html("("+t+")")),$("[data-role~=privacy_toggle]").show()):$("[data-role~=privacy_toggle]").hide()},i.prototype.adjustSubscriberListVisibilty=function(e){return $("[data-behavior~=subscriber_list]").toggle(e>0),$("[data-behavior~=no_subscribers]").toggle(e<1)},i}(bcx.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};bcx.views.TaggingsView=function(e){function n(e,t){this.el=e,n.__super__.constructor.call(this,t)}return t(n,e),n.prototype.events={"click [data-behavior~=remove_tagging]":"removeTagging"},n.prototype.initialize=function(){return this.setTaggableTypeAndId(),this.installAddTaggingsView(),this.refresh(),$(this.el).addClass("editing")},n.prototype.setTaggableTypeAndId=function(){return this.taggableType=$(this.el).data("taggable-type"),this.taggableId=$(this.el).data("taggable-id")},n.prototype.installAddTaggingsView=function(){var e,t,n;return n=""+this.taggableType+":"+this.taggableId,e=$(this.el).find("[data-behavior~=edit_taggings]"),t=$("<div>").appendTo(e),this.addTaggingsView=bcx.views.AddTaggingView.findOrCreate(n),this.addTaggingsView.taggingsView=this,this.addTaggingsView.install(t.get(0))},n.prototype.refresh=function(){return this.existingTaggings=this.findExistingTaggings(),this.existingTagNames=this.findExistingTagNames(),this.addTaggingsView.afterRefresh()},n.prototype.unregister=function(){return this.addTaggingsView.unregister(),$(this.el).removeClass("editing")},n.prototype.findExistingTaggings=function(){var e,t,n,r,i,s;t=$(this.el).find("> ul li"),s=[];for(r=0,i=t.length;r<i;r++){n=t[r],e=$(n);if(e.data("deleted"))continue;s.push({name:e.find("[data-role=tag_name]").text().trim(),url:e.data("url")})}return s},n.prototype.findExistingTagNames=function(){return _(this.findExistingTaggings()).pluck("name")},n.prototype.removeTagging=function(e){var t,n;return t=$(e.currentTarget).closest("li"),n=t.data("url"),t.trigger("tagging:remove",[n,this]),!1},n}(bcx.View)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this.onDocumentMouseDown=t(this.onDocumentMouseDown,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.templatePrefix="templates/calendar_event_editor/",n.viewName("template_calendar_event_editor"),n.include(bcx.views.Autoresize),n.prototype.className="expanded_content bubble",n.prototype.initialize=function(){var e;return n.__super__.initialize.apply(this,arguments),e=this.identifier.split("-")[0].split(":"),this.bucketType=e[0],this.bucketId=e[1],this.events=_.extend({},this.events,{"focus [data-behavior~=date_entry]":"showRelativeDatePicker","date_picker:hidden [data-behavior~=date_entry]":"uninstallEventListener"}),this.delegateEvents()},n.prototype.renderWithCalendarEvent=function(e){return this.calendarEvent=e,this.render(),this.setupPlaceholder(),this.autofocus()},n.prototype.autofocus=function(){return _.defer(function(e){return function(){return e.$(":input[name=summary]").focus().get(0).select()}}(this))},n.prototype.setupPlaceholder=function(){return $(this.el).find("[data-behavior~=placeholder]").placeholder()},n.prototype.hide=function(){return $(this.el).collapse(),$(document).trigger("client_projects:done_editing")},n.prototype.installDateEntryBehavior=function(e){var t,n,r;return t=$(e),n=t.find("[data-behavior~=relative_date_picker]"),r=new bcx.views.RelativeDatePicker({el:n,due_week:t.find("input[data-due-week]").val(),due_wday:t.find("input[data-due-wday]").val(),onDatePick:function(e){return function(r,i){return t.find("input[data-due-week]").val(r),t.find("input[data-due-wday]").val(i),t.find("input[data-relative-date]").val("Week "+(r+1)+", "+CalendarDate.weekdayNames[i]),e.ensureMinimumSpannedEndsAtDate(),n.hide(),n.trigger("date_picker:hidden")}}(this)}),n.data("view",r)},n.prototype.installEventListener=function(){return"undefined"!=typeof document.attachEvent?document.attachEvent("mousedown",this.onDocumentMouseDown):document.addEventListener("mousedown",this.onDocumentMouseDown,!0)},n.prototype.uninstallEventListener=function(){return"undefined"!=typeof document.detachEvent?document.detachEvent("mousedown",this.onDocumentMouseDown):document.removeEventListener("mousedown",this.onDocumentMouseDown,!0)},n.prototype.onDocumentMouseDown=function(e){var t,n,r,i;n=$("[data-behavior~=date_entry]");if(!n.length)return;return t=$(e.target).closest("[data-behavior~=date_entry]"),r=t.length?(i=t.siblings("[data-behavior~=date_entry]"),i.find("[data-behavior~=relative_date_picker]")):$("[data-behavior~=date_entry] > [data-behavior~=relative_date_picker]"),r.trigger("date_picker:hidden"),r.hide()},n.prototype.showRelativeDatePicker=function(e){var t,n,r;t=$(e.currentTarget),n=t.find("[data-behavior~=relative_date_picker]");if(r=n.data("view"))return r.render(),this.installEventListener(),n.show()},n.prototype.isEditorForTemplate=function(){return!0},n.prototype.currentPersonCanChangeBucket=function(){return!1},n.prototype.ensureMinimumSpannedEndsAtDate=function(){var e,t,n,r,i,s;s=this.$("[data-input~=starts_at]").data("view"),n=this.$("[data-input~=ends_at]").data("view"),i=s.current_week,t=n.current_week,r=s.due_wday,e=n.due_wday;if(t<i||t===i&&e<r)return n.setWeekAndDay(i,r)},n.prototype.updateCalendarEventAttributes=function(){var e,t,r,i,s,o,u;n.__super__.updateCalendarEventAttributes.apply(this,arguments),$(":input[name='calendar_event[subscribers][]'][type~=hidden]"),s=function(){var e,t,n,r;n=this.$(":input[name='calendar_event[subscribers][]']:checked"),r=[];for(e=0,t=n.length;e<t;e++)i=n[e],r.push(i.value);return r}.call(this),t=this.$(":input[name='calendar_event[subscribers][]'][type~=hidden]:not([disabled])");for(o=0,u=t.length;o<u;o++)e=t[o],s.push(e.value);return this.calendarEvent.set({subscribers:s}),r=function(){var e,t,n,r;n=this.$(":input[name='calendar_event[new_subscriber_emails][]']"),r=[];for(e=0,t=n.length;e<t;e++)i=n[e],r.push(i.value);return r}.call(this),this.calendarEvent.set({new_subscriber_emails:_(r).compact()}),this.calendarEvent.set({starts_at_due_week:this.field("starts_at_due_week"),starts_at_due_wday:this.field("starts_at_due_wday"),ends_at_due_week:this.field("ends_at_due_week"),ends_at_due_wday:this.field("ends_at_due_wday")})},n.prototype.subscribersPath=function(){var e;return e="/"+this.bucketType.toLowerCase()+"s/"+this.bucketId+"/subscribers?subscribable_type=CalendarEvent",this.calendarEvent.isNew()||(e=""+e+"&subscribable_id="+this.calendarEvent.id),e},n.prototype.selectedBucket=function(){return this.calendarEvent.isNew()?n.__super__.selectedBucket.apply(this,arguments):this.calendarEvent.bucket()},n.prototype.calendarEventRecurrenceRequestSucceeded=function(){return Stacker.workspace.visit(this.calendarEvent.url(),{replaceSheet:!0})},n}(bcx.AbstractCalendarEventEditor)}.call(this),function(){var e;$(document).on("click","[data-behavior~=attachment_export]",function(t){return $(this).parent().addClass("processing"),t.preventDefault(),t.stopImmediatePropagation(),$.ajax({url:$(this).attr("href"),type:"POST",success:function(t){var n;return n=new BackgroundOperationProcessor(new bcx.AttachmentExport(t)),n.on("processor:failed",function(t){return function(){return e()}}(this)),n.startWatchingOperation()},error:function(){return e()}})}),e=function(){return alert("Sorry, something went wrong. Please contact our support team at support@basecamp.com.")}}.call(this),function(){$(document).on("page:change",function(){return $("[data-behavior~=bucket_operation_tool]").each(function(){return new bcx.views.BucketOperationToolView({el:this})})})}.call(this),function(){$("a[data-role~=cancel]").live("click",function(e){return $(this).closest("[data-behavior~=expandable]").collapse(),e.preventDefault()})}.call(this),function(){var e,t;e="form[data-behavior~=confirm]",$(""+e+" a[data-behavior~=start]").live("click",function(n){var r;return r=$(this).closest(e),t("confirm",r),r.find("input[type=submit]").focus()}),$(""+e+" a[data-behavior~=stop]").live("click",function(n){var r;return r=$(this).closest(e),t("intro",r)}),$(e).live("ajax:before",function(e){var n;return n=$(this),t("request",n)}),t=function(e,t){return t.find("> div:visible").hide(),t.find("> div."+e).show()}}.call(this),function(){$.datepicker.setDefaults({dateFormat:"d M, yy",dayNamesMin:["S","M","T","W","T","F","S"],changeMonth:!1,changeYear:!1,gotoCurrent:!0,prevText:"Previous",selectOtherMonths:!0,showOtherMonths:!0}),$("[data-behavior~=date_picker]").live("focus",function(){return $(this).datepicker}),$("table.ui-datepicker-calendar td a.ui-state-default").live("click",function(e){return e.stopImmediatePropagation()})}.call(this),function(){bcx.on("page:update","install dirty-tracking behavior",function(){return $("[data-behavior~=dirty_tracking]").install("tracking of original value",function(e){return e.each(function(){var e;return e=$(this),e.data("originalValue",e.val())})})}),$("[data-behavior~=dirty_tracking]").live("change keyup paste",_.debounce(function(e){var t,n;t=$(e.currentTarget),n=t.val()!==t.data("originalValue");if(t.attr("data-dirty")){if(!n)return t.removeAttr("data-dirty")}else if(n)return t.attr("data-dirty",!0)},350)),$("form").live("submit reset",function(e){return setTimeout(function(){if(!e.isDefaultPrevented())return $(e.currentTarget).find("[data-behavior~=dirty_tracking]").removeAttr("data-dirty")},10)}),$.fn.isDirty=function(){return $(this).find("[data-dirty]").length>0}}.call(this),function(){var e,t,n,r,i,s,o,u,a,f;u="html > .drag_hover_highlight",a=function(){return $(u).show()},i=function(){return $(u).hide()},f=8,t=$("<div class=drag_hover_highlight>").css({height:f+"px"}),n=$("<div class=drag_hover_highlight>").css({height:f+"px"}),r=$("<div class=drag_hover_highlight>").css({width:f+"px"}),e=$("<div class=drag_hover_highlight>").css({width:f+"px"}),o=function(i){var s,o,u,a,l,c,h,p,d,v,m,g,y,b,w;return w=i.offset(),h=w.left,d=w.top,b=i.outerWidth(),o=i.outerHeight(),p=h+b,s=d+o,g=$(window).scrollTop(),m=$(window).scrollLeft(),y=$(window).width(),v=$(window).height(),c=Math.max(0,d-g-f),a=Math.max(0,h-m-f),l=Math.min(y-f,p-m),u=Math.min(v-f,s-g),t.css({width:b+f+"px",left:a+"px",top:c+"px"}),n.css({width:b+2*f+"px",left:a+"px",top:u+"px"}),r.css({height:o+f+"px",left:a+"px",top:c+"px"}),e.css({height:o+f+"px",left:l+"px",top:c+"px"})},$(document).ready(function(){return $("html").append(t,n,r,e),$(u).bind("mouseover",i),i()}),s=null,$(document).bind("file:dragenter",function(e){s=$(e.target).dispatch("file:draghighlight"),$(e.target).addClass("drag_hover");if(!s.isDefaultPrevented())return o($(e.target)),a()}),$(document).bind("file:dragleave",function(e){return i(),setTimeout(function(){return $(e.target).removeClass("drag_hover")},5)}),$(document).bind("file:drop",function(e){return $(e.target).removeClass("drag_hover")})}.call(this),function(){$("a[data-behavior~=edit_identity]").live("click",function(e){return e.preventDefault(),window.location=$(this).attr("href")+("?origin="+encodeURIComponent(window.location))})}.call(this),function(){$(document).on("keypress",":input[data-behavior~=prevent_enter]",function(e){if(e.keyCode===$.ui.keyCode.ENTER)return e.preventDefault()}),$(document).on("keypress",":input[data-behavior~=tab_on_enter]",function(e){var t;if(e.keyCode===$.ui.keyCode.ENTER)return t=$(this).closest("form").find(":focusable"),t.eq(t.index(this)+1).focus()})}.call(this),function(){$("[data-behavior~=expand_on_check]").live("click",function(e){return $(this).find(":checked").length?$(this).closest("[data-behavior~=expandable]").expand():$(this).closest("[data-behavior~=expandable]").collapse()}),$("[data-behavior~=collapse_on_check]").live("click",function(e){return $(this).find(":checked").length?$(this).closest("[data-behavior~=expandable]").collapse():$(this).closest("[data-behavior~=expandable]").expand()})}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c;l="[data-behavior~=expandable]",o="[data-behavior~=expand_exclusively]",a=""+l+" [data-behavior~=expand_on_click]",n=""+l+" [data-behavior~=collapse_on_click]",e=""+l+"[data-behavior~=collapse_on_clickoutside]",u=function(e){return $(this).expand()||$(this).collapse(),e.preventDefault()},t=function(e){return $(this).collapse(),e.preventDefault()},$.support.touch&&($(a).live("touchstart",u),$(n).live("touchstart",t)),$(a).live("mousedown",function(e){return u.call(this,e),e.preventDefault()}),$(a).live("click",function(e){return e.preventDefault()}),$(n).live("click",function(e){return t.call(this,e),e.preventDefault()}),$(e).live("beforeexpand",function(){return $(this).bind("clickoutside.outside",function(){return $(this).collapse()})}).live("beforecollapse",function(){return $(this).unbind(".outside")}),r="exclusively_expanded",s=null,i=null,$(o).live("beforeexpand",function(e){var t,n;return n=$(this).get(0),s&&s!==n&&$(s).removeClass(r).collapse(),$(n).addClass(r),s=n,t=f,$(document).bind("click.exclusiveExpandable",function(e){if(t===f)return;if(!$(e.target).closest(s).length)return $(s).collapse()})}),f=0,window.addEventListener("mousedown",function(){return f++},!0),$(o).live("beforecollapse",function(){return $(document).unbind(".exclusiveExpandable"),s=null}),$("div.sheet").live("beforeSheetSave",function(){return $(""+l+".expanded").collapse()}),c=function(e,t){var n;return n=e.dispatch(t),!n.isDefaultPrevented()},$.fn.expandable=function(){return $(this).closest(l)},$.fn.expand=function(){var e;return e=$(this).expandable(),e.is(":not(.expanded)")&&c(e,"beforeexpand")&&(e.addClass("expanded"),e.trigger("expand")),e},$.fn.collapse=function(){var e;return e=$(this).expandable(),e.is(".expanded")&&c(e,"beforecollapse")&&(e.removeClass("expanded"),e.trigger("collapse")),e}}.call(this),function(){var e;e=70,$("span.pill[data-behavior~=expandable]:has(.balloon)").live("expand",function(t){var n,r,i,s,o;n=$(t.target).find(".balloon"),n.data("original-class")&&(n.removeClass("left_side right_side").addClass(n.data("original-class")),n.data("original-class",null)),n.data("moved-up")&&(n.css({marginTop:0}),n.find(".arrow").css({marginTop:0}),n.data("moved-up",!1)),r=n.offset().top+n.outerHeight()-($(window).height()+$(window).scrollTop()),o=n.offset().top-$(window).scrollTop()-n.outerHeight()+e,r>20&&o>0&&(s=n.outerHeight()-e,n.css({marginTop:"-"+s+"px"}),n.find(".arrow").css({marginTop:s}),n.data("moved-up",!0));if(n.hasClass("right_side")){i=n.offset().left+n.outerWidth()-($(window).width()+$(window).scrollLeft());if(i>0)return n.removeClass("right_side").addClass("left_side"),n.data("original-class","right_side")}else if(n.hasClass("left_side")&&n.offset().left<0)return n.removeClass("left_side").addClass("right_side"),n.data("original-class","left_side")})}.call(this),function(){bcx.Busy=function(){function e(e){this.form=$(e)}return e.prototype.start=function(){return this.form.addClass("busy")},e.prototype.stop=function(){return this.form.removeClass("busy")},e.prototype.end=function(){return this.stop().resetForm()},e}(),$("form:not([data-skip_busy])").live("ajax:beforeSend",function(e){return $(this).hasClass("busy")?!1:(new bcx.Busy(this)).start()}),$("form:not([data-skip_busy])").live("ajax:error",function(e){return(new bcx.Busy(this)).stop(),alert("Sorry, something went wrong. Please try again.")}),$("form:not([data-skip_busy]):not([data-behavior~=no_reset])").live("ajax:success",function(e){return(new bcx.Busy(this)).end()}),$(document).ready(function(){return $("article.edit a.cancel, li.edit_mode a.cancel, div.edit_links a, div.nubbin a").live("click",function(){return(new bcx.Busy($(this).parent())).start()})}),bcx.on("page:update","stop form-busy animation",function(){return(new bcx.Busy($(".busy:not([data-skip_busy])"))).stop()})}.call(this),function(){$("[data-behavior~=hide_buttons_on_expand]").live("expand",function(e){if(e.target!==this)return;return $(this).parents().find(".has_buttons").first().addClass("hide_buttons")}).live("collapse",function(e){if(e.target!==this)return;return $(this).parents().find(".has_buttons").first().removeClass("hide_buttons")})}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;f=null,t=null,a=null,u=!1,o="g",c=function(){return f=n("a[data-hotkey]"),t=n("input[data-hotkey]")},bcx.on("page:update","find hotkey elements",c),$(function(){return setTimeout(c,100)}),$(window).bind("keypress",function(e){if(e.altKey||e.ctrlKey||e.metaKey
)return;return s(e)}),$(window).bind("keydown",function(e){if(e.keyCode!==$.ui.keyCode.ESCAPE)return;if(e.isDefaultPrevented())return;return i(e)}),h=function(e){return e==null&&(e=!1),u=e},i=function(e){var t,n,r,i,s,o;s=$(e.target).filter(":focus");if(s.is("input[data-hotkey]"))s.blur();else if((n=(t=s.closest("article")).find("a[data-role~=cancel]")).length){if(t.isDirty())return!1;n.click()}else if((i=s.closest("[data-behavior~=expandable]:not([data-behavior~=ignore_collapse_hotkey]).expanded")).length){if(i.isDirty())return!1;i.collapse()}else if((i=$("[data-behavior~=expandable]:not([data-behavior~=ignore_collapse_hotkey]).expanded")).length){if(i.isDirty())return!1;i.collapse()}else(n=(r=$("[data-behavior~=new_project_dialog]:visible")).find("a[data-role~=cancel]")).length&&n.click();return(o=s.get(0))!=null&&o.blur(),!1},s=function(n){var i,s,a,c;if($(n.target).closest("input, select, textarea, [contenteditable]").length)return;a=n.charCode,26>=a&&a>=1&&(a+=96),c=String.fromCharCode(a);if(!u&&c!==o)return;c===o&&!u&&(h(!0),setTimeout(h,2e3));if(i=t[c])return l(i,r);if(s=f[c])return l(s,e)},n=function(e){var t;return t={},$(e).each(function(){var e,n;return e=$(this),n=e.data("hotkey"),t[n]=e}),t},l=function(t,n){var r,i;return h(),i=t.data("hotkey"),r=t.dispatch("hotkey"),r.isDefaultPrevented()?(a=null,!1):((a!=null?a.key:void 0)===i&&(a!=null?a.action:void 0)===e?(history.back(),a=null):($.scrollTo(t,{offset:-60,axis:"y",duration:100,onAfter:n}),a={key:i,action:n}),!1)},r=function(e){var t;return t=e.get(0),t.focus(),t.select()},e=function(e){return e.effect("pulsate",{times:3,duration:150}),e.click()}}.call(this),function(){var e,t,n,r,i;n="[data-behavior~=has_hover_content]",r="[data-behavior~=hover_content]:not(.expanded, .ignore_hover)",$.support.touch&&$(n).live("tap",function(){if($(this).find(r).filter(function(){return $(this).is(":hidden")||$(this).css("visibility")==="hidden"}).length)return event.preventDefault(),i(this,function(e){return $(e).addClass("popout")})}),$(n).live("mouseenter",function(){return i(this)}),$(n).live("mouseleave",function(){return t(this)}),i=function(t,n){return $(t).find(""+r+":not([data-hovercontent-strategy])").each(function(){if($(this).css("visibility")==="hidden")return $(this).attr("data-hovercontent-strategy","visibility")}),$(".hiding").each(function(){return e($(this),!1)}),$(t).find(r).each(function(){$(this).data("hovercontent-strategy")==="visibility"?($(this).css("visibility","visible"),$(this).addClass("showing")):($(this).hide(),$(this).show()),$(this).trigger("hovercontent:show");if(n)return n(this)})},e=function(e,t){return e.data("hovercontent-strategy")==="visibility"?t?(e.addClass("hiding"),setTimeout(function(t){return function(){return e.css("visibility","hidden"),e.removeClass("hiding"),e.removeClass("showing")}}(this),120)):(e.css("visibility","hidden"),e.removeClass("showing")):t?(e.addClass("hiding"),e.delay(100).fadeOut(100,function(){return $(this).removeClass("hiding")})):e.hide(),e.trigger("hovercontent:hide")},t=function(t,n){return n==null&&(n=!0),$(t).find(""+r+":visible").each(function(){var t;t=$(this);if(t.css("visibility")==="hidden")return;return e(t,n)})}}.call(this),function(){$("form[data-behavior~=member], form[data-behavior~=invite], form[data-behavior~=adhoc_subscriber_validation]").live("ajax:before",function(e){var t,n,r;t=$(this),n=t.find("div.field.invalid");if(n.size())return n.first().find("[data-role~=human_input]").focus(),!1;r=t.find("div.field.unknown");if(r.size())return r.first().find("[data-role~=human_input]").focus(),!1})}.call(this),function(){$("[data-behavior~=input_change_emitter]").live("focus",function(e){var t,n,r,i,s,o;return t=$(this),n=o=t.val(),i=function(){n=t.val();if(n!==o)return t.trigger("input:change",{currentValue:n,previousValue:o}),o=n},s=setInterval(i,50),r=function(){return clearInterval(s),t.unbind("blur",r)},t.bind("blur",r)})}.call(this),function(){$("div.current_user_links").find("a").live("click",function(){return $(this).closest("div.current_user_links").collapse()}),$("[data-behavior~=hover_global_nav]").live("mouseenter",function(e){return $(this).find("div.global_links").toggleClass("active")})}.call(this),function(){$("[data-behavior~=nubbin]").live("hovercontent:show",function(){return $(this).css({display:"inline-block",left:$(this).outerWidth()*-1})})}.call(this),function(){var e,t,n,r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};n=function(){return $(this).find("[data-behavior~=hide_on_expand]").hide().click().end().siblings("[data-behavior~=tool][data-behavior~=expandable]").collapse()},t=function(){return $(this).find("[data-behavior~=hide_on_expand]").show()},e=function(){return $(this).closest("[data-behavior~=tool]").addClass("busy")},$("[data-behavior~=perma_tools] [data-behavior~=tool][data-behavior~=expandable]").live("expand",n).live("collapse",t),$("[data-behavior~=perma_tools] [data-behavior~=tool_action]").live("click",e),$("[data-role~=just_copied] a[data-behavior~=close_copied_notice]").live("click",function(e){var t;return e.preventDefault(),t=$(this).closest("div.copied_notice"),t.closest("div.sheet").removeClass("copied"),t.closest("div.sheet").find("div.sheet_body").animate({opacity:1},"fast"),t.fadeOut("fast")}),bcx.permaTools={},bcx.permaTools.showLinkIfAccessible=function(e,t){return $.getJSON("/buckets.json",function(n){var i,s;i=e==="Project"?n.projects:n.calendars;if(s=parseInt(t),r.call(_(i).pluck("id"),s)>=0)return $("[data-behavior~=show_link_if_accessible]").show()})}}.call(this),function(){$(document).on("ajax:before",'[data-behavior~="require_input"]',function(e){var t;return t=!1,$(this).find("[data-role~=accept_as_input]").each(function(){if($(this).hasContent())return t=!0,!1}),t}),$.fn.hasContent=function(){return $(this).is("input, select, textarea")?$(this).val().trim().length:$(this).is("ul")?$(this).find("li").length:$(this).length}}.call(this),function(){var e;e=function(e){return $(e).is("body, #workspace, #workspace > div.container")},$("html").bind("mousedown",function(t){if(e(t.target))return t.preventDefault()}),$("html").bind("dblclick",function(t){var n;if(e(t.target)){n=parseInt(t.clientY/window.innerHeight*100);if(n<33)return $.scrollTo(0,300);if(n>66)return $.scrollTo("max",300)}})}.call(this),function(){var e,t;$.fn.slider=function(n){return n!=null?this.each(function(){var e;e=$(this);if(e.data("slider"))return t(e,n)}):this.each(function(){var t;t=$(this);if(!t.data("slider"))return e(t)})},$("[data-behavior~=slider] [data-behavior~=slide]").live("mousedown",function(e){var n,r,i;return i=$(this).closest("[data-slide-index]").data("slide-index"),n=$(this).closest("[data-behavior~=slider]"),r=$(this).data("direction"),r==="forward"?i++:i--,t(n,i),!1}),e=function(e){var t,n,r,i;return n=e.children(":first"),t=e.find("[data-slide-index]"),i=e.width(),r=t.length,n.width(""+100*r+"%"),t.width(i).first().addClass("active"),e.data("slider",!0)},t=function(e,t){var n,r,i,s,o,u,a;return s=e.children(":first"),i=s.find("[data-slide-index]"),r=i.filter("[data-slide-index].active"),a=r.data("slide-index"),o=t<a?"backward":"forward",u=-(t*s.parent().width()),n=i.filter("[data-slide-index="+t+"]"),e.css({overflow:"hidden"}),s.css({height:r.css("height")}),o==="backward"&&(r.css("margin-left",""),n.css("margin-left",-u)),n.addClass("active"),s.animate({height:n.css("height"),"margin-left":u},250,"easeOutExpo",function(){return r.removeClass("active"),r.css("margin-left",""),n.css("margin-left",-u),e.css({overflow:""}),s.css({height:""}),n.trigger("slider:slide")}),n.trigger("slider:beforeslide")}}.call(this),function(){var e,t,n,r,i,s,o,u,a,f;i="div.project[data-behavior~=read_only]",e="div.sheet:not(.inactive)",u="[data-behavior~=sortable_container]",a={defaults:{tolerance:"pointer",handle:"[data-behavior~=sortable_handle]",revert:200,distance:2},todo:{axis:"y",containment:e,connectWith:""+u+"[data-sortable-type=todo]"},todolist:{axis:"y",containment:e,opacity:.8}},s=function(e){var t,n,r;return n=e.data("sortable-type"),t=$.extend({},a.defaults,(r=a[n])!=null?r:{}),e.sortable(t)},document.addEventListener("mousedown",function(e){var t,n;n=$(e.target).closest(u);if(!n.length)return;t=n.closest(u),t.closest(i).length||s(t);if(e.ctrlKey&&e.button===0)return e.preventDefault(),e.stopPropagation()},!0),$("[data-behavior~=sortable_container]").live("sortstart",function(e,t){var n,r,i,o;return i=e.currentTarget,n=$(i),o=n.data("sortable-type"),r=$(""+u+"[data-sortable-type='"+o+"']"),r.each(function(){if(this!==i)return s($(this))}),n.sortable("refresh")}),o=!1,f=function(e){return setTimeout(function(){return o||e(),o=!1},1)},$(u).live("sortreceive",function(e,t){return o=!0,e.stopPropagation()}),$(u).live("sortupdate",function(e,t){return f(function(e){return function(){var e,n,i,s,o;return i=$(t.item.context),e=i.closest(u),n=e.closest("[data-behavior~=sortable]"),o=e.data("sortable-type"),s=r(e,i),i.trigger(""+o+":move",[s,n.get(0)])}}(this)),e.stopPropagation()}),r=function(e,t){var n,r,i,s;return n=null,i=t.get(0),s=e.data("sortable-type"),r="[data-behavior~=sortable][data-sortable-type='"+s+"']",e.find(r).each(function(e){if(this===i)return n=e+1}),n},$(u).live("sortstart",function(e,n){return t(n),e.stopPropagation()}),$(u).live("sortbeforestop",function(e,n){return t(n),e.stopPropagation()}),t=function(e){if($.browser.mozilla||$.browser.msie&&$.browser.version==="11.0")return n(e)},n=function(e){return e.item.data("margin-top-compensation")?(e.item.css("margin-top","-="+e.item.data("margin-top-compensation")),e.item.data("margin-top-compensation",null)):(e.item.data("margin-top-compensation",$(window).scrollTop()),e.item.css("margin-top","+="+e.item.data("margin-top-compensation")))}}.call(this),function(){var e;e="[data-behavior~=text_input_field]",$(e).live("focus",function(e){var t;return t=$(this),t.addClass("focused")}),$(e).live("blur",function(e){var t;return t=$(this),t.removeClass("focused")}),$(e).live("input:change blur",function(e){var t,n;return t=$(this),n=$(e.target),n.val().trim()===""?t.addClass("blank"):t.removeClass("blank")})}.call(this),function(){$("form:not(.submitting) textarea[data-behavior~=submit_on_enter]").live("keypress",function(e){if(e.keyCode===$.ui.keyCode.ENTER)return $(this).closest("form").addClass("submitting").submit(),e.preventDefault()}),$("form:not(.submitting) textarea[data-behavior~=submit_on_control_enter]").live("keydown",function(e){var t;if(e.keyCode===$.ui.keyCode.ENTER&&(e.ctrlKey||e.metaKey))return t=$(this).closest("form"),t.find("input[type=submit]").focus(),t.addClass("submitting").submit(),e.preventDefault()})}.call(this),function(){Mousetrap.bind("d o g c o w",function(){var e;return $("head").append("<link href='https://bcx.basecamp-static.com/assets/themes/themes-50b773b9a2ba0617aaa62d416f212cbb.css' media='all' rel='stylesheet' />"),e=new Audio("https://bcx.basecamp-static.com/assets/classicmac-097177a1864b38d536ec1ac0c1b6a283.mp3"),$("html").addClass("classicmac_fadein"),e.play(),setTimeout(function(e){return function(){return $("html").addClass("classicmac_startup")}}(this),800),setTimeout(function(e){return function(){return $("html").removeClass("classicmac_startup"),$("html").addClass("classicmac")}}(this),4e3)})}.call(this),function(){var e;e=function(e){return function(t){return e($data,$text,$entry)}},$("[data-behavior~=time_entry]").live("keypress",function(e){if(e.which===$.ui.keyCode.ENTER)return $(e.currentTarget).blur()}).live("blur",function(e){var t,n,r,i,s,o;n=$(e.currentTarget),t=n.find("input[type=hidden]"),r=n.find("input[type=text]");if(r.val()===r.data("placeholder"))return t.val("");try{return o=r.val(),o.length?(o.match(/noon/i)&&(o="12pm"),o.match(/midnight/i)&&(o="12am"),s=CalendarTime.parse(o),r.val(s.toFriendlyString()),t.val(s.toString())):t.val("")}catch(u){return i=u,r.val(""),t.val(""),r.addClass("shake"),r.onTransitionEnd(function(){return r.removeClass("shake")})}})}.call(this),function(){var e,t;bcx.on("page:update","set the index view to grid or list, defaulting to grid",function(){var n,r,i;n=$("[data-role~=toggleable_view]:not(.inactive) [data-role~=index]");if(n.length)return r=n.data("type"),i=$.cookie(""+r+"_view"),i?e(r,i):t("grid")}),$(document).on("click","[data-behavior~=toggle_view]",function(t){var n,r;return n=$(this).data("type"),r=$(this).data("view"),$.cookie(""+n+"_view",r,{expires:5e3,path:"/"}),e(n,r),t.preventDefault()}),e=function(e,n){var r;r=$("[data-role~=index]");if(r.length)return t(n),r.removeClass("list_view grid_view"),r.addClass(""+n+"_view"),e==="attachments"&&bcx.rescaleImages(),e==="documents"&&bcx.positionDocumentGroupFlags(),Beanstalk.logEvent("toggle_view_"+e,n)},t=function(e){var t;return t=$("[data-behavior~=toggle_view][data-view~="+e+"]"),t.addClass("selected"),t.siblings().removeClass("selected")}}.call(this),function(){$(document).live("touchstart",function(){var e,t;return e=!1,t=new Date,$(this).one("touchmove",function(){return e=!0}),$(this).one("touchcancel",function(){return e=!0}),$(this).one("touchend",function(){if(e)return;if(new Date-t<500)return $(event.target).trigger("tap")})})}.call(this),function(){$(document).on("click","[data-behavior~=open_videobox]",function(){return $("body").prepend("<div id='videobox'> <div class='video_wrapper'> <a data-behavior='close_videobox' class='close'></a> <iframe src='"+$(this).attr("data-video-src")+"' frameborder='0' allowfullscreen width='640' height='360'></iframe> <p> <a data-behavior='close_videobox' class='back'>Back to your project</a> </p> </div> </div>"),setTimeout(function(){return $("#videobox").addClass("fade")},1),Beanstalk.logEvent("videoboxOpened",$(this).attr("data-video-src")),!1}),$(document).on("click","[data-behavior~=close_videobox]",function(){return $("#videobox").remove(),!1})}.call(this),function(){bcx.on("page:change","hide or show account limit notices",function(){if(bcx.currentPerson!=null)return bcx.currentPerson.attributes.show_storage_prod?$("div.limit.storage.prod").show():$("div.limit.storage.prod").hide(),bcx.currentPerson.attributes.account_can_upload?$("div.limit.storage.reached").hide():($("div.limit.storage.reached:not(.thanks)").show(),$("[data-role~=account_upgrade_wrapper]").hide())})}.call(this),function(){var e,t,n;n=function(){return _($("img[src*=asset1]")).each(function(e){return $(e).attr("src",$(e).attr("src").replace(/asset1/,"public"))})},e=function(){return _($("a[href*=asset1]")).each(function(e){return $(e).attr("href",$(e).attr("href").replace(/asset1/,"public"))})},t=function(){var e;e=$("div.panel").attr("data-behavior");if(!/read_only/.test(e))return $("div.panel").attr("data-behavior","read_only "+e)},bcx.on("page:update","turn page anonymous",function(){if($("body.anonymous").length)return n(),e(),t(),bcx.avatars.removeLinks()}),$("a.download").live("mouseenter",function(){if($("body.anonymous").length&&/asset1/.test($(this).attr("href")))return $(this).attr("href",$(this).attr("href").replace(/asset1/,"public"))})}.call(this),function(){bcx.on("page:update","install auto grow input behavior",function(){return $("[data-behavior~=autogrow]").install("auto grow input",function(e){return e.each(function(){return $(this).autoGrowInput({comfortZone:50,minWidth:200,maxWidth:640})})})})}.call(this),function(){bcx.on("page:update","install autoload behavior",function(){return $("[data-autoload-url]").install("behavior for autoloading a URL",function(e){var t,n;if(n=e.data("autoload-url"))return $.get(n),e.attr("data-autoload-url",""),t=e.closest("div.sheet"),t.addBehavior("prevent_reload_when_stacked")})})}.call(this),function(){var e,t;t="[data-behavior~=autoresize]:not([data-behavior~=wysiwyg])",e=function(e){return e.filter(":visible").autoResize()},bcx.on("page:update","install autoresize behavior on visible elements",function(){return e($(t))}),$("[data-behavior~=expandable]:has("+t+")").live("expand",function(){return e($(this).find(t))}),$(""+t+":visible").live("focus",function(){return $(this).autoResize()})}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this.clearWhenSubmit=t(this.clearWhenSubmit,this),this.watchForChanges=t(this.watchForChanges,this),this.generateStorageKey=t(this.generateStorageKey,this),this.findForm=t(this.findForm,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.prototype.findForm=function(){return this.$form=$(this.input).closest("form")},n.prototype.generateStorageKey=function(){var e;return e=$.md5([this.input.getAttribute("name"),this.$form.attr("action"),window.location.pathname].join("")),"autosave:"+e},n.prototype.watchForChanges=function(){return $(this.input).bind("change keyup paste",function(e){return function(){return e.save()}}(this))},n.prototype.clearWhenSubmit=function(){return this.$form.bind("submit",function(e){return function(){return e.$form.data("remote")?$(document).bind("ajaxSuccess."+e.storageKey,function(t,n,r){if(e.$form.attr("action")===r.url)return $(document).unbind("ajaxSuccess."+e.storageKey),e.clear()}):e.clear()}}(this))},n}(bcx.AbstractAutoSave),bcx.on("page:update","install autosave behavior",function(){return $("[data-behavior~=autosave]").install("behavior for autosaving",function(t){return t.each(function(){return new e(this)})})})}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.updateAvailability=t(this.updateAvailability,this),this.timeLeftInWords=t(this.timeLeftInWords,this),this.availableUntil=t(this.availableUntil,this),this.isAvailable=t(this.isAvailable,this),this.watchOrRemove=t(this.watchOrRemove,this),this.$el=$(e),this.watchOrRemove()}return e.prototype.watchOrRemove=function(){return this.isAvailable()?(this.updateAvailability(),setTimeout(function(e){return function(){return e.watchOrRemove()}}(this),5e3)):this.$el.remove()},e.prototype.isAvailable=function(){return new Date<this.availableUntil()},e.prototype.availableUntil=function(){return new Date(Date.parse(this.$el.data("available-until")))},e.prototype.timeLeftInWords=function(){var e;return e=(this.availableUntil()-new Date)/6e4,e<1?""+Math.floor(e*60)+" seconds":e>=1&&e<2?"1 minute":""+Math.floor(e)+" minutes"},e.prototype.updateAvailability=function(){return this.$el.find("[data-display~=available_time_left]").text(this.timeLeftInWords())},e}(),bcx.on("page:update","install availability window behavior",function(){return $("[data-available-until]").install("behavior for availability window",function(t){return t.each(function(){return new e(this)})})})}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.availableAfter=t(this.availableAfter,this),this.isAvailable=t(this.isAvailable,this),this.watchOrShow=t(this.watchOrShow,this),this.$el=$(e),this.watchOrShow()}return e.prototype.watchOrShow=function(){return this.isAvailable()?this.$el.show():setTimeout(function(e){return function(){return e.watchOrShow()}}(this),5e3)},e.prototype.isAvailable=function(){return new Date>this.availableAfter()},e.prototype.availableAfter=function(){return new Date(Date.parse(this.$el.data("available-after")))},e}(),bcx.on("page:update","install available-after behavior",function(){return $("[data-available-after]").install("behavior for availabile after",function(t){return t.each(function(){return new e(this)})})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};bcx.on("page:update","update subscribers_sentence content for subscribables",function(){var e,t;e=$("div.subscribable[data-behavior~=expandable]");if(e.length){if(!(t=e.attr("data-subscribers")))return;return e.find("[data-behavior~=subscribers_sentence]").html(function(e){return function(){return _.chain(JSON.parse(t)).reject(function(e){return e.id===bcx.currentPerson.id}).reject(function(e){return e.wants_notifications===!1}).pluck("name").value().join(", ").replace(/,\s([^,]+)$/," and $1")}}(this))}}),bcx.on("page:update","replace cached avatar images",function(){if(bcx.currentPerson!=null)return $("img[data-current-person-avatar]").attr("src",bcx.currentPerson.avatarUrl()).attr("title",bcx.currentPerson.get("name")).attr("alt","")}),bcx.on("page:update","remove elements not visible to the current person",function(){return $("[data-visible-to]").each(function(){var t,n,r;n=$(this).attr("data-visible-to").split(/\s/),t=parseInt($(this).closest("[data-creator-id]").data("creator-id"));if(_.include(n,"admin")&&bcx.currentPerson.isAdmin())return;if(_.include(n,"creator")&&bcx.currentPerson.id===t)return;if(_.include(n,"accountManager")&&bcx.currentPerson.isAccountManager())return;if(_.include(n,"groupMember")&&(r=bcx.currentPerson.id,e.call($(this).closest("[data-group-member-ids]").data("group-member-ids"),r)>=0))return;return $(this).remove()}),$("[data-hidden-from]").each(function(){var e,t;t=$(this).attr("data-hidden-from").split(/\s/),e=parseInt($(this).closest("[data-creator-id]").data("creator-id"));if(_.include(t,"admin")&&bcx.currentPerson.admin||_.include(t,"creator")&&bcx.currentPerson.id===e||_.include(t,"accountManager")&&bcx.currentPerson.isAccountManager())return $(this).remove()})})}.call(this),function(){bcx.on("page:update","remove time tags displaying the current year",function(){var e;return e=(new Date).getFullYear(),$("time[datetime][data-behavior~=visible_unless_current_year]").each(function(){var t;t=CalendarDate.parse($(this).attr("datetime")).year;if(t===e)return $(this).remove()})})}.call(this),function(){bcx.on("page:update","group by date",function(){var e,t,n,r,i,s,o,u,a,f,l,c;t=$("section[data-behavior~=group_by_date] article[data-behavior~=group_by_date]");if(!t.length)return;r=t.closest("section"),a=CalendarDate.today(),u={},o=function(e){var t,n;return(t=u[e])?t:(n="> div.date_group[datetime='"+e+"']",(t=r.find(n)).length||(r.append($(JST["desktop/templates/date_group"]({today:a,date:e}))),t=r.find(n)),u[e]=t)},c=[];for(f=0,l=t.length;f<l;f++)i=t[f],e=$(i),e.removeBehavior("group_by_date"),s=CalendarDate.parse(e.attr("datetime")),n=o(s),c.push(n.append(e));return c})}.call(this),function(){var e,t,n,r;r=[/.*viewscreencasts.com\/.*/,/.*screenr.com\/.*/,/maps\.google\.com\/maps\?.*/,/maps\.google\.com\/\?.*/,/maps\.google\.com\/maps\/ms\?.*/,/www\.google\.com\/maps\/.*/,/cl\.ly\/.*/,/cl\.ly\/.*\/content/,/d\.pr\/.*/,/.*twitch\.tv\/.*/,/.*justin\.tv\/.*\/b\/.*/,/.*justin\.tv\/.*\/w\/.*/,/www\.ustream\.tv\/recorded\/.*/,/www\.ustream\.tv\/channel\/.*/,/www\.ustream\.tv\/.*/,/.*twitvid\.com\/.*/,/blip\.tv\/.*\/.*/,/.*\.blip\.tv\/.*\/.*/,/video\.google\.com\/videoplay\?.*/,/.*revver\.com\/video\/.*/,/video\.yahoo\.com\/watch\/.*\/.*/,/video\.yahoo\.com\/network\/.*/,/sports\.yahoo\.com\/video\/.*/,/.*viddler\.com\/explore\/.*\/videos\/.*/,/streamio\.com\/.*/,/s3m\.io\/.*/,/soundcloud\.com\/.*/,/snd.sc\/.*/],n=new RegExp("https*://"+function(){var e,n,i;i=[];for(e=0,n=r.length;e<n;e++)t=r[e],i.push(t.source);return i}().join("|"),"i"),e=/https?:\/\/(?:www\.)?glui\.me/i,$.embedly.defaults.key="c279bf201ad211e1a5be4040d3dc5c07",$.embedly.defaults.maxWidth=580,$.embedly.defaults.secure=!0,$.embedly.defaults.wmode="transparent",$.embedly.defaults.urlRe={test:function(t){return e.test(t)?!1:n.test(t)}},bcx.on("page:update","install embed.ly",function(){return $("[data-embeddable]").install("embed.ly content",function(e){return e.find("a").each(function(){if(!$(this).parents("pre").length)return $(this).embedly()})})})}.call(this),function(){var e,t,n,r;e=function(e){var i,s;if(!e.parents("pre").length)return(i=(s=r(e))!=null?s:t(e))!=null?i:n(e)},r=function(e){var t,n,r;t=/(?:youtu\.be\/|youtube\.com)(?:\/embed\/|\/v\/|\/watch\?v=|\/watch\?.+&v=)?([\w-]{10,11})/;if(n=(r=e.text().match(t))!=null?r[1]:void 0)return e.html('<iframe width="420" height="315" src="//www.youtube.com/embed/'+n+'" frameborder="0" allowfullscreen id="ytplayer" type="text/html"></iframe>')},t=function(e){var t,n,r;t=/vimeo\.com(?:\/(?!album)|(?!review)[^\/]+)?\/(\d+)/;if(n=(r=e.text().match(t))!=null?r[1]:void 0)return e.html('<iframe width="540" height="304" src="//player.vimeo.com/video/'+n+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>')},n=function(e){var t,n,r,i;t=/(?:wistia\.com|wi\.st)\/(?:medias|embed)\/(.+)/;if(r=(i=e.text().match(t))!=null?i[1]:void 0)return n=encodeURI("https://fast.wistia.net/embed/iframe/"+decodeURIComponent(r)),e.html('<iframe width="580" height="326" src="'+n+'" allowtransparency="true" frameborder="0" scrolling="no" class="wistia_embed" name="wistia_embed" allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen msallowfullscreen></iframe>')},bcx.on("page:update","install local embeds",function(){return $("[data-embeddable]").install("local embeds",function(t){var n;n=t.find("a");if(n.length<=100)return n.each(function(){return e($(this))})})})}.call(this),function(){bcx.on("page:change","prepare feedback button",function(){var e;bcx.currentPerson!=null&&(e={name:bcx.currentPerson.get("name"),email_address:bcx.currentPerson.get("email_address"),has_classic_account:bcx.currentPerson.get("has_classic_account"),account_url:document.location.href,getsPhoneSupport:!0},$.cookie("help",JSON.stringify(e),{path:"/"}));if(!$.browser.mobile)return $("#contact_support_button").show()})}.call(this),function(){bcx.on("page:change","install infinite pagination behavior",function(){var e;return e=function(e,t){t==null&&(t={}),e.infinitePage(t);if(!e.attr("data-infinite-page-reload"))return e.closest("div.sheet").addBehavior("prevent_reload_when_stacked")},$("[data-behavior~=infinite_page]").install("behavior for infinite scrolling and pagination",function(t){return e(t)})})}.call(this);var Launchbar={initialize:function(e){this.addBodyClass(),this.rememberLocation(),this.installBehaviors(e)},addBodyClass:function(){$(document.body).addClass("with_launchbar")},rememberLocation:function(){try{var e=3,t=new Date;t.setTime(t.getTime()+e*36e5),document.cookie="return_to="+encodeURIComponent(window.location.href)+"; expires="+t.toUTCString()}catch(n){}},installBehaviors:function(e){var t=$(e),n=".menus > .menu";t.on("mouseenter",n,Launchbar.behaviors.mouseEnter).on("mouseleave",n,Launchbar.behaviors.mouseLeave),$.support.touch&&t.on("touchstart",n,Launchbar.behaviors.touchStart),$(e).find("a.disable_click, a.on").on("click",function(){return!1})},openMenu:function(e){var t=$(e).find(".items"),n=Launchbar.closeMenu(!1),r=function(){t.addClass("menu_active").show()};n?r():t.delay(500).queue(r)},closeMenu:function(e){$("#launchbar .items").stop(!0,!0);var t=$("#launchbar .menu_active");if(t.length)return e===!1?t.hide().removeClass("menu_active"):t.delay(500).fadeOut(100).queue(function(){$(this).removeClass("menu_active")}),!0},behaviors:{mouseEnter:function(){Launchbar.openMenu(this)},mouseLeave:function(){Launchbar.closeMenu()},touchStart:function(e){if($(e.target).closest(".account").length)return;return Launchbar.openMenu(this),$(window).one("touchstart",function(e){$(this).closest("#launchbar").length==0&&Launchbar.closeMenu()}),!1}}};$(function(){var e=$("#launchbar");e.length&&Launchbar.initialize(e)}),function(){$(function(){var e;if($("#launchbar").length)return;return e="<div id=launchbar class=fake><ul class=menus><li class=menu></li></ul><div style='clear: both'></div></div>",Launchbar.initialize($(e).hide().prependTo("body"))}),bcx.on("page:change","set Launchbar links not to load in the current stack",function(){return $("div#launchbar").find("a").attr("data-stacker",!1)})}.call(this),function(){var e;e=75,bcx.on("page:update","install link truncation behavior",function(){return $("a[data-behavior~=truncate]").install("behavior for truncating long links",function(t){return t.each(function(){var t;t=$(this);if(t.text().length>e){t.html(""+t.html().substring(0,e)+"…");if(!t.attr("title"))return t.attr("title",t.attr("href"))}})})})}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function r(e){this.field=e,this.idle=t(this.idle,this),this.busy=t(this.busy,this),this.changeSort=t(this.changeSort,this),this.paginateIndex=t(this.paginateIndex,this),this.fetchIndex=t(this.fetchIndex,this),this.highlightResults=t(this.highlightResults,this),this.paginateResults=t(this.paginateResults,this),this.fetchResults=t(this.fetchResults,this),this.paginate=t(this.paginate,this),this.display=t(this.display,this),this.fetch=t(this.fetch,this),this.updateQuery=t(this.updateQuery,this),this.apply=t(this.apply,this),this.install=t(this.install,this),this.$field=$(this.field),this.$sheet=this.$field.closest(".sheet"),this.$results=this.$sheet.find("[data-role~=live_filter_results]"),this.$sorts=this.$sheet.find("[data-sort]"),this.request=null,this.type=this.$field.data("type"),this.indexUrl=this.$field.data("index-url"),this.filterUrl=this.$field.data("filter-url"),this.filtering=!1}var e,n;return e=200,n=function(e){return e.closest("[data-role~=facet]").find("[data-role~=option]").removeClass("selected").end().find("[data-role~=toggle]").text(e.text()).end().collapse(),e.closest("[data-role~=option]").addClass("selected")},r.install=function(e){return(new this(e)).install()},r.prototype.install=function(){return this.$field.on("keyup",_.debounce(this.apply,e)),this.$sorts.on("click",this.changeSort),this.$results.on("infinite_page:load",function(e){return function(){if(e.filtering)return e.highlightResults()}}(this))},r.prototype.apply=function(){var e;this.updateQuery(),e=!!this.filtering;if(this.filtering=this.query.length>0)return this.$sheet.removeBehavior("prevent_reload_when_stacked"),this.$sheet.find("[data-behavior~=infinite_page]").attr("data-infinite-page-reload",""),this.fetchResults(),Beanstalk.logEvent("filtered",this.type);if(e)return this.fetchIndex()},r.prototype.updateQuery=function(){return this.query=this.$field.val().trim()},r.prototype.fetch=function(e,t){var n;return t==null&&(t={}),t=_(t).extend({sort:this.sort}),(n=this.request)!=null&&n.abort(),this.busy(),this.request=$.ajax(e,{data:t,dataType:"html"}).always(function(e){return function(){return e.request=null}}(this)).always(this.idle).done(this.display)},r.prototype.display=function(e){return this.$results.html(e)},r.prototype.paginate=function(e,t){return t==null&&(t={}),t=_(t).extend({sort:this.sort}),this.$results.trigger("infinite_page:uninstall").infinitePage({url:e,data:t})},r.prototype.fetchResults=function(){return this.fetch(this.filterUrl,{q:this.query}).done(this.paginateResults).done(this.highlightResults)},r.prototype.paginateResults=function(){return this.paginate(this.filterUrl,{q:this.query})},r.prototype.highlightResults=function(){return this.$results.find("[data-role~=live_filter_highlight]").highlightQuery(this.query,{className:"live_filter_highlight"})},r.prototype.fetchIndex=function(){return this.fetch(this.indexUrl).done(this.paginateIndex)},r.prototype.paginateIndex=function(){return this.paginate(this.indexUrl)},r.prototype.changeSort=function(e){var t;t=$(e.target),this.sort=t.data("sort");if(this.filtering)return e.preventDefault(),e.stopPropagation(),n(t),this.apply()},r.prototype.busy=function(){return this.$field.addClass("busy")},r.prototype.idle=function(){return this.$field.removeClass("busy")},r}(),bcx.on("page:change","install live filters",function(){return $("[data-behavior~=live_filter]").each(function(){return e.install(this)})})}.call(this),function(){var e,t;t=null,e=[],bcx.on("page:beforechange page:change","apply body classes from active panel",function(){var n,r,i,s;return n=$("body"),i=window.location.pathname,t!==i&&(_.each(e,function(e){return n.removeClass(e)}),e=[]),t=i,r=((s=$("div.panel:not(.inactive)").attr("data-body-class"))!=null?s:"").split(/\s/),_.each(r,function(t){if(!n.hasClass(t))return n.addClass(t),e.push(t)})})}.call(this),function(){bcx.on("page:update","apply read-only behavior",function(){return $("div.sheet[data-behavior~=read_only] input[type='checkbox'], div.project[data-behavior~=read_only] article.document textarea").attr("disabled",!0),$("div.sheet[data-behavior~=read_only] div[data-behavior~=edit_project_header]").attr("data-behavior","expandable"),$("div.sheet[data-behavior~=read_only] > header div.header_links a:first-child span.link").html("People on this project")})}.call(this),function(){bcx.on("page:update","remove redundant elements"
,function(){var e,t,n,r,i,s,o,u;s=_.uniq($("[data-unique-id]").map(function(){return $(this).attr("data-unique-id")})),u=[];for(r=0,i=s.length;r<i;r++)t=s[r],e=$("[data-unique-id="+t+"]"),e.length>1?(n=(o=e.data("keep"))!=null?o:"first",u.push(e.not(":"+n).remove())):u.push(void 0);return u})}.call(this),function(){bcx.on("page:update","turn page single project",function(){if($("body.single_project_account").length)return bcx.avatars.removeLinks(),$(".access[data-person-id] a.person_name").each(function(){return $(this).parent().html($(this).text())})})}.call(this),function(){var e;e=function(e){var t;t=e.find("[data-behavior~=lazy_load_subscribers]");if(t.html()==="")return $.ajax(t.url(),{success:function(e){return t.html(e)}})},bcx.installAdhocSubscribers=function(){return $(".subscribers[data-behavior~=expandable] [data-behavior~=adhoc_subscribers]").install("behavior for ad-hoc subscriber fields",function(e){return $.getJSON("/everyone.json",function(t){var n;return e.data("people",t),n=new bcx.views.AdhocSubscriberList({el:e.get(0)}),n.render(),n.focus()})})},bcx.installAdhocSubscriberValidation=function(){var e,t;return e=$("[data-behavior~=adhoc_subscribers]").parents("form"),t=e.attr("data-behavior")||"",e.attr("data-behavior","adhoc_subscriber_validation "+t)},$("article.message.new, article.upload.new, article.todolist, article.calendar_event.new, section.calendar_events.edit").live("expand",function(t){if(t.target===this)return e($(this))}),bcx.on("page:change","lazy-load subscribers for upload edit form",function(){var t;t=$("article.upload.edit");if(t.length)return e(t)}),$("div.ad-hoc.subscribers").live("expand",function(e){return $(this).find("[data-role~=human_input]:first").focus()}),$("article.comment.new, .subscribers[data-behavior~=expandable]").live("expand",function(){return bcx.installAdhocSubscribers(),bcx.installAdhocSubscriberValidation()}),bcx.on("page:update","install subscriber list behavior",function(){return $("[data-behavior~=subscriber_list]").install("behavior for subscriber fields",function(e){return e.each(function(e,t){var n;return n=new bcx.views.SubscriberList({el:t}),n.render(),$(t).data("view",n)})})})}.call(this),function(){bcx.on("page:update enlarger:install autoview:render view:render","convert time tags",LocalTime.run)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};bcx.Toolbar=function(){function t(t){this.scroll=e(this.scroll,this);var n;this.toolbar=t,this.document=this.toolbar.closest("[data-behavior~=wysiwyg_container]"),this.toolbarHeight=this.toolbar.height(),this.followAlways=this.document.hasBehavior("wysiwyg_follow_always"),this.followThreshold=(n=this.document.data("wysiwyg-follow-threshold"))!=null?n:0}return t.prototype.toolbarOffset=5,t.prototype.detached=!1,t.prototype.scroll=function(){var e,t,n,r;if(!this.toolbar.is(":visible"))return;n=this.document.offset().top-this.toolbarOffset,t=this.document.outerHeight(),r=$(window).scrollTop(),e=n+t+this.toolbarOffset-this.toolbarHeight;if(e>r&&r>n){if(!this.followAlways&&(t<=this.followThreshold||r>=$(document).height()-$(window).height()))return;if(!this.detached)return this.detach()}else if(this.detached)return this.attach()},t.prototype.detach=function(){var e,t,n;return t=$(document).height(),this.toolbar.hide(),e=$(document).height(),this.toolbar.show(),n=t-e,this.document.css({paddingTop:n}),this.toolbar.addBehavior("wysiwyg_follower"),this.detached=!0},t.prototype.attach=function(){return this.toolbar.removeBehavior("wysiwyg_follower"),this.document.css({paddingTop:""}),this.detached=!1},t.toolbars=[],t.install=function(){return setTimeout(function(){return $("div[data-behavior~=wysiwyg_toolbar]").install("attaching toolbar",function(e){var n;return n=new t(e),t.toolbars.push(n),$(window).bind("scroll.documentToolbar",n.scroll)})},10)},t.uninstall=function(){var e,n,r,i;i=t.toolbars;for(n=0,r=i.length;n<r;n++)e=i[n],$(window).unbind("scroll.documentToolbar",e.scroll);return t.toolbars.clear},t}(),bcx.on("page:update","install the document toolbar positioning behavior",bcx.Toolbar.install),bcx.on("page:change","uninstall toolbar following",bcx.Toolbar.uninstall)}.call(this),function(){$(window).bind("focus",function(e){if(e.target===window)return window.isFocused=!0}),$(window).bind("blur",function(e){if(e.target===window)return window.isFocused=!1}),window.isFocused=!0}.call(this),function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}};$(function(){var e;e=function(){var e,t;return e=document.createElement("span"),e.textContent="﻿",e.style.cssText="position: absolute; top: 0; left: 0; margin: 0; padding: 0",document.body.appendChild(e),t=e.offsetWidth,document.body.removeChild(e),t}();if(e>0)return wysihtml5.INVISIBLE_SPACE="​"}),wysihtml5.commands.pre={exec:function(e,t){return wysihtml5.commands.formatInline.exec(e,t,"pre")},state:function(e,t,n){return wysihtml5.commands.formatInline.state(e,t,"pre")},value:function(){return null}},e=function(){function e(e){this.textarea=e,this.handleUnsupportedBroswers=r(this.handleUnsupportedBroswers,this),this.formatUnformattedContent=r(this.formatUnformattedContent,this),this.containsHtml=r(this.containsHtml,this),this.$textarea=$(e),wysihtml5.browser.supported()&&(!$.browser.safari||!$.browser.mobile)?(this.formatUnformattedContent(),this.editor=this.createEditor(),this.$iframe=$(this.editor.composer.iframe),this.onload(),this.focusOnExpand()):this.handleUnsupportedBroswers()}return e.prototype.unsupportedMessage="This message contains rich formatting, but your web browser only supports editing plain text. Some formatting may be lost.",e.prototype.config={autoLink:!1,style:!0,bodyClassName:"wysihtml5-supported",composerClassName:"wysiwyg_editor",stylesheets:["https://bcx.basecamp-static.com/assets/desktop-5d7befef3eeeec1c7bbbd5f73eb96d38.css"],parserRules:{tags:{strong:{},b:{},em:{},i:{},u:{},br:{},p:{},div:{},span:{},ul:{},ol:{},li:{},del:{},a:{check_attributes:{href:"url"}},img:{check_attributes:{src:"url","class":"alt",alt:"alt"}},pre:{},blockquote:{}}},indentMatcher:/.*/},e.prototype.onload=function(){return this.editor.observe("load",function(e){return function(){return e.setupAutoResize(),e.copyClasses(),e.addIEClass(),e.addAccessibilityAttributes(),e.triggerChangeEvents()}}(this))},e.prototype.insertToolbar=function(){var e;return e=$(JST["desktop/templates/wysiwyg_toolbar"]({})),this.$textarea.before(e),e[0]},e.prototype.createEditor=function(){var e;return e=new wysihtml5.Editor(this.textarea,$.extend(this.config,{toolbar:this.insertToolbar()})),e.observe("focus:composer",function(e){return function(){return e.$textarea.trigger("wysiwyg:focus")}}(this)),e.observe("blur:composer",function(e){return function(){return e.$textarea.trigger("wysiwyg:blur")}}(this)),this.$textarea.live("focus",function(){return e.composer.focus()}),e.observe("paste",function(e){return function(t){return e.pasted=!0}}(this)),e},e.prototype.setupAutoResize=function(){if(!this.$textarea.hasBehavior("autoresize"))return;return this.$iframe.addBehavior("autoresize"),this.$iframe.data("autoresize-limit",this.$textarea.data("autoresize-limit")),this.$iframe.data("rows",this.$textarea.attr("rows")),this.$iframe.autoResize()},e.prototype.copyClasses=function(){var e;this.$iframe.contents().find("html").addClass(this.config.composerClassName);if(e=this.$textarea.data("wysiwyg-class"))return this.$iframe.contents().find("body").addClass(e)},e.prototype.addIEClass=function(){if($.browser.msie)return this.$iframe.contents().find("body").addClass("ie")},e.prototype.addAccessibilityAttributes=function(){return this.$iframe.contents().find("body").attr("role","textbox").attr("aria-multiline",!0)},e.prototype.triggerChangeEvents=function(){var e;return e=this.$iframe.contents().find("body"),_.each(["keyup","keydown"],function(t){return function(n){return e.bind(n,function(e){return t.$textarea.trigger($.Event(n,{keyCode:e.keyCode,ctrlKey:e.ctrlKey,metaKey:e.metaKey}))})}}(this)),_.each(["newword:composer","change"],function(e){return function(t){return e.editor.observe(t,function(){return e.$textarea.trigger("change")})}}(this))},e.prototype.focusOnExpand=function(){return this.$iframe.closest("[data-behavior~=expandable]").bind("expand",function(e){return function(){if(e.$textarea.attr("autofocus"))return e.$iframe.contents().find("body").focus()}}(this))},e.prototype.containsHtml=function(){return this.$textarea.val()&&this.$textarea.val().match(/<\w+>/i)},e.prototype.formatUnformattedContent=function(){if(!this.containsHtml())return this.$textarea.val(this.$textarea.val().replace(/\n/g,"<br>")).trigger("change")},e.prototype.handleUnsupportedBroswers=function(){this.$textarea.removeBehavior("wysiwyg"),this.containsHtml()&&(this.$textarea.attr("disabled",!0).css({opacity:.3}),setTimeout(function(e){return function(){return confirm(e.unsupportedMessage)?$.post("/content/unformat",{content:e.$textarea.val()},function(t){return e.$textarea.attr("disabled",!1).css({opacity:1}).val(t).trigger("change").get(0).focus()}):e.$textarea.closest("form").find("a[data-role~=cancel]").click()}}(this),100));if(this.$textarea.hasBehavior("autoresize"))return this.$textarea.autoResize()},e}(),n="textarea[data-behavior~=wysiwyg]",bcx.on("page:update","install wysiwyg behavior",function(){return t($(""+n+":visible"))}),$("[data-behavior~=expandable]:has("+n+")").live("expand",function(){return t($(this).find(""+n+":visible"))}),t=function(t){return t.install("behavior for wysiwyg editor",function(t){return t.each(function(){return new e(this)})})}}.call(this),function(){}.call(this),function(){window.Beanstalk={enablePageviewTracking:!0,enablePresenceTracking:!1,presenceGranularity:60,dev:location.host.match(/.*?\.dev/),uuid:null,site_id:null,beaconURL:function(){var e,t;return e=Beanstalk.dev?"dash.dev":"dash.37signals.com",t=""+window.location.protocol+"//"+e+"/beacon.gif?"}}}.call(this),function(){var e=[].slice;Beanstalk.beacon={params:[],enabled:!0,autosend:!0,log:function(e){var t,n,r;r=[];for(t in e)n=e[t],r.push(Beanstalk.beacon.params.push([t,n]));return r},send:function(){var t,n,r,i,s,o,u;if(!Beanstalk.beacon.enabled)return;r=[],o=Beanstalk.beacon.params;for(n in o)s=o[n],typeof s!="function"&&r.push(""+encodeURIComponent(s[0])+"="+encodeURIComponent(s[1]));if(r.length){Beanstalk.uuid&&r.unshift("uuid="+Beanstalk.uuid),Beanstalk.site_id&&r.unshift("site_id="+Beanstalk.site_id),r.unshift("tz="+(new Date).getTimezoneOffset()/60),i=[Beanstalk.beaconURL()].concat(e.call(r)).join("&");if(i.length<4096)t=new Image,t.src=i,t.onerror=function(){if(Beanstalk.dev)return Beanstalk.beacon.enabled=!1,console.warn("disabling instrumentation beacon")};else{r={},u=Beanstalk.beacon.params;for(n in u)s=u[n],typeof s!="function"&&(typeof r[s[0]]=="undefined"?r[s[0]]=s[1]:Object.prototype.toString.call(r[s[0]])==="[object Array]"?r[s[0]].push(s[1]):r[s[0]]=[r[s[0]],s[1]]);r&&(Beanstalk.site_id&&(r.site_id=Beanstalk.site_id),Beanstalk.uuid&&(r.uuid=Beanstalk.uuid),r.tz=(new Date).getTimezoneOffset()/60),$.ajax({type:"POST",url:Beanstalk.beaconURL(),data:r,error:function(){if(Beanstalk.dev)return Beanstalk.beacon.enabled=!1,console.warn("disabling instrumentation beacon")}})}}return Beanstalk.beacon.params=[]}}}.call(this),function(){Beanstalk.logCohort=function(e,t){return Beanstalk.beacon.log({"cohort[][experiment]":e,"cohort[][group]":t}),Beanstalk.beacon.send()}}.call(this),function(){Beanstalk.logEvent=function(e,t){return Beanstalk.beacon.log({"event[][name]":e,"event[][value]":t}),Beanstalk.beacon.send()}}.call(this),function(){Beanstalk.logPageview=function(){if(Beanstalk.enablePageviewTracking){Beanstalk.beacon.log({"pageview[host]":document.location.host,"pageview[path]":document.location.pathname,"pageview[query]":document.location.search,"pageview[title]":document.title,"pageview[referrer]":document.referrer});if(Object.keys(Beanstalk.Timing.times).length===0&&Beanstalk.beacon.autosend)return setTimeout(Beanstalk.beacon.send,500)}},document.addEventListener&&document.addEventListener("DOMContentLoaded",function(){return Beanstalk.logPageview()},!1)}.call(this),function(){Beanstalk.enablePresenceTracking&&setInterval(function(){return Beanstalk.beacon.log({presence:!0}),Beanstalk.beacon.send()},Beanstalk.presenceGranularity*1e3)}.call(this),function(){Beanstalk.logSignup=function(e,t){return Beanstalk.beacon.log({"signup[product]":e,"signup[account_id]":t}),Beanstalk.beacon.send()}}.call(this),function(){var e;typeof e=="undefined"&&(e={times:{}}),Beanstalk.Timing={times:e.times,mark:function(e,t){return t||(t=(new Date).getTime()),Beanstalk.Timing.times[e]=t},init:function(e){return e!==void 0&&(Beanstalk.Timing.times=e),Beanstalk.Timing.findStartTime(),Beanstalk.Timing.addEventListener("beforeunload",Beanstalk.Timing.beforeUnload,!1),Beanstalk.Timing.addEventListener("load",Beanstalk.Timing.onload,!1),Beanstalk.Timing.addEventListener("DOMContentLoaded",Beanstalk.Timing.domloaded,!1)},addEventListener:function(e,t,n){try{if("undefined"!=typeof window.attachEvent)return window.attachEvent("on"+e,t);if(window.addEventListener)return window.addEventListener(e,t,n)}catch(r){}},domloaded:function(){return Beanstalk.Timing.mark("domloaded")},onload:function(){return Beanstalk.Timing.mark("onload"),Beanstalk.Timing.done()},findStartTime:function(){var e;e=Beanstalk.Timing.findStartWebTiming()||Beanstalk.Timing.findStartGToolbar();if(e)return Beanstalk.Timing.mark("starttime",e)},findStartWebTiming:function(){var e,t;return t=void 0,e=window.performance||window.mozPerformance||window.msPerformance||window.webkitPerformance,"undefined"!=typeof e&&"undefined"!=typeof e.timing&&"undefined"!=typeof e.timing.navigationStart&&(t=e.timing.navigationStart),t},findStartGToolbar:function(){var e;return e=void 0,"undefined"!=typeof window.external&&"undefined"!=typeof window.external.pageT?e=(new Date).getTime()-window.external.pageT:"undefined"!=typeof window.gtbExternal&&"undefined"!=typeof window.gtbExternal.pageT?e=(new Date).getTime()-window.gtbExternal.pageT():"undefined"!=typeof window.chrome&&"undefined"!=typeof window.chrome.csi&&(e=(new Date).getTime()-window.chrome.csi().pageT),e&&Beanstalk.Timing.dprint("Beanstalk.Timing.findStartGToolbar: startTime = "+e),e},done:function(){var e,t,n,r,i;Beanstalk.Timing.mark("done"),typeof window.performance!="undefined"&&typeof window.performance.timing!="undefined"&&(Beanstalk.Timing.domloaded=window.performance.timing.domComplete,Beanstalk.Timing.firstbyte=window.performance.timing.responseStart,Beanstalk.Timing.onload=window.performance.timing.loadEventEnd),t=[],i=Beanstalk.Timing.times;for(e in i)n=i[e],t.push(""+e+":"+n);r=document.querySelectorAll("[data-x-runtime]"),r.length>0&&t.push("xruntime:"+1e3*+r[0].getAttribute("data-x-runtime")),t=t.join(","),Beanstalk.beacon.log({timing:t}),Beanstalk.Timing.times={};if(Beanstalk.beacon.autosend)return setTimeout(Beanstalk.beacon.send,300)}}}.call(this),function(){var e,t;t=function(e){return e.match(/page_updates/)||e.match(/calendar_updates/)||e.match(/projects\.js/)||e.match(/stars$/)||e.match(/beacon\.gif/)||e.match(/progress\.js/)||e.match(/stage\.txt/)},$(function(){var e,n,r,i;return Beanstalk.site_id=2,Beanstalk.beacon.autosend=!1,bcx.currentPerson&&(Beanstalk.uuid="bcx/"+bcx.currentPerson.get("id")+",id/"+bcx.currentIdentityId+",qb/"+bcx.currentAccountSlug),n=new Date,r=$.cookie("X-Request-Id"),i=$.cookie("X-Runtime"),$("#runtime a").attr("href","https://dash.37signals.com/logs/find_request?app=bcx&x_request_id="+r+"&day="+n.getUTCFullYear()+"-"+(n.getUTCMonth()+1)+"-"+n.getUTCDate()),$("#runtime a").text("Rendered in "+i+" seconds"),$("#runtime a").attr("data-x-runtime",i),$("#runtime a").attr("data-x-request-id",r),$("#runtime").show(),Beanstalk.beacon.log({xrequestid:$("[data-x-request-id]").data("x-request-id")}),e=setInterval(Beanstalk.beacon.send,5e3),$(document).ajaxSend(function(n,r,i){if(!t(i.url))return clearInterval(e),Beanstalk.Timing.mark("ajaxSend"),$("#runtime").hide()}),$(document).ajaxComplete(function(e,r,i){if(!t(i.url)){n=new Date,$("#runtime a").attr("href","https://dash.37signals.com/logs/find_request?app=bcx&x_request_id="+r.getResponseHeader("X-Request-Id")+"&day="+n.getUTCFullYear()+"-"+(n.getUTCMonth()+1)+"-"+n.getUTCDate()),$("#runtime a").text("Rendered in "+r.getResponseHeader("X-Runtime")+" seconds"),$("#runtime a").attr("data-x-runtime",r.getResponseHeader("X-Runtime")),$("#runtime a").attr("data-x-request-id",r.getResponseHeader("X-Request-Id")),$("#runtime").show();if(!_.find(Beanstalk.beacon.params,function(e){return e[0]==="xrequestid"}))return Beanstalk.beacon.log({xrequestid:r.getResponseHeader("X-Request-Id")})}}),$(document).bind("page:change",function(){return Beanstalk.logPageview(),e=setInterval(Beanstalk.beacon.send,5e3),Beanstalk.Timing.mark("page:change"),Beanstalk.Timing.done()}),$(document).bind("page:beforechange",function(){return Beanstalk.Timing.mark("page:beforechange")})}),$(window).load(function(){return typeof window.performance!="undefined"&&typeof window.performance.timing!="undefined"?(setTimeout(function(){return e(window.performance.timing)},10),$(document).bind("page:change",function(t){if(typeof window.performance.getEntriesByName!="undefined")return setTimeout(function(){var n;n=_.filter(window.performance.getEntries(),function(e){return e.name.match(t.delegateTarget.URL.split("#")[0])});if(n.length>0)return e(n[0])},50)})):setTimeout(Beanstalk.beacon.send,100)}),e=function(e){var n,r,i;r={};for(n in e){i=e[n];if(typeof i=="string"||typeof i=="number")r[n]=i}return r["x-runtime"]=1e3*+$("a[data-x-runtime]").attr("data-x-runtime"),Beanstalk.beacon.log({navigationTiming:JSON.stringify(r)}),setTimeout(function(){var s,o,u,a;if(typeof window.performance.getEntriesByType!="undefined"){u=_.filter(window.performance.getEntriesByType("resource"),function(n){var r,i;return e.startTime===window.performance.timing.startTime?r=!0:r=n.startTime>=e.startTime,i=n.name!==e.name,r&&i&&!t(n.name)});if(u.length>0){o=[];for(s in u){r={},a=u[s];for(n in a){i=a[n];if(typeof i=="string"||typeof i=="number")r[n]=i}o.push(r)}Beanstalk.beacon.log({resourceTiming:JSON.stringify(o)}),typeof performance.webkitClearResourceTimings!="undefined"&&performance.webkitClearResourceTimings();if(typeof performance.clearResourceTimings!="undefined")return performance.clearResourceTimings()}}},100),setTimeout(Beanstalk.beacon.send,500)}}.call(this),function(){bcx.on("page:change","let Intercom know that the page changed",function(){return window.Intercom("update")}),$(document).on("click","a[data-behavior~=track_userevent]",function(){return window.Intercom("trackEvent",$(this).data("userevent"))}),$(document).on("click","a[data-behavior~=track_userevent][data-userevent=canceled_account]",function(){return window.intercomSettings.company.canceled_at=Math.floor((new Date).getTime()/1e3),window.Intercom("update")})}.call(this),function(){}.call(this),function(){}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/stage_switcher"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s;t.push('<ul class="menus">\n  <li class="menu">\n    <a class="application" href="#">'),t.push(r(this.stage)),t.push('<input type="hidden" data-hotkey="`"></a>\n    <div class="items">\n      <ul class="items">\n        '),s=this.stages;for(n=0,i=s.length;n<i;n++)e=s[n],t.push('\n          <li class="item'),this.stage===e&&t.push(r(" active")),t.push('">\n            <a href="#" data-stage="'),t.push(r(e)),t.push('">'),t.push(r(e)),t.push("</a>\n            "),this.stage===e&&t.push("<span>✓</span>"),t.push("\n          </li>\n        ");t.push('\n      </ul>\n    </div>\n  </li>\n</ul>\n<span><a class="cancel" data-behavior="cancel">&#215;</a></span>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){var e,t,n,r,i,s,o,u;if(t=$.cookie("stage"))o=$.trim(t.replace(/\.$/,""));u=["production","rollout","beta1","beta2","beta3","beta4"],e=$("<div class=stage_switcher>"),i=function(){return e.html(JST["desktop/templates/stage_switcher"]({stage:o,stages:u}))},r=function(){return $.get("/"+bcx.currentAccountSlug+"/stage.txt",function(e){return o=$.trim(e),i()})},s=function(){return $.cookie("stage_switcher","1"),e.addClass("active"),$("#launchbar.fake").show()},n=function(){return $.cookie("stage_switcher",null),e.removeClass("active"),$("#launchbar.fake").hide()},$(function(){$("#launchbar").prepend(e),i();if($.cookie("stage")&&$.cookie("stage_switcher"))return s(),r()}),$("#launchbar .stage_switcher:not(.active)").live("mousedown",function(){return r()}),$("#launchbar .stage_switcher:not(.active)").live("hotkey",function(){return s(),r(),!1}),$("#launchbar .stage_switcher:not(.active)").live("click",function(e){if(e.shiftKey)return s(),!1}),$("#launchbar .stage_switcher [data-stage]").live("click",function(e){return o=$(e.currentTarget).data("stage"),$.cookie("stage",""+o+".",{domain:"."+window.location.hostname,path:"/"}),i(),setTimeout(function(){return window.location.reload()},1),!1}),$("#launchbar .stage_switcher a").live("click",function(e){return!1}),$("#launchbar .stage_switcher a[data-behavior~=cancel]").live("click",function(e){return n(),!1})}.call(this),function(){var e,t,n;e=function(e){return $(e).closest(".field").addClass("error")},t=function(e){return $(e).closest(".field").removeClass("error")},n=function(n,r){return r($(n).val())?(t(n),!0):(e(n),!1)},$(function(){return $("form[data-behavior~=signup]").find("input[type=text]:first").focus(),$("form[data-behavior~=signup]").on("focusin","input[class^=cc]",function(){return t(this)}).on("blur","input.cc-number",function(){if($(this).val())return n(this,Queenbee.CreditCard.validateNumber)}).on("blur","input.cc-zip-code",function(){return n(this,Queenbee.CreditCard.validateZipCode)}).on("submit",function(e){var t,r,i;return r=$(this).find("input.cc-number"),i=$(this).find("input.cc-zip-code"),t=[],n(r,Queenbee.CreditCard.validateNumber)||t.push(r),n(i,Queenbee.CreditCard.validateZipCode)||t.push(i),t.length?e.preventDefault():($(this).addClass("busy").find(":submit").prop("disabled",!0),Queenbee.CreditCard.encryptForm(this))})})}.call(this),function(){}.call(this),function(){var e,t;e="",(t=function(){if(navigator.userAgent.match(/iPhone.*Mobile.*Safari/))return;return bcx.currentAccountSlug&&window.location.pathname==="/"+bcx.currentAccountSlug+"/calendar"?$.ajax("/"+bcx.currentAccountSlug+"/calendar_updates?since="+e,{complete:function(n){return e=n.getResponseHeader("X-Page-Updated-At"),setTimeout(t,5e3)}}):(e="",setTimeout(t,1e4))})()}.call(this),function(){var e,t,n,r,i,s=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};this.bcx.poller={bucket:null,updatedAt:null,idleCount:0,active:window.location.host.split(".")[0]!=="public"},t=function(e){return 1e3*Math.min(30,3+4*Math.log(e+1))},r=function(){return bcx.poller.idleCount=0,e(0)},e=function(e){return e==null&&(e=1),bcx.poller.idleCount+=e,i(bcx.poller.period=t(bcx.poller.idleCount))},i=function(e){if(navigator.userAgent.match(/iPhone.*Mobile.*Safari/))return;return setTimeout(n,e)},n=function(t){var n,i,o;if(!bcx.currentPerson)return;return(i=/(\/(?:projects|calendars)\/[^/]+)/.exec(window.location.pathname))&&bcx.poller.active?(n=i[1],bcx.poller.bucket!==n&&(bcx.poller.bucket=n,bcx.poller.updatedAt=null,bcx.poller.idleCount=0),o=""+n+"/page_updates?since="+bcx.poller.updatedAt,t&&(o=""+o+"&all=1"),$.ajax(o,{success:function(t,n,i){var s;if(s=i.getResponseHeader("X-Page-Updated-At"))bcx.poller.updatedAt=s;return t.length===0?e(1):r()},error:function(t){var n;return(n=t.status,s.call([502,503,504],n)>=0)?e(1e3):bcx.poller.active=!1}})):(bcx.poller.updatedAt=null,bcx.poller.bucket=null,r())},r(),$("div.sheet").live("afterSheetRestore",_.debounce(function(e,t){if(!t.canBeReloadedWhenStacked())return bcx.poller.updatedAt=parseInt(t.inactiveSince/1e3),n(!0)}))}.call(this),function(){var e,t,n,r,i,s,o;(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T;return t=null,e=null,o=null,s=null,r=null,g=null,m=null,n=null,a=null,u=function(){return t=$("[data-behavior~=format_timeline]"),a?n=t.filter("[data-event-id='"+a+"']"):n=null},i=function(t,n){return e=t,o=CalendarDate.parse(e.data("datetime")),s=e.data("bucket-identifier"),typeof n=="function"&&n(),r=e,g=o,m=s},w=function(){return r=null,g=null,m=null},d=function(e,t){var n,r,s,o;o=[];for(r=0,s=e.length;r<s;r++)n=e[r],o.push(i($(n),t));return o},l=function(e){return w(),d(t,e)},c=function(e){var r,s;if(!n)return;s=t.index(n);if(s!==-1)return r=$(t.slice(0,s).toArray().reverse()),i(n),d(r,e)},y=function(){return t.parent().find(".day").remove()},h=function(){return t.parent().find(".project").hide()},b=function(){if((r!=null?r.data("event-id"):void 0)===e.data("event-id"))return e.remove()},p=function(){if(o.isnt(g))return e.parent().prepend(JST["desktop/templates/timeline_day_bubble"]({date:o}))},S=function(){if(s!==m||o.isnt(g))return e.prev("div.project").show()},E=function(){return e.parent().show()},f=function(e){return e==="left"?"right":"left"},T=function(){var t,n;if(e.data("side")==null){t=(n=r!=null?r.data("side"):void 0)!=null?n:"right";if(s!==m||o.isnt(g))t=f(t);return e.attr("data-side",t),e.parent().find(".chiral").removeClass("left right").addClass(t)}},x=function(){return t.scaleImages()},v=function(e){return $(window).scrollTop()<50||!n?e():n.preserveScrollOffset(e)},bcx.on("page:update","format timeline",function(){if($("[data-behavior~=timeline]").length){u();if(!t.filter(":not([data-side])").length)return;return v(function(){return y(),h(),l(function(){return b(),p(),S(),E()}),c(function(){return T()}),l(function(){return T()}),x()}),a=t.first().data("event-id")}})})(),s=0,i=!1,$(window).focus(function(){if($("[data-behavior~=timeline]").length)return document.title="Daily Progress",s=0,i=!1}),$(window).blur(function(){return i=!0}),bcx.on("page:update","show count in title when timeline changes",function(){var t;if($("[data-behavior~=timeline]").length){t=(new Date).getTime(),$("section.global_activity section.stream").find("article.event").each(function(n){var r,o,u;u=Date.parse($(this).find("time").attr("datetime")),o=t<u+e()+1e3,r=parseInt($(this).find("span.creator").attr("data-creator-id"));if(o&&r!==bcx.currentPerson.id){$(this).pulsate();if(i)return s+=1}});if(i&&s>0)return document.title="("+s+") Daily Progress"}}),o=null,e=function(){return bcx.progress.period=1e3*Math.min(30,5+4*Math.log(bcx.progress.idleCount+1))},t=function(){var n;return n=$("section.stream").find("article.event"),n.length&&($.support.cors?$.ajax({url:""+location.protocol+"//"+bcx.progressHost+"/"+bcx.currentAccountSlug+"/progress.js",type:"GET",data:{after:n.data("event-id"),since:n.data("datetime")},xhrFields:{withCredentials:!0},crossDomain:!0}):$.get("/progress.js",{after:n.data("event-id"),since:n.data("datetime")})),o=setTimeout(t,e())},n=function(){if(o==null)return bcx.progress={idleCount:0},t()},r=function(){if(o!=null)return clearTimeout(o),o=null},bcx.on("page:change","poll for timeline changes",function(){return $("[data-behavior~=timeline]").length?n():r()})}.call(this),function(){var e,t,n,r;$("[data-behavior~=access-toggle] select").live("change",function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d;return r=$(this),f=r.closest(".self").length>0,a=r.val()==="client_access",d=r.val()==="no_access"?"revoke":"grant",t=r.closest("[data-bucket-id]"),n=t.find(".indicator"),u=t.attr("data-group-type"),s=t.attr("data-bucket-id"),o=u==="project_template"?"project":u,p=t.closest("[data-person-id]").attr("data-person-id"),h="/"+o+"s/"+s+"/accesses",t.addClass("busy"),l=function(e,n,r){return t.removeClass("busy"),alert("The "+d+' operation failed. Please try again.\n\nThe error was "'+r+'" ('+n+")")},c=function(e,r,i){return f&&d==="revoke"?t.remove():(t.removeClass("busy"),n.toggleClass("active",d==="grant"),n.toggleClass("client",a===!0))},d==="grant"?(i=r.val()==="team_access"?{invitees:[{id:p}]}:{client_invitees:[{id:p}]},$.ajax(h,{data:i,type:"POST",error:l,success:c})):$.ajax(""+h+"/null?person_id="+p,{type:"DELETE",error:l,success:c})}),$("[data-behavior~=grant-all]").live("click",function(e){var t,n,r,i,s,o,u;return e.preventDefault(),i=$(this),s=i.attr("href"),r=i.data("group-type"),t=i.data("access-type"),n=$("table.accesses tr[data-group-type~="+r+"]"),n.addClass("busy"),o=function(e,t,r){return alert('Access could not be granted. Please try again.\n\nThe error was "'+r+'" ('+t+")"),n.removeClass("busy")},u=function(e,r,i){return n.removeClass("busy"),n.find("td.indicator").addClass("active"),t==="team"?(n.find("option[value=team_access]").prop("selected",!0),n.find("td.indicator").removeClass("client")):(n.find("option[value=client_access]").prop("selected",!0),n.find("td.indicator").addClass("client"))},$.ajax(s,{type:"POST",error:o,success:u})}),$("[data-behavior~=revoke-all]").live("click",function(e){var t,n,r,i,s,o,u;return e.preventDefault(),r=$(this),s=r.closest(".self").length>0,i=r.attr("href"),n=r.data("group-type"),t=$("table.accesses tr[data-group-type~="+n+"]"),t.addClass("busy"),o=function(e,n,r){return alert('Access could not be revoked. Please try again.\n\nThe error was "'+r+'" ('+n+")"),t.removeClass("busy")},u=function(e,n,r){return t.removeClass("busy"),t.find("td.indicator").removeClass("active client"),s?t.remove():t.find("option[value=no_access]").prop("selected",!0)},$.ajax(i,{type:"DELETE",error:o,success:u})}),bcx.on("page:update","install invitee field lists",function(){return $("form[data-behavior~=invite] [data-behavior~=invitees]").install("behavior for invitee fields",function(t){return t.each(function(e,t){return r(t)}),e()})}),r=function(e){var t;return t=new bcx.views.InviteeFieldList({el:e}),t.render(),t.focus(),$(e).data("view",t)},e=function(){var e;e=$("form[data-behavior~=invite]:not([data-behavior~=email-only]) [data-behavior~=invitees]");if(e.length>0)return e.addClass("loading"),$.getJSON("/invitees.json",function(t){return e.removeClass("loading"),e.each(function(){var e,n,r,i;(e=$(this).data("people",t).data("view"))!=null&&e.reload();if(((n=(r=document.activeElement)!=null?r.tagName:void 0)!=null?n:"BODY")==="BODY")return(i=$(this).data("people",t).data("view"))!=null?i.focus():void 0})})},$("article.access [data-behavior~=invite]").live("click",function(e){var t,n,r;r=$(this),t=r.closest("article.access"),n=t.find("[data-role~=invite_display]");if(r.is(".activated"))return;return r.data("deactivated_html",r.html()),r.html(r.attr("data-activated-text")),r.addClass("activated"),r.bind("ajax:success",function(e,t){var i,s;return r.unbind("ajax:success",arguments.callee),r.animate({opacity:0},150,"linear",function(){return r.html(r.data("deactivated_html")),r.removeClass("activated"),r.delay(1e3).animate({opacity:1},300,"linear")}),s=n.find("div:first-child"),i=s.clone(!0),i.find("time").replaceWith(t),n.append(i),s.delay(300).animate({"margin-top":-s.height()},300,"easeOutQuad",function(){return s.remove()})})}),$("article.access [data-behavior~=revoke_project_access]").live("ajax:before",function(e){var t,n;n=$(this),t=n.closest("article.access");if(n.is(".activated"))return;return n.data("deactivated_html",n.html()),n.html(n.attr("data-activated-text")),n.addClass("activated"),n.bind("ajax:success",function(e,t){return n.unbind("ajax:success",arguments.callee),n.animate({opacity:0},150,"linear",function(){return n.html(n.data("deactivated_html")),n.removeClass("activated"),n.delay(1e3).animate({opacity:1},300,"linear")})})}),$("article.access [data-behavior~=revoke]").live("ajax:before",function(e){var t;return t=$(this).closest("article.access"),t.addClass("revoking")}),bcx.on("page:update",'apply "many" class to section.accesses',function(){var e;e=$("section.accesses > div.added");if(e.size()===0)return;return e.find("> article").size()>1?e.addClass("many"):e.removeClass("many")}),bcx.on("page:update","install superpower slider",function(){return $("[data-behavior~=slider]:visible").slider()}),$("[data-behavior~=invite] [data-behavior~=slider]").live("slider:slide",function(e){return $("form[data-behavior~=invite]").focus().blur()}),t=function(e){var t,n,r;return n=$("a[data-accesses-list='"+e+"']"),r=
$("section[data-accesses-list='"+e+"']"),t=$("a[data-accesses-list='client']").siblings("figure"),e==="client"?t.hide():t.show(),$("[data-behavior~=toggle_accesses_list]").removeClass("selected"),n.addClass("selected"),$("section[data-behavior~=accesses_list]").hide(),r.fadeIn(),r.find("[data-behavior~=slider]").slider(),r.find("figure").removeClass("initial_load")},n=function(){var e;if(!$("div.accesses_tabs a[data-accesses-list]").length)return;if(!window.location.hash)return t("team",!1);e=window.location.hash.slice(1);if(_.contains(["team","client"],e))return t(e)},$(window).on("hashchange",n),bcx.on("page:change","load project accesses list from hash",n),$("[data-behavior~=toggle_accesses_list]").live("stackerLinkClicked",function(){return!1})}.call(this),function(){$("[data-behavior~=confirm_opt_into_client_projects]").live("click",function(e){var t;return t=$(this).closest(".submit"),t.addClass("busy")}).live("ajax:success",function(e){var t;return t=$(this).closest(".submit"),t.removeClass("busy"),$("[data-behavior~=opt_into_client_projects]").hide(),$("[data-behavior~=clients_list]").show().removeClass("hidden")}),$("[data-behavior~=confirm_opt_out_of_client_projects]").live("click",function(e){var t;return t=$(this).closest(".submit"),t.addClass("busy")}).live("ajax:success",function(e){var t;return t=$(this).closest(".submit"),t.removeClass("busy"),$("[data-behavior~=clients_list]").hide().addClass("hidden"),$("[data-behavior~=opt_into_client_projects]").fadeIn()}),$("[data-behavior~=toggle_client_access_on]").live("click",function(e){var t,n;return t=$(this).closest("form[data-behavior~=create_project]"),t.find("[data-behavior~=is_client_project]").val(!0),n=$(this).closest("section[data-behavior~=accesses_list]"),n.addClass("client_access_on"),e.preventDefault()})}.call(this),function(){$("#publicize_toggle").live("beforeexpand",function(e){return $(this).closest("div.sheet").css({"padding-top":$(this).outerHeight()-10})}),$("#publicize_toggle").live("expand",function(e){return $("html").addClass("shaded")}),$("#publicize_toggle").live("collapse",function(e){return $("html").removeClass("shaded"),$(this).closest("div.sheet").css({"padding-top":""})}),$("form[data-behavior~=publicize]").live("submit",function(e){var t;return e.preventDefault(),t=$(this).closest("p"),t.addClass("busy")}).live("ajax:success",function(e){return $(document).trigger("client_projects:publicize"),$("[data-behavior~=toggle_private_visibility]").prop("checked",!1)}),$(document).bind("client_projects:editing",function(){var e;return e=$("div.sheet:not(.inactive)").addClass("editing")}),$(document).bind("client_projects:done_editing",function(){var e;return e=$("div.sheet:not(.inactive)").removeClass("editing")}),$(document).bind("client_projects:publicize",function(){var e,t,n,r,i,s,o,u,a,f;r=$("#publicize_toggle"),e=$("article.comment.new span.hidden_from_client"),n=r.find("[data-role~=visibility_status]"),n.html(n.attr("data-public-text")),r.collapse(),r.removeClass("private").addClass("success"),e.addClass("inactive"),t=$("[data-role~=privacy_explanation]"),t.hide(),u=$("[data-behavior~=subscriber_list]"),f=[];for(s=0,o=u.length;s<o;s++)i=u[s],f.push((a=$(i).data("view"))!=null?a.publicize():void 0);return f}),$(document).bind("client_projects:privatize",function(){var e,t,n,r,i,s,o,u,a;n=$("#publicize_toggle"),e=$("article.comment.new span.hidden_from_client"),t=n.find("[data-role~=visibility_status]"),t.html(t.attr("data-private-text")),n.collapse(),n.removeClass("success inactive").addClass("private"),e.removeClass("inactive"),o=$("[data-behavior~=subscriber_list]"),a=[];for(i=0,s=o.length;i<s;i++)r=o[i],a.push((u=$(r).data("view"))!=null?u.privatize():void 0);return a})}.call(this),function(){var e;bcx.on("page:update","watch unfinished exports",function(){return $("[data-behavior~=export_status]").each(function(){var t;t=$(this);if(t.data("status")==="processing"&&!t.data("watching"))return e(t)})}),$("[data-behavior=start_export]").live("click",function(t){var n;return t.preventDefault(),n=$(this).closest("[data-behavior~=export_status]"),n.attr("data-status","processing"),$.post($(this).data("url"),function(t){return n.data("url",t.url),e(n)})}),e=function(e){var t;return e.data("watching",!0),setTimeout(t=function(){return $.getJSON(e.data("url")).done(function(n){return function(n){var r,i;return n.status==="finished"?(n.chunks<2?(i=""+n.url+".zip",r="false"):(i=n.url,r="true"),e.find("[data-role=download]").attr("href",i).attr("data-stacker",r),e.attr("data-status","finished")):setTimeout(t,1e4)}}(this))},1e4)}}.call(this),function(){$("[data-behavior~=account_name]").live("expand",function(e){return $("input[type=text]").focus()}),$("form[data-behavior=migrate_account]").on("ajax:before",function(e){return $(this).addClass("busy")}),$(document).on("click","a[data-behavior=unlink_account]",function(e){return $(this).closest("span").addClass("busy")}),$("form[data-behavior~=change_plan]").on("ajax:before",function(e){return $(this).addClass("busy")}),$("form[data-behavior~=account_upgrade_form]").live("ajax:before",function(e){var t;return t=$(this).find("[data-role~=account_upgrade_submit]"),t.html(""),t.addClass("busy")}),$("[data-behavior~=account_upgrade_confirmation]").live("click",function(e){return $("[data-role~=account_upgrade_notice]").hide(),$("[data-role~=account_upgrade_wrapper]").fadeIn("fast"),!1}),$("form#demographic_survey").live("submit",function(e){return $.support.cors?$.post("https://dash.37signals.com/surveys.js",$(this).serialize(),function(){return window.location="/"+bcx.currentAccountSlug}):$(this).submit(),!1})}.call(this),function(){bcx.on("page:change","append a special class for IE",function(){var e;if($.browser.msie)return e=$('[data-role~="expandable_plan"]'),e.addClass("ie")}),$(document).on("click",'[data-role~="expandable_plan"]:not(.disqualified)',function(e){var t;return t=$(this).parents().eq(1).find("li"),t.removeClass("selected"),$(this).addClass("selected")}),$(document).on("change","[data-behavior~=disable_on_select]",function(){return $(this).parents("form").find("[data-role~=enabled_on_select]").hide(),$(this).parents("form").find("[data-role~=disabled_on_select]").show()}),$(document).on("change","[data-behavior~=enable_on_select]",function(){return $(this).parents("form").find("[data-role~=enabled_on_select]").show(),$(this).parents("form").find("[data-role~=disabled_on_select]").hide()}),$(document).on("click","[data-behavior~=pay_by_credit_card]",function(e){return $("[data-role~=pay_by_credit_card]").show(),$("[data-role~=pay_by_check]").hide(),e.preventDefault()}),$(document).on("click","[data-behavior~=pay_by_check]",function(e){return $("[data-role~=pay_by_check]").show(),$("[data-role~=pay_by_credit_card]").hide(),e.preventDefault()}),$(document).on("submit","form[data-behavior~=cc-form]",function(e){var t,n,r,i,s,o;r=$(this).find("input.cc-number"),i=$(this).find("input.cc-zip-code"),n=[],Queenbee.CreditCard.validateNumber(r.val())||n.push(r),Queenbee.CreditCard.validateZipCode(i.val())||n.push(i);if(n.length){for(s=0,o=n.length;s<o;s++)t=n[s],$(t).addClass("invalid");return e.preventDefault()}return $(this).addClass("busy").find(":submit").prop("disabled",!0),Queenbee.CreditCard.encryptForm(this)}),$(document).on("submit","[data-behavior~=check-form]",function(e){var t;return $(this).find(":input").removeClass("invalid"),t=$(this).find("input[data-required]").filter(function(){return $(this).val()===""}),t.length?(t.addClass("invalid"),t[0].focus(),e.preventDefault()):$(this).addClass("busy").find(":submit").prop("disabled",!0)}),$(document).on("input change","input[data-required].invalid",function(){if($(this).val()!=="")return $(this).removeClass("invalid")})}.call(this),function(){var e;bcx.watchCachingClassicProjects=function(){return setTimeout(function(){var e;if((e=$("[data-behavior~=caching_classic_projects]")).length)return $.getJSON(e.url()).done(function(t){if(e.is(":visible"))return t.caching_classic_projects?bcx.watchCachingClassicProjects():window.location.reload()})},5e3)},e=function(e){var t,n;if(!e.hasClass("import_in_progress"))return;return t=e.attr("data-import-url"),setTimeout(n=function(){return $.getJSON(t).done(function(t){return t.finished_at?(e.find("[data-status=finished] a").attr("href","/"+bcx.currentAccountSlug+"/projects/"+t.project_id),e.removeClass("import_in_progress").addClass("import_finished")):t.started_at==null?e.removeClass("import_in_progress").addClass("import_error"):setTimeout(n,5e3)})},5e3)},bcx.ensureCurrentAccountCanImportProjects=function(){return bcx.currentAccount.canCreateProjects()?($("[data-behavior~=can-create-project-imports]").show(),$("[data-behavior~=cant-create-project-imports]").hide()):($("[data-behavior~=can-create-project-imports]").hide(),$("[data-behavior~=cant-create-project-imports]").show())},$(document).on("click","[data-behavior~=start_import]",function(t){var n;return n=$(this).closest("article"),n.removeClass("import_available").addClass("import_in_progress").collapse(),$.ajax({type:"POST",url:n.attr("data-import-url")}).success(function(t){return e(n),bcx.currentAccount.fetch({success:bcx.ensureCurrentAccountCanImportProjects})}).fail(function(e){return n.removeClass("import_in_progress").addClass("import_error")}),t.preventDefault()}),$("div.project_imports article.project[data-behavior~=expandable]").on("expand",function(e){return $(this).slideIntoView({duration:"slow"})}),$(document).on("page:update",function(){return bcx.ensureCurrentAccountCanImportProjects(),$("article.project.import_in_progress").install("watch import progress",function(t){return e(t)})})}.call(this),function(){var e;e=function(e){if(e.keyCode===$.ui.keyCode.ENTER)return e.preventDefault(),$("textarea.body").focus()},$("article.announcement.edit textarea:first, article.message.edit textarea:first").live("keypress",e),$("article.announcement.new").live("expand",function(t){var n;return n=$(this).find("textarea").first(),n.focus(),n.bind("keypress",e)}).live("collapse",function(e){return $(this).find("form").resetForm(),$(this).find("[data-behavior~=wysiwyg_toolbar]").hide()}).live("wysiwyg:focus",function(e){return $(this).find("[data-behavior~=wysiwyg_toolbar]").slideDown("fast")}),bcx.on("page:change","remove new features flag",function(){if($("[data-behavior~=remove_new_features_flag]").length)return $(".announcements_link").remove(),$("nav").removeClass("has_announcements")})}.call(this),function(){$.fn.removeAttachment=function(e){var t;return this.hasClass("result")?this.fadeOutAndRemove():(t=this.find("[data-role=content_container]"),t.data("contents",t.html()),t.html(e)),this},$.fn.restoreAttachment=function(){var e;return e=this.find("[data-role=content_container]"),e.html(e.data("contents")),this},bcx.on("page:change","annotate active sheet with file_drop_target behavior attribute",function(){return $("div.sheet:not(.inactive) [data-behavior~=file_drop_target]").size()===0?$("html").removeBehavior("file_drop_target"):$("html").addBehavior("file_drop_target")}),$("article[data-behavior~=file_drop_target]").live("file:drop",function(e,t){return Beanstalk.logEvent("fileAttached","byDragToMessage"),$(this).find("form").attachFiles(t),$(this).expand(),e.stopPropagation()}),$("div.sheet.project > div.sheet_body .has_buttons button").live("file:drop",function(e,t){return Beanstalk.logEvent("fileAttached","byDragToMessage"),$(this).closest("section").find("form").attachFiles(t),$(this).closest("section").find("article.new").expand(),e.stopPropagation()}),$("html").live("file:drop",function(e,t){var n;return Beanstalk.logEvent("fileAttached","byDragToWindow"),$("article.new.expanded").length>0?n=$("article.new.expanded"):$("article.upload.new").length>0?n=$("article.upload.new"):$("article.message.new").length>0?n=$("article.message.new"):$("article.comment.new").length>0&&(n=$("article.comment.new")),n.show().expand().slideIntoView({duration:"slow"}),n.find("form").attachFiles(t)}),$(".file_input_button input").live("click",function(){return Beanstalk.logEvent("fileAttached","byManualSelection")}),$(document).on("click","[data-behavior~=direct_download]",function(){return window.location.href=$(this).attr("data-download-path"),!1})}.call(this),function(){var e,t,n,r,i,s,o,u,a;bcx.on("enlarger:install enlarger:activate","activate audio/video/pdf embed",function(){return $("audio, video").each(function(){return this.pause()}),$("figure:visible [data-behavior~=attachment_embed]").install("activate embed",function(t){return t.data("type")==="pdf"?n(t):e(t)})}),bcx.on("enlarger:beforeuninstall","deactivate audio/video embed, clear src to stop in-progress downloads",function(){return $("#enlarger audio, #enlarger video").each(function(){return this.pause(),this.src=""})}),e=function(e){var n,r,i;return u(e),i=e.data("type"),r=e.data("file-url"),e.html("<"+i+" width='600' height='400' controls src='"+r+"'/>"),n=e.find(i),n.on("loadedmetadata",function(){if($(this).is("video")&&o($(this)))return $(this).trigger("error")}),n.on("canplay",function(){a(e),$(this).is("video")&&Beanstalk.logEvent("videoEmbed","succeeded");if($(this).is(":visible"))return this.play()}),n.on("error",function(){$(this).is("video")&&Beanstalk.logEvent("videoEmbed","failed");if(!s(n))return t(e)})},o=function(e){return e.prop("videoWidth")===0||e.prop("videoHeight")===0},s=function(e){var t;return((t=e.get(0).error)!=null?t.code:void 0)!=null===2},n=function(e){var n;return $.support.pdf?(n=e.data("file-url"),e.html("<object data='"+n+"' width='100%' height='100%' frameborder='0'></object>"),a(e)):t(e)},t=function(e){var t;return r(e),t=e.closest("figure").find("[data-behavior~=embed_failed]"),t.prev().data("thumbnail")&&t.show(),e.remove()},u=function(e){return e.closest("figure").find("[data-behavior~=embed_loading]").show()},r=function(e){return e.closest("figure").find("[data-behavior~=embed_loading]").hide()},i=function(e){return e.closest("figure").find("img[data-role~=enlarged]").hide()},a=function(e){return i(e),r(e),e.removeClass("hidden")}}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g=function(e,t){return function(){return e.apply(t,arguments)}},y={}.hasOwnProperty,b=function(e,t){function r(){this.constructor=e}for(var n in t)y.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};a=null,i=function(){var e;if(e=window.location.search.match(/enlarge=(\d+)/))return e[1]},u=function(){var e,t;if(t=i()){e=$("[data-behavior~=enlargeable][data-attachment-id="+t+"]");if(e.length)return e.click()}},o=function(e){return e==null&&(e=!1),a!=null&&a.uninstall({pushState:e,withAnimation:!1}),!0},bcx.closeEnlarger=function(){return o(!0)},"pushState"in window.history&&$(window).bind("popstate",function(e){if(!u())return e.originalEvent.state==="enlarger"?Stacker.workspace.visit(window.location.toString(),{defaultStack:!0}):o()}),$(document).ready(u),bcx.on("workspace:visit",o),$("[data-behavior~=enlargeable]").live("click",function(e){var t,r,i,s;if(e.metaKey)return;if(e.altKey&&(r=$(this).find("[data-behavior~=direct_download")).length)return r.click(),!1;t=$(this).is("img")?$(this):$(this).find("img"),i=t.closest("section, html");if(s=t.data("attachment-id"))(a!=null?a.installed:void 0)&&a.doesContain(s)?a.activate(s):a=new n({activeattachmentId:s,$thumbnails:i.find("img[data-container-id="+t.data("container-id")+"]")});return!1}),$(document).on("click","[data-behavior~=enlargeable_trigger]",function(e){return $(this).addClass("active"),$(this).closest(".todo").find("[data-behavior~=enlargeable]:first").click(),!1}),n=function(t){function i(e){var t,n,r;e==null&&(e={}),this.didClickEnlarger=g(this.didClickEnlarger,this),t=e.$thumbnails,n=e.activeattachmentId,this.initialPath=Stacker.normalizePath(window.location.toString()),this.attachments=function(){var e,n,i;i=[];for(e=0,n=t.length;e<n;e++)r=t[e],i.push(c($(r)));return i}(),this.activate(n),this.install()}var n;return b(i,t),i.prototype.bind=function(){var e;return e=$(this.el),e.on("click","[data-behavior~=activate]",function(e){return function(t){return t.preventDefault(),$(t.target).is("img")?e.activate($(t.target).data("attachment-id")):e.activate($(t.target).find("img").data("attachment-id"))}}(this)),e.on("click","[data-behavior~=scroll_forward]",function(e){return function(t){if(!$(t.target).is("[disabled]"))return e.nav.scrollForward()}}(this)),e.on("click","[data-behavior~=scroll_reverse]",function(e){return function(t){if(!$(t.target).is("[disabled]"))return e.nav.scrollReverse()}}(this)),e.on("click","[data-behavior~=toggle_dialog]",function(e){return function(t){return t.preventDefault(),t.stopPropagation(),e.toggleDialog($(t.target).data("dialog"))}}(this)),e.on("click",this.didClickEnlarger),$(document).bind("keydown.enlarger",function(e){return function(t){if($(t.target).is(":input")||t.metaKey)return;switch(t.which){case $.ui.keyCode.ESCAPE:return e.uninstall(),t.preventDefault();case $.ui.keyCode.RIGHT:return e.next(),t.preventDefault();case $.ui.keyCode.LEFT:return e.previous(),t.preventDefault();case $.ui.keyCode.UP:return t.preventDefault();case $.ui.keyCode.DOWN:return t.preventDefault()}}}(this)),$(window).bind("resize.enlarger",function(e){return function(t){return e.resize()}}(this))},i.prototype.unbind=function(){return $(document).unbind(".enlarger"),$(window).unbind(".enlarger")},i.prototype.install=function(){var e,t;return this.insert(),v(this.el),this.resize(),this.bind(),this.activateShade(),$(this.el).removeClass("visible"),e=f(this.el),t=l(this.active),m($(this.active.imgInPage),{$from:t,$to:e,easing:"ease-out"},function(e){return function(t){return t.css("z-index",-1),t.remove(),$(e.el).addClass("visible")}}(this)),bcx.trigger("enlarger:install"),this.installed=!0},i.prototype.uninstall=function(e){var t,n,r;e==null&&(e={});if(!this.installed)return;return bcx.trigger("enlarger:beforeuninstall"),e.pushState!==!1&&this.pushState(this.initialPathWithoutEnlarged()),this.unbind(),t=f(this.el),r=l(this.active),n=$.extend({},{$from:t.show(),$to:r},e),m($(this.active.imgInPage),n,function(e){return function(e){return e.css("z-index",-1),e.remove()}}(this)),$("[data-behavior=enlargeable_trigger].active").removeClass("active"),this.remove(),this.deactivateShade(),this.installed=!1},i.prototype.initialPathWithoutEnlarged=function(){return this.initialPath.replace(/enlarge=\d+/,"").replace(/\?$/,"")},i.prototype.activate=function(e){var t;if(((t=this.active)!=null?t.attachmentId:void 0)===e)return;return this.active=_(this.attachments).detect(function(t){return t.attachmentId===e}),this.pushState(),this.loadDetails(),this.installed&&this.redraw(),bcx.trigger("enlarger:activate")},i.prototype.pushState=function(e){e==null&&(e=this.active.permaPath);if("pushState"in window.history&&Stacker.normalizePath(e)!==Stacker.normalizePath(window.location.toString()))return window.history.pushState("enlarger",null,e)},i.prototype.loadDetails=function(){if(this.active.trashed)return;return _.defer(function(e){return function(){var t;t=$(e.el).find("aside[data-role=details_"+e.active.attachmentId+"]:not([data-details-loaded])");if(t.length)return t.attr("data-details-loaded",!0),$.get(e.active.detailsPath,function(e){return t.html(e)})}}(this))},i.prototype.didClickEnlarger=function(e){var t;t=$(e.target);if(!t.closest("div.image_wrapper").length&&!t.is("a, [data-behavior]"))return this.uninstall()},i.prototype.doesContain=function(e){return _.detect(this.attachments,function(t){return t.attachmentId===e})},i.prototype.next=function(){if(this.attachments.length>1)return this.activate((this.attachments[this.attachments.indexOf(this.active)+1]||this.attachments[0]).attachmentId),this.nav.scrollActivatedThumbnailIntoView()},i.prototype.previous=function(){if(this.attachments.length>1)return this.activate((this.attachments[this.attachments.indexOf(this.active)-1]||this.attachments[this.attachments.length-1]).attachmentId),this.nav.scrollActivatedThumbnailIntoView()},i.prototype.renderEnlargedAttachment=function(e){var t,n,r,i;return n=(r=e.largeWidth)!=null?r:e.width,t=(i=e.largeHeight)!=null?i:e.height,'<img class="enlarged" data-role="enlarged" src="'+e.thumbnailSrc+'" data-large-src="'+e.largeSrc+'" data-original-src="'+e.originalSrc+'" data-thumbnail="'+e.thumbnail+'" width="'+n+'" height="'+t+'">'},i.prototype.getEmbedDimensions=function(e){return e.thumbnail?e:n(e.contentType)},n=function(e){switch(!1){case!/audio/.test(e):return{width:500,height:80};case!/video/.test(e):return{width:600,height:360};case!/pdf/.test(e):return{width:2880,height:1800}}},i.prototype.render=function(){return JST["desktop/templates/enlarger"]({attachments:this.attachments,active:this.active,pluralize:this.pluralize,renderEnlargedAttachment:this.renderEnlargedAttachment,getEmbedDimensions:this.getEmbedDimensions})},i.prototype.insert=function(){return $("html").append(this.render()),this.el=$("#enlarger")[0],this.nav=new r($(this.el).find("nav:first")[0]),this.nav.center($(this.el).find("nav img.activated")),this.loadActiveAttachment()},i.prototype.resize=function(){return d(this.el),this.nav.resize()},i.prototype.redraw=function(){var e;return $(this.el).find("figure:visible").hide(),$(this.el).find("#enlarged_attachment"+this.active.attachmentId).show(),$(this.el).find("nav img.activated").removeClass("activated"),$(this.el).find("nav img[data-attachment-id="+this.active.attachmentId+"]").addClass("activated"),(e=this.dialog)!=null&&e.deactivate(),this.loadActiveAttachment()},i.prototype.toggleDialog=function(t){var n;return((n=this.dialog)!=null?n.isActive():void 0)?this.dialog.deactivate():(this.dialog=function(){switch(t){case"delete":return new e(this.active,this.el)}}.call(this),this.dialog.activate())},i.prototype.remove=function(){return $(this.el).remove()},i.prototype.activateShade=function(){return $("html").addClass("shaded")},i.prototype.deactivateShade=function(){return $("html").removeClass("shaded")},i.prototype.loadActiveAttachment=function(){var e,t;if(this.loadingImage)return;if(!(e=f(this.el)).is("img"))return;return t=e.data("large-src")||e.data("original-src"),this.loadingImage=new Image,this.loadingImage.onload=function(n){return function(){return e.attr("src",t),n.loadingImage=null}}(this),this.loadingImage.onerror=function(e){return function(){return e.loadingImage=null}}(this),this.loadingImage.src=t},i}(bcx.View),r=function(){function e(e){this.el=$(e),this.updateScrollButtons(),this.resize()}return e.prototype.getView=function(){return $(this.el).find("[data-behavior~=scroll_view]:first")},e.prototype.getContent=function(){return $(this.el).find("[data-behavior~=scroll_content]:first")},e.prototype.activateScrollButton=function(e){return $(this.el).find("[data-behavior~=scroll_"+e+"]").addClass("active")},e.prototype.deactivateScrollButton=function(e){return $(this.el).find("[data-behavior~=scroll_"+e+"]").removeClass("active")},e.prototype.enableScrollButton=function(e){return $(this.el).find("[data-behavior~=scroll_"+e+"]").attr("disabled",!1)},e.prototype.disableScrollButton=function(e){return $(this.el).find("[data-behavior~=scroll_"+e+"]").attr("disabled",!0)},e.prototype.scrollForward=function(){return this.activateScrollButton("forward"),this.scroll(this.distanceToEnd())},e.prototype.scrollReverse=function(){return this.activateScrollButton("reverse"),this.scroll(this.distanceToStart())},e.prototype.scrollActivatedThumbnailIntoView=function(){var e,t,n,r,i,s,o,u;t=this.getView(),e=$(this.el).find("img.activated"),u=h(t),i=h(e),s=u.left,o=u.left+u.width,n=i.left-i.width,r=i.left+i.width+i.width,n<s&&this.scroll(n-s);if(r>o)return this.scroll(r-o)},e.prototype.center=function(e){var t,n;if(this.scrolling())return n=this.centerPositionFor(e),n=Math.max(this.maxScrollPosition(),n),n=Math.min(this.minScrollPosition(),n),t=this.getContent(),t.css({left:n}),this.updateScrollButtons()},e.prototype.centerPositionFor=function(e){var t,n;return t=this.getView(),n=e.position().left+e.width()/2,-n+t.width()/2},e.prototype.maxScrollPosition=function(){var e,t;return t=this.getView(),e=this.getContent(),t.width()-e.width()},e.prototype.minScrollPosition=function(){return 0},e.prototype.scroll=function(e){var t,n,r,i,s;return t=this.getContent(),r=parseInt(t.css("left")),n=this.adjustedDistance(e),i=e>0?-1:1,s=r+n*i,s=Math.max(this.maxScrollPosition(),s),s=Math.min(this.minScrollPosition(),s),t.animate({left:s},function(e){return function(){return e.updateScrollButtons()}}(this))},e.prototype.updateScrollButtons=function(){return this.deactivateScrollButton("reverse"),this.deactivateScrollButton("forward"),this.distanceToEnd()===0?this.disableScrollButton("forward"):this.enableScrollButton("forward"),this.distanceToStart()===0?this.disableScrollButton("reverse"):this.enableScrollButton("reverse")},e.prototype.resize=function(){var e;return e=this.getView(),this.scrolling()?e.addClass("scrolling"):e.removeClass("scrolling")},e.prototype.scrolling=function(){var e,t;return t=this.getView(),e=this.getContent(),t.width()<e.width()},e.prototype.distanceToEnd=function(){var e,t,n,r,i,s;return t=this.getView(),e=this.getContent(),s=t.width(),r=e.width(),n=parseInt(e.css("left")),i=r+n-s,Math.max(i,0)},e.prototype.distanceToStart=function(){var e;return e=this.getContent(),parseInt(e.css("left"))},e.prototype.adjustedDistance=function(e){return Math.min(this.maxScrollDistance(),Math.abs(e))},e.prototype.maxScrollDistance=function(){var e;return e=this.getView(),Math.floor(e.width()*.5)},e}(),f=function(e){return $(e).find("figure:visible [data-role~=enlarged]")},l=function(e){var t;return t=$("[data-behavior=enlargeable_trigger].active"),t.length?t:$(e.imgInPage)},d=function(e){var t,n;return t=$(e).find("figure:visible"),n={height:t.height(),width:t.width()-t.find("aside").outerWidth(!0)},$(e).find("[data-role~=enlarged]").each(function(){var e;return e=$(this),e.css(p(e,n))})},v=function(e){var t,n;return t=$(e).find("nav img"),n={height:t.css("max-height"),width:t.css("max-width")},t.each(function(){var e;return e=$(this),e.css(p(e,n))})},c=function(e){var t,n,r;return t={imgInPage:e.get(0),thumbnailSrc:e.attr("src"),width:(n=e.attr("width"))!=null?n:e.data("width"),height:(r=e.attr("height"))!=null?r:e.data("height"),isReadOnly:$("div.sheet[data-behavior~=read_only]").length},_.defaults(e.data(),t)},p=function(e,t){var n,r,i,s,o,u,a,f;s=parseInt(e.attr("width")||e.data("width")),r=parseInt(e.attr("height")||e.data("height")),a=parseInt(t.width),o=parseInt(t.height),i=s/r,u=a/o,f=s,n=r;if(f>a||n>o)e.hasClass("pdf")||e.hasClass("doc_preview")?(f=a<400?400:a,n=o):i>u?(f=a,n=parseInt(f/i)):(n=o,f=parseInt(n*i));return{width:f,height:n}},m=function(e,t,n){var r,i,o,u;t==null&&(t={}),u=h(t.$from||e),i=h(t.$to||window),r=s(e),r.css(u);if(t.withAnimation===!1){typeof n=="function"&&n(r);return}return $("html").append(r),o=200,"onwebkittransitionend"in window?(r.one("webkitTransitionEnd",function(){return typeof n=="function"?n(r):void 0}),setTimeout(function(){return r.trigger("webkitTransitionEnd")},o*2),_.defer(function(){return r.css(_.extend(i,{"-webkit-transition-property":"left right width height","-webkit-transition-animation":"ease-out","-webkit-transition-duration":""+o+"ms"}))})):r.animate(i,o,"easeOutQuad",function(){return typeof n=="function"?n(r):void 0})},s=function(e){var t,n,r;if(e.hasClass("file_icon")){if(this.loadingIcon)return;n=e.data("large-src"),r="hidden",this.loadingIcon=new Image,this.loadingIcon.onload=function(e){return function(){return t.css({visibility:"visible"}),e.loadingIcon=null}}(this),this.loadingIcon.onerror=function(e){return function(){return e.loadingIcon=null}}(this),this.loadingIcon.src=n}return t=e.clone().attr("data-behavior","").attr("src",n).css({"-webkit-transform":"translate3D(0,0,0)",border:"none",visibility:r,padding:0,position:"fixed",zIndex:2e3})},h=function(e){var t,n,r,i,s,o,u,a,f,l,c;return i=e.offset(),t=parseInt((a=e.css("border-left-width"))!=null?a:0),s=parseInt((f=e.css("border-top-width"))!=null?f:0),n=parseInt((l=e.css("padding-left"))!=null?l:0),o=parseInt((c=e.css("padding-top"))!=null?c:0),r=$(window).scrollLeft(),u=$(window).scrollTop(),{left:i.left+t+n-r,top:i.top+s+o-u,width:e.width(),height:e.height()}},t=function(){function e(e,t){this.attachment=e,this.$figure=$(t).find("#enlarged_attachment"+this.attachment.attachmentId),this.$container=this.$figure.find("[data-role~=dialog]"),this.$enlarged=this.$figure.find("[data-role~=enlarged]")}return e.prototype.activate=function(){},e.prototype.deactivate=function(){if(this.isActive())return this.animateOut()},e.prototype.animateIn=function(){return this.$enlarged.transition({opacity:.5}),this.$container.find("article").show()},e.prototype.animateOut=function(){return this.$enlarged.transition({opacity:1}),this.$container.html(""),this.$container.find("article").hide()},e.prototype.isActive=function(){return this.$container.html()},e}(),e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return b(t,e),t.prototype.activate=function(){return this.$container.html(this.$figure.find("[data-role~=delete_dialog]").html()),this.animateIn()},t}(t)}.call(this),function(){var e,t,n,r,i,s,o,u,a,f=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t=null,e=null,a="[data-behavior~=file_drop_target]",i=0,$(window).bind("dragenter",function(n){var u,f;r(n);if(!s(n))return;u=$(n.target).closest(a);if(!u.length)return;return u.is(t)?i++:(o(),i=1,f=u.dispatch("file:dragenter"),t=u,e=f.isDefaultPrevented()?null:u)}),$(window).bind("dragover",function(e){return r(e)}),$(window).bind("dragleave",function(e){var n;r(e),n=$(e.target).closest(a);if(!n.length)return;if(n.is(t)&&--i===0)return o()}),$(window).bind("drop",function(n){var i;r(n);if(!s(n))return;i=$(n.target).closest(a);if(!i.length)return;if(i.is(e))return i.trigger("file:drop",[_(n.originalEvent.dataTransfer.files).toArray()]),i.trigger("file:dragleave"),t=null,e=null}),$(document).bind("page:update expand",function(){return _.defer(function(){return $(""+a+" iframe").install("behavior for dropping files on an iframe",function(e){return e.each(function(){var e,t,r;try{e=$(this),r=e.attr("src");if(!r||RegExp("^"+window.location.origin).test(r))return t=e.closest(a),e.contents().bind("dragenter",function(t){if(!s(t))return;return n(e)}),t.bind("file:dragenter",function(){return n(e)}),t.bind("file:drop file:dragleave",function(){return u(t)})}catch(i){}})})})}),o=function(){if(t)return t.trigger("file:dragleave"),t=null,e=null},s=function(e){var t,n;return f.call((t=(n=e.originalEvent.dataTransfer)!=null?n.types:void 0)!=null?t:[],"Files")>=0},r=function(e){return e.stopPropagation(),e.preventDefault()},n=function(e){var t,n,r,i,s,o;return r=1,i=e.position(),n=i.left-r,s=i.top-r,o=e.outerWidth()+r*2,t=e.outerHeight()+r*2,i="absolute",e.before($('<div class="iframe_blanket">').css({left:n,top:s,width:o,height:t,position:i}))},u=function(e){return e.find(".iframe_blanket").remove()}}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;n="677854858412",r={client_id:n,scope:"https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/userinfo.email"},b=null,k="document kix spreadsheet ritz drawing presentation punch form freebird".split(" "),g=_(k).map(function(e){return"application/vnd.google-apps."+e}),i=function(e,t){var n,i;return n=_.extend({immediate:e},r),e?(i=L().id)&&_.extend(n,{user_id:i,authuser:!1}):_.extend(n,{approval_prompt:"force",max_auth_age:0,user_id:!1}),gapi.auth.authorize(n,function(e){return N(),typeof t=="function"?t():void 0})},f=function(){var e;if(e=d())w(e),gapi.auth.setToken(null);return b!=null&&b.setVisible(!1),b=null},d=function(){var e;return(e=gapi.auth.getToken())!=null?e.access_token:void 0},w=function(e){return $.getJSON("https://accounts.google.com/o/oauth2/revoke?token="+e)},L=function(e){var t,n;return t="google:userinfo",e?bcx.storage.set(t,e):e===null?bcx.storage.unset(t):(n=bcx.storage.get(t))!=null?n:{}},c=function(e){return gapi.client.load("oauth2","v2",function(){return gapi.client.oauth2.userinfo.get().execute(function(t){if(t!=null)return e(t)})})},N=function(){return d()?c(function(e){if(L().id!==e.id){L({id:e.id,email:e.email});if(L().id)return $(document).trigger("google:userchange")}}):L(null)},u=function(){return d()?gapi.load("picker",function(){return $("div.picker, iframe.picker").remove(),b=s(),b.setVisible(!0),t(),h()}):i(!1,function(){return d()?u():x()})},C=function(){return f(),u(),Beanstalk.logEvent("GooglePicker","switchAccount")},y=function(t){var n,r,i,s;switch(t.action){case google.picker.Action.PICKED:s=t.docs;for(r=0
,i=s.length;r<i;r++)n=s[r],n.fileId=n.id;return e.attachGoogleDocs(t.docs)}},s=function(){return(new google.picker.PickerBuilder).setAppId(n).setOAuthToken(gapi.auth.getToken().access_token).setTitle("Attach a file from Google").addView((new google.picker.DocsView).setIncludeFolders(!0).setMimeTypes(g)).enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setCallback(y).build()},l=function(e,t){return gapi.client.load("drive","v2",function(){return gapi.client.drive.files.get({fileId:e}).execute(function(e){return t(e)})})},a=function(e){var t,n,r,s;return s=$(e).data(),t=s.fileId,n=s.fileUrl,r=new bcx.views.GoogleDocPreview({el:e}),r.google={isAuthorized:d,authorize:i,deauthorize:f,fetchMetadata:l,fileId:t,fileUrl:n},r.render()},h=function(){var e;e=$("div.picker-dialog:visible");if(e.offset().top+e.outerHeight()-$(window).height()+$(window).scrollTop()>0)return e.css({top:$(window).scrollTop()+($(window).height()-e.outerHeight())/2})},S=function(){return $("div.picker-dialog:visible [data-role~=picker_account_email]").html(L().email)},t=function(){var e;return e="picker_account_switcher",$("div.picker-dialog:visible").prepend($("[data-behavior~="+e+"]").clone().removeBehavior(e)),S()},T=function(){return d()?u():$("[data-behavior~=google_connector]").show().addClass("active")},x=function(){return $("[data-behavior~=google_connector_access_denied]").show().addClass("active")},p=function(){return $(".google_connector").hide().removeClass("active")},e=null,$(document).on("click","[data-behavior~=google_file_picker]",function(){return e=$(this),T(),!1}),$(document).on("click","[data-behavior~=create_google_file_picker]",function(){return u(),p(),!1}),$(document).on("click","[data-behavior~=google_account_switcher]",function(e){return C(),!1}),$(document).on("click","[data-behavior~=cancel_google_connect]",function(e){return p(),!1}),$(document).on("google:userchange",function(){return S(),$("[data-behavior~=google_doc_preview]").trigger("reset")}),bcx.on("enlarger:install enlarger:activate","load google doc previews",function(){return $("[data-behavior~=google_doc_preview]:visible").install("google doc views",function(e){return A(function(){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(a(t));return i})})}),bcx.on("page:update","load google client",function(){return $("[data-behavior~=load_google_client]").install("load google client",function(e){return A(function(){return e.fadeIn("fast")})})}),E=!1,m=!1,o=[],A=function(e){return m?e():(o.push(e),v())},v=function(){typeof gapi!="undefined"&&gapi!==null&&googleClientLoaded();if(!E)return E=!0,$("<script>").attr("src","https://apis.google.com/js/client.js?onload=googleClientLoaded").appendTo("head")},this.googleClientLoaded=function(){var e;return e=function(){var e;m=!0,e=[];while(o.length)e.push(o.shift().call());return e},d()?e():i(!0,e)}}.call(this),function(){var e,t;$.fn.scaleImages=function(){return this.find("figure.proportional img[data-width][data-height]:not([data-scaled]):visible").each(function(){var n,r,i,s,o,u,a;return n=$(this),a=e(n),u=a[0],r=a[1],i=a[2],u>r?(o=Math.min(i,u),s=parseInt(o*r/u)):(s=Math.min(i,r),o=parseInt(s*u/r)),t(n,o,s)}),this.find("figure.full_width img[data-width][data-height]:not([data-scaled]):visible").each(function(){var n,r,i,s,o,u,a;return n=$(this),a=e(n),u=a[0],r=a[1],i=a[2],o=Math.min(i,u),s=parseInt(o*r/u),t(n,o,s)}),this.find("div.grid_view:not([data-scaled])").each(function(){var e,t,n;return e=$(this),t=e.attr("data-columns"),n=e.find("div.cell:first").width(),e.find("div.cell:nth-child("+t+"n+1)").each(function(){var e,r;return e=$(this),e.find("figcaption").css({width:n}),e.nextAll(":lt("+(t-1)+")").find("figcaption").css({width:n}),r=[],e.find("div.background").each(function(){return r.push($(this).height())}),e.nextAll(":lt("+(t-1)+")").find("div.background").each(function(){return r.push($(this).height())}),e.find("div.background").css({height:_(r).max(),width:n}),e.nextAll(":lt("+(t-1)+")").find("div.background").css({height:_(r).max(),width:n})}),e.attr("data-scaled",!0)}),this},bcx.on("page:update","scale images",function(){return $("[data-role=project_dates]").length?_.defer(function(){return $(document).scaleImages()}):$(document).scaleImages()}),e=function(e){return[parseInt(e.data("width")),parseInt(e.data("height")),e.closest("figure").width()]},t=function(e,t,n){var r,i;if(r=parseInt(e.data("max-size")))i=Math.max(1,t/r,n/r),t=Math.round(t/i),n=Math.round(n/i);return e.css({width:t,height:n}),e.attr("data-scaled",!0)},bcx.rescaleImages=function(){return $("[data-scaled]").removeAttr("data-scaled"),$(document).scaleImages()}}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};e=function(e){function n(){return this.populateName=t(this.populateName,this),this.basenameKeyPressed=t(this.basenameKeyPressed,this),this.selectBasename=t(this.selectBasename,this),n.__super__.constructor.apply(this,arguments)}return r(n,e),n.install=function(e){return _(new this({el:e})).tap(function(e){return e.install()})},n.prototype.initialize=function(){return this.$form=this.$el.closest("form"),this.$basename=this.$("[data-role~=basename]"),this.$name=this.$("input[data-role~=name]")},n.prototype.install=function(){var e;return this.extname=(e=this.$name.data("extname"))!=null?e:"",this.originalBasename=this.$basename.val(),this.$basename.on("mousedown",this.selectBasename).on("keydown",this.basenameKeyPressed).on("keyup",this.populateName).autosizeInput({space:0}),this.instrument()},n.prototype.instrument=function(){var e;return e=this.$el.closest("[data-behavior~=pending_attachments]").length?"asPendingAttachment":"asStandalone",this.$form.on("submit",function(t){return function(){if(t.$basename.val()!==t.originalBasename)return Beanstalk.logEvent("fileRenamed",e)}}(this))},n.prototype.selectBasename=function(e){if(!this.$basename.is(":focus"))return e!=null&&e.preventDefault(),this.$basename.focus().select()},n.prototype.basenameKeyPressed=function(e){switch(e.keyCode){case $.ui.keyCode.ENTER:return this.$basename.blur();case $.ui.keyCode.ESCAPE:return this.reset()}},n.prototype.populateName=function(){var e;return e=this.$basename.val(),this.$name.val(""+e+this.extname)},n.prototype.reset=function(){return this.$basename.val(this.originalBasename).blur(),this.populateName()},n}(bcx.View),bcx.on("page:change","install attachment name editor",function(){return _.defer(function(){return $("[data-behavior~=attachment_name_editor]").each(function(){return e.install(this).selectBasename()})})}),$("[data-behavior~=pending_attachments]").live("attachment:add",function(t){return e.install(t.target)})}.call(this),function(e){var t={EventEmitter:function(){}},n=e.EventEmitter=t.EventEmitter,r=Array.isArray;n.prototype.emit=function(e){if(e==="error")if(!this._events||!this._events.error||r(this._events.error)&&!this._events.error.length)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if(typeof t=="function"){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return!0}if(r(t)){var n=Array.prototype.slice.call(arguments,1),i=t.slice();for(var s=0,o=i.length;s<o;s++)i[s].apply(this,n);return!0}return!1},n.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");return this._events||(this._events={}),this.emit("newListener",e,t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){var n=this;n.on(e,function r(){n.removeListener(e,r),t.apply(this,arguments)})},n.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var n=this._events[e];if(r(n)){var i=n.indexOf(t);if(i<0)return this;n.splice(i,1),n.length==0&&delete this._events[e]}else this._events[e]===t&&delete this._events[e];return this},n.prototype.removeAllListeners=function(e){return e&&this._events&&this._events[e]&&(this._events[e]=null),this},n.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),r(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}(typeof exports=="undefined"?window:exports),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function r(){this.constructor=e}for(var n in t)m.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};u=function(){function e(){this.process=v(this.process,this),this.pendingAttachments=[]}return e.prototype.queue=function(e){return this.pendingAttachments.push(e),e.on("end",this.process),e.on("error",this.process),setTimeout(this.process,1)},e.prototype.remove=function(e){return this.pendingAttachments=_(this.pendingAttachments).without(e),e.stop()},e.prototype.process=function(){var e,t;if(((e=this.processing)!=null?e.state:void 0)==="uploading")return;return this.processing=this.pendingAttachments.shift(),(t=this.processing)!=null?t.start():void 0},e}(),e=function(e){function t(e){this.file=e,this.initialize(),t.__super__.constructor.call(this)}return g(t,e),t.prototype.initialize=function(){return delete this.state,this.setupImageState()},t.prototype.setupImageState=function(){var e,t,n,r,i,s;return this.isImage=!this.file.isLinked&&/^image\/(?!x-|vnd|tiff|svg?)/.test(this.file.type),t=(n=this.file.name)!=null?n.match(/^(.+?)(\.[a-z0-9]+)?$/):void 0,this.basename=(r=t[1])!=null?r:this.file.name,this.extname=t[2],e=(i=this.file.iconExtension)!=null?i:(s=this.extname)!=null?s.slice(1):void 0,this.iconPath=FileIcons.path(e,"big")},t.prototype.getImage=function(e){if(!this.isImage)return;return this.loadImage(e)},t.prototype.prepareThumbnail=function(){return this.getImage(function(e){return function(t){return e.$item.prepend($(t).addClass("thumbnail")),e.$item.addClass("image")}}(this))},t.prototype.loadImage=function(e){},t.prototype.remove=function(){return this.$item.trigger("attachment:remove").remove()},t.prototype.render=function(){return this.$item=$(JST["desktop/templates/pending_attachment"](this)),this.prepareThumbnail(),this.$item.delegate("a[data-behavior~=remove]","click",function(e){return function(t){return e.remove(),!1}}(this)),this.$item},t}(EventEmitter),i=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.initialize=function(){return delete this.file.id,this.file.isLinked=!0,this.file.link={url:this.file.url,source:this.file.linkSource,key:this.file.linkKey,size:0},t.__super__.initialize.call(this)},t}(e),t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.initialize=function(){return this.file.type=this.file.mimeType,this.file.linkSource="google",this.file.linkKey=this.file.id,this.file.iconExtension=this.extension(),t.__super__.initialize.call(this)},t.prototype.extension=function(){var e,t;switch(e=(t=this.file.type.match(/\.(\w+)$/))!=null?t[1]:void 0){case"drawing":return"gdraw";case"form":return"gform";case"freebird":return"gform";case"presentation":return"gslides";case"spreadsheet":return"gsheet";default:return"gdoc"}},t.prototype.loadImage=function(e){var t;return t=new Image,t.src=this.file.thumbnails[this.file.thumbnails.length-1].url,e(t)},t}(i),o=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return g(t,e),t.prototype.loadImage=function(e){var t;return t=new Image,t.src=this.file.thumbnailURL,e(t)},t.prototype.remove=function(){return this.$item.find("input[type=hidden][name*=_trash]").val("1"),this.$item.hide().trigger("attachment:remove")},t}(e),s=function(e){function t(e,n){this.uploader=n,t.__super__.constructor.call(this,e),this.on("error",function(){this.remove();if(!this.aborted)return alert('There was a problem uploading the file "'+this.file.name+'".\nPlease try adding it again.')})}return g(t,e),t.prototype.remove=function(){return this.state||this.emit("cancel"),this.uploader.remove(this),t.__super__.remove.call(this)},t.prototype.render=function(){var e;return t.__super__.render.call(this),e=this.$item.find("[data-behavior~=progress] > div"),this.on("progress",function(t){return e.css({width:""+t+"%"})}),this.on("end",function(e){return this.$item.find("input[type=hidden][name*=token]").attr("value",e),this.$item.removeClass("uploading")}),this.$item.addClass("uploading")},t}(e),n=function(e){function n(){return this.onProgress=v(this.onProgress,this),this.onReadyStateChange=v(this.onReadyStateChange,this),n.__super__.constructor.apply(this,arguments)}var t;return g(n,e),n.prototype.initialize=function(){return n.__super__.initialize.call(this),this.xhr=new XMLHttpRequest,this.xhr.open("POST","/"+bcx.currentAccountSlug+"/attachments/stage?"+$.cookie("csrf-param")+"="+encodeURIComponent($.cookie("csrf-token")),!0),this.xhr.setRequestHeader("Content-Type","application/octet-stream"),this.isImage&&!window.FileReader&&this.xhr.setRequestHeader("X-Return-Content",!0),this.xhr.onreadystatechange=this.onReadyStateChange,this.xhr.upload.onprogress=this.onProgress,this.on("end",function(e){return function(){if(!window.FileReader)return e.prepareThumbnail()}}(this))},n.prototype.loadImage=function(e){var t,n;if(window.FileReader)return n=new FileReader,n.onload=function(t){var n;return n=new Image,n.src=t.target.result,e(n)},n.readAsDataURL(this.file);if(this.file.content)return t=new Image,t.src="data:"+this.file.type+";base64,"+this.file.content,e(t)},n.prototype.start=function(){if(!this.state)return this.state="uploading",this.xhr.send(this.file)},n.prototype.stop=function(){if(this.state==="uploading")return this.aborted=!0,this.xhr.abort()},n.prototype.onReadyStateChange=function(){var e,n;if(this.xhr.readyState===4)return this.xhr.status===200?(e=t(this.xhr))?(this.token=e.token,(n=this.file).content==null&&(n.content=e.content),this.state="completed",this.emit("end",this.token)):(this.state="failed",this.emit("error",this.xhr)):(this.state="failed",this.emit("error",this.xhr))},n.prototype.onProgress=function(e){var t;return t=e.loaded/e.total*100,this.emit("progress",t)},t=function(e){var t,n;try{return t=e.responseText,JSON.parse(t)}catch(r){n=r}},n}(s),r=function(e){function n(e,t){var r;this.$input=$(e),r={name:this.extractName(),type:"application/octet-stream"},n.__super__.constructor.call(this,r,t)}var t;return g(n,e),t=0,n.prototype.initialize=function(){return n.__super__.initialize.call(this),this.id="upload_frame_hack_"+(t+=1),this.$engine=$(JST["desktop/templates/legacy_pending_attachment"](this)),$(document.body).append(this.$engine),this.$target=this.$engine.find("iframe"),this.$form=this.$engine.find("form"),this.$form.append(this.$input),this.stop(),this.on("end",function(e){return function(t){e.setupImageState(),e.$item.find("input[type=hidden][name*=content_type]").attr("value",e.file.type);if(e.file.content!=null)return e.prepareThumbnail()}}(this)),this.$target.load(function(e){return function(){return e.extractResponse()?(e.state="completed",e.emit("end",e.token)):(e.state="failed",e.emit("error")),e.$engine.remove()}}(this))},n.prototype.render=function(){return n.__super__.render.call(this),this.on("end",function(e){return this.$item.removeClass("busy")}),this.$item.addClass("busy")},n.prototype.loadImage=function(e){var t;if(!this.file.content)return;return t=new Image,t.src="data:"+this.file.type+";base64,"+this.file.content,e(t)},n.prototype.start=function(){var e;if(!this.state){this.state="uploading";try{return this.$form.submit()}catch(t){return e=t,console.error(e),console.trace(),this.state="failed",this.emit("error")}}},n.prototype.stop=function(){var e,t;this.state==="uploading"&&(this.aborted=!0,this.state="failed",this.emit("error",this.xhr));if(this.$target[0].stop!=null)return this.$target[0].stop();if(e=this.$target[0].contentWindow){if(e.stop!=null)return e.stop();if(((t=e.document)!=null?t.execCommand:void 0)!=null)return e.document.execCommand("Stop")}},n.prototype.extractName=function(){var e;return(e=this.$input.val().match(/[^\/\\]+$/))!=null?e[0]:void 0},n.prototype.extractResponse=function(){var e,t,n;try{return e=this.$target[0].contentWindow.document.body.innerText,n=JSON.parse(e),this.token=n.token,this.file={name:n.name,type:n.type,content:n.content}}catch(r){t=r}},n}(s),p=new u,f="[data-behavior~=pending_attachments]",$.fn.attachFiles=function(e){var t,r,i;r=$(this).closest("form"),i=r.find(""+f+" > ul");if(!i.length)return;return(t=r.find("input[type=file]:first")).length&&e.length&&!t.attr("multiple")&&(r.find("a[data-behavior~=remove]").click(),e.length>1&&(e=e.slice(0,1))),_.each(e,function(e){var t;return t=new n(e,p),i.append(t.render()),i.find("li:last").trigger("attachment:add"),a(r,t)})},$.fn.attachSelf=function(){var e,t,n;e=$(this).closest("form"),t=e.find(""+f+" > ul");if(!t.length)return;return $(this).attr("multiple")||$container.find("a[data-behavior~=remove]").click(),n=new r(this,p),t.append(n.render()),t.find("li:last").trigger("attachment:add"),a(e,n)},$.fn.attachGoogleDocs=function(e){var n,r,i,s,o,u,a;n=$(this).closest("form"),r=n.find(""+f+" > ul");if(!r.length)return;a=[];for(o=0,u=e.length;o<u;o++)s=e[o],i=new t(s),r.append(i.render()),r.find("li:last").trigger("attachment:add"),a.push(n.find("input[type=submit][data-role~=uploader]").prop("disabled",!1));return a},a=function(e,t){var n,r,i,s,o,u,a;p.queue(t),n=(o=e.data("queuedAttachmentCount"))!=null?o:0,n===0&&e.trigger("upload:start"),e.data("queuedAttachmentCount",n+1),u=["cancel","error","end"],a=[];for(i=0,s=u.length;i<s;i++)r=u[i],a.push(t.on(r,function(){return h(e)}));return a},h=function(e){var t;return t=e.data("queuedAttachmentCount")-1,t===0&&e.trigger("upload:finish"),e.data("queuedAttachmentCount",t)},d=function(e){var t,n;return t=$(e),n=t.wrap("<span>").closest("span").html(),t.unwrap(),t.after(n),window.File?(t.attachFiles(e.files),t.remove()):t.attachSelf()},window.File||$(document).live("ie:change",function(e,t){return d(t)}),$(""+f+" input[type=file]").live("change",function(e){return d(e.target)}),$("form").live("attachments:link",function(e,t){var n,r;n=$(e.target).find(""+f+" ul");try{return _.each(t,function(e){var t;return t=new o(e),n.append(t.render()),n.find("li:last").trigger("attachment:add")})}catch(i){return r=i,console.error(r),console.trace()}}),$("form").live("reset",function(e){if(!$(this).find(""+f).length)return;return $(this).find(""+f+" > ul").html(""),c(this)}),c=function(e){var t,n,r,i;n=$(e);if(!n.hasBehavior("toggle_file_label"))return;return t=n.find(""+f+" li:visible"),i=n.find("input[type=submit][data-role~=uploader]"),r=n.find("[data-behavior~=pluralize_subscribable_label]"),t.length>1?(r.html("these files"),i.val("Add these files"),i.data("originalValue",i.val())):(r.html("this file"),i.val("Add this file"),i.data("originalValue",i.val()))},$(document).on("attachment:add","[data-behavior~=file_drop_target]",function(){return $(this).addClass("has_attachments"),_.defer(function(e){return function(){return c($(e).closest("form"))}}(this))}),$(document).on("attachment:remove","[data-behavior~=file_drop_target]",function(){return _.defer(function(e){return function(){c($(e).closest("form"));if(!$(e).find(""+f+" li:visible").length)return $(e).removeClass("has_attachments")}}(this))}),bcx.on("page:update","make pending attachments sortable",function(){return $(""+f+"[data-sortable~=true] > ul").sortable({axis:"y",tolerance:"pointer",cancel:"input.name, div.taggings"})}),$("form").live("upload:start",function(e){var t;return t=$(this).find("input[type=submit][data-role~=uploader]"),t.data("originalValue",t.val()).val("Uploading...").prop("disabled",!0)}),$("form").live("upload:finish",function(e){var t;return t=$(this).find("input[type=submit][data-role~=uploader]"),t.val(t.data("originalValue")).prop("disabled",!1)}),l=0,$(""+f+" > ul > li").live("tagging:add",function(e,t,n){var r;return l+=1,r=$(JST["desktop/templates/pending_tagging"]({tagName:t,taggingId:l})),r.appendTo($(this).find("[data-behavior~=taggings] > ul")),e.preventDefault(),n.refresh()}).live("tagging:remove",function(e,t,n){var r;return r=$(this).find("[data-url='"+t+"']"),r.fadeOutAndRemove({collapse:["width","height"]}),r.attr("data-deleted",!0),n.refresh()}),$(window).on("beforeunload",function(){if($("[data-behavior~=pending_attachments] ul.pending_attachments li").length)return"Your uploaded files will not be saved if you close this window."})}.call(this),function(){var e,t,n,r;r=null,$("[data-behavior~=edit_taggings]").live("expand",function(){var e;return e=$(this).closest("[data-behavior~=taggings]"),r!=null&&r.unregister(),r=new bcx.views.TaggingsView(e.get(0))}).live("collapse",function(e){return r!=null&&r.unregister(),r=null,e.stopPropagation()}),$("[data-behavior~=taggings]:not([data-behavior~=pending_taggings])").live("tagging:add",function(e,n,r){return t(),$.ajax({type:"POST",url:$(this).data("url"),data:{"tagging[taggable_type]":$(this).data("taggable-type"),"tagging[taggable_id]":$(this).data("taggable-id"),"tagging[tag_name]":n},complete:function(){return r.refresh()}})}).live("tagging:remove",function(e,n,r){return $(e.target).addClass("removing"),t(),$.ajax({type:"DELETE",url:n,complete:function(){return r.refresh()}})}),t=function(){var e;if(e=Stacker.workspace.findPanel($("div.sheet.attachments.inactive")))return e.expireCache()},$("div.sheet.attachments.tagged").live("stackerLinkClicked",function(e,t){return t.replaceSheet=!0}),$('#enlarger [data-behavior~="taggings"]').live("stackerLinkClicked",function(e,t){return t.defaultStack=!0}),$("[data-behavior~=edit_tag] :input[type=radio]").live("click",function(e){var t;return t=$(this).val(),$(this).closest("li").find("span.label_color").css("background","#"+t),$(this).closest("[data-behavior~=expandable]").collapse()}),$("[data-behavior~=rename_tag]").live("click",function(e){var t;return t=$(this).closest("li"),t.find("[data-behavior~=name_tag]").expand(),t.find("[data-behavior~=edit_tag]").collapse(),e.preventDefault()}),$("[data-behavior~=rename_tag_form]").live("ajax:before",function(){var e;return e=$(this).find("input[type=text]").val(),$.trim(e).length?($(this).addClass("busy"),t(),!0):!1}),$("[data-behavior~=name_tag]").live("expand",function(e){return $(this).find(".submit").slideDown(100),$(this).find("input[type=text]").focus().keydown().select()}).live("collapse",function(){return $(this).find(".submit").hide(),$(this).find("form").resetForm()}),$("[data-behavior~=edit_tag] [data-behavior~=confirm_delete]").live("click",function(e){var t;return t=$(this).closest("div.wrapper"),t.css("height",92),t.find("div.actions, div.confirm_delete").css("top",-55),e.preventDefault()}),$("[data-behavior~=edit_tag] [data-behavior~=cancel_delete]").live("click",function(e){return $(this).closest("[data-behavior~=edit_tag]").collapse(),e.preventDefault()}),$("[data-behavior~=edit_tag]").live("collapse",function(){return $(this).trigger("reset")}),$("[data-behavior~=edit_tag]").live("reset",function(){var e;return e=$(this).find("div.wrapper"),e.css("height",47),e.find("div.actions, div.confirm_delete").css("top",0)}),e=function(e){return $(e).attr("disabled","disabled"),$(e).val("Add tags")},n=function(e){var t;return t=$(e).find("ul.suggestions"),t.children().size()===1?t.hide():t.show(),$(e).find("ul.ui-menu").hide()}}.call(this),function(){var e;e=function(e){var t,n;return t=e.data("collection-name"),((n=bcx.currentProject)!=null?n.get(""+t+"_count"):void 0)===0},$("form#new_upload").live("ajax:success",function(e){return(new bcx.Busy(this)).end()}),$("form#new_upload").live("ajax:error",function(e){return(new bcx.Busy(this)).end(),alert("There was a problem with your upload. Please try again.")}),$("[data-behavior~=new_upload]").live("click",function(e){return $("article.upload.new").expand(),e.preventDefault()}),$("article.upload.new [data-behavior~=toggle_private_visibility]").live("change",function(e){var t,n;return t=$(this).closest("article.upload.new"),n=t.find("[data-behavior~=subscriber_list]").data("view"),$(this).is(":checked")?n!=null?n.privatize():void 0:n!=null?n.publicize():void 0}),$("article.upload.new").live("expand",function(e){if(e.target!==this)return;return $("div.sheet.attachments").removeClass("blank_slate")}).live("collapse",function(t){var n;$(this).find("form").resetForm(),$(this).find("textarea").keydown(),n=$(this).parent().find("section");if(e(n))return $("div.sheet.attachments").addClass("blank_slate")})}.call(this),function(){var e;e=function(){var e,t;if(t=$(":hidden[name=recurrence_starts_at]").val())return e=CalendarDate.parse(t),bcx.calendarEvents.models[0].addRecurrencesInRange(e.previous(),e.next())},$("button[data-behavior~=new_calendar_event]").live("click",function(){var e;return e=bcx.Autoview.get("template_calendar_event_editor",bcx.currentBucket.identifier()),e.renderWithCalendarEvent(new bcx.models.CalendarEvent({summary:"New event"})),$("div.sheet.calendar_events").removeClass("blank_slate"),$("article.calendar_event.new").expand(),!1}),$("article.calendar_event [data-behavior~=toggle_private_visibility]").live("change",function(e){var t,n;return t=$(this).closest("article.calendar_event"),n=t.find("[data-behavior~=subscriber_list]").data("view"),$(this).is(":checked")?n!=null?n.privatize():void 0:n!=null?n.publicize():void 0}),$("[data-behavior~=edit_calendar_event]").live("click",function(){var t,n;return $(document).trigger("client_projects:editing"),e(),t=bcx.calendarEvents.get($(this).data("calendar-event-id")),n=bcx.Autoview.get("template_calendar_event_editor",bcx.currentBucket.identifier("-"+t.id)),n.renderWithCalendarEvent(t),n.autofocus(),$("section.calendar_events.edit").expand(),!1}),$("[data-behavior~=delete_action]").live("click",function(t){var n,r;if($("[data-behavior~=recurring_cancel]").length)return e(),n=bcx.calendarEvents.get($(this).data("calendar-event-id")),r=bcx.Autoview.get("calendar_event_editor/recurrence_prompt"),r.calendarEvent=n,r.destroy()}),$("article.calendar_event.new").live("collapse",function(){if(!bcx.currentProject.get("calendar_events_count"))return $("div.sheet.calendar_events").addClass("blank_slate")}),$("div.calendar_event form[data-behavior~=publicize]").live("ajax:success",function(e){var t,n;return t=$(this).closest("div.calendar_event[data-calendar-event-id]"),n=bcx.calendarEvents.get(t.data("calendar-event-id")),n.set("private",!1)}),bcx.on("page:change",'click the new calendar event button if the location hash is "#create"',function(){if(window.location.hash==="#create")return $("button[data-behavior~=new_calendar_event]").click()})}.call(this),function(){var e;e=function(e){if(e===bcx.currentBucket)return $("div.sheet.grid").toggleClass("blank_slate",!e.calendarIsUsed())},bcx.projects.bind("change",e),bcx.calendars.bind("change",e),bcx.on("page:update",'remove "initial_load" class from calendar',function(){return $("div.panel.calendar").removeClass("initial_load")}),bcx.on("page:change","ensure peopleAndGroups collection is reloaded after page change",function(){return bcx.peopleAndGroups.loaded=!1})}.call(this),function(){bcx.on("identity:set",function(){var e;return(e=function(){return CalendarDate.firstDayOfWeek=bcx.currentPerson.get("start_of_week")})(),bcx.currentPerson.bind("change:start_of_week",e)}),$("[data-behavior~=set_start_of_week]").live("click",function(e){var t,n;return t=$(e.currentTarget),n=t.prop("checked")?1:0,bcx.currentPerson.setStartOfWeek(n)})}.call(this),function(){$("article.comment.new").live("expand",function(e){var t;if(e.target!==this)return;$(this).slideIntoView({duration:"slow"}),t=$("[data-subscribers]");if(t.html()==="")return $.ajax(t.data("subscribers"),{dataType:"html",success:function(e){return t.hide().html(e),setTimeout(function(){return t.fadeIn()},1),bcx.installAdhocSubscribers()}})}),$("article.comment span.time > span a").live("click",function(){return $(this).closest("span").addClass("busy")})}.call(this),function(){$(document).on("click","[data-behavior=save_document]",function(){return $("form.edit_document").submit(),!1}),$(document).on("click","[data-behavior=clear_document]",function(){return bcx.storage.unset($("textarea.name").data("autosave-storage-key")),bcx.storage.unset($("textarea.body").data("autosave-storage-key"))}),$(document).on("click","[data-behavior=create_document]",function(){return $("form.new_document").submit(),!1}),$("div.document [data-behavior~=toggle_private_visibility]").live("change",function(e){var t;return t=$(this).closest("div.document"),t.find("[data-behavior~=private_flag]").val($(this).is(":checked"))})}.call(this),function(){$(document).on("change","[data-behavior~=compare_document_version] select",function(){return $(this).find("option:selected").val()===""?$("[data-behavior~=compare_document_version] input[type=submit]").attr("disabled",!0):$("[data-behavior~=compare_document_version] input[type=submit]").attr("disabled",!1)}),$(document).on("submit","[data-behavior~=compare_document_version]",function(e){return e.preventDefault(),Stacker.workspace.visit($(this).attr("action").slice(0,-1)+$(this).find("option:selected").val(),{replaceSheet:!0})})}.call(this),function(){$.fn.removeDocument=function(e){var t;return this.hasClass("result")?this.fadeOutAndRemove():(t=$(e).addBehavior("content_container").data("content",this.get(0).outerHTML),this.replaceWith(t)),this},$.fn.restoreDocument=function(){if(this.hasBehavior("content_container"))return this.replaceWith(this.data("content"))}}.call(this),function(){var e,t,n,r;n=null,bcx.on("page:update","position group flag, only show one per group",function(){return bcx.positionDocumentGroupFlags()}),bcx.positionDocumentGroupFlags=function(){return $("section.documents.grouped:not(.list_view)").length?(e(),$("[data-behavior~=document_group]").each(r)):$("[data-role=document_group_flag]").hide()},e=function(){var e;return e=_.min($("article.document"),function(e){return $(e).offset().left}),n=$(e).offset().left},r=function(){var e,n,r,i,s;e=$(this),r=e.data("flagged"),i=e.data("document-group-id"),n=$("[data-document-group-id='"+i+"']").not(e),s=n.is(function(){return $(this).data("flagged")===!0});if(!r&&!s)return t(e)},t=function(e){var t,r,i;r=e.find("[data-role=document_group_flag]"),t=e.find("article.document"),i=_.find(t,function(e){return $(e).offset().left===n});if(i)return r.show().appendTo(i),e.data("flagged",!0)}}.call(this),function(){bcx.on("page:change","enable placeholders in IE",function(){return setTimeout(function(){if($.browser.msie)return $("article.document textarea.name").placeholder()},1)})}.call(this),function(){var e,t,n;n="You haven't saved your changes. Do you really want to leave without saving this document?",e=function(){return $("article.document form").data("ignore-leave-warning",!0)},t=function(){return $("article.document form").length&&!$("article.document form").data("ignore-leave-warning")},$(window).on("beforeunload",function(){if(t())return n}),$(document).on("workspace:visit",function(r){if(t())return confirm(n)?e():r.preventDefault()}),$(document).on("click","[data-behavior~=create_document],[data-behavior~=save_document],[data-behavior~=clear_document]",function(){return e()})}.call(this),function(){var e;e=function(){if($("form.edit_document").length)return $.ajax($("form.edit_document").attr("action")+"/lock",{type:"PUT",success:function(){return setTimeout(e,2e4)}})},bcx.on("page:update","keep the lock alive or it will expire",function(){if($("form.edit_document").length)return setTimeout(e,2e4)})}.call(this),function(){$(document).on("keypress","article.document textarea.name",function(e){if(e.keyCode===$.ui.keyCode.ENTER)return $("textarea.body").focus(),e.preventDefault()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};bcx.Sidebar=function(){function t(t){this.scroll=e(this.scroll,this),this.sidebar=t,this.document=this.sidebar.closest("[data-behavior~=sidebar_follower_container]"),this.sidebarHeight=this.sidebar.height()}return t.prototype.detached=!1,t.prototype.scroll=function()
{var e,t,n,r;n=this.document.offset().top,t=this.document.outerHeight(),r=$(window).scrollTop(),e=n+t+this.sidebarHeight;if(e>r&&r>n){if(r>=$(document).height()-$(window).height())return;if(!this.detached)return this.detach()}else if(this.detached)return this.attach()},t.prototype.detach=function(){return this.sidebar.addBehavior("sidebar_follower"),this.sidebar.addClass("sidebar_follower"),this.detached=!0,console.log("detached!")},t.prototype.attach=function(){return this.sidebar.removeBehavior("sidebar_follower"),this.sidebar.removeClass("sidebar_follower"),this.detached=!1},t.sidebars=[],t.install=function(){return setTimeout(function(){return $("[data-behavior~=sidebar_follower]").install("attaching sidebar",function(e){var n;return n=new t(e),t.sidebars.push(n),$(window).bind("scroll.documentSidebar",n.scroll)})},10)},t.uninstall=function(){var e,n,r,i;i=t.sidebars;for(n=0,r=i.length;n<r;n++)e=i[n],$(window).unbind("scroll.documentSidebar",e.scroll);return t.sidebars.clear},t}(),bcx.on("page:update","install the sidebar following behavior",bcx.Sidebar.install),bcx.on("page:change","uninstall sidebar following",bcx.Sidebar.uninstall)}.call(this),function(){bcx.on("page:update","mark events about document versions so they will replace sheet on click",function(){return $('div.sheet.document span.summary:contains("version")').parent().attr("data-behavior","document_version_link")}),$(document).on("stackerLinkClicked","div.sheet.document [data-behavior~=document_version_link]",function(e,t){return t.replaceSheet=!0})}.call(this),function(){$(document).on("touchstart","section.documents [data-behavior=link_container]",function(){if(!$(event.target).is("a[target~=_blank]"))return Stacker.workspace.visit($(this).find("a[href]:first").attr("href")),!1}),$(document).on("click","article.document[data-behavior=link_container]",function(e){var t;if(!$(e.target).is("a[target~=_blank]"))return t=$(this).find("a[href]:first").attr("href"),e.ctrlKey||e.metaKey?window.open(t,"_blank"):Stacker.workspace.visit(t),!1})}.call(this),function(){var e,t,n;n=function(){var e,t;return e=$("[data-behavior~=confirm_dropbox_rekey]"),t=e.find("> div"),e.hide(),t.find("div.rekey_confirm").show(),t.find("div.rekey_success").hide(),t.css({"background-color":""})},$("div.dropbox_notify input[type=checkbox]").live("click",function(e){var t,n;return t=$(this).closest("form"),n=t.find("input[type=checkbox]:checked"),n.length?$("[data-behavior~=notify_selected_button]").attr("disabled",!1):$("[data-behavior~=notify_selected_button]").attr("disabled",!0)}),$("[data-behavior~=notify_all_button]").live("click",function(e){return e.preventDefault(),$(":checkbox").prop("checked",!0),$("form").submit()}),$("[data-behavior~=notify_selected_button]").live("click",function(e){var t,n;e.preventDefault(),t=$(this).closest("form"),n=t.find("input[type=checkbox]:checked");if(n.length)return t.submit()}),$("section.tutorial [data-behavior~=select_on_focus]").live("click",function(e){return $(this).select()}),$("section.tutorial [data-behavior~=toggle_dropbox_rekey]").live("click",function(e){var t;return t=$(this).closest("section").find("[data-behavior~=confirm_dropbox_rekey]"),t.slideToggle(200,"easeOutQuad"),e.preventDefault()}),$("section.tutorial [data-behavior~=submit_dropbox_rekey]").live("click",function(e){var t,n,r;return r=$(this).closest("section").find("[data-behavior~=confirm_dropbox_rekey] > div"),t=$(this).closest("section").find("[data-behavior~=dropbox_address]"),n=$(this).closest("p.submit"),n.addClass("busy"),$.ajax($(this).data("path"),{type:"POST",success:function(e){return function(e,i,s){return n.removeClass("busy"),r.find("div.rekey_confirm").hide(),r.find("div.rekey_success").show(),r.animate({"background-color":"#390"}),t.highlight(),t.is("input")?t.val(t.val().replace(/(project-[0-9]+)-[^@]+/,"$1-"+e.dropbox_key)):t.html(t.html().replace(/(project-[0-9]+)-[^@]+/,"$1-"+e.dropbox_key))}}(this)}),e.preventDefault()}),e=function(e){var t,r;return t=$("a[data-tutorial='"+e+"']"),r=$("section[data-tutorial='"+e+"']"),$("[data-behavior~=toggle_tutorial]").removeClass("selected"),t.addClass("selected"),$("section[data-behavior~=tutorial]").hide(),r.fadeIn(),n()},t=function(){var t;if(!$("div.sheet.dropbox a[data-tutorial]").length)return;return window.location.hash?(t=window.location.hash.slice(1),e(t)):e("discussions",!1)},$(window).on("hashchange",t),bcx.on("page:change","load dropbox tutorial from hash",t),$("[data-behavior~=toggle_tutorial]").live("stackerLinkClicked",function(){return!1})}.call(this),function(){bcx.on("page:update","rename event creator to you",function(){return $(".event .creator[data-creator-id="+bcx.currentPerson.id+"]").text("You")})}.call(this),function(){$(document).on("click","a[data-behavior~=reveal_event_history]",function(){var e;return e=$(".event_stream"),e.addClass("busy"),$.get("/recordables/"+$(this).attr("data-recordable-sgid")+"/events",function(t){return e.removeClass("busy"),e.html(t)}),!1})}.call(this),function(){$(document).on("click","a[data-behavior~=reveal_event_subscribers]",function(e){return $(this).next("span").toggle(),e.preventDefault()})}.call(this),function(){var e;e=function(){return $("[data-behavior~=appear_on_resize]").show().addClass("showing"),$("[data-behavior~=busy_until_resize]").removeClass("busy"),$("[data-behavior~=resize_to_fit]").contents().find("a").bind("click",function(e){return window.open(this.href),e.preventDefault()})},bcx.on("page:beforechange","hide iframe content until ready",function(){return $("[data-behavior~=appear_on_resize]").hide()}),bcx.on("page:update","update iframe src to avoid overriding browser back button",function(){var e,t,n;e=$("iframe[data-src]"),n=e.data("src"),t=e.get(0);if((t!=null?t.contentWindow.location.href:void 0)!==n)return t.contentWindow.location.href=n}),bcx.on("page:change","resize iframe to fit email",function(){return setTimeout(function(e){return function(){return $("[data-behavior~=busy_until_resize]").addClass("busy")}}(this),10),$("[data-behavior~=resize_to_fit]").iframeAutoHeight({debug:!1,minHeight:100,callback:e})})}.call(this),function(){var e,t;e=function(e){return e.resetForm().find(".invitees").trigger("reset")},t=function(e,t){return e.addClass("shake"),e.onTransitionEnd(function(){e.removeClass("shake");if(t)return t.focus()}),!1},$("[data-behavior~=new_group]").live("click",function(e){return $.getJSON("/everyone.json",function(e){return function(e){return $("[data-behavior~=members]").data("people",e).data("view").reload()}}(this)),$("article.groups.new").expand(),$("article.groups.new").find("textarea").first().focus().get(0).select(),$("article.groups_blank_slate, div.groups_blank_slate_arrow").hide(),$("div.panel.people_index").removeClass("groups_blank_slate"),e.preventDefault()}),$("article.groups.new a[data-behavior=cancel]").live("click",function(t){return e($("article.groups.new form")),$("section.groups > article.group").length===0&&($("article.groups_blank_slate, div.groups_blank_slate_arrow").show(),$("div.panel.people_index").addClass("groups_blank_slate")),t.preventDefault()}),$("article.membership [data-behavior~=remove]").live("ajax:before",function(e){var t;return t=$(this).closest("article.membership"),t.addClass("removing")}).live("ajax:success",function(e){var t;return t=$(this).closest("article.membership"),t.animate({opacity:0},300,"linear",function(){return t.animate({height:0},Math.sqrt(t.height())*35,"easeOutQuad",function(){return t.remove()})})}),$("form[data-behavior~=save_group]").live("ajax:before",function(e){var n,r,i,s,o;n=$(this),s=n.find("textarea"),i=n.find("div.invitee:not(.blank)"),r=n.find("div.invitee input[type=text]").first(),o=r.parents("div.person");if(s.val().trim()==="")return t(s,s),!1;if(i.length===0)return t(o,r),!1}),$("[data-behavior~=rename_group]").live("expand",function(e){return $(this).find(".submit").slideDown(100),$(this).find("textarea").focus().keydown().select()}).live("collapse",function(){return $(this).find(".submit").hide(),$(this).find("form").resetForm()}).find("[data-behavior~=editable_field_prompt]").live("mouseover",function(){return $(this).delay(300).animate({borderColor:"#b3b3b3"},100),$(this).animate({width:370},100)}).live("mouseout",function(){return $(this).stop(!0,!0).css({width:"auto",borderColor:"transparent"})}),$("[data-behavior~=new_subgroup]").live("expand",function(){return $(this).find("textarea").focus().get(0).select()}).live("ajax:before",function(e){var n,r,i,s,o;n=$(this),o=n.find("textarea"),i=n.find("input[type=checkbox]:checked"),s=$(e.target).attr("data-method"),r=n.find("section.invite h2");if(s!=="delete"){if(o.val().trim()==="")return t(o,o),!1;if(i.length===0)return t(r),!1}})}.call(this),function(){bcx.on("page:update","install member field list behavior",function(){return $("form[data-behavior~=member] [data-behavior~=members]").install("behavior for member fields",function(e){return e.each(function(e,t){var n;return n=new bcx.views.MemberFieldList({el:t}),n.render(),n.focus(),$(t).data("view",n)})})})}.call(this),function(){$("article.message.edit").live("wysiwyg:focus",function(e){return $(this).find("[data-behavior~=wysiwyg_toolbar]").slideDown("fast")})}.call(this),function(){bcx.on("page:change","focus message title and enable placeholders in IE",function(){return setTimeout(function(){return $.browser.msie?$("article.message.new textarea").first().focus().placeholder():$("article.message.new textarea").first().focus()},1)})}.call(this),function(){$("div.sheet.message.new article textarea:not(.body)").live("keypress",function(e){if(e.keyCode===$.ui.keyCode.ENTER)return $("textarea.body").focus(),e.preventDefault()})}.call(this),function(){bcx.on("page:change","link existing attachments",function(){var e,t;if($("article.message.new[data-attachments]").length)return e=$("article.message.new[data-attachments]"),t=e.data("attachments"),e.find("form").trigger("attachments:link",t)})}.call(this),function(){$("[data-behavior~=check_all_subscribers]").live("click",function(e){return $("[data-behavior~=subscriber_select_all]").trigger("click"),$(this).closest("[data-behavior~=expandable]").collapse()}),$("[data-behavior~=check_remembered_subscribers]").live("click",function(e){return $("[data-behavior~=subscriber_select_remembered]").trigger("click"),$(this).closest("[data-behavior~=expandable]").expand()}),$("[data-behavior~=uncheck_all_subscribers]").live("click",function(e){return $("[data-behavior~=subscriber_select_none]").trigger("click"),$(this).closest("[data-behavior~=expandable]").collapse()}),$("[data-behavior~=toggle_subscribers_list]").live("click",function(e){return $("[data-role~=subscribers_list]").toggle(),e.preventDefault()}),$("[data-behavior~=clear_selections_on_expand]").live("mousedown",function(e){if(!$(this).closest("[data-behavior~=expandable]").find(".expanded_content:visible").length)return $("[data-behavior~=subscriber_select_none]").trigger("click")}),bcx.on("page:change","trigger load subscribers",function(){if($("article.message.new").length)return $("article.message.new").expand()})}.call(this),function(){var e,t;t=function(e){return bcx.storage.set("notificationSetting:"+bcx.currentProject.id,e)},e=function(){var e;return(e=bcx.storage.get("notificationSetting:"+bcx.currentProject.id))!=null?e:"check_all_subscribers"},$(document).on("click","[data-behavior~=check_all_subscribers]",function(){return t("check_all_subscribers")}),$(document).on("click","[data-behavior~=check_remembered_subscribers]",function(){return t("check_remembered_subscribers")}),$(document).on("click","[data-behavior~=uncheck_all_subscribers]",function(){return t("uncheck_all_subscribers")}),bcx.on("subscriber_list:render","pick notification setting",function(){if($("article.message.new").length)return $("[data-behavior~="+e()+"]").trigger("click"),$("article.message.new textarea").first().focus()})}.call(this),function(){$("article.message.new [data-behavior~=toggle_private_visibility]").live("change",function(e){var t,n,r,i;t=$(this).closest("article.message.new"),i=t.find("[data-behavior~=subscriber_list]").data("view"),$(this).is(":checked")?i!=null&&i.privatize():i!=null&&i.publicize(),t.find("[data-all-subscribers-list]").toggle(),t.find("[data-team-subscribers-list]").toggle(),t.find("[data-role~=subscribers_list]").hide(),r=$(this).closest("[data-behavior~=expandable]").find(".expanded_content:visible").length,n=$("[data-behavior~=uncheck_all_subscribers] > input[type~=radio]").is(":checked");if(r||n)return $("[data-behavior~=subscriber_select_none]").trigger("click")})}.call(this),function(){$("a[data-behavior~=add_to_all_projects]").live("click",function(e){var t,n;return e.preventDefault(),t=$("[data-display~=invite_projects] :checkbox[data-behavior~=project_checkbox]"),n=$("[data-display~=invite_projects] :checkbox[data-behavior~=client_checkbox]:not(:disabled)"),t.length!==t.filter(":checked").length?t.prop("checked",!0):(t.prop("checked",!1),n.prop("checked",!1))}),$("table[data-display~=invite_projects] input:checkbox[data-behavior~=client_checkbox]").live("change",function(e){var t;if($(this).is(":checked"))return t=$(this).closest("tr"),t.find("input:checkbox[data-behavior~=project_checkbox]").prop("checked",!0)}),$("table[data-display~=invite_projects] input:checkbox[data-behavior~=project_checkbox]").live("change",function(e){var t;if($(this).is(":not(:checked)"))return t=$(this).closest("tr"),t.find("input:checkbox[data-behavior~=client_checkbox]:not(:disabled)").prop("checked",!1)}),$("a[data-behavior~=add_to_all_calendars]").live("click",function(e){var t;return e.preventDefault(),t=$("[data-display~=invite_calendars] :checkbox"),t.prop("checked",t.length!==t.filter(":checked").length)}),$("form[data-behavior~=email_preferences]").live("change",function(){return $(this).submit(),$(this).find(":input").attr("disabled",!0)}),$("form[data-behavior~=email_preferences]").live("ajax:before",function(){return $(this).find("[data-display~=status]").addClass("busy")}),$("form[data-behavior~=email_preferences]").live("ajax:success",function(){return setTimeout(function(e){return function(){return $(e).find("[data-display~=status]").removeClass("busy"),$(e).find(":input").attr("disabled",!1),$(e).closest("form").removeClass("busy")}}(this),300)}),$("form[data-behavior~=notification_email]").live("ajax:before",function(){var e,t,n;t=$(this),e=t.find("input[type=text]"),n=e.val(),t.find("[data-status]").hide();if(!bcx.EmailAddressHelper.looksLikeEmailAddress(n))return t.find("[data-status=error]").show(),e.focus().select(),!1}),$("form[data-behavior~=notification_email]").live("ajax:success",function(){var e;return e=$(this),e.find("[data-status=success]").show().delay(1500).fadeOut(),e.find("input[type=submit]").blur()}),$("[data-behavior~=calendar_preferences]").live("change",function(){return $(this).submit()}),$("[data-behavior~=calendar_preferences]").live("ajax:before",function(){return $(this).find("[data-display~=status]").addClass("busy")}),$("[data-behavior~=calendar_preferences]").live("ajax:success",function(){return setTimeout(function(e){return function(){return $(e).find("[data-display~=status]").removeClass("busy"),$(e).removeClass("busy")}}(this),300)}),bcx.on("page:change","truncate event summaries on person permapage",function(){return $("div.sheet.person article.event span.summary").truncate({max_length:60,more:"..."})}),$("header div.resend_invite [data-behavior~=select_on_focus]").live("click",function(e){return $(this).select()}),$("a[data-behavior~=resend_invitation]").live("click",function(e){var t,n,r,i,s;return e.preventDefault(),r=$(this),n=r.closest("header"),t=n.find("[data-role~=invite_display]"),i=n.find("[data-role~=invite_status]"),s=i.find("time"),t.data("deactivated_html",t.html()),t.html(t.attr("data-activated-text")),t.animate({opacity:1},150,"linear"),r.one("ajax:success",function(e){return function(){return setTimeout(function(){return t.html(t.data("deactivated_html")),s.html("a moment ago"),s.highlight(),t.delay(1e3).animate({opacity:0},300,"linear",function(){return s.attr("datetime",new Date)})},500)}}(this))}),$("[data-behavior~=projects_select_all]").live("click",function(e){var t,n;return e.preventDefault(),n=$(this),n.addClass("busy"),t=$("[data-display~=projects_list] :checkbox"),t.attr("disabled",!0),$.ajax($(this).data("path"),{type:"POST",success:function(e){return t.prop("checked",t.length),t.removeAttr("disabled"),setTimeout(function(e){return function(){return n.removeClass("busy")}}(this),300)}})}),$("[data-behavior~=projects_select_none]").live("click",function(e){var t,n;return e.preventDefault(),n=$(this),n.addClass("busy"),t=$("[data-display~=projects_list] :checkbox"),t.attr("disabled",!0),$.ajax($(this).data("path"),{type:"POST",success:function(e){return t.removeAttr("checked",t.length),t.removeAttr("disabled"),setTimeout(function(e){return function(){return n.removeClass("busy")}}(this),300)}})}),$("[data-behavior~=expand_project_selection]").live("click",function(e){var t;if($(this).find(":checked").length)return t=$("[data-display~=projects_list] :checkbox"),t.prop("checked",t.length),$(this).closest("[data-behavior~=expandable]").expand()}),$("[data-behavior~=collapse_project_selection]").live("click",function(e){var t,n;t=$(this).find("input[type=radio]"),n=$(this).find("[data-status]"),n.addClass("busy"),$(this).closest("[data-behavior~=expandable]").collapse();if(t.closest(":checked").length)return $.ajax(t.data("path"),{type:"POST",success:function(e){return setTimeout(function(e){return function(){return n.removeClass("busy")}}(this),300)}})})}.call(this),function(){$(document).on("change","select[data-behavior=outstanding_todos_due]",function(){return Stacker.workspace.visit($(this).data("path")+("?due="+$(this).find("option:selected").val()),{replaceSheet:!0}),!1})}.call(this),function(){bcx.on("page:change","disable checkbox for current person's permissions",function(){if(bcx.currentPerson!=null)return $("[data-behavior~=change_permissions][data-person-id="+bcx.currentPerson.id+"] :checkbox").prop("disabled",!0)}),$(":checkbox[data-behavior~=admin_permission]").live("change",function(){var e,t,n;return n=$(this).parents("[data-behavior~=set_permission_checkboxes]"),e=n.find(":checkbox[data-behavior~=can_create_projects_permission]"),t=e.siblings("input:hidden"),t.prop("disabled",!1),$(this).is(":checked")?(e.prop("checked",!0),e.prop("disabled",!0)):e.prop("disabled",!1)}),$("[data-behavior~=change_permissions] :checkbox").live("change",function(){return $(this).closest("form").submit()})}.call(this),function(){var e;e=function(){var e;if(!bcx.currentProject)return;return e=$("div.sheet.project"),bcx.currentProject.isUsed()?e.removeClass("blank_slate"):e.addClass("blank_slate")},bcx.on("page:change",'apply "blank_slate" class to current project sheet',e),bcx.projects.bind("change",function(t){if(t===bcx.currentProject)return e()}),$("[data-behavior~=bounce_nav]").live("click",function(e){if(!$(this).hasClass("stars"))return $("[data-behavior~=bounce]").bounce()})}.call(this),function(){$("section.projects.cards article.card").live("click",function(e){var t;t=$(e.target);if(t.is("article.card"))return t.find("a").click()})}.call(this),function(){bcx.on("page:update","make project events visible",function(){var e;return e=$("[data-behavior~=project_events] .event_container").show(),e.find(".excerpt_attachments").remove()})}.call(this),function(){var e;$("[data-behavior~=edit_project_header]").live("expand",function(e){var t;return t=$(this).find("form"),t.find(".submit").slideDown(100),t.find("textarea").keydown()}).live("collapse",function(){return $(this).find("form").resetForm(),$(this).find(".submit").hide()}),e=function(){var e,t;e=$(this).closest("[data-behavior~=expandable]");if(!e.find(".expanded_content").length)return;return e.expand(),$(this).closest("h1.field").length?t=e.find(".expanded_content h1.field textarea"):t=e.find(".expanded_content div.description.field textarea"),t.focus().select()},$("[data-behavior~=edit_project_header] [data-behavior~=editable_field_prompt]").live("click",e).live("tap",e).live("mouseover",function(){var e;e=$(this).closest("[data-behavior~=expandable]");if(!e.find("div.expanded_content").length)return;return $(this).delay(300).animate({borderColor:"#b3b3b3"},100),$(this).animate({width:600},100)}).live("mouseout",function(){return $(this).stop(!0,!0).css({width:"auto",borderColor:"transparent"})})}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L;t=null,e=!1,bcx.on("page:update","extract new project dialog",function(){var e;e=$("#workspace [data-behavior~=new_project_dialog]");if(e.length)return e.remove(),t=e.get(0),c(),e.detach()}),bcx.on("page:change","hide new dialog",function(){if($("#new_project_dialog").is(":visible"))return bcx.cancelNewProject()}),$(document).bind("workspace:beforeload",function(){if($("#new_project_dialog").is(":visible"))return y()}),$("[data-behavior~=new_project]").live("click",function(){return o(),u(function(){return T(function(){return x(),r(),f(),d(),v(),k()})}),!1}),$("[data-behavior~=cancel_new_project]").live("click",function(){return bcx.cancelNewProject()}),bcx.cancelNewProject=function(){return i(),n(),w(),h(),m(),v(),s(function(){return N(),C()}),!1},$("form[data-behavior~=create_project]").live("submit",function(){return e=!0}).live("ajax:before",function(t){var n;n=$(t.target).find("textarea:first");if(n.val().match(/^\s*$/))return n.val(n.prop("placeholder")).focus().select(),e=!1,!1}).live("ajax:error",function(){return e=!1}).live("ajax:success",function(){return a(),i(),n(),w(),m(),S(function(){return L(),b(),p(),$(t).detach(),N(),e=!1})}),$("[data-behavior~=create_draft_project]").live("click",function(){var t,n;if(!e){t=$(this).closest("[data-role~=project_card]").addClass("loading"),n=$("[data-role~=project_card]:not(.loading)").addClass("inactive");if(t.filter("[data-behavior~=expandable]").length)return t.collapse()}}).live("ajax:before",function(t){if(e)return!1}).live("ajax:error",function(){return e=!1}).live("create_draft:success",function(){var r;return r=$(this).closest("[data-role~=project_card]"),r.filter("[data-behavior~=expandable]").length?e=!1:(i(),a(),n(),S(function(){return L(),b(),p(),$(t).detach(),N(),e=!1}))}),$("[data-behavior~=create_draft_project]").live("click",function(t){var n;t.preventDefault(),t.stopImmediatePropagation();if(!e)return e=!0,n=$(this),$.ajax({url:n.attr("href"),type:"POST",success:function(e){var t;return t=new BackgroundOperationProcessor(new bcx.CopyOperation(e)),t.on("processor:finished",function(e){return function(){return n.trigger("create_draft:success"),bcx.trigger("animate_draft:on")}}(this)),t.startWatchingOperation()},error:function(t){return function(){return e=!1,$(t).closest("[data-role~=project_card]").removeClass("loading"),alert("You've hit the project limit! Your account must be upgraded before you can create more projects.")}}(this)})}),$(document).bind("workspace:load",function(){if(!e&&$("div.project_index").length)return p(),$(t).detach(),b(),g()}),c=function(){return $(t).attr("id","new_project_dialog").find("[data-behavior~=lazy_invitees]").attr("data-behavior","invitees")},f=function(e){var n;return n=$(t).find("[data-behavior~=invitees]"),n.addClass("loading"),n.install("behavior for invitee fields",function(e){return e.each(function(){var e;return e=new bcx.views.InviteeFieldList({el:this}),e.render(),$(this).data("view",e)})}),setTimeout(function(){return $.getJSON("/invitees.json",function(t){return n.each(function(){var e;return $(this).data("people",t),$(this).removeClass("loading"),e=$(this).data("view"),e!=null?e.reload():void 0}),typeof e=="function"?e():void 0})},10)},o=function(e){return $("body > header").transition({opacity:0},{duration:200,timing:"ease-in",complete:e})},u=function(e){return $("#workspace > .container").transition({opacity:0},{duration:200,timing:"ease-in"}),$("section.projects:first").transition({"padding-top":100},{duration:300,timing:"ease-in",complete:e})},N=function(e){return $("body > header").transition({opacity:1},{duration:200,timing:"ease-out",complete:e})},g=function(){return $("body > header").css({opacity:1})},C=function(e){return $("#workspace > .container").transition({opacity:1},{duration:200,timing:"ease-out"}),$("section.projects:first").transition({"padding-top":0},{duration:300,timing:"ease-out",complete:e})},a=function(){return $("#workspace").css({visibility:"hidden"})},L=function(){return $("#workspace").css({visibility:"visible"})},b=function(){return $("#workspace > .container").css({opacity:1}),y()},y=function(){return $("section.projects:first").css({"padding-top":0})},T=function(e){return $("body").append(t),p(),$("#new_project_dialog").show().css({padding:"200px 0"}).transition({padding:"0"},{duration:350,timing:"ease-out"}),$("#new_project_dialog > article.new").transition({width:640,height:300,opacity:1},{duration:350,timing:"ease-out",complete:e})},s=function(e){return $("#new_project_dialog").transition({padding:"200px 0"},{duration:350,timing:"ease-in"}),$("#new_project_dialog > article.new").transition({width:0,height:0,opacity:0},{duration:350,timing:"ease-in",complete:function(){return p(),$(t).detach(),typeof e=="function"?e():void 0}})},x=function(){return $("#new_project_dialog > article.new form").css({visibility:"visible"}),$("#new_project_dialog section.project_templates").css({opacity:1})},i=function(){return $("#new_project_dialog > article.new form").css({visibility:"hidden"}),$("#new_project_dialog section.project_templates").css({opacity:0})},r=function(){return $("#new_project_dialog > article.new").css({overflow:"hidden",height:"auto"})},n=function(){return $("#new_project_dialog > article.new").css({overflow:"",height:l()})},w=function(){return $("a[data-behavior~=slide].done_editing:visible").trigger("mousedown")},E=function(){var e;return e=$("div.welcome_message"),e.collapse(),e.find("input:checkbox").prop("checked",!1)},m=function(){return $("#new_superpowers").html("")},S=function(e){return setTimeout(function(){return $("#new_project_dialog > article.new").transition({width:900,height:900,margin:"90px auto"},{duration:600,timing:"ease-in-out",complete:e})},200)},h=function(){var e,n;return(e=$(t).find("a[data-accesses-list='team']").get(0))!=null&&e.click(),(n=$(t).find("section[data-accesses-list='client']"))!=null?n.removeClass("client_access_on"):void 0},p=function(){return!e&&$(t).is(":visible")&&i(),w(),m(),E(),$(t).hide().find("form[data-behavior~=create_project]").resetForm().find(".invitees").trigger("reset"),$(t).find("> article.new").css({width:"",height:"",margin:""}),$(t).find("p#new_superpowers_prompt").css({display:""}),$(t).find("[data-role~=project_card]").removeClass("inactive loading")},d=function(){var e,t,n;return e=$("form[data-behavior~=create_project]"),e.find("textarea[name~='project[name]']").html("Name the project"),e.find("textarea[name~='project[description]']").html(""),e.find("input[name~=project_template_id]").val(""),t=(n=$("[data-behavior~=invitees]"))!=null?n.data("view"):void 0,t!=null?t.flushAndReplaceSelection([]):void 0},v=function(){return bcx.currentAccount.canCreateProjects()?($("[data-role~=limit_projects_reached]").hide(),$("[data-role~=account_upgrade_notice]").hide(),$("[data-role~=account_upgrade_wrapper]").show()):($("[data-role~=limit_projects_reached]").show(),$("[data-role~=account_upgrade_wrapper]").hide())},k=function(){var e,t,n,r;return e=$("#new_project_dialog > article.new"),n=e.find("form.project_template"),t=e.find("form.new_project"),n.length?(t.hide(),n.show()):(r=t.show().find("textarea").focus().get(0))!=null?r.select():void 0},l=function(){return $("#new_project_dialog > article.new").height()},$("[data-behavior~=start_blank_project]").live("click",function(e){var t,n,r;return t=$("#new_project_dialog > article.new"),r=t.find("form.project_template"),n=t.find("form.new_project"),e.preventDefault(),r.hide(),n.fadeIn("fast",function(){return $(this).find("textarea").focus().get(0).select()}),t.find("div.blank_project").show(),$("[data-behavior~=slider]:visible").slider()})}.call(this),function(){bcx.on("page:change","paginate projects",function(){var e;if(e=$("[data-behavior~=infinite_projects]"))return e.infinitePage({url:e.data("path"),data:{presentation:e.data("presentation")}})}),$(document).on("click","[data-behavior~=change_project_view]",function(){var e,t;return t=$(this),e=t.parents(".project_view"),!t.hasClass("on")&&!e.hasClass("busy")&&($("[data-behavior~=change_project_view]").removeClass("on"),e.addClass("busy"),$.cookie("project_view",null,{path:"/"}),$.cookie("project_view",t.attr("class"),{expires:5e3,path:"/"+bcx.currentAccountSlug}),$.ajax({url:t.attr("data-path"),dataType:"html"}).done(function(e){return $("#all_projects").fadeOut(200,function(){var t;return $(this).html(e).fadeIn(200),t=$("[data-behavior~=infinite_projects]"),t.infinitePage({url:t.data("path"),data:{presentation:t.data("presentation")}})})}).always(function(){return e.removeClass("busy"),t.toggleClass("on")})),!1})}.call(this),function(){var e,t,n;n="div.project > div.sheet_body > section[data-collection-name]",t=function(e){var t,n;return t=e.data("collection-name"),(((n=bcx.currentProject)!=null?n.get(""+t+"_count"):void 0)===0||e.hasClass("empty"))&&e.find("article.new.expanded").length<1},e=function(){return $(n).each(function(){var e;return e=$(this),t(e)?e.hide():e.show()})},bcx.on("page:change","hide or show empty project sections",function(){return e()}),$(""+n+" > article.new[data-behavior~=expandable]").live("beforeexpand",function(){var e;return e=$(this).closest("section"),e.show()}).live("expand",function(){return $("div.sheet.project").removeClass("blank_slate")}).live("collapse",function(){var e;e=$(this).closest("section"),t(e)&&e.hide();if(!bcx.currentProject.isUsed()&&$(""+n+" > article.new[data-behavior~=expandable].expanded").length<1)return $("div.sheet.project").addClass("blank_slate")}),bcx.projects.bind("change",function(t){if(t===bcx.currentProject)return e()})}.call(this),function(){$("div.project_settings_links a:not(.skip_busy)").live("click",function(){return $(this).closest("div").addClass("busy")}),$("section.project_settings").find("a[data-behavior=cancel]").live("click",function(e){return $("#project_settings").slideUp(300,function(){return $("div.project_settings_links").removeClass("busy").fadeIn("fast")}),e.preventDefault()})}.call(this),function(){$(document).on("click","[data-behavior~=time_warp]",function(e){return e.preventDefault(),e.stopImmediatePropagation(),$(this).closest(".balloon").toggleClass("clicked"),setTimeout(function(e){return function(){return Stacker.workspace.visit($(e).closest("a").attr("href"),{replaceSheet:!0})}}(this),1500)}),bcx.on("page:change","randomize the animated gif img src",function(){var e;e=$("[data-role~=time_warp_img]");if(e.length)return e.attr("src",e.attr("src")+Date.now())})}.call(this),function(){var e;e=function(){return $.ajax({url:bcx.currentProject.urlForTrashOperation(),statusCode:{200:function(){return Stacker.workspace.visit(window.location.pathname,{replaceSheet:!0})},202:function(){return setTimeout(e,3e3)}},error:function(){return setTimeout(e,3e3)}})},bcx.on("page:change","request project trash operation status",function(){if($("[data-behavior~=trash_operation]").length>0)return e()})}.call(this),function(){var e;e=function(){function r(r){var i,s,o,u;i=$(r),s=new e(i),o=new t(i),u=new n(i)}var e,t,n;return t=function(){function e(e){this.$container=e,this.$container.find("input[type=text]").focus(function(e){return function(t){return e.onFocus(t)}}(this)).keyup(function(e){return function(t){return e.onKeyUp(t)}}(this)).keydown(function(e){return function(t){return e.onKeyDown(t)}}(this)).bind("clickoutside",function(e){return function(t){return e.onClickOutside(t)}}(this)),this.$container.bind("jumpto:cancel",function(e){return function(t){return e.onCancel(t)}}(this)),this.$container.bind("jumpto:visit",function(e){return function(t){return e.onVisit(t)}}(this)),navigator.userAgent.match(/MSIE/)&&this.$container.find("[data-behavior~=placeholder]").placeholder()}return e.prototype.keyEventFor=function(e){switch(e){case $.ui.keyCode.TAB:return"jumpto:down";case $.ui.keyCode.UP:return"jumpto:up";case $.ui.keyCode.DOWN:return"jumpto:down";case $.ui.keyCode.ENTER:return"jumpto:pick";case $.ui.keyCode.ESCAPE:return"jumpto:cancel";case $.ui.keyCode.HOME:return"jumpto:first";case $.ui.keyCode.END:return"jumpto:last";case $.ui.keyCode.PAGE_UP:return"jumpto:first";case $.ui.keyCode.PAGE_DOWN:return"jumpto:last";default:return null}},e.prototype.onFocus=
function(e){return $(e.currentTarget).trigger("jumpto:focus")},e.prototype.onKeyUp=function(e){var t;if(!this.keyEventFor(e.which))return t=$(e.currentTarget),t.trigger("jumpto:update",$.trim(t.val()))},e.prototype.onKeyDown=function(e){var t;if(t=this.keyEventFor(e.which))return $(e.currentTarget).trigger(t),e.preventDefault()},e.prototype.onClickOutside=function(e){return $(e.currentTarget).blur(),$(e.currentTarget).trigger("jumpto:blur")},e.prototype.onCancel=function(e){var t;t=this.$container.find("input[type=text]");if(t.val())return t.val("")},e.prototype.onVisit=function(e){return this.$container.find("input[type=text]").blur().val(""),this.$container.trigger("jumpto:blur")},e}(),n=function(){function e(e){this.$container=e,this.$container.bind("jumpto:results",function(e){return function(t,n){return e.onResults(t,n)}}(this)).bind("jumpto:update",function(e){return function(t,n){return e.onUpdate(t,n)}}(this)).bind("jumpto:cancel",function(e){return function(t){return e.onCancel(t)}}(this)).bind("jumpto:focus",function(e){return function(t){return e.onFocus(t)}}(this)).bind("jumpto:blur",function(e){return function(t){return e.onBlur(t)}}(this)).bind("jumpto:pick",function(e){return function(t){return e.onPick(t)}}(this)).bind("jumpto:up",function(e){return function(t){return e.onUp(t)}}(this)).bind("jumpto:down",function(e){return function(t){return e.onDown(t)}}(this)).bind("jumpto:first",function(e){return function(t){return e.onFirst(t)}}(this)).bind("jumpto:last",function(e){return function(t){return e.onLast(t)}}(this)),this.$container.find("[data-search-result]").live("mouseenter",function(e){return function(t){return e.onHover(t)}}(this))}return e.prototype.onResults=function(e,t){var n,r,i;return i=t.query,r=t.content,n=this.$resultsPageFor(i),n.length?n=n.replaceWith(r):this.$container.find("dl:last").after(r),this.selectFirstResult(),this.$container.trigger("jumpto:focus")},e.prototype.onUpdate=function(e,t){var n;return t?(n=this.$resultsPageFor(t),n.length?this.$container.trigger("jumpto:focus"):this.$container.trigger("jumpto:query",t),this.selectFirstResult()):this.$container.trigger("jumpto:cancel")},e.prototype.onCancel=function(e){return this.deselectAll(),this.$container.find("dl").hide()},e.prototype.onFocus=function(e){var t;this.$container.find("dl").hide(),this.deselectInactive(),t=this.$activeResults();if(t.length)return t.show(),this.$container.trigger("jumpto:activate")},e.prototype.onBlur=function(e){return this.$container.find("dl").hide()},e.prototype.onPick=function(e){var t,n;return this.$activeSelection().length?this.visit(this.$activeSelection().find("a").attr("href")):this.$activeResults().find("dd").length===1?(this.select(this.$activeResults().find("dd")),$(e.currentTarget).trigger("jumpto:pick")):this.$activeResults().length?this.visit(this.$activeResults().find("a").attr("href")):(t=this.$container.find("input[type=text]").val(),n="/"+bcx.currentAccountSlug+"/search?q="+encodeURIComponent(t),bcx.currentProject!=null&&(n+="&project_id="+bcx.currentProject.id),bcx.currentBucket!=null&&(n+="&bucket_id="+bcx.currentBucket.getBucketId()),this.visit(n))},e.prototype.onUp=function(e){var t,n;return t=this.$activeSelection(),t.length?(n=t.prev("[data-search-result]"),n.length||(n=t.prev("dt").prev("[data-search-result]")),n.length?this.select(n):$(e.currentTarget).trigger("jumpto:last")):$(e.currentTarget).trigger("jumpto:last")},e.prototype.onDown=function(e){var t,n;return n=this.$activeSelection(),n.length?(t=n.next("[data-search-result]"),t.length||(t=n.next("dt").next("[data-search-result]")),t.length?this.select(t):$(e.currentTarget).trigger("jumpto:first")):$(e.currentTarget).trigger("jumpto:first")},e.prototype.onFirst=function(e){return this.select(this.$activeResults().find("[data-search-result]:first"))},e.prototype.onLast=function(e){return this.select(this.$activeResults().find("[data-search-result]:last"))},e.prototype.onHover=function(e){return this.select($(e.target).closest("[data-search-result]"))},e.prototype.$resultsPageFor=function(e){return this.$container.find("dl[data-query="+$.md5(e)+"][data-bucket-id="+this.getCurrentBucketId()+"]")},e.prototype.activeQuery=function(){return $.md5($.trim(this.$container.find("input[type=text]").val()))},e.prototype.$activeResults=function(){return this.$container.find("dl[data-query="+this.activeQuery()+"][data-bucket-id="+this.getCurrentBucketId()+"]")},e.prototype.$inactiveResults=function(){return this.$container.find("dl[data-query!="+this.activeQuery()+"][data-bucket-id!="+this.getCurrentBucketId()+"]")},e.prototype.$activeSelection=function(){return this.$activeResults().find(".selected")},e.prototype.deselect=function(e){return e.removeClass("selected")},e.prototype.deselectAll=function(){return this.deselect(this.$container.find("dl > *"))},e.prototype.deselectInactive=function(){return this.deselect(this.$inactiveResults().find("dd"))},e.prototype.selectFirstResult=function(){return this.select(this.$activeResults().find("[data-search-result]:first"))},e.prototype.select=function(e){if(e.length>0)return this.deselectAll(),e.addClass("selected")},e.prototype.visit=function(e){return Stacker.workspace.visit(e,{defaultStack:!0}),this.$container.trigger("jumpto:visit")},e.prototype.getCurrentBucketId=function(){var e,t;return(e=(t=bcx.currentBucket)!=null?t.getBucketId():void 0)!=null?e:""},e}(),e=function(){function e(e){this.$container=e,$(document).bind("page:change",function(e){return function(){return e.$container.trigger("jumpto:cancel")}}(this)),this.$container.bind("jumpto:query",function(e){return function(t,n){return e.onQuery(t,n)}}(this)).bind("jumpto:activate",function(e){return function(){return e.stopWaiting()}}(this)).bind("jumpto:cancel",function(e){return function(){return e.stopWaiting()}}(this)).bind("jumpto:visit",function(e){return function(){return e.stopWaiting()}}(this))}return e.blindWaitThreshold=300,e.prototype.onQuery=function(e,t){var n,r,i;return this.startWaiting(),n={q:t,project_id:(r=bcx.currentProject)!=null?r.id:void 0,bucket_id:(i=bcx.currentBucket)!=null?i.getBucketId():void 0,t:+(new Date)},n[$.cookie("csrf-param")]=encodeURIComponent($.cookie("csrf-token")),$.support.cors?$.ajax({url:""+location.protocol+"//"+bcx.searchHost+"/"+bcx.currentAccountSlug+"/jumpto",type:"GET",data:n,xhrFields:{withCredentials:!0},crossDomain:!0}):$.ajax({url:"/jumpto",type:"GET",data:n})},e.prototype.startWaiting=function(){return this.waitTimeout!=null?this.waitTimeout:this.waitTimeout=setTimeout(function(e){return function(){return e.$container.addClass("waiting")}}(this),this.constructor.blindWaitThreshold)},e.prototype.stopWaiting=function(){return this.waitTimeout!=null&&(clearTimeout(this.waitTimeout),this.waitTimeout=null),this.$container.removeClass("waiting")},e}(),r}(),$(function(){return new e("[data-behavior~=jumpto]")})}.call(this),function(){var e,t;e=null,t=function(t){var n,r,i,s,o,u,a,f;return n=$(this),s=n.data("project-id"),r=$("[data-behavior~=project_star][data-project-id="+s+"]"),i="/projects/"+s+"/stars",a=t.data,(f=bcx.currentProject)!=null&&f[a.action](),r.toggleClass("on",a.toggle),a.toggle?r.removeBehavior("hover_content"):r.addBehavior("hover_content").trigger("mouseenter"),n.parent().hasClass("card")&&r.trigger("mouseleave"),o=$.cookie("project_view")==="starred"&&n.data("refresh-project-view")!==!1,u=$.cookie("project_view")==="list"&&n.data("refresh-project-view")!==!1,$.ajax(i,{type:a.verb,data:{refresh_project_cards:o,refresh_project_list:u},success:function(t){var r,i,s,f;if(o){if((i=$("section.projects.cards")).length){r=n.closest("article"),r.preserveScrollOffset(function(){return i.html(t)});if(a.toggle)return s=$(".starred_project_notification"),s.show().offset({top:r.offset().top-parseInt(s.height()/2)}),e!=null&&clearTimeout(e),e=setTimeout(function(){return s.fadeOut(),e=null},4e3)}}else if(u&&(f=$("div.stars_list")).length)return r=n.closest("article"),r.preserveScrollOffset(function(){return f.html(t)})}}),t.preventDefault()},$(".on[data-behavior~=project_star]").live("click tap",{verb:"DELETE",action:"unstar",toggle:!1},t),$("[data-behavior~=project_star]:not(.on)").live("click tap",{verb:"POST",action:"star",toggle:!0},t),bcx.on("page:update",'apply "on" class to current project star',function(){var e,t;if((t=bcx.currentProject)!=null?t.starred:void 0)if((e=$("div.sheet.project [data-behavior~=project_star]:not(.on)")).length>0)return e.addClass("on")}),bcx.on("page:change","request current project star state",function(){var e;if((e=$("div.sheet.project [data-behavior~=project_star]")).length>0)return $.ajax("/projects/"+e.attr("data-project-id")+"/stars",{success:function(e){var t,n;return e==="on"?(t=bcx.currentProject)!=null?t.star():void 0:(n=bcx.currentProject)!=null?n.unstar():void 0}})})}.call(this),function(){$("a[data-behavior~=resubscribe]").live("click",function(e){return e.preventDefault(),$(this).parent().addClass("busy"),$.post($(this).url())})}.call(this),function(){var e,t,n,r;bcx.on("page:change","watch unfinished copies",function(){return $("[data-role~=copyable_project][data-last-copy-status=pending], [data-role~=copyable_project][data-last-copy-status=processing]").each(function(){var e,t,n;return e=$(this),n=e.data("last-copy-status"),t={id:e.data("last-copy-id")},e.find("[data-role=copy_available], [data-role=copy_confirm]").hide(),e.find("[data-role=copy_processing]").show(),r(t)})}),$(document).on("click","[data-behavior~=confirm_todo_preserve]",function(e){var t;return t=$(this).closest("[data-role~=copyable_project]"),t.find("[data-role=copy_available]").hide(),t.find("[data-role=copy_confirm]").show(),e.preventDefault()}),$(document).on("click","[data-behavior~=copy_to_template]",function(t){var n,i,s;return n=$(this).closest("[data-role~=copyable_project]"),s=$(this).data("preserve-todo-assignments"),i={preserve_todo_assignments:s},n.find("[data-role=copy_available]").hide(),n.find("[data-role=copy_confirm]").hide(),n.find("[data-role=copy_processing]").show(),$.ajax({type:"POST",url:$(this).data("copy-path"),data:i}).done(function(e){return r(e)}).fail(function(){return e(n)}),t.preventDefault()}),$(document).on("click","[data-behavior~=cancel_copy]",function(e){var t;return t=$(this).closest("[data-role~=copyable_project]"),t.find("[data-role=copy_available]").show(),t.find("[data-role=copy_confirm]").hide(),e.preventDefault()}),r=function(e){var r,i;return r=new bcx.CopyOperation({id:e.id}),i=new BackgroundOperationProcessor(r),i.pollDelay=5e3,i.on("processor:success",function(){return n(r)}),i.on("processor:failed",function(){return t(r)}),i.startWatchingOperation()},n=function(e){var t;return t=$("article[data-project-id="+e.get("source_resource_id")+"]"),t.find("[data-behavior=copy_to_template_url]").attr("href","/"+bcx.currentAccountSlug+"/projects/"+e.get("destination_resource_id")),t.find("[data-role=copy_processing]").hide(),t.find("[data-role=copy_finished]").show()},t=function(t){var n;return n=$("article[data-project-id="+t.get("source_resource_id")+"]"),e(n)},e=function(e){return e.find("[data-role=copy_processing]").hide(),e.find("[data-role=copy_error]").show()}}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c;n=!1,bcx.on("animate_draft:on","flag draft creation",function(){return n=!0}),bcx.on("page:update","hide project settings on drafts",function(){if($("div.sheet.project[data-status=draft]").length)return s()}),bcx.on("page:beforechange page:change","hide or show project draft notice",function(){return $("div.sheet.project[data-status=draft]").length?(u(),bcx.peopleAndGroups.load(c)):o()}),u=function(){if(!$("#draft_notice").length)return $("#workspace").before(JST["desktop/templates/draft_notice"](this)),f()},c=function(){var e,t,n;return t=_(bcx.currentBucket.people()).reject(function(e){return e.isPerson()&&e.id==="person_"+bcx.currentPerson.id}),e=function(){switch(t.length){case 0:return"You're the only one on this project. Invite more people so they can join the discussion.";case 1:return""+t[0].get("name")+" has been notified.";case 2:case 3:case 4:return n=t.map(function(e){return e.get("name")}).sort().join(", ").replace(/,\s([^,]+)$/," and $1"),""+n+" have been notified.";default:return n=t.slice(0,3).map(function(e){return e.get("name")}).sort().join(", "),""+n+", and "+(t.length-3)+" other people have been notified."}}(),$('p[data-behavior~="recipients_notified_notice"]').html(e)},o=function(){return $("#draft_notice").remove()},a=function(){return $("#draft_notice").removeClass("initial_load")},f=function(){return n?(t(),n=!1):a()},t=function(){return setTimeout(function(){var e;return e=$("#draft_notice"),e.css({display:"block",height:0}),e.transition({height:e.find("> div").height()+40},{duration:250,timing:"ease-in-out",complete:function(){return e.transition({opacity:1},{duration:300,timing:"ease-in-out",complete:function(){return e.css({height:""}),e.removeClass("initial_load"),$("[data-behavior~=edit_project_header] h1[data-behavior~=editable_field_prompt]").click()}})}})},700)},i=function(){var e;return e=$("#draft_notice"),e.find("section.draft_description").hide(),e.find("section.draft_confirmation").show().transition({opacity:1}),setTimeout(function(){return e.css({height:e.find("> div").height()+40}),e.transition({opacity:0},{duration:300,timing:"ease-in-out",complete:function(){return e.transition({height:0},{complete:function(){return e.hide()}})}})},6e3)},l=function(){return $("section.project_settings a.settings").show(),$("section.project_settings a.delete").hide()},s=function(){return $("section.project_settings a.settings").hide(),$("section.project_settings a.delete").show()},e=function(){return $("div.sheet.project[data-status=draft]").data("status","active")},r=function(){return bcx.currentBucket.justPublished=!0,e(),i(),_.defer(l)},$("[data-behavior~=publish_draft_project]").live("click",function(e){return $(this).closest(".submit").addClass("busy"),$.ajax({url:bcx.currentProject.urlForPublish(),type:"PUT",success:r}),e.preventDefault()})}.call(this),function(){var e,t,n;e=!1,$("[data-behavior~=show_template_actions]").live("click",function(e){return $(this).closest("[data-role~=template_card]").expand(),e.preventDefault()}),$("[data-role~=template_card] [data-behavior~=confirm_delete]").live("click",function(e){return e.preventDefault(),e.stopImmediatePropagation(),n($(this).closest("[data-role~=template_card]"))}),$("[data-role~=template_card] [data-behavior~=cancel_delete]").live("click",function(e){return $(this).closest("[data-role~=template_card]").collapse(),e.preventDefault()}),$("[data-role~=template_card]").live("beforeexpand",function(){return $(this).find("div.actions").css({"margin-top":"30px",opacity:0})}).live("expand",function(){return $(this).find("div.actions").transition({"margin-top":"0",opacity:1},{duration:200,timing:"ease-in-out"})}).live("collapse",function(){var e;return e=$(this),t(e)}),n=function(e){return e.find("div.actions > ul").hide(),e.find("div.actions > div").show().transition({opacity:1})},t=function(e){return e.find("div.actions > ul").show(),e.find("div.actions > div").hide().css({opacity:0})}}.call(this),function(){var e;e=function(){function e(e,t){this.projectId=e,this.root=t!=null?t:$(document),this.projectId!=null&&(this.panel=$("div.panel:first"),this.load())}return e.prototype.load=function(){if(!this.loading())return this.loaded()?this.updateSelects():this.fetch()},e.prototype.loading=function(){return this.panel.data("assignee-options-loaded-"+this.projectId)!=null&&this.options()==null},e.prototype.loaded=function(){return this.panel.data("assignee-options-loaded-"+this.projectId)!=null&&this.options()!=null},e.prototype.options=function(){return this.panel.data("assignee-options-"+this.projectId)},e.prototype.fetch=function(){return this.panel.attr("data-assignee-options-loaded-"+this.projectId,!0),$.getJSON("/projects/"+this.projectId+"/assignees.json",function(e){return function(t){return e.panel.data("assignee-options-"+e.projectId,t),e.updateSelects(t)}}(this))},e.prototype.updateSelects=function(e,t){return t==null&&(t=this.options()),this.root.find("select[data-behavior~=assignee_options][data-project-id="+this.projectId+"][data-assignee-options-loaded!=true]").each(function(e){return function(n,r){return e.updateSingleSelect($(r),t)}}(this))},e.prototype.updateSingleSelect=function(e,t){var n,r,i,s,o;return o=e.data("assignee-code"),n="p"+bcx.currentPerson.id,s=e.data("private")?t.team_people:t.people,r=e.data("private")?t.team_groups:t.groups,e.attr("data-assignee-options-loaded",!0).find("option").remove().end().append("<option value=''>Unassigned</option>").append("<option value='"+n+"' data-current-person='true'>Me ("+_.escape(bcx.currentPerson.attributes.name)+")</option>").append("<option disabled></option>"),i=(o!=null?o[0]:void 0)==="g"&&r.length?[this.optionTags("People",s,"Person",o),this.optionTags("Companies",r,"Group",o)]:_(s).map(function(e){return function(t){var r,i,s,u,a;return u=t[0],i=t[1],a=t[2],s=t[3],r=i===n?$('<option value="'+i+'" data-current-person="true" '+e.selectedAttr(i,o)+">"):$('<option value="'+i+'" data-assignee-wants-notifications="'+a+'" data-first-name="'+s+'" '+e.selectedAttr(i,o)+">"),r.text(u)}}(this)),e.append.apply(e,i).trigger("todos:assignee_options:loaded")},e.prototype.optionTags=function(e,t,n,r){var i;return i="<optgroup label='"+e+"'>",_(t).each(function(e){return function(t){return i+='<option value="'+t[1]+"\" data-type='"+n+"' "+e.selectedAttr(t[1],r)+">"+_.escape(t[0])+"</option>"}}(this)),i+="</optgroup>"},e.prototype.selectedAttr=function(e,t){return e===t?'selected="selected"':""},e}(),$("[data-behavior~=load_assignee_options]").live("mouseenter focus",function(){return $(this).find("select[data-behavior~=assignee_options]").install("assignee-options",function(t){return new e(t.data("project-id"),t.parent())})}),$("a[data-behavior~=load_assignee_options]").live("mouseenter touchstart",function(){return new e($(this).parent().parent().find("select[data-behavior~=assignee_options]").data("project-id"))}),window.bcx.AssigneeOptionsLoader=e}.call(this),function(){var e,t,n,r,i,s,o,u,a,f;t="select[data-behavior=todos_date_filter]",e="select[data-behavior=todos_assignee_filter]",u="li.todo:not([data-behavior~=complete])",r=$.support.touch&&$.browser.mobile?"touchstart":"focus",$(e).live(""+r+" update",function(e,t){var r,i,o;return i=$(this).val(),$(this).find("option[value!=]").remove(),o=n.settings().dueDate,o&&(r=f(o)),_.each($(this).data("options"),function(e){return function(t){var n;n=s(t.value,r);if(n.length!==0)return $(e).append('<option value="'+t.value+'">'+t.option+" ("+n.length+")</option>")}}(this)),$(this).val(t||i)}),window.bcx.todosDateFilterAction=function(e,t){var r,i,s;return s=e.val(),e.find("option[value!=]").remove(),i=n.settings().assigneeCode,i&&(r=a(i)),_.each(e.data("options"),function(t){return function(t){var n;n=o(t.value,r);if(n.length!==0)return e.append('<option value="'+t.value+'">'+t.option+" ("+n.length+")</option>")}}(this)),e.val(t||s)},$(t).live(""+r+" update",function(e,t){return window.bcx.todosDateFilterAction($(this),t)}),$(""+e+", "+t).live("change",function(){return $(document).trigger("todofilter:settingschange")}),$("a[data-behavior~=show_all_todos]").live("click",function(e){return n.reset(),e.preventDefault()}),i=function(){var e;return""+(((e=bcx.currentProject)!=null?e.id:void 0)||window.location.pathname)+":todoFilters"},$(document).bind("todofilter:change todofilter:reset",function(){return bcx.storage.set(i(),n.settings())}),bcx.on("page:change","load todo filter settings from storage",function(){n.updateFromStorage();if(!n.noneSet())return $(document).trigger("todofilter:settingschange")}),$(document).bind("todofilter:settingschange todolists:loadmore todos:update",function(){if($(e).length||$(t).length)return n.apply(),n.updateFromStorage()}),n={settings:function(){return{assigneeCode:$(e).val(),dueDate:$(t).val()}},noneSet:function(){return _.compact(_.values(n.settings())).length===0},reset:function(){return $("section.todos").removeClass("filtered"),$("ul.todolists > li").show(),$(u).show(),$(t).val(""),$(e).val(""),$(document).trigger("todofilter:reset")},updateFromStorage:function(){var n;if($(""+e+", "+t).length)if(n=bcx.storage.get(i())){n.assigneeCode&&$(e).trigger("update",n.assigneeCode);if(n.dueDate)return $(t).trigger("update",n.dueDate)}},apply:function(){var e,t,r,i,s;return i=n.settings().assigneeCode,s=n.settings().dueDate,n.noneSet()?n.reset():(n.displayHeader(),$("section.todos").addClass("filtered"),$("ul.todolists > li").show(),r=$(u).hide(),i&&(e=a(i)),s&&(t=f(s)),e&&t?$(_.intersection(e,t)).show():e?e.show():t&&t.show(),$("ul.todolists > li").each(function(){if(!$(this).find("ul.todos li.todo:visible").length&&!$(this).find("article.todolist").hasClass("new"))return $(this).hide()}),$(document).trigger("todofilter:change"))},displayHeader:function(){var r,i,s,o,u;r=$("[data-behavior~=todo_filter_header]"),r.find("span").hide();if(i=n.settings().assigneeCode)s=_.detect($(e).data("options"),function(e){return e.value.toString()===i}).option;if(u=u=n.settings().dueDate)o=_.detect($(t).data("options"),function(e){return e.value===u}).option;if(s&&o)return r.find("[data-behavior=assigned_to]").show().find("[data-behavior=value]").html(s).show(),r.find("[data-behavior=filter_and]").show(),r.find("[data-behavior=filter_due]").show().find("[data-behavior=value]").html(o.toLowerCase()).show();if(s)return r.find("[data-behavior=assigned_to]").show().find("[data-behavior=value]").html(s).show();if(o)return r.find("[data-behavior=filter_due]").show().find("[data-behavior=value]").html(o.toLowerCase()).show()}},a=function(e){return e==="unassigned"?$(""+u+":not([data-assignee-code])"):$(""+u+"[data-assignee-code="+e+"]")},f=function(e){return e==="never"?$(""+u+":not([data-due-datetime])"):$(""+u+"[data-due-datetime]").filter(function(){var t;t=CalendarDate.parse($(this).data("due-datetime"));switch(e){case"today":return t.equals(CalendarDate.today());case"tomorrow":return t.equals(CalendarDate.today().next());case"week":return CalendarDate.today().fallsOnSameWeekAs(t);case"nextweek":return CalendarDate.today().next(7).fallsOnSameWeekAs(t);case"later":return t.compareTo(CalendarDate.today().beginningOfWeek().next(14))>=0;case"past":return t.compareTo(CalendarDate.today())===-1}})},s=function(e,t){var n;return n=a(e),t?_.intersection(n,t):n},o=function(e,t){var n;return n=f(e),t?_.intersection(t,n):n}}.call(this),function(){var e;e=function(e){var t,n;return t=e.data("collection-name"),((n=bcx.currentProject)!=null?n.get(""+t+"_count"):void 0)===0},$("[data-behavior~=new_todolist]").live("click",function(e){return $("article.todolist.new").expand(),e.preventDefault()}),$("article.todolist [data-behavior=edit]").live("click",function(e){return $(this).closest("article.todolist").expand(),$(document).trigger("client_projects:editing"),e.preventDefault()}),$("div.sheet.todolist aside [data-behavior=edit]").live("click",function(e){return $(this).closest("div.sheet").find("article.todolist").expand(),$(document).trigger("client_projects:editing"),e.preventDefault()}),$("section.todos article.todolist[data-behavior~=expandable]").live("expand",function(e){var t;if(e.target!==this)return;return t=$(this),$("div.sheet.todolists").removeClass("blank_slate"),setTimeout(function(){return t.find("input[type=text]").first().focus().get(0).select(),t.find("textarea").keydown()},10)}).live("collapse",function(t){var n,r;if(t.target!==this)return;return n=$(this),n.find("form").resetForm(),$(document).trigger("client_projects:done_editing"),r=$(this).closest("section"),e(r)&&$("div.sheet.todolists").addClass("blank_slate"),n.closest("article.todolist").find("div.nubbin").removeClass("busy")}),$("form.edit_todolist, form.new_todolist").live("ajax:before",function(){var e,t;e=$(this);if((t=e.find(':input[name="todolist[name]"]')).length&&!$.trim(t.val()))return e.removeClass("submitting"),t.get(0).focus(),!1})}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c;$(document).bind("todo:move",function(e,t,n){var r,i;return r=$(n).find("> article.todolist"),r.find("ul.empty").removeClass("empty"),i={context:"move",todo:{position:t}},r.length&&(i.todo.todolist_id=r.id()),$.ajax({url:$(e.target).url(),type:"PUT",data:i})}),$(document).bind("todolist:move",function(e,t){var n;return n=$(e.target).find("> article.todolist"),$.ajax({url:n.url(),type:"PUT",data:{context:"move",todolist:{position:t}}})}),$("article.todolist li [data-behavior~=toggle], :checkbox[data-behavior~=toggle_todo]").live("click",function(){return $.ajax({url:$(this).url(),type:"POST"})}),$("article.todolist ul.new").live("expand",function(e){var t;if(e.target!==this)return;return t=$(this),t.find("textarea").first().focus(),_.defer(function(){return t.find(".busy").removeClass("busy")})}),$(document).on("todos:assignee_options:loaded","select[data-behavior~=assignee_options]",function(e){return f($(this)),a($(this))}),$(".new_todo").live("keydown",function(e){var t;t=$(e.target);if(t.parents("li.edit_mode").length&&e.keyCode===$.ui.keyCode.ESCAPE)return t.closest("form").find("a[data-behavior=cancel]").click()}),$(".new_todo [data-behavior~=assignee_options]").live("keydown",function(e){var t;t=$(e.target);if(t.parents("li.edit_mode").length&&e.keyCode===$.ui.keyCode.TAB)return _.defer(function(){return t.closest("form").find("span[data-behavior~=expandable]").expand()})}),$(document).on("file:drop","article.todolist li.edit_mode article[data-behavior~=file_drop_target]",function(){return $(this).closest("li").find("[data-behavior~=todo_attachments]").expand()}),$("span[data-behavior~=expandable]:has([data-behavior~=relative_date_picker])").live("beforeexpand",function(){var e,t,n;return e=$(this).find("[data-behavior~=relative_date_picker]"),t=e.closest("form"),n=new bcx.views.RelativeDatePicker({el:e,due_week:t.find('input[name~="todo[due_week]"]').val(),due_wday:t.find('input[name~="todo[due_wday]"]').val(),onDatePick:function(n,r){var i;return i=e.closest("span.pill"),t.find('input[name~="todo[due_week]"]').val(n),t.find('input[name~="todo[due_wday]"]').val(r),t.hasBehavior("new_todo")||t.hasBehavior("edit_todo")?(i.find("time").text("Week "+(n+1)+" "+CalendarDate.weekdayNames[r]),t.find("textarea").last().focus()):(i.addClass("busy"),t.submit()),i.collapse()}}),n.render()}),$("span[data-behavior~=expandable]:has([data-behavior~=date_picker])").live("beforeexpand",function(){var e,t,n;return t=$(this).find("[data-behavior~=date_picker]"),e=t.prev("[data-behavior~=alt_date_field]"),n=e.val(),t.closest("form").hasBehavior("new_todo")&&$(this).closest("span.pill").removeClass("blank"),t.datepicker({altField:e,dateFormat:"yy-mm-dd",altFormat:"yy-mm-dd",firstDay:CalendarDate.firstDayOfWeek,onSelect:function(){var e,n,r;return e=t.closest("form"),n=$(this).closest("span.pill"),e.hasBehavior("new_todo")||e.hasBehavior("edit_todo")?(r=t.datepicker("getDate"),n.find("time").text(CalendarDate.parse(r).abbreviatedShortWithWeekday()),e.find("textarea").last().focus()):(n.addClass("busy"),e.submit()),n.collapse()}}),n?t.datepicker("setDate",n):(t.datepicker("setDate",null),t.find(".ui-state-active").removeClass("ui-state-active"))}),$(".ui-datepicker-next, .ui-datepicker-prev").live("click",function(e){return e.stopImmediatePropagation()}),$("footer a[data-behavior~=no_due_date]").live("click",function(e){var t,n,r;return e.preventDefault(),n=$(this).closest("form"),n.find("[data-behavior~=alt_date_field]").val(""),r=n.find("span.pill"),n.hasBehavior("new_todo")||n.hasBehavior("edit_todo")?(t=r.find("time"),t.text(t.data("blank-text")),n.find("textarea").last().focus()):(r.addClass("busy"),n.submit()),r.collapse()}),e=function(){function e(e){this.selects=$(e)}return e.prototype.watch=function(e){return this.selects.live("keydown",function(t){var n;return n=$(this),t.keyCode===$.ui.keyCode.ENTER?e.call(this,n):n.data("assignee-changing",!0)}),this.selects.live("change",function(){var t;t=$(this),t.data("assignee-changed",!0);if(!t.data("assignee-changing"))return e.call(this,t)}),this.selects.live("mouseover blur",function(){return $(this).data("assignee-changing",!1)}),this.selects.live("blur",function(){var t;t=$(this);if(t.data("assignee-changed"))return e.call(this,t)})},e}(),s=new e("article.todolist li.edit_mode select"),s.watch(function(e){var t,n,r;return n=e.closest("span.pill"),t=n.find("[data-behavior~=assignee_name]"),t.width(t.width()),e.parents("form").find("textarea").last().focus(),(r=e.val())?(e.data("assignee-code",r),n.removeClass("blank"),t.text(e.find(":selected").text()),o(e)):(e.data("assignee-code",""),n.addClass("blank"),t.text(t.data("blank-text"))),f(e),a(e),e.data("assignee-changing",!1)}),u=new e("article.todolist li:not(.edit_mode) select, form[data-behavior~=edit_calendar_todo] select"),u.watch(function(e){return n(e)?l(e):c(e)}),$("article.todolist li:not(.edit_mode) [data-behavior~=confirm_assignee_change]").live("click",function(){return c($(this)),!1}),$("article.todolist li:not(.edit_mode) [data-behavior~=cancel_assignee_change]").live("click",function(){var e,t;return e=$(this).parents("form"),t=e.find("select"),t.val(e.data("original-assignee-code")),e.trigger("reset"),t.focus(),o(t),f(t),a(t),!1}),n=function(e){return(!bcx.currentBucket||bcx.currentBucket.isActive()&&!bcx.currentBucket.justPublished)&&e.find(":selected").data("assignee-wants-notifications")===!1},r=function(e){return e.find(":selected").data("current-person")===!0},i=function(e){return e.find(":selected").data("type")==="Group"},t=function(e){return e.find(":selected").data("first-name")},l=function(e){var n;return n=e.parents("form"),n.find("[data-display~=email-warning-confirmation-on]").show().find("[data-role=assignee_first_name]").text(t(e)||"This person"),n.find("[data-display~=email-warning-confirmation-off]").hide(),e.parents("form").find(".exclusively_expanded").trigger("expand")},o=function(e){return e.parents("form").find("[data-display~=email-warning-confirmation-on]").hide(),e.parents("form").find("[data-display~=email-warning-confirmation-off]").show()},f=function(e){var s;return s=e.parents("form"),i(e)?(s.find("[data-display~=email-warning-on]").hide(),s.find("[data-display~=email-warning-off]").hide()):n(e)&&!r(e)?(s.find("[data-display~=email-warning-on]").show().find("[data-role=assignee_first_name]").text(t(e)||"This person"),s.find("[data-display~=email-warning-off]").hide()):(s.find("[data-display~=email-warning-on]").hide(),s.find("[data-display~=email-warning-off]").show().find("[data-role=assignee_first_name]").text(t(e)||"This person"))},a=function(e){var s;return s=e.closest("form"),e.find(":selected").val().trim().length&&!i(e)&&!r(e)?n(e)?s.find("[data-display~=email-message-on]").hide():s.find("[data-display~=email-message-on]").show().find("[data-role=assignee_first_name]").text(t(e)||"This person"):s.find("[data-display~=email-message-on]").hide()},c=function(e){var t;return t=e.closest("span.pill"),t.collapse().addClass("busy"),t.closest("form").submit(),e.data("assignee-changing",!1),e.data("original-assignee-code",e.val())},$("article.todolist ul.new form").live("reset",function(){var e,t,n;return n=$(this),e=n.find("[data-behavior~=assignee_name]"),e.text(e.data("blank-text")),f(e),n.find("[data-display~=email-message-on]").hide(),n.find("[data-display~=email-warning-on]").hide(),n.find("[data-behavior~=todo_attachments]").collapse(),t=n.find("[data-behavior~=due_date]"),t.text(t.data("blank-text")),n.find("[data-behavior~=alt_date_field]").val(""),n.find("span.pill[data-behavior~=expandable]:has(.balloon)").collapse(),_.defer(function(){return n.find("textarea").last().focus()})}),$("span.pill[data-behavior~=expandable]:has(.balloon)").live("expand",function(e){return $(this).closest("li.todo").addClass("balloon_expanded"),$(this).find("[data-behavior~=assignee_options]").focus(),f($(this).find("select[data-behavior~=assignee_options]"))}),$("span.pill[data-behavior~=expandable]:has(.balloon)").live("collapse",function(e){return $(this).closest("li.todo").removeClass("balloon_expanded"),$(this).find("[data-behavior~=assignee_name]").width("auto")}),bcx.on("page:change",'show todo pills and add "ignore_hover" class',function(){return $("div.sheet.todo span.pill:not(.comments)").show().addClass("ignore_hover")}),$("article.todolist form.edit_todo, article.todolist form.new_todo").live("ajax:before",function(e){var t,n,r;n=$(this),r=$(e.target);if(r.is(n)&&(t=n.find(':input[name="todo[content]"]')).length&&!$.trim(t.val()))return n.removeClass("submitting"),t.get(0).focus(),!1}),$("[data-behavior~=load_completed_todos]").live("click",function(
e){return e.preventDefault(),e.stopImmediatePropagation(),$(this).closest("p").addClass("busy"),$(this).closest("ul.completed").load($(this).attr("href"))})}.call(this),function(){bcx.on("page:change page:update","show topic archiving tool in active buckets",function(){return _.defer(function(){var e;if((e=bcx.currentProject)!=null?e.isActive():void 0)return $("[data-role~=topic_archiving_tool]").show()})})}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/add_tagging"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="expanded_content balloon top_left_side">\n  <span class="arrow"></span>\n  <span class="arrow"></span>\n\n  <input type="text" name="tagging[tag_name]" value="" placeholder="Type to add a new label">\n  <div class="choose_tags"></div>\n\n  <div class="submit">\n    <input type="submit" value="Add label" class="action_button green"> or\n    <a href="#" data-behavior="cancel">I\'m done</a>\n  </div>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/adhoc_subscriber"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="autocomplete_people">\n  <label class="focused placeholder">Type a name or email address...</label>\n  <label class="blurred placeholder">Add another person...</label>\n  <input type="text" data-behavior="input_change_emitter" data-role="human_input" value="'),t.push(r(this.model.get("name"))),t.push('">\n  <input type="hidden" data-role="email_address_input" name="'),t.push(r(this.subscribable)),t.push('[new_subscriber_emails][]" value="'),t.push(r(this.model.get("email_address"))),t.push('">\n  <input type="hidden" data-role="person_id_input" name="'),t.push(r(this.subscribable)),t.push('[subscribers][]" value="'),t.push(r(this.model.get("person_id"))),t.push('">\n  <div class="suggestions" data-role="suggestions_view">\n    <!-- templates/autocomplete_people_suggestions -->  \n  </div>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/agenda"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l,c,h,p,d;this.isTemplate||(t.push('\n  <header class="upcoming">\n    <h1>Here&rsquo;s what&rsquo;s coming up next.</h1>\n    '),this.allUpcoming||t.push('\n      <a href="#" data-behavior="toggle_all" class="action_button">Show past events too</a>\n    '),t.push('\n  </header>\n\n  <header class="past">\n    <h1>Here&rsquo;s everything on the calendar.</h1>\n    '),this.allPast||t.push('\n      <a href="#" data-behavior="toggle_all" class="action_button">Show upcoming events only</a>\n    '),t.push("\n  </header>\n")),t.push("\n\n"),h=this.itemGroups;for(o=0,f=h.length;o<f;o++){i=h[o],t.push('\n  <article class="day '),i.date.isPast()&&!this.isTemplate&&t.push(r("past")),t.push('">\n    <header>\n      <h1 style="color: #'),t.push(r(this.bucket.getColor())),t.push('">'),t.push(r(this.isTemplate?i.date.relativeDateLabel():i.date.longWithYear())),t.push("</h1>\n      <time>"),this.isTemplate||t.push(r(i.date.dayThisWeek())),t.push('</time>\n    </header>\n\n    <div class="events">\n      <ul>\n        '),p=i.CalendarEvents;for(u=0,l=p.length;u<l;u++){n=p[u],t.push('\n          <li>\n            <a href="'),t.push(r(n.showPath())),t.push('" class="decorated">'),t.push(r(this.emojify(n.get("summary")))),t.push("</a>\n            "),n.isTimed()&&(t.push("\n              <span>at "),t.push(r(n.getStartTime().toFriendlyString())),t.push("</span>\n            ")),t.push("\n\n            ");if(e=n.get("comments_count"))t.push('\n              <span class="pill comments"><a href="'),t.push(r(n.showPath())),t.push('">'),t.push(r(this.pluralize(e,"comment"))),t.push("</a></span>\n            ");t.push("\n\n            "),n.get("private")&&t.push('\n              <span class="hidden_from_client">The client can&rsquo;t see this event</span>\n            '),t.push("\n          </li>\n        ")}t.push("\n\n        "),d=i.Todos;for(a=0,c=d.length;a<c;a++)s=d[a],t.push("\n          <li>\n            "),t.push(this.JST("todo",{todo:s,pluralize:this.pluralize,emojify:this.emojify,context:"agenda",isTemplate:this.isTemplate})),t.push("\n            "),s.get("private")&&t.push('\n              <span class="hidden_from_client">The client can&rsquo;t see this to-do</span>\n            '),t.push("\n          </li>\n        ");t.push("\n      </ul>\n    </div>\n  </article>\n")}t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/autocomplete_people_suggestions"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u;t.push('<ol class="suggestions">\n  ');if(((s=this.results.enabledOptions)!=null?s.length:void 0)||((o=this.results.disabledOptions)!=null?o.length:void 0)){t.push("\n    ");if(this.results.enabledOptions.length){t.push("\n      "),u=this.results.enabledOptions;for(n=0,i=u.length;n<i;n++)e=u[n],t.push('\n        <li class="'),e===this.selected&&t.push(r("selected")),t.push(' enabled option suggestion" data-behavior="select_suggestion" data-suggestion-id="'),t.push(r(e.id)),t.push('">\n          '),e.isSubgroup()?(t.push('\n            <strong class="name">'),t.push(r(e.get("name"))),t.push("</strong> <span>Group at "),t.push(r(e.group().get("name"))),t.push(" with "),t.push(r(this.pluralize(e.get("member_ids"),"person","people"))),t.push("</span>\n          ")):e.isGroup()?(t.push('\n            <strong class="name">'),t.push(r(e.get("name"))),t.push("</strong> <span>Company with "),t.push(r(this.pluralize(e.get("member_ids"),"person","people"))),t.push("</span>\n          ")):(t.push('\n            <span class="name">'),t.push(r(e.get("name"))),t.push('</span> <span class="email">'),t.push(r(e.get("email_address"))),t.push("</span>\n          ")),t.push("\n        </li>\n      ");t.push("\n    ")}else t.push('\n      <li class="disabled hint suggestion">\n        '),this.results.disabledOptions[0].isGroup()?(t.push('\n          Everyone from <span class="name">'),t.push(r(this.results.disabledOptions[0].get("name"))),t.push("</span> is already on the project.\n        ")):(t.push('\n          <span class="name">'),t.push(r(this.results.disabledOptions[0].get("name"))),t.push("</span> is already on the project.\n        ")),t.push("\n      </li>\n    ");t.push("\n  ")}else t.push("\n    "),this.showInvalidMessage?t.push('\n      <li class="invalid hint suggestion">\n        This email address isn’t formatted properly.\n      </li>\n    '):(t.push("\n      "),this.showUnknownMessage&&t.push('\n        <li class="unknown hint suggestion">\n          This person isn’t in the system yet. Please enter their email address instead.\n        </li>\n      '),t.push("\n    ")),t.push("\n  ");t.push("\n</ol>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/autocomplete_subscribers/group"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a;t.push('<li class="subscriber group" data-role="subscriber_group" data-id="'),t.push(r(this.group.id)),t.push('">\n  <div class="group_name">\n    <div class="icon group"></div>\n    <span class="name">'),t.push(r(this.group.get("name"))),t.push('</span>\n    <a href="#" class="remove" data-behavior="remove">Remove</a>\n  </div>\n  <ul>\n    '),u=this.people;for(n=0,s=u.length;n<s;n++)e=u[n],t.push("\n      "),t.push(this.renderSubscriber(e)),t.push("\n    ");t.push("\n\n    ");if(this.unsubscribers.length){t.push("\n      "),a=this.unsubscribers;for(i=0,o=a.length;i<o;i++)e=a[i],t.push("\n        "),t.push(this.renderSubscriber(e)),t.push("\n      ");t.push("\n    ")}t.push("\n  </ul>\n</li>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/autocomplete_subscribers/index"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s;t.push('<div class="subscribed_people">\n  <ul data-role="subscribers">\n    ');if(this.peopleAndGroups.loaded){t.push("\n      "),s=this.subscribers();for(n=0,i=s.length;n<i;n++)e=s[n],t.push("\n        "),t.push(this.renderSubscriber(e)),t.push("\n      ");t.push("\n    ")}t.push('\n  </ul>\n</div>\n\n<div class="new_subscriber">\n  <input type="text" '),this.peopleAndGroups.loaded||t.push(r("disabled")),t.push(' data-behavior="new_subscriber placeholder prevent_enter" placeholder="Type a name or email address..." >\n</div>\n\n<div class="choose_subscribers" data-role="choose_subscribers"></div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/autocomplete_subscribers/subscriber"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<li class="subscriber '),this.isDisabled&&t.push(r("disabled")),t.push('"\n    data-role="subscriber"\n    data-id="'),t.push(r(this.model.id)),t.push('"\n    data-new-subscriber-email="'),this.model.isNewlyInvitedPerson()&&t.push(r(this.model.get("email_address"))),t.push('">\n  <a>\n    '),this.model.isGroup()?(t.push('\n      <div class="icon group"></div>\n      <span class="name">\n        '),t.push(r(this.model.get("name"))),t.push("\n      </span>\n      "),this.model.get("name")!=="Everyone"&&(t.push('\n        <span class="byline">\n          '),this.model.isSubgroup()?(t.push("\n            Group inside "),t.push(r(this.model.group().get("name"))),t.push("\n          ")):(t.push("\n            "),t.push(r("Company")),t.push("\n          ")),t.push("\n        </span>\n      ")),t.push("\n    ")):this.model.isNewlyInvitedPerson()?(t.push('\n      <div class="icon new_person"></div>\n      <span class="name">\n        '),t.push(r(this.model.get("email_address"))),t.push('\n      </span>\n      <span class="byline looped_in">Looped in.</span>\n    ')):(t.push('\n      <img class="avatar" src="'),t.push(r(this.model.get("avatar"))),t.push('" alt="">\n      <span class="name">\n        '),t.push(r(this.model.get("name"))),t.push("\n      </span>\n      "),this.isDisabled&&t.push('\n        <span class="byline">Turned off email notifications.</span>\n      '),t.push("\n      "),this.isOutsideSubscriber&&t.push('\n        <span class="byline looped_in">Looped in.</span>\n      '),t.push("\n    ")),t.push("\n  </a>\n\n  "),this.forceSubscriber||t.push('\n    <a href="#" class="remove" data-behavior="remove">Remove</a>\n  '),t.push("\n</li>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/bucket_operation_tool_conflict"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n;t.push("<strong>"),t.push(r(this.label)),t.push(" this "),t.push(r(this.sourceResourceHumanName)),t.push("</strong>\n\n"),this.conflict.status==="completed"?(t.push("\n  <p>\n    "),this.conflict.destination?(t.push("\n      "),t.push(r(this.conflict.creator.name)),t.push(" just moved this "),t.push(r(this.sourceResourceHumanName)),t.push(" to <strong>"),t.push(r(this.conflict.destination.name)),t.push("</strong>.\n    ")):(t.push("\n      "),t.push(r(this.conflict.creator.name)),t.push(" just moved this "),t.push(r(this.sourceResourceHumanName)),t.push(".\n    ")),t.push("\n  </p>\n")):(t.push("\n  <p>\n    "),this.conflict.destination?(t.push("\n      "),t.push(r(this.conflict.creator.name)),t.push(" is "),t.push(r((e=this.conflict.type)==="MoveOperation"||e==="ContainableMoveOperation"?"moving":"copying")),t.push(" this "),t.push(r(this.sourceResourceHumanName)),t.push(" to <strong>"),t.push(r(this.conflict.destination.name)),t.push("</strong> right now.\n    ")):(t.push("\n      "),t.push(r(this.conflict.creator.name)),t.push(" is "),t.push(r((n=this.conflict.type)==="MoveOperation"||n==="ContainableMoveOperation"?"moving":"copying")),t.push(" this "),t.push(r(this.sourceResourceHumanName)),t.push(" right now.\n    ")),t.push("\n\n    Please hold on for a moment until it's finished.\n  </p>\n")),t.push('\n\n<a href="#" class="cancel" data-behavior="collapse_on_click">OK, close this</a>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_accesses"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){bcx.peopleAndGroups.loaded||this.calendar.isNew()?(t.push('\n  <section>\n    <div class="slider" data-behavior="slider">\n      <ul class="slides">\n        <li class="slide" data-slide-index=\'0\'>\n          '),this.calendar.isNew()||this.calendar.people().length<2?(t.push('\n            <figure>\n              <img src="'),t.push(r(bcx.currentPerson.avatarUrl())),t.push('" class="avatar" alt="Avatar" />\n              <h4>You\'re the only one who can see this calendar.</h4>\n            </figure>\n\n            <div class="subscribable">\n              <div class="invitees">\n                <h4>Invite more people</h4>\n                <p>Type names or email addresses:</p>\n\n                <section class="invite">\n                  <div class="invitees" data-behavior="calendar_invitees" data-disabled-people-ids="" data-disabled-group-ids=""></div>\n                </section>\n              </div>\n            </div>\n          ')):(t.push("\n            <h4>Who can see this calendar?</h4>\n            <p>"),t.push(r(this.calendar.peopleNames())),t.push(' (<a href="#" data-behavior="slide" data-direction="forward" class="decorated">change</a>)</p>\n          ')),t.push("\n        </li>\n        <li class=\"slide\" data-slide-index='1'>\n          "),this.calendar.isNew()&&this.calendar.people().length>1||(t.push('\n            <div class="subscribable change_accesses">\n              <div class="invitees">\n                <h4>Invite more people</h4>\n                <p>Type names or email addresses:</p>\n\n                <section class="invite">\n                  <div class="invitees" data-behavior="calendar_invitees" data-disabled-people-ids="" data-disabled-group-ids="" data-selected-people-ids=\''),t.push(r(JSON.stringify(this.calendar.peopleIds()))),t.push("' data-calendar-id='"),t.push(r(this.calendar.id)),t.push("'></div>\n                </section>\n              </div>\n            </div>\n          ")),t.push("\n        </li>\n      </ul>\n    </div>\n  </section>\n")):t.push('\n  <section class="loading">\n    <!-- loading -->\n  </section>\n'),t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_blank_slate"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<article class="blank_slate">\n  <div class="blank_slate_arrow"></div>\n  <div class="blank_slate_body can_create_calendars">\n    <h1>Get started by adding your first calendar!</h1>\n    <p>Calendars make it easy to keep everyone on track. Create different calendars for vacations, staff meetings, and more. Any project you create will also have its own calendar.</p>\n    <p><a href="#" class="watch" data-behavior="open_videobox" data-video-src="//fast.wistia.net/embed/iframe/hx9t6e6yoh">Watch a quick video about Calendars</a></p>\n  </div>\n</article>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_display"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="right">\n  <div class="sheet">\n    '),t.push(r(this.renderTemplate("calendar_blank_slate"))),t.push('\n\n    <div data-autoview-name="calendar_navigation"></div>\n    <div data-autoview-name="calendar_grid"></div>\n  </div>\n</div>\n\n<div class="left">\n  <aside class="calendar_list">\n    <div data-autoview-name="calendar_list"></div>\n    <div data-autoview-name="calendar_editor"></div>\n    <div data-autoview-name="project_editor"></div>\n  </aside>\n</div>\n\n<div data-autoview-name="calendar_item_editor"></div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_editor"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u;t.push('<div class="balloon top_right_side '),t.push(r(this.calendar.isNew()?"new":void 0)),t.push('">\n  <span class="arrow"></span>\n  <span class="arrow"></span>\n\n  <form>\n    <header>\n      <fieldset class="calendar_settings">\n        <h3>\n          <textarea name="name" data-behavior="autoresize placeholder submit_on_enter" rows="1" placeholder="Name this calendar">'),t.push(r(this.calendar.get("name"))),t.push('</textarea>\n        </h3>\n\n        <p>Choose a color:</p>\n        <div class="swatches">\n          '),e=this.calendar.getColor(),t.push("\n          "),u=bcx.bucketColors;for(i=s=0,o=u.length;s<o;i=++s)n=u[i],t.push('\n            <input type="radio" id="'),t.push(r(this.id)),t.push("_swatch_"),t.push(r(i)),t.push('" name="color" value="'),t.push(r(n)),t.push('"'),e===n&&t.push(r(" checked")),t.push('>\n            <label class="swatch" for="'),t.push(r(this.id)),t.push("_swatch_"),t.push(r(i)),t.push('" style="background-color: #'),t.push(r(n)),t.push('"></label>\n          ');t.push('\n        </div>\n      </fieldset>\n    </header>\n\n    <div data-behavior="calendar_accesses"></div>\n\n    <footer>\n      <p class="submit">\n        '),this.calendar.isNew()?t.push('\n          <input type="submit" value="Add this calendar" class="action_button">\n          or <a href="#" class="cancel" data-behavior="cancel">Cancel</a>\n        '):(t.push('\n          <input type="submit" value="Save changes", class="action_button">\n          '),(bcx.currentPerson.isAdmin()||bcx.currentPerson.id===this.calendar.get("creator_id"))&&t.push('\n            or <a href="#" class="cancel" data-behavior="cancel">Close</a>\n            <a href="#" class="image delete" data-behavior="delete"></a>\n          '),t.push("\n        ")),t.push("\n      </p>\n    </footer>\n  </form>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="event" data-id="'),t.push(r(this.calendarEvent.id)),t.push('"\n  style="'),this.calendarEvent.isTimed()||t.push(r("background-color: #"+this.calendarEvent.getColor())),t.push('">\n\n  <span class="event"\n    title="'),this.calendarEvent.isNew()||t.push(r(""+this.calendarEvent.getBucketName()+": "+this.calendarEvent.get("summary"))),t.push('"\n    style="'),this.calendarEvent.isTimed()&&t.push(r("color: #"+this.calendarEvent.getColor())),t.push('">\n\n    '),this.calendarEvent.isTimed()?(t.push('\n      <span class="title">&bull;&nbsp;'),t.push(r(this.emojify(this.calendarEvent.get("summary")))),t.push('</span>\n      <span class="time">'),t.push(r(this.calendarEvent.getStartTime().toFriendlyString())),t.push("</span>\n    ")):(t.push('\n      <span class="title">'),t.push(r(this.emojify(this.calendarEvent.get("summary")))),t.push("</span>\n    ")),t.push("\n  </span>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/bucket_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f;t.push('<fieldset class="event_calendar" data-role="bucket_fields" '),this.currentPersonCanChangeBucket()||t.push('style="display:none"'),t.push(">\n  ");if(this.bucketId!=null)t.push('\n    <input type="hidden" name="bucket" value="'),t.push(r(this.bucketType)),t.push(":"),t.push(r(this.bucketId)),t.push('">\n  ');else{t.push("\n    "),n=this.display.currentBucket(),t.push("\n\n    ");if(this.calendarEvent.isNew()&&n)t.push('\n      <input type="hidden" name="bucket" value="'),t.push(r(n.identifier())),t.push('">\n\n    ');else{t.push("\n      "),o=this.calendarEvent.isNew()?(f=this.display.currentBucket())!=null?f:this.lastUsedBucket:this.calendarEvent.bucket(),t.push('\n\n      <div class="event_field" data-role="bucket_container">\n        <label class="field_label">Calendar:</label>\n        <div class="field_entry">\n          <select name="bucket" data-behavior="bucket_selector">\n            '),e=bcx.calendars,t.push("\n            "),e.length&&(t.push('\n              <optgroup label="Calendars">\n                '),e.each(function(e){return function(e){return t.push('\n                  <option value="Calendar:'),t.push(r(e.id)),t.push('" '),o===e&&t.push(r("selected='selected'")),t.push(">"),t.push(r(e.get("name"))),t.push("</option>\n                ")}}(this)),t.push("\n              </optgroup>\n            ")),t.push("\n\n            "),s=bcx.projects.activeOrDraft(),t.push("\n            ");if(s.length){t.push('\n              <optgroup label="Projects">\n                ');for(u=0,a=s.length;u<a;u++)i=s[u],t.push('\n                  <option value="Project:'),t.push(r(i.id)),t.push('" '),o===i&&t.push(r("selected='selected'")),t.push(">"),t.push(r(i.get("name"))),i.isDraft()&&t.push(r(" - unpublished")),t.push("</option>\n                ");t.push("\n              </optgroup>\n            ")}t.push("\n          </select>\n        </div>\n      </div>\n    ")}t.push("\n  ")}t.push("\n</fieldset>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/calendar_event_editor"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l,c;t.push('<form class="calendar_event_editor_form '),this.calendarEvent.isSpanned()&&t.push(r("spanned")),t.push('" data-skip_busy>\n  <div class="expandable" data-behavior="expandable recurrence_prompt">\n    <div class="collapsed_content">\n      <header class="text_entry">\n        '),t.push(this.JST("name_fields")),t.push("\n        ");if(this.isEditorForTemplate()){f="bucket relative_date recurrence privacy".split(" ");for(s=0,u=f.length;s<u;s++)n=f[s],t.push(this.JST(""+n+"_fields"))}t.push("\n      </header>\n      <section>\n        ");if(!this.isEditorForTemplate()){l="bucket date subscriber reminder privacy".split(" ");for(o=0,a=l.length;o<a;o++)n=l[o],t.push(this.JST(""+n+"_fields"))}t.push("\n        ");if(!this.calendarEvent.isNew()&&!this.isEditorForTemplate()){t.push('\n          <div class="discuss">\n            ');if((c=this.display)!=null?!c.bucket:!void 0)i='data-default-stack="true"';t.push("\n            "),(e=this.calendarEvent.get("comments_count"))?(t.push('\n              <a href="'),t.push(r(this.calendarEvent.showPath())),t.push('" '),t.push(r(i)),t.push('><span class="pill comments">'),t.push(r(this.pluralize(e,"comment"))),t.push("</span></a>\n            ")):(t.push('\n              <a href="'),t.push(r(this.calendarEvent.showPath())),t.push('" '),t.push(r(i)),t.push('><span class="pill comments">Discuss this event...</span></a>\n            ')),t.push("\n          </div>\n        ")}t.push("\n      </section>\n      <footer>\n        "),this.isEditorForTemplate()&&(t.push('\n          <div data-behavior="lazy_load_subscribers" data-url="'),t.push(r(this.subscribersPath())),t.push('"></div>\n        ')),t.push('\n\n        <div class="calendar_alert" data-behavior="calendar_alert" data-succeeded-text="Emails sent!" data-failed-text="Error saving event! Please try again."></div>\n          <p class="submit">\n            '),this.calendarEvent.isNew()?t.push('\n              <input type="submit" value="Add this event" class="action_button green">\n              or <a href="#" class="cancel" data-role="cancel" data-behavior="cancel">Cancel</a>\n            '):t.push('\n              <input type="submit" value="Save changes" class="action_button green">\n              or <a href="#" class="cancel" data-role="cancel" data-behavior="cancel">Close</a>\n              <a href="#" class="image delete" data-behavior="delete"></a>\n            '),t.push('\n          </p>\n        </div>\n      </footer>\n    </div>\n    <div class="expanded_content" data-role="expanded_recurrence_prompt">\n      <!-- templates/calendar_event_editor/recurrence_prompt -->\n    </div>\n  </div>\n</form>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/calendar_item_editor"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n;t.push('<div class="balloon balloon_expanded left_side '),t.push(r((e=this.calendarItem)!=null?e.constructor.modelName.toLowerCase():void 0)),t.push(" "),((n=this.calendarEvent)!=null?typeof n.needsRecurrencePrompt=="function"?n.needsRecurrencePrompt():void 0:void 0)&&t.push(r("recurrence_prompt")),t.push('">\n  <span class="arrow"></span>\n  <span class="arrow"></span>\n\n  '),this.todo?(t.push("\n    "),t.push(this.JST("calendar_todo_editor")),t.push("\n  ")):(t.push("\n    "),this.calendarEvent.needsRecurrencePrompt()?(t.push("\n      <form>\n        "),t.push(this.renderRecurrencePrompt("move")),t.push("\n      </form>\n    ")):(t.push("\n      "),t.push(this.JST("calendar_event_editor")),t.push("\n    ")),t.push("\n  ")),t.push("\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/calendar_todo_editor"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0
,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<header>\n  <h4>\n    <span class="project">Project: <strong><a href="'),t.push(r(this.todo.bucket().url())),t.push('" data-default-stack="true">'),t.push(r(this.todo.bucket().get("name"))),t.push('</a></strong></span>\n    <span>List: <strong><a href="'),t.push(r(this.todo.todolist().showPath())),t.push('" data-default-stack="true">'),t.push(r(this.todo.todolist().get("name"))),t.push("</a></strong></span>\n  </h4>\n</header>\n\n<section>\n  "),t.push(JST["desktop/templates/todo"](this)),t.push("\n</section>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/date_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div data-behavior="expandable" class="'),this.calendarEvent.isNew()||t.push(r("expanded")),t.push('">\n  <div class="collapsed_content">\n    <fieldset class="event_date">\n      <div class="event_field">\n        <label class="field_label">When:</label>\n        <div class="field_entry">\n          <strong>\n            <time>'),t.push(r(this.calendarEvent.getStartDate().longWithYear())),t.push("</time>\n            "),this.calendarEvent.isTimed()?(t.push("\n              at <time>"),t.push(r(this.calendarEvent.getStartTime().toFriendlyString())),t.push("</time>\n            ")):this.calendarEvent.isSpanned()&&(t.push("\n              – <time>"),t.push(r(this.calendarEvent.getEndDate().longWithYear())),t.push("</time>\n            ")),t.push('\n          </strong>\n          <p><a href="#" class="decorated" data-behavior="expand_on_click">Lasts multiple days or repeats...</a></p>\n        </div>\n      </div>\n    </fieldset>\n  </div>\n\n  <div class="expanded_content">\n    <fieldset class="event_date">\n      <div class="event_field">\n        <label class="field_label">Starts:</label>\n        <div class="field_entry" data-behavior="date_entry">\n          <input type="hidden" name="starts_at_date" value="'),t.push(r(this.calendarEvent.getStartDate())),t.push('">\n          <input type="text" class="datepicker" readonly tabindex="-1">\n        </div>\n      </div>\n\n      <div class="event_field">\n        <label class="field_label">Ends:</label>\n        <div class="field_entry" data-behavior="date_entry">\n          <input type="hidden" name="ends_at_date" value="'),t.push(r(this.calendarEvent.getSpannedEndDate())),t.push('">\n          <input type="text" class="datepicker" readonly tabindex="-1">\n        </div>\n      </div>\n    </fieldset>\n\n    '),t.push(this.JST("recurrence_fields")),t.push("\n  </div>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/name_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e;t.push('<fieldset class="event_name">\n  <strong>\n    <textarea name="summary" data-behavior="autoresize placeholder submit_on_enter dirty_tracking" rows="1" placeholder="Name the event">'),t.push(r(this.calendarEvent.get("summary"))),t.push("</textarea>\n  </strong>\n</fieldset>\n\n"),this.isEditorForTemplate()||(t.push('\n  <fieldset class="event_time">\n    <span class="time" data-behavior="time_entry">\n      <input type="hidden" name="starts_at_time" value="'),t.push(r(this.calendarEvent.getStartTime())),t.push('">\n      <input type="text" data-behavior="placeholder dirty_tracking" value="'),t.push(r((e=this.calendarEvent.getStartTime())!=null?e.toFriendlyString():void 0)),t.push('" placeholder="any time">\n    </span>\n  </fieldset>\n')),t.push('\n\n<fieldset class="event_note">\n  <textarea name="description" data-behavior="autoresize placeholder dirty_tracking prevent_enter tab_on_enter" rows="1" placeholder="Add an optional note">'),t.push(r(this.calendarEvent.get("description"))),t.push("</textarea>\n</fieldset>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/privacy_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<fieldset class="event_privacy" data-role="privacy_toggle" style="display:none;">\n  <label>\n    <input type="checkbox" name="private" '),this.calendarEvent.get("private")&&t.push(r('checked="checked" value="true"')),t.push("> Don&rsquo;t show this event to the client\n  </label>\n</fieldset>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/recurrence_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u;t.push('<fieldset class="event_recurrence">\n  <div class="event_field">\n    <label class="field_label">\n      Repeats'),t.push(r(this.calendarEvent.isRecurrence()?":":"?")),t.push('\n    </label>\n\n    <div class="field_entry">\n      ');if(this.calendarEvent.isRecurrence())t.push("\n        "),t.push(r(this.recurrenceDescription())),t.push("\n      ");else{t.push('\n        <select name="freq" class="freq">\n          '),o={No:"","Every day":"daily","Every week":"weekly","Every month":"monthly","Every year":"yearly"};for(n in o)i=o[n],t.push('\n            <option value="'),t.push(r(i)),t.push('" '),this.calendarEvent.get("freq")===i&&t.push(r("selected")),t.push(">"),t.push(r(n)),t.push("</option>\n          ");t.push('\n        </select>\n\n        <div class="recurrence_end" style="'),this.calendarEvent.isRecurring()||t.push(r("display:none")),t.push('">\n          <ul>\n            <li>\n              <label>\n                <input type="radio" name="event_recurrence_end" value="forever" '),(!this.calendarEvent.isRecurring()||this.calendarEvent.isRecurringInfinitely())&&t.push(r("checked")),t.push('>\n                <span class="wrapper">Forever</span>\n              </label>\n            </li>\n            <li>\n              <input type="radio" id="event_recurrence_end" name="event_recurrence_end" value="count" '),!this.calendarEvent.isNew()&&this.calendarEvent.get("count")&&t.push(r("checked")),t.push('>\n              <span>\n                For\n                <select name="count">\n                  ');for(e=s=2;s<=30;e=++s)t.push('\n                    <option value="'),t.push(r(e)),t.push('" '),e===this.calendarEvent.get("count")&&t.push(r("selected")),t.push(">"),t.push(r(e)),t.push("</option>\n                  ");t.push('\n                </select>\n                <label for="event_recurrence_end" data-role="freqtext">'),t.push(r(this.freqText(this.calendarEvent.getFreq()))),t.push("</label>\n              </span>\n            </li>\n            "),this.isEditorForTemplate()||(t.push('\n              <li>\n                <label>\n                  <input type="radio" name="event_recurrence_end" value="until" '),!this.calendarEvent.isNew()&&this.calendarEvent.get("until_date")&&t.push(r("checked")),t.push('>\n                  <span data-behavior="date_entry">Until\n                    <input type="hidden" name="until_date" value="'),t.push(r(this.calendarEvent.get("until_date")||((u=this.calendarEvent.getSpannedEndDate())!=null?u.next():void 0))),t.push('">\n                    <input type="text" class="date" readonly>\n                  </span>\n                </label>\n              </li>\n            ')),t.push("\n          </ul>\n        </div>\n      ")}t.push("\n    </div>\n  </div>\n</fieldset>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/recurrence_prompt"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="recurrence_prompt" data-role="recurrence_prompt">\n  <h4>You\'re '),t.push(r(this.verb)),t.push(" a repeating event.<br>Do you want to "),t.push(r(this.action)),t.push(' all future versions of this event too?</h4>\n  <ul>\n    <li>\n      <label>\n        <input type="radio" name="event_recurrence_choice" value="recurring">\n        <span class="button">Yes, '),t.push(r(this.action)),t.push(" all future versions.</span>\n      </label>\n    </li>\n    "),this.calendarEvent.isRecurring()||(t.push('\n      <li>\n        <label>\n          <input type="radio" name="event_recurrence_choice" value="excluded">\n          <span class="button">No, just '),t.push(r(this.action)),t.push(" this one and keep the others as they are.</span>\n        </label>\n      </li>\n    ")),t.push('\n    <li>\n      <label>\n        <input type="radio" name="event_recurrence_choice" value="cancel">\n        <span class="button">Never mind, don\'t '),t.push(r(this.action)),t.push(" anything.</span>\n      </label>\n    </li>\n  </ul>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/relative_date_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s;t.push('<fieldset class="event_date">\n  <div class="event_field">\n    <label class="field_label">Starts on:</label>\n\n    <div class="field_entry" data-behavior="date_entry">\n      <input type="hidden" data-due-week name="starts_at_due_week" value="'),t.push(r((e=this.calendarEvent.get("start_due_week"))!=null?e:0)),t.push('">\n      <input type="hidden" data-due-wday name="starts_at_due_wday" value="'),t.push(r((n=this.calendarEvent.get("start_due_wday"))!=null?n:1)),t.push('">\n\n      <input type="text" data-relative-date class="datepicker" readonly value="'),t.push(r(this.calendarEvent.relativeDateLabelFor("start"))),t.push('">\n\n      <div data-behavior="relative_date_picker" class="notranslate relative_datepicker balloon" data-input=\'starts_at\'></div>\n    </div>\n  </div>\n\n  <div class="event_field">\n    <label class="field_label">Ends on:</label>\n\n    <div class="field_entry" data-behavior="date_entry">\n      <input type="hidden" data-due-week name="ends_at_due_week" value="'),t.push(r((i=this.calendarEvent.get("end_due_week"))!=null?i:0)),t.push('">\n      <input type="hidden" data-due-wday name="ends_at_due_wday" value="'),t.push(r((s=this.calendarEvent.get("end_due_wday"))!=null?s:1)),t.push('">\n\n      <input type="text" data-relative-date class="datepicker" readonly value="'),t.push(r(this.calendarEvent.relativeDateLabelFor("end"))),t.push('">\n\n      <div data-behavior="relative_date_picker" class="notranslate relative_datepicker balloon" data-input=\'ends_at\'></div>\n    </div>\n  </div>\n</fieldset>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/reminder_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l,c,h;t.push('<fieldset class="event_reminders" data-role="reminder_fields">\n  <div class="event_field">\n    <label class="field_label">Reminder:</label>\n    <div class="field_entry">\n      '),n=this.calendarEvent.reminderOffset("timed"),t.push('\n      <select name="timed_reminder_offset" class="timed_reminder_offset" data-behavior="reminder_offset">\n        '),f=this.timedReminderOffsets;for(s=0,u=f.length;s<u;s++)l=f[s],e=l[0],i=l[1],t.push('\n          <option value="'),t.push(r(i)),t.push('" '),i===n&&t.push(r("selected")),t.push(">"),t.push(r(e)),t.push("</option>\n        ");t.push("\n      </select>\n\n      "),n=this.calendarEvent.reminderOffset(),t.push('\n      <select name="all_day_reminder_offset" class="all_day_reminder_offset" data-behavior="reminder_offset">\n        '),c=this.allDayReminderOffsets;for(o=0,a=c.length;o<a;o++)h=c[o],e=h[0],i=h[1],t.push('\n          <option value="'),t.push(r(i)),t.push('" '),i===n&&t.push(r("selected")),t.push(">"),t.push(r(e)),t.push("</option>\n        ");t.push('\n      </select>\n\n      <span data-behavior="time_entry" data-role="reminder_time">\n        <input type="text" name="reminder_time" value="'),t.push(r(this.calendarEvent.reminderTimeValue())),t.push('" data-behavior="placeholder dirty_tracking" placeholder="time?" class="reminder_time">\n      </span>\n    </div>\n  </div>\n</fieldset>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/subscriber_fields"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e;t.push('<fieldset class="event_subscribers" data-role="subscriber_fields">\n  <div class="event_field">\n    <label class="field_label">Email to:</label>\n    <div class="field_entry">\n      '),this.calendarEvent.isNew()?t.push('\n        <div data-role="autocomplete_placeholder"></div>\n      '):(t.push("\n        "),this.peopleAndGroups.loaded?(t.push('\n          <div data-behavior="expandable">\n            <div class="subscribers_list collapsed_content">\n              '),e=this.calendarEvent.subscribers(),t.push("\n              "),e.length&&(t.push("\n                "),e.length===1?(t.push('\n                  <img class="avatar" src="'),t.push(r(e[0].get("avatar"))),t.push('">\n                  <span class="name">'),t.push(r(e[0].get("name"))),t.push("</span>\n                ")):(t.push("\n                  "),t.push(r(_.chain(e).map(function(e){return e.get("name")}).toSentence().value())),t.push(".<br>\n                ")),t.push("\n              ")),t.push('\n              <p><a href="#" class="decorated" data-behavior="expand_on_click">Add or remove people...</a></p>\n            </div>\n            <div class="expanded_content">\n              <div data-role="autocomplete_placeholder"></div>\n              <p class="subscribers_edit_notice">People you add will get an email immediately.</p>\n            </div>\n          </div>\n        ')):t.push("\n          Loading...\n        "),t.push("\n      ")),t.push("\n    </div>\n  </div>\n</fieldset>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_event_editor/template_calendar_event_editor"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="template_calendar_event_editor">\n  '),t.push(this.JST("calendar_event_editor")),t.push("\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_grid"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;t.push('<div class="days_of_week">\n  <div class="days">\n    ');for(g=y=0;y<=6;g=++y)t.push("\n      "),a=(g+CalendarDate.firstDayOfWeek)%7,t.push('\n      <div class="day" data-day="'),t.push(r(a)),t.push('">'),t.push(r(CalendarDate.abbreviatedWeekdayNames[a])),t.push("</div>\n    ");t.push('\n  </div>\n</div>\n\n<div class="grid_content"><div class="weeks">\n'),B=this.display.getWeeks();for(b=0,S=B.length;b<S;b++){m=B[b],t.push('\n  <div class="week" data-behavior="calendar_event_drag_area" data-date="'),t.push(r(m[0])),t.push('">\n    '),l=this.display.getSpannedLayoutFor(m[0],m[6]),t.push('\n    <div class="events spanned">\n      '),j=l.rows;for(w=0,x=j.length;w<x;w++){h=j[w],t.push('\n        <div class="row">\n          '),F=h.getOccurrences();for(E=0,T=F.length;E<T;E++)c=F[E],t.push("\n            "),i=c.calendarEvent,t.push('\n            <div class="'),t.push(r(this.classesForSpannedEventFrom(c,m))),t.push('" style="background-color: #'),t.push(r(i.getColor())),t.push('" title="'),t.push(r(i.getBucketName())),t.push(": "),t.push(r(i.get("summary"))),t.push('" data-id="'),t.push(r(i.id)),t.push('" >\n              <span class="event">\n                <span class="title">'),t.push(r(this.emojify(i.get("summary")))),t.push("</span>\n              </span>\n            </div>\n          ");t.push('\n        </div>\n        <div class="spacer"></div>\n      ')}t.push('\n    </div>\n\n    <div class="dates_wrapper">\n      <div class="dates">\n        ');for(p=O=0,N=m.length;O<N;p=++O){u=m[p],t.push("\n          "),s=this.display.getTimedCalendarEventsFor(u),t.push("\n          "),e=this.display.getAllDayCalendarEventsFor(u),t.push("\n          "),n=function(){q=[];for(var e=0,t=l.getSlotHeight(p);0<=t?e<t:e>t;0<=t?e++:e--)q.push(e);return q}.apply(this),t.push("\n          "),v=this.display.getTodosFor(u),t.push('\n\n          <div class="'),t.push(r(this.classesForDate(u))),t.push('" data-date="'),t.push(r(u)),t.push('">\n            <div class="day">\n              '),u.equals(this.today)?t.push("\n                Today\n              "):u.equals(u.beginningOfMonth())&&(t.push("\n                "),t.push(r(u.getMonthName())),t.push("\n              ")),t.push("\n              "),t.push(r(u.day)),t.push('\n            </div>\n\n            <div class="events spanned">\n              ');for(_=0,C=n.length;_<C;_++)f=n[_],t.push('\n                <div class="spacer"></div>\n              ');t.push('\n            </div>\n\n            <div class="events all_day">\n              ');for(D=0,k=e.length;D<k;D++)i=e[D],t.push("\n                "),t.push(this.renderCalendarEvent(i)),t.push("\n              ");t.push('\n            </div>\n\n            <div class="events timed">\n              ');for(P=0,L=s.length;P<L;P++)i=s[P],t.push("\n                "),t.push(this.renderCalendarEvent(i)),t.push("\n              ");t.push("\n            </div>\n\n            ");if(o=v.length){t.push('\n              <div class="events todos '),s.length||e.length||n.length||t.push(r("no_events")),t.push('">\n                <h5>'),t.push(r(this.pluralize(o,"To-do"))),t.push("</h5>\n\n                ");for(H=0,A=v.length;H<A;H++)d=v[H],t.push("\n                  "),t.push(this.renderTodo(d)),t.push("\n                ");t.push("\n              </div>\n            ")}t.push("\n          </div>\n        ")}t.push("\n      </div>\n    </div>\n\n  </div>\n")}t.push("\n</div></div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_jump"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a;t.push('<div class="calendar_jump balloon top_left_side">\n  <span class="arrow"></span>\n  <span class="arrow"></span>\n\n  <form>\n    <table border="0" cellspacing="0" cellpadding="0">\n      <tr>\n        <td class="nav"><a href="#" data-direction="backward">&#9664;</a></td>\n        <td>\n          '),e=this.getFirstMonth(),t.push("\n          "),a=[0,1];for(s=0,u=a.length;s<u;s++){i=a[s],t.push("\n            <dl>\n              <dt>"),t.push(r(e.year)),t.push("</dt>\n              ");for(n=o=0;o<=11;n=++o)t.push('\n                <dd>\n                  <a href="#" data-date="'),t.push(r(e)),t.push('" class="'),e.fallsOnSameMonthAs(this.display.getSignificantDate())&&t.push(r("selected")),t.push('">\n                    '),t.push(r(e.getAbbreviatedMonthName())),t.push("\n                  </a>\n                </dd>\n                "),e=e.nextMonth(),t.push("\n              ");t.push("\n            </dl>\n          ")}t.push('\n        </td>\n        <td class="nav"><a href="#" data-direction="forward">&#9654;</a></td>\n      </tr>\n    </table>\n  </form>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_list"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f;i=this.projects.activeOrDraftWithCalendarItems(),t.push('\n\n<section class="calendars">\n  <div class="new_calendar_event">\n    <a href="#" data-behavior="add_calendar" class="decorated">+ Add a calendar</a>\n  </div>\n\n  <h4>Calendars</h4>\n  ');if(this.calendars.length){t.push("\n    <ul>\n      "),f=this.calendars.models;for(s=0,u=f.length;s<u;s++)e=f[s],t.push('\n        <li class="calendar" id="calendar_'),t.push(r(e.id)),t.push('" data-bucket-type="calendar" data-bucket-id="'),t.push(r(e.id)),t.push('">\n          <span class="swatch" style="background-color: #'),t.push(r(e.getColor())),t.push('"><a href="#" class="'),this.display.getBucketVisibility(e)&&t.push(r("active")),t.push('" data-behavior="toggle_bucket"></a></span>\n          <a href="/'),t.push(r(bcx.currentAccountSlug)),t.push("/calendars/"),t.push(r(e.id)),t.push('/calendar_events" data-default-stack="true">'),t.push(r(this.emojify(e.get("name")))),t.push("</a>\n        </li>\n      ");t.push("\n    </ul>\n  ")}else t.push('\n    <div class="calendar_list_blank_slate no_calendars">\n      <div class="blank_slate_arrow"></div>\n      <div>\n        <h5>Add your first calendar</h5>\n        <p>Keep track of events that aren’t part of a project.</p>\n      </div>\n    </div>\n  ');t.push("\n</section>\n\n");if(i.length){t.push('\n  <section class="calendars">\n    <h4>Projects</h4>\n    <ul>\n      ');for(o=0,a=i.length;o<a;o++)n=i[o],t.push('\n        <li data-bucket-type="project" data-bucket-id="'),t.push(r(n.id)),t.push('">\n          <span class="swatch" style="background-color: #'),t.push(r(n.getColor())),t.push('"><a href="#" class="'),this.display.getBucketVisibility(n)&&t.push(r("active")),t.push('" data-behavior="toggle_bucket"></a></span>\n          <a href="/'),t.push(r(bcx.currentAccountSlug)),t.push("/projects/"),t.push(r(n.id)),t.push('/calendar_events" data-default-stack="true">'),t.push(r(this.emojify(n.get("name")))),n.isDraft()&&t.push(r(" - unpublished")),t.push("</a>\n        </li>\n      ");t.push("\n    </ul>\n  </section>\n")}t.push('\n\n<section class="calendar_feeds">\n  <p><a href="/'),t.push(r(bcx.currentAccountSlug)),t.push('/calendar_feeds" class="decorated" data-default-stack="true">Subscribe to iCal</a></p>\n</section>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_navigation"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<button class="toggle_calendar_list hide action_button" data-behavior="toggle_calendar_list">\n  <span class="hide">Hide the calendar list</span>\n</button>\n\n<button class="toggle_calendar_list show action_button" data-behavior="toggle_calendar_list">\n  <span class="show">Show the calendar list</span>\n</button>\n\n<nav>\n  <button class="month_arrow" data-behavior="navigate calendar_event_drag_area" data-direction="backward"></button>\n\n  <h1 data-behavior="expandable" class="calendar_title">\n    <a href="#" data-behavior="jump_to_month">\n      '),t.push(r(this.display.getTitle())),t.push("\n\n      "),this.showingSpinner&&t.push('\n        <span class="busy"></span>\n      '),t.push('\n    </a>\n\n    <div data-autoview-name="calendar_jump"></div>\n  </h1>\n\n  <button class="month_arrow" data-behavior="navigate calendar_event_drag_area" data-direction="forward"></button>\n\n  '),this.display.firstWeekContainsToday()||t.push('\n    <a href="#" class="today" data-behavior="navigate calendar_event_drag_area" data-direction="today">Today</a>\n  '),t.push('\n</nav>\n\n<a href="#" data-behavior="edit_bucket" class="calendar_settings_link decorated">Calendar settings...</a>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/calendar_todo"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="event todo '),this.todo.get("completed")&&t.push(r("complete")),t.push('" data-id="'),t.push(r(this.todo.id)),t.push('" data-behavior="calendar_todo">\n  <span class="wrapper event">\n    <input type="checkbox" value="1" '),this.todo.get("completed")&&t.push(r('checked="checked"')),t.push(' data-behavior="toggle_todo" data-url="'),t.push(r(this.todo.togglePath())),t.push('">\n\n    <span class="content"\n          title="['),t.push(r(this.todo.bucket().get("name"))),t.push("] "),t.push(r(this.todo.get("content"))),t.push('"\n          style="color:#'),t.push(r(this.todo.bucket().getColor())),t.push('">\n\n      '),t.push(r(this.emojify(this.truncateWord(this.todo.get("content"),5)))),t.push("\n    </span>\n  </span>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/date_group"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push("<header>\n  <div>\n    <h2>"),t.push(r(this.date.getMonthName())),t.push(" "),t.push(r(this.date.day)),t.push(" "),this.date.fallsOnSameYearAs(this.today)||t.push(r(this.date.year)),t.push("</h2>\n    <time>\n      "),this.date.is(this.today)?t.push('\n        <time class="today">Today</time>\n      '):this.date.is(this.today.previous())?t.push("\n        <time>Yesterday</time>\n      "):this.date.fallsOnSameWeekAs(this.today)&&(t.push("\n        <time>"),t.push(r(this.date.getWeekdayName())),t.push("</time>\n      ")),t.push('\n    </time>\n  </div>\n</header>\n\n<div class="date_group" datetime="'),t.push(r(this.date)),t.push('"></div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/draft_notice"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div id="draft_notice" class="workspace_notice initial_load">\n  <div>\n    <section class="draft_description">\n      <h1>Ready to publish this project?</h1>\n      <p>\n        Since you\'re using a template, review the project name, adjust the dates if necessary, and invite anybody who\'s missing.\n        When you\'re done, click publish and we\'ll notify the people you invited.\n      </p>\n\n      <div class="submit">\n        <button data-behavior="publish_draft_project" class="action_button green">Publish this project</button> or\n        <a href="'
),t.push(r(bcx.currentBucket.urlForTrash())),t.push('" data-confirm="Are you sure you want to completely delete this unpublished project?" data-method="post" data-remote="true" rel="nofollow">Delete it instead</a>\n      </div>\n    </section>\n\n    <section class="draft_confirmation">\n      <h1>Your project is live!</h1>\n      <p data-behavior=\'recipients_notified_notice\'>\n        Everyone added to this project has been notified.\n      </p>\n    </section>\n\n    <span class="arrow"></span>\n    <span class="arrow"></span>\n  </div>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/enlarger"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a;t.push('<div id="enlarger" class="'),this.attachments.length>1&&t.push(r("with_nav")),t.push('">\n  <button class="close"></button>\n\n  '),u=this.attachments;for(n=0,s=u.length;n<s;n++){e=u[n],t.push('\n    <figure id="enlarged_attachment'),t.push(r(e.attachmentId)),t.push('" style="'),e!==this.active&&t.push(r("display:none;")),t.push('" class="'),e.trashed&&t.push(r("trashed")),t.push(" "),e.isReadOnly&&t.push(r("read_only")),t.push('">\n\n      <div class="table_wrapper">\n        <div class="cell_wrapper">\n          <div class="image_wrapper">\n            <aside data-role="details_'),t.push(r(e.attachmentId)),t.push('"></aside>\n\n            <div class="image_stage">\n              <div>\n                ');if(e.trashed){t.push('\n                  <header class="notice">\n                    This '),t.push(r(e.description)),t.push(" was deleted "),e.trasher&&t.push(r("by "+e.trasher)),t.push(" on "),t.push(r(e.trashedAt)),t.push(".<br>\n\n                    ");if(bcx.currentPerson.isAdmin()||bcx.currentPerson.id===e.creatorId)t.push('\n                      <a href="'),t.push(r(e.restorePath)),t.push('" data-remote="true" data-method="POST">Bring it back</a>\n\n                      or <a href="'),t.push(r(e.path)),t.push('" data-remote="true" data-method="DELETE" data-confirm="There is no undo from this action. The content will be lost for good. Are you sure?">permanently delete it</a>\n                      so it&rsquo;s gone for good.\n                    ');t.push("\n                  </header>\n                ")}t.push("\n\n                "),e.type==="image"&&e.thumbnail?(t.push('\n                  <a href="'),t.push(r(e.originalSrc)),t.push('" data-stacker="false" target="_blank">\n                    '),t.push(this.renderEnlargedAttachment(e)),t.push("\n                  </a>\n                ")):e.trashed?(t.push("\n                  "),t.push(this.renderEnlargedAttachment(e)),t.push("\n\n                  <figcaption>\n                    <h3>"),t.push(r(e.filename)),t.push('</h3>\n\n                    <div class="meta">\n                      <h4>\n                        Added <time datetime="'),t.push(r(e.createdAt)),t.push('" data-time-ago></time>  by '),t.push(r(e.creator)),t.push("\n                        "),e.linked||(t.push("\n                          <br>"),t.push(r(e.filesize)),t.push(" "),t.push(r(e.extension)),t.push("\n                        ")),t.push("\n                      </h4>\n                    </div>\n                  </figcaption>\n                ")):(t.push('\n                    <a href="'),t.push(r(e.originalSrc)),t.push('" data-stacker="false" target="_blank">\n                    '),t.push(this.renderEnlargedAttachment(e)),t.push('\n                    <div class="embed_failed" data-behavior="embed_failed"></div>\n                  </a>\n                  '),e.linked?(t.push('\n                    <div data-behavior="google_doc_preview"\n                         data-file-id="'),t.push(r(e.storageKey)),t.push('"\n                         data-file-url="'),t.push(r(e.originalSrc)),t.push('"\n                         data-attachment-name="'),t.push(r(e.filename)),t.push('"\n                         data-attachment-creator-id="'),t.push(r(e.creatorId)),t.push('"\n                         data-attachment-update-path="'),t.push(r(e.path)),t.push('"\n                         data-width="2880"\n                         data-height="1800"\n                         class="doc_preview"></div>\n                  ')):e.embeddable&&(t.push('\n                    <div class="embed_loading" data-behavior="embed_loading">Loading...</div>\n                    <div data-behavior="attachment_embed"\n                         data-role="enlarged"\n                         data-file-url="'),t.push(r(e.originalSrc)),t.push('"\n                         data-type="'),t.push(r(e.type)),t.push('"\n                         data-thumbnail="'),t.push(r(e.thumbnail)),t.push('"\n                         data-content-type="'),t.push(r(e.contentType)),t.push('"\n                         data-audio-codec="'),t.push(r(e.audioCodec)),t.push('"\n                         data-video-codec="'),t.push(r(e.videoCodec)),t.push('"\n                         data-width="'),t.push(r(this.getEmbedDimensions(e).width)),t.push('"\n                         data-height="'),t.push(r(this.getEmbedDimensions(e).height)),t.push('"\n                         class="attachment_embed hidden '),t.push(r(e.classes)),t.push('">\n                    </div>\n                  ')),t.push("\n                ")),t.push("\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </figure>\n  ")}t.push("\n\n  ");if(this.attachments.length>1){t.push('\n    <nav>\n      <div class="images" data-behavior="scroll_view">\n        <table data-behavior="scroll_content">\n          <tr>\n            '),a=this.attachments;for(i=0,o=a.length;i<o;i++)e=a[i],t.push('\n              <td>\n                <a href="#" class="thumbnail_wrap '),t.push(r(e.classes)),t.push('" data-behavior="activate">\n                  <img\n                    class="'),e===this.active&&t.push(r("activated")),t.push('"\n                    src="'),t.push(r(e.thumbnailSrc)),t.push('"\n                    title="'),t.push(r(e.filename)),t.push('"\n                    width="'),t.push(r(e.width)),t.push('"\n                    height="'),t.push(r(e.height)),t.push('"\n                    data-behavior="activate"\n                    data-attachment-id="'),t.push(r(e.attachmentId)),t.push('"\n                  >\n                </a>\n              </td>\n            ');t.push('\n          </tr>\n        </table>\n      </div>\n\n      <button class="left arrow" data-behavior="scroll_reverse"></button>\n      <button class="right arrow" data-behavior="scroll_forward"></button>\n    </nav>\n  ')}t.push("\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/google_doc_preview"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){this.browserSupportsPreviews()?(t.push("\n  "),this.google.isAuthorized()?(t.push("\n    "),this.error?(t.push('\n      <div class="meta">\n        No preview? <a href="'),t.push(r(this.google.fileUrl)),t.push('" data-stacker="false" target="_blank">Request access</a> to see this file or <a href="#" data-behavior="sign_in">sign in to a different Google account</a>.\n      </div>\n    ')):(t.push("\n      "),this.isPreviewable()&&t.push('\n        <div class="loading_preview">Loading preview&hellip;</div>\n      '),t.push("\n    ")),t.push("\n  ")):(t.push('\n    <div class="meta">\n      <a href="#" data-behavior="sign_in">Sign in to Google</a> or <a href="https://accounts.google.com/SignUp?continue='),t.push(r(this.google.fileUrl)),t.push('" data-stacker="false" target="_blank">create a Google account</a> to see this file.\n    </div>\n  ')),t.push("\n\n  "),this.isPreviewable()&&(t.push('\n    <div class="when_loaded" data-role="iframe_container">\n    </div>\n\n    <div class="meta preview">\n      <strong>Last updated <time datetime="'),t.push(r(this.file.modifiedDate)),t.push('" data-time-ago></time> by '),t.push(r(this.file.lastModifyingUserName)),t.push('</strong><br>\n      This preview is read-only. <a href="'),t.push(r(this.google.fileUrl)),t.push('" data-stacker="false" target="_blank">Open this file on Google Drive</a> to make edits.\n    </div>\n  ')),t.push("\n")):(t.push('\n  <div class="meta no_preview">\n    To view or edit this file, <a href="'),t.push(r(this.google.fileUrl)),t.push('" data-stacker="false" target="_blank">open it on Google Drive</a>.\n  </div>\n')),t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/invitee_field"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="autocomplete_people">\n  '),this.collection.isEnabled(this.model)&&(t.push("\n    "),this.model.isGroup()?(t.push('\n      <input type="hidden" name="groups[][id]" value="'),t.push(r(this.model.get("group_id"))),t.push('">\n    ')):(t.push('\n      <input type="hidden" name="'),t.push(r(this.inputNameForEmailAddress())),t.push('" data-role="email_address_input" value="'),t.push(r(this.model.get("email_address"))),t.push('">\n    ')),t.push("\n  ")),t.push('\n  <div class="icon"></div>\n  <div class="input">\n    '),this.readOnly()?(t.push('\n      <input type="text" value="'),t.push(r(this.model.get("name")||this.model.get("email_address"))),t.push('" spellcheck="false" readonly>\n      <input type="text" style="background:white; opacity:0;" disabled>\n    ')):(t.push('\n      <input type="text" value="'),t.push(r(this.model.get("name")||this.model.get("email_address"))),t.push('" data-behavior="input_change_emitter" data-role="human_input" spellcheck="false">\n    ')),t.push('\n  </div>\n  <div class="suggestions" data-role="suggestions_view">\n    <!-- templates/autocomplete_people_suggestions -->\n  </div>\n  '),this.removable()&&t.push('\n    <a class="remove" data-behavior="remove_invitee"></a>\n  '),t.push("\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/invitee_field_group"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="group invitee field">\n  <input type="hidden" name="groups[][id]" value="'),t.push(r(this.model.get("group_id"))),t.push('">\n  <div class="icon"></div>\n  <div class="input">\n    <input type="text" value="'),t.push(r(this.model.get("name"))),t.push('" spellcheck="false" readonly>\n    <input type="text" style="background:white; opacity:0;" disabled>\n  </div>\n  <a class="remove" data-behavior="remove_group"></a>\n</div>\n\n'),this.enabled.length&&t.push('\n  <div data-role="enabled_invitees"></div>\n'),t.push("\n\n"),this.disabled.length&&(t.push("\n  "),this.enabled.length===0?t.push("\n    <h3>Everyone in this group is already on the project</h3>  \n  "):(t.push("\n    "),this.disabled.length===1?t.push("\n      <h3>One person is already on the project</h3>\n    "):t.push("\n      <h3>These people are already on the project</h3>\n    "),t.push("\n  ")),t.push('\n  <div data-role="disabled_invitees"></div>\n')),t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/legacy_pending_attachment"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push("<div style='width: 0px; height: 0px; visibility: hidden;'>\n  <iframe name='"),t.push(r(this.id)),t.push("' id='"),t.push(r(this.id)),t.push("'></iframe>\n  <form action='/"),t.push(r(bcx.currentAccountSlug)),t.push("/attachments/stage' method='post' enctype='multipart/form-data' target='"),t.push(r(this.id)),t.push("'>\n    <input type='hidden' name='"),t.push(r($.cookie("csrf-param"))),t.push("' value='"),t.push(r($.cookie("csrf-token"))),t.push("' />\n  </form>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/member_field"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="autocomplete_people">\n  <div class="icon"></div>\n  <div class="input">\n    <input type="hidden" name="memberships[][person_id]" value="" data-role="person_id_input">\n\n    '),this.readOnly()?(t.push('\n      <input type="text" value="'),t.push(r(this.model.get("name"))),t.push('" spellcheck="false" readonly>\n      <input type="text" style="background:white; opacity:0;" disabled>\n    ')):(t.push('\n      <input type="text" value="'),t.push(r(this.model.get("name"))),t.push('" data-behavior="input_change_emitter" data-role="human_input" spellcheck="false">\n    ')),t.push('\n  </div>\n  <div class="suggestions" data-role="suggestions_view">\n    <!-- templates/autocomplete_people_suggestions -->\n  </div>\n  '),this.removable()&&t.push('\n    <a class="remove" data-behavior="remove_member"></a>\n  '),t.push("\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/membership_suggestions"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u;t.push('<ol class="suggestions">\n  ');if(((s=this.results.enabledOptions)!=null?s.length:void 0)||((o=this.results.disabledOptions)!=null?o.length:void 0)){t.push("\n    ");if(this.results.enabledOptions.length){t.push("\n      "),u=this.results.enabledOptions;for(n=0,i=u.length;n<i;n++)e=u[n],t.push('\n        <li class="'),e===this.selected&&t.push(r("selected")),t.push(' option suggestion" data-behavior="select_suggestion" data-suggestion-id="'),t.push(r(e.id)),t.push('">\n          <span class="name">'),t.push(r(e.get("name"))),t.push('</span> <span class="email">'),t.push(r(e.get("email_address"))),t.push("</span>\n        </li>\n      ");t.push("\n    ")}else t.push('\n      <li class="disabled option hint suggestion">\n        <span class="name">'),t.push(r(this.results.disabledOptions[0].get("name"))),t.push("</span> <span>is already in this group</span>\n      </li>\n    ");t.push("\n  ")}else t.push("\n    "),this.showUnknownMessage&&t.push('\n      <li class="unknown hint suggestion">\n        This person isn’t in the system yet.\n      </li>\n    '),t.push("\n  ");t.push("\n</ol>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/new_superpowers"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<table border="0" cellspacing="0" cellpadding="0" id="invitee-'),t.push(r(this.invitee.emailAddressAlphanumeric())),t.push('">\n  <tr data-behavior="set_permission_checkboxes">\n    <td>\n      <strong>'),t.push(r(this.invitee.get("email_address"))),t.push('</strong>\n    </td>\n\n    <td class="option projects">\n      <input name="permissions['),t.push(r(this.invitee.get("email_address"))),t.push('][can_create_projects]" type="hidden" value="0">\n      <input name="permissions['),t.push(r(this.invitee.get("email_address"))),t.push('][can_create_projects]" data-behavior="can_create_projects_permission" type="checkbox" value="1">\n    </td>\n\n    <td class="option admin">\n      <input name="permissions['),t.push(r(this.invitee.get("email_address"))),t.push('][admin]" type="hidden" value="0">\n      <input name="permissions['),t.push(r(this.invitee.get("email_address"))),t.push('][admin]" data-behavior="admin_permission" type="checkbox" value="1">\n    </td>\n  </tr>\n</table>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/pending_attachment"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<li data-dirty>\n  <input type="hidden" name="attachments[][id]" value="'),t.push(r(this.file.id)),t.push('">\n  <input type="hidden" name="attachments[][_trash]" value="">\n  <input type="hidden" name="attachments[][name]" value="'),t.push(r(this.file.name)),t.push('" data-role="name" data-extname="'),t.push(r(this.extname)),t.push('">\n  <input type="hidden" name="attachments[][content_type]" value="'),t.push(r(this.file.type)),t.push('">\n  <input type="hidden" name="attachments[][token]" value="">\n\n  '),this.file.link!=null&&(t.push('\n    <input type="hidden" name="attachments[][link][source]" value="'),t.push(r(this.file.link.source)),t.push('">\n    <input type="hidden" name="attachments[][link][url]" value="'),t.push(r(this.file.link.url)),t.push('">\n    <input type="hidden" name="attachments[][link][key]" value="'),t.push(r(this.file.link.key)),t.push('">\n    <input type="hidden" name="attachments[][link][size]" value="'),t.push(r(this.file.link.size)),t.push('">\n  ')),t.push('\n\n  <a class="remove" data-behavior="remove" href="#"><span>Remove</span></a>\n  <div class="icon"><img src="'),t.push(r(this.iconPath)),t.push('" class="file_icon" width="32" height="32"></div>\n  <div class="progress" data-behavior="progress"><div></div></div>\n\n  <div class="filename">\n    '),this.file.isLinked?(t.push("\n      "),t.push(r(this.file.name)),t.push("\n    ")):(t.push('\n      <input type="text" class="name" data-role="basename" value="'),t.push(r(this.basename)),t.push('">\n      <span class="extension">'),t.push(r(this.extname)),t.push("</span>\n    ")),t.push('\n  </div>\n\n  <div data-behavior="taggings pending_taggings" class="taggings">\n    <ul class="tags"></ul>\n    <div class="edit_taggings" data-behavior="expandable expand_exclusively edit_taggings">\n      <a href="#" data-behavior="expand_on_click">Label...</a>\n    </div>\n  </div>\n</li>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/pending_invitee"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<li data-email-address="'),t.push(r(this.invitee.get("email_address"))),t.push('">\n  <img class="avatar" src="'),t.push(r(this.invitee.get("avatar_url")||"/assets/icons/avatar.gif")),t.push('">\n  <div class="text">\n    '),t.push(r(this.invitee.get("name")||this.invitee.get("email_address"))),t.push(' <a class="remove" data-behavior="remove"></a>\n  </div>\n  '),this.id?(t.push('\n    <input type="hidden" name="invitees[][id]" value="'),t.push(r(this.invitee.id)),t.push('">\n  ')):(t.push('\n    <input type="hidden" name="invitees[][email_address]" value="'),t.push(r(this.invitee.get("email_address"))),t.push('">\n  ')),t.push("\n</li>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/pending_tagging"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<li data-url="'),t.push(r(this.taggingId)),t.push('">\n  <input type="hidden" name="attachments[][tag_names][]" value="'),t.push(r(this.tagName)),t.push('">\n  <span class="label" data-role="tag_name">'),t.push(r(this.tagName)),t.push('</span>\n  <a href="#" data-behavior="remove_tagging" class="remove_tagging"><span>Remove label</span></a>\n  <span class="label_color"></span>\n</li>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/people_suggestions"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s;s=this.suggestions;for(n=0,i=s.length;n<i;n++)e=s[n],t.push('\n  <li class="'),e===this.selected&&t.push(r("selected")),t.push(' suggestion suggestion" data-behavior="select_suggestion" data-suggestion-id="'),t.push(r(e.id)),t.push('">\n    '),e.isGroup()?(t.push('\n      <strong class="name">'),t.push(r(e.get("name"))),t.push("</strong> <span>Company with "),t.push(r(e.get("person_ids").length)),t.push(" people</span>\n    ")):(t.push('\n      <span class="name">'),t.push(r(e.get("name"))),t.push('</span> <span class="email">'),t.push(r(e.get("email_address"))),t.push("</span>\n    ")),t.push("\n  </li>\n");t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/project_dates"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f;if(this.itemGroups.length){t.push('\n  <section data-collection-name=\'calendar_events\'>\n    <article class="note">\n      <div class="note_body">\n        <h1><a href="'),t.push(r(this.bucket.calendarUrl())),t.push('">Upcoming Events</a></h1>\n\n        '),a=this.itemGroups;for(i=0,o=a.length;i<o;i++){n=a[i],t.push("\n          "),this.isTemplate?(t.push("\n            <strong>"),t.push(r(n.date.relativeDateLabel())),t.push("</strong>\n          ")):(t.push("\n            <strong>"),t.push(r(this.dateLabelFor(n.date))),t.push("</strong>\n          ")),t.push('\n\n          <ul class="project_dates">\n            '),f=n.CalendarEvents;for(s=0,u=f.length;s<u;s++)e=f[s],t.push('\n              <li>\n                <a href="'),t.push(r(e.showPath())),t.push('">'),t.push(r(this.emojify(e.summary()))),t.push("</a>\n                "),e.isTimed()&&(t.push('\n                  <time data-local-time-with-timezone datetime="'),t.push(r(e.get("starts_at"))),t.push('"></time>\n                ')),t.push("\n                "),t.push(r(this.untilDateFor(e))),t.push("\n              </li>\n            ");t.push("\n          </ul>\n        ")}t.push('\n\n        <p class="more_events"><a href="'),t.push(r(this.bucket.calendarUrl())),t.push("\" class='decorated'>All upcoming events...</a></p>\n      </div>\n    </article>\n  </section>\n")}t.push("\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/project_editor"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o;t.push('<div class="balloon top_right_side">\n  <span class="arrow"></span>\n  <span class="arrow"></span>\n\n  <form>\n    <header>\n      <fieldset class="calendar_settings">\n        <p>Choose a color</p>\n        <div class="swatches">\n          '),o=bcx.bucketColors;for(n=i=0,s=o.length;i<s;n=++i)e=o[n],t.push('\n            <input type="radio" id="'),t.push(r(this.id)),t.push("_swatch_"),t.push(r(n)),t.push('" name="color" value="'),t.push(r(e)),t.push('"'),this.project.getColor()===e&&t.push(r(" checked")),t.push('>\n            <label class="swatch" for="'),t.push(r(this.id)),t.push("_swatch_"),t.push(r(n)),t.push('" style="background-color: #'),t.push(r(e)),t.push('"></label>\n          ');t.push('\n        </div>\n      </fieldset>\n    </header>\n    \n    <section>\n      <h4>Who can see this calendar?</h4>\n      <p>Only people who can see this project can see this calendar. You can <a href="'),t.push(r(this.project.accessesUrl())),t.push('" class="decorated" data-stacker=\'false\'>change who has access</a> on the project page.</p>\n    </section>\n    \n    <footer>      \n      <p class="submit">\n        <input type="submit" value="Save changes">\n        or <a href="#" class="cancel" data-behavior="cancel">Close</a>\n      </p>\n    </footer>\n  </form>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/project_toolbar"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a;t.push('<div class="tools'),this.visibleToolsInProject().length&&t.push(r(" has_tools_in_project")),this.visibleToolsNotInProject().length&&t.push(r(" has_tools_not_in_project")),t.push('">\n  \n  ');if(this.visibleToolsInProject().length){t.push('\n    <div class="group in_project">\n      '),u=this.tools;for(n=0,s=u.length;n<s;n++)e=u[n],t.push("\n        "),e.isInProject()&&(t.push('\n          <a href="'),t.push(r(e.url())),t.push('" data-tool-name="'),t.push(r(e.name)),t.push('">\n            <span class=""><strong>'),t.push(r(e.pluralizedCount())),t.push("</strong></span>\n          </a>\n        ")),t.push("\n      ");t.push("\n    </div>\n  ")}t.push("\n\n  ");if(this.visibleToolsNotInProject().length){t.push('\n    <div class="group not_in_project">\n      <span class="label">Add the first:</span>\n      '),a=this.tools;for(i=0,o=a.length;i<o;i++)e=a[i],t.push("\n        "),e.isNotInProject()&&(t.push('\n          <a href="'),t.push(r(e.url())),t.push('" data-tool-name="'),t.push(r(e.name)),t.push('">\n            <span class="">'),t.push(r(e.pitch)),t.push("</span>\n          </a>\n        ")),t.push("\n      ");t.push("\n    </div>\n  ")}t.push("\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/relative_date_picker"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o;t.push('<header>\n  <a href=\'#\' title="Previous" class="prev" data-behavior=\'toggle_week previous\'><span>Previous</span></a>\n  <a href=\'#\' title="Next" class="next" data-behavior=\'toggle_week next\'><span>Next</span></a>\n  <div class="title">Week '),t.push(r(this.current_week+1)),t.push("</div>\n</header>\n\n<ul>\n  "),o=CalendarDate.weekdayNames;for(n=i=0,s=o.length;i<s;n=++i)e=o[n],t.push('\n    <li>\n      <a href="#" class=\''),this.current_week===this.due_week&&this.due_wday===n&&t.push(r("active")),t.push("' data-wday='"),t.push(r(n)),t.push("'>"),t.push(r(e)),t.push("</a>\n    </li>\n  ");t.push("\n</ul>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/single_calendar_display"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"
)}),function(){(function(){t.push('<div class="container">\n  <div data-autoview-name="calendar_navigation"></div>\n  <div data-autoview-name="calendar_grid"></div>\n</div>\n\n<div data-autoview-name="calendar_item_editor"></div>\n<div data-autoview-name="calendar_editor"></div>\n<div data-autoview-name="project_editor"></div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/subscribers"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l,c,h;t.push('<table>\n  <tbody>\n    <tr>\n      <td class="subscribers">\n        '),i=this.activePeople().models,t.push("\n        "),this.showCurrentPerson&&i.unshift(this.currentPerson),t.push("\n\n        "),this.project.isTemplate()||this.project.isDraft()?(t.push("\n          "),o=i,t.push("\n          "),u=[],t.push("\n        ")):(t.push("\n          "),o=i.filter(function(e){return e.get("wants_notifications")===!0}),t.push("\n          "),u=i.filter(function(e){return e.get("wants_notifications")===!1}),t.push("\n          "),n=u.length&&!o.length,t.push("\n        ")),t.push("\n\n        "),this.project.isTemplate()?(t.push("\n          <h4>Who should receive updates?</h4>\n          <p>Since this is a project template, we won't email anyone about this "),t.push(r(this.humanize(this.subscribable))),t.push(" now. People you check below will be notified when new comments are added after the project is published.</p>\n        ")):this.project.isDraft()?(t.push("\n          <h4>Who should receive updates?</h4>\n          <p>Since this project isn't published yet, we won't email anyone about this "),t.push(r(this.humanize(this.subscribable))),t.push(" now. People you check below will be notified when new comments are added after the project is published.</p>\n        ")):o.length&&(t.push('\n          <h4>Email <span data-behavior="pluralize_subscribable_label">'),t.push(r("this "+this.humanize(this.subscribable))),t.push("</span> to people on the project:</h4>\n        ")),t.push("\n\n        "),o.length&&t.push('\n          <div class="select_all_or_none">\n            <a href="#" class="decorated select_everyone" data-behavior="subscriber_select_all">Select all</a> |\n            <a href="#" class="decorated select_everyone" data-behavior="subscriber_select_none">Select none</a>\n\n            <a href="#" class="decorated select_everyone" data-behavior="subscriber_select_remembered" style="display:none">\n              Select remembered (only included as a gateway for the label click)\n            </a>\n          </div>\n        '),t.push('\n\n        <div class="subscribers">\n          <div>\n            '),h=_(o).inGroups(this.subscribable==="comment"?2:3);for(a=0,l=h.length;a<l;a++){i=h[a],t.push('\n              <div class="column">\n                ');for(f=0,c=i.length;f<c;f++)s=i[f],t.push('\n                  <label data-subscriber-id="'),t.push(r(s.get("person_id"))),t.push('"\n                      title="'),t.push(r(s===this.currentPerson?"Me ("+s.get("name")+")":s.get("name"))),t.push('">\n                    <input name="'),t.push(r(this.subscribable)),t.push('[subscribers][]" type="checkbox" value="'),t.push(r(s.get("person_id"))),t.push('">\n                    '),t.push(r(s===this.currentPerson?"Me ("+s.get("name")+")":s.get("name"))),t.push("\n                  </label>\n                ");t.push("\n              </div>\n            ")}t.push("\n          </div>\n        </div>\n\n        "),u.length&&(t.push('\n          <div class="unsubscribers">\n            <h6>\n              '),n?t.push("\n                Everyone on this project has\n              "):u.length>1?t.push("\n                These people have\n              "):t.push("\n                This person has\n              "),t.push("\n              turned off email notifications:</h6>\n            <p>"),t.push(r(_(u).map(function(e){return e.get("name")}).join(", ").replace(/,\s([^,]+)$/," and $1"))),t.push("</p>\n          </div>\n        ")),t.push("\n      </td>\n\n      "),e=this.activeGroups(),t.push("\n      "),!e.isEmpty()&&!n&&(t.push('\n        <td class="groups">\n          <h4>Select people from:</h4>\n          <div class="group_options">\n            '),e.reject(function(e){return e.isSubgroup()}).forEach(function(e){return function(n){return t.push('\n              <a href="#" data-member-ids="'),t.push(r(JSON.stringify(e.groupMemberIds(n)))),t.push('" data-group-id="'),t.push(r(n.id)),t.push('">\n                <span>'),t.push(r(n.get("name"))),t.push("</span>\n              </a>\n              "),n.subgroups().isEmpty()||(t.push('\n                <div class="subgroup_options">\n                  '),n.subgroups().forEach(function(i){return t.push('\n                    <a href="#" class="subgroup" data-member-ids="'),t.push(r(JSON.stringify(e.groupMemberIds(i)))),t.push('" data-group-id="'),t.push(r(i.id)),t.push('" data-parent-group-id="'),t.push(r(n.id)),t.push('">\n                      <span>'),t.push(r(i.get("name"))),t.push("</span>\n                    </a>\n                  ")}),t.push("\n                </div>\n              ")),t.push("\n            ")}}(this)),t.push("\n          </div>\n        </td>\n      ")),t.push("\n    </tr>\n  </tbody>\n</table>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/timeline_day_bubble"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e;e=this.date.getLocalDate().toISOString(),t.push('\n\n<div class="day">\n  <a href="/'),t.push(r(bcx.currentAccountSlug)),t.push("/summary/"),t.push(r(this.date)),t.push('" class="decorated" data-default-stack="true">\n    <span>\n      '),this.date.isToday()||this.date.is(CalendarDate.today().previous())?(t.push('\n        <time class="head" data-local="weekday" datetime="'),t.push(r(e)),t.push('"></time>\n        <time class="subhead" data-local="date" datetime="'),t.push(r(e)),t.push('"></time>\n      ')):(t.push('\n        <time class="head" data-local="date" datetime="'),t.push(r(e)),t.push('"></time>\n        <time class="subhead" data-local="weekday" datetime="'),t.push(r(e)),t.push('"></time>\n      ')),t.push("\n    </span>\n  </a>\n</div>\n")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/todo"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e;t.push('<form class="calendar_todo_editor_form" action="'),t.push(r(this.todo.showPath())),t.push('" method="PUT" data-remote="true" data-behavior="edit_calendar_todo has_hover_content">\n  <div>\n    <span class="wrapper '),this.todo.get("completed")&&t.push(r("complete")),t.push('">\n      <input type="checkbox" value="1" '),this.todo.get("completed")&&t.push(r('checked="checked"')),t.push(' data-behavior="toggle_todo" data-url="'),t.push(r(this.todo.togglePath())),t.push('" '),this.isTemplate&&t.push(r('disabled="disabled"')),t.push('>\n\n      <span class="content">\n        <a href="'),t.push(r(this.todo.showPath())),t.push('" '),this.context!=="agenda"&&t.push(r('data-default-stack="true"')),t.push(' title="'),this.context==="agenda"&&t.push(r("List: "+this.todo.todolist().get("name"))),t.push('">'),t.push(r(this.emojify(this.todo.get("content")))),t.push("</a>\n\n        "),this.todo.get("has_attachments")&&t.push('\n          <span class="attachments_icon"></span>\n        '),t.push("\n\n        "),this.todo.get("comments_count")&&(t.push('\n          <span class="pill comments">\n            <a href="'),t.push(r(this.todo.showPath())),t.push('" '),this.context!=="agenda"&&t.push(r('data-default-stack="true"')),t.push(">"),t.push(r(this.pluralize(this.todo.get("comments_count"),"comment"))),t.push("</a>\n          </span>\n        ")),t.push('\n\n        <span class="pill has_balloon '),this.todo.assignee()||t.push(r("blank")),t.push('" data-behavior="expandable expand_exclusively load_assignee_options '),this.todo.assignee()||t.push(r("hover_content")),t.push('">\n          <a href="#" data-behavior="expand_on_click">\n            <span data-behavior="assignee_name">\n              '),t.push(r(((e=this.todo.assignee())!=null?e.get("name"):void 0)||"Unassigned")),t.push('\n            </span>\n          </a>\n\n          <span class="balloon right_side expanded_content">\n            <span class="arrow"></span>\n            <span class="arrow"></span>\n\n            <label>\n              <b>Assign this to-do to:</b>\n\n              <select name="todo[assignee_code]"\n                      data-behavior="assignee_options"\n                      data-project-id="'),t.push(r(this.todo.bucket().get("id"))),t.push('"\n                      data-assignee-code="'),t.push(r(this.todo.get("assignee_code"))),t.push('">\n                <option value="⎈">Loading...</option>\n              </select>\n            </label>\n\n            <small><p>The person you select will be notified by email</p></small>\n\n            <label>\n              <b>Set the due date:</b>\n              <hr>\n              '),this.isTemplate?(t.push('\n                <input type="hidden" name="todo[due_week]" id="alt_date_todo_'),t.push(r(this.todo.get("id"))),t.push('" value="'),t.push(r(this.todo.get("due_week"))),t.push('" data-behavior="alt_date_field">\n                <input type="hidden" name="todo[due_wday]" id="alt_date_todo_'),t.push(r(this.todo.get("id"))),t.push('" value="'),t.push(r(this.todo.get("due_wday"))),t.push('" data-behavior="alt_date_field">\n                <div data-behavior="relative_date_picker" class="notranslate relative_datepicker"></div>\n              ')):(t.push('\n                <input type="hidden" name="todo[due_on]" id="alt_date_todo_'),t.push(r(this.todo.get("id"))),t.push('" value="'),t.push(r(this.todo.getDueDate())),t.push('" data-behavior="alt_date_field">\n                <div data-behavior="date_picker" class="notranslate"></div>\n              ')),t.push('\n            </label>\n\n            <footer><a href="#" data-behavior="no_due_date" class="no_date">No due date</a></footer>\n          </span>\n        </span>\n      </span>\n    </span>\n  </div>\n</form>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["desktop/templates/wysiwyg_toolbar"]=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div data-behavior="wysiwyg_toolbar" style="display: none;">\n  <a tabindex="-1" data-wysihtml5-command="bold" title="CTRL+B">Bold</a>\n  <a tabindex="-1" data-wysihtml5-command="italic" title="CTRL+I">Italic</a>\n  <a tabindex="-1" data-wysihtml5-command="insertUnorderedList">Bullets</a>\n  <a tabindex="-1" data-wysihtml5-command="insertOrderedList">Numbers</a>\n  <a tabindex="-1" data-wysihtml5-command="pre">Quote</a>\n</div>\n')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")}}.call(this);